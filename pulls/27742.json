{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742",
    "id": 1363377743,
    "node_id": "PR_kwDOABII585RQ35P",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/27742",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/27742.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/27742.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27742",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27742/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/cdb5b163d623db802ed7f8a3394b2674362f409b",
    "number": 27742,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "[NO MERGE] BIP331 Ancestor Package Relay",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "**WORK IN PROGRESS.** Please do not run it for any use other than testing.\r\n  \r\nThis PR is not meant for merge. This branch exists to help reviewers see what package relay would look like all together. I will open separate PRs for these components and expect to add more tests, docs, and polish along the way. This PR contains all of the functionality built in a linear manner. However, since there are pieces in various areas of the codebase and they can make progress in parallel, commits don't necessarily need to be merged in this order.\r\n\r\n**See #27463 for what PR(s) are open for review right now.**\r\n\r\n## Note to Reviewers\r\n\r\nThe major purpose of this PR is to solicit \"approach\" review.\r\n\r\nThis is a large project, and the first few p2p commits essentially define the interface. I'd like to get rough consensus on approach before we start looking at code details and merging PRs, because I believe it will help us \"get useful stuff in\" faster and avoid premature optimizations.\r\n\r\nHere are some questions I hope are answered before we try to merge anything (originally https://github.com/bitcoin/bitcoin/pull/27742#issuecomment-1572205313):\r\n\r\n1. Does the proposed protocol look sound?\r\n2. Are these 3 milestones appropriate?\r\n3. Is there important functionality that is in the \"todo improvements\" section but should be included in one of the 3 milestones? Alternatively, is there not-that-important stuff in the milestones that we should defer until later?\r\n4. Does it make sense to have this PeerManager <-> TxPackageTracker <-> TxOrphanage relationship?\r\n\r\n\r\nComments about naming, typos, code details, etc. are also appreciated but please note I may wait until their respective PRs are open to incorporate your comments. Thank you for your patience.\r\n\r\n## Project Structure\r\n\r\n### 3 Major Milestones\r\n\r\nThis project is split into 3 milestones, each of which gives us something useful.\r\n\r\n1. Modularize and improve orphan-handling (also some refactoring).\r\n\t- Introduce a `TxPackageTracker` class, responsible for orphan handling. It starts out as a wrapper for the `TxOrphanage`.\r\n\t- Use all announcers as potential candidates for resolving an orphan. Add a `TxRequestTracker` Orphan Request Tracker which helps track orphans we need to resolve. Preferentially request orphan resolution from outbounds, preferred relay, etc., over inbounds.\r\n\r\n2. When package relay peers are available, use `ancpkginfo` instead of missing parents when handling orphans.\r\n\t- Add `sendpackages` negotiation logic.\r\n\t- Add a separate rejections filter for transactions that are eligible for reconsideration when validated together as a package, so that children of low-feerate transactions are still considered.\r\n\t- Send `getdata(MSG_ANCPKGINFO)` to package relay peers for orphan resolution. Use `ancpkginfo` to request missing ancestors through normal individual transaction relay.\r\n\r\n3. Download and validate ancestor packages using `getpkgtxns` and `pkgtxns`.\r\n\t- Add support for `getpkgtxns` and `pkgtxns`. Send a `pkgtxns` using the list of missing transactions from `ancpkginfo`.\r\n\t- Ensure we can process \"normal\" orphans even if a peer is trying to overwhelm/churn our orphanage. Do this by \"opportunistically\" protecting orphans from random eviction if they were sent by package relay peers, and redownloading orphans if we cannot afford to protect them. Each peer is allocated a certain amount of orphans they can protect at a time (\"token bucket\" style but the number of tokens is static for now). Outbound peers get more than inbounds.\r\n\t- If a transaction's parent(s) are below the fee filter, don't announce it (save the bandwidth of legacy nodes).\r\n\r\n###  Todo improvements \r\nThese could be added to the milestones or deferred until basic functionality is deployed.\r\n- Store orphans serialized instead of as CTransactionRefs to significantly reduce their memory usage.\r\n- Perhaps try to keep orphans in disk and/or process them asynchronously, given the incredibly DoSable nature of orphan handling.\r\n- Dynamically allocate tokens for orphan protection. For example, if a long-standing inbound peer continuously provides good packages for orphans, they should have more tokens. If a peer is obviously serving us garbage, reduce their tokens.\r\n- Detect when we have received all the transactions for a package, regardless of how (individual or block or other), and return `PackageToValidate`  in `GetTxToReconsider`.\r\n- New format for mempool.dat, packages instead of transactions.",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "created_at": "2023-05-24T15:38:55Z",
    "updated_at": "2023-06-05T14:19:37Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "c6dcb5f724163dbc8ce503d51c3d4be17b6ffc84",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "glozow:package-relay-token-bucket",
      "ref": "package-relay-token-bucket",
      "sha": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 244262754,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNDQyNjI3NTQ=",
        "name": "bitcoin",
        "full_name": "glozow/bitcoin",
        "owner": {
          "login": "glozow",
          "id": 25183001,
          "node_id": "MDQ6VXNlcjI1MTgzMDAx",
          "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/glozow",
          "html_url": "https://github.com/glozow",
          "followers_url": "https://api.github.com/users/glozow/followers",
          "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
          "organizations_url": "https://api.github.com/users/glozow/orgs",
          "repos_url": "https://api.github.com/users/glozow/repos",
          "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/glozow/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/glozow/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/glozow/bitcoin",
        "archive_url": "https://api.github.com/repos/glozow/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/glozow/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/glozow/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/glozow/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/glozow/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/glozow/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/glozow/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/glozow/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/glozow/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/glozow/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/glozow/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/glozow/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/glozow/bitcoin/events",
        "forks_url": "https://api.github.com/repos/glozow/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/glozow/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/glozow/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/glozow/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/glozow/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/glozow/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/glozow/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/glozow/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/glozow/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/glozow/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/glozow/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/glozow/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/glozow/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/glozow/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/glozow/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/glozow/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:glozow/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/glozow/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/glozow/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/glozow/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/glozow/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/glozow/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/glozow/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/glozow/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/glozow/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/glozow/bitcoin/hooks",
        "svn_url": "https://github.com/glozow/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 7,
        "watchers_count": 7,
        "size": 225090,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T07:39:06Z",
        "created_at": "2020-03-02T02:31:56Z",
        "updated_at": "2022-01-07T17:55:23Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "f08bde7f715cf84ef050c3f6902bc75fb90cedb3",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34325,
        "stargazers_count": 69819,
        "watchers_count": 69819,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 626,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T07:29:24Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T07:34:31Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
      }
    },
    "author_association": "MEMBER",
    "draft": true,
    "additions": 3861,
    "deletions": 304,
    "changed_files": 39,
    "commits": 54,
    "review_comments": 41,
    "comments": 5
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA1MDI0N2UwOTYzMDhhZjE1ZTk1ZDc4NWI4YzkyZTczYzE2MGI3M2Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/050247e096308af15e95d785b8c92e73c160b73f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/050247e096308af15e95d785b8c92e73c160b73f",
      "tree": {
        "sha": "6f70416c8fa2007d0a860ee7c9b3c09789b3c19c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6f70416c8fa2007d0a860ee7c9b3c09789b3c19c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0f8c95dccd120ad5fd371f81025137b855796f13",
          "sha": "0f8c95dccd120ad5fd371f81025137b855796f13",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0f8c95dccd120ad5fd371f81025137b855796f13"
        }
      ],
      "message": "[validation] require child feerate > package feerate",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T11:23:01Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-10T16:02:41Z"
      },
      "sha": "050247e096308af15e95d785b8c92e73c160b73f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGEyNDhlYjQ2MTdiZTRiNzhjNTdlNjM4MzZkOGIxZTAxOTBmODk2MGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a248eb4617be4b78c57e63836d8b1e0190f8960b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a248eb4617be4b78c57e63836d8b1e0190f8960b",
      "tree": {
        "sha": "a388968b72e2635bb0e7c83848487c2ffa96e766",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a388968b72e2635bb0e7c83848487c2ffa96e766"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/050247e096308af15e95d785b8c92e73c160b73f",
          "sha": "050247e096308af15e95d785b8c92e73c160b73f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/050247e096308af15e95d785b8c92e73c160b73f"
        }
      ],
      "message": "[test util] multi-input multi-output CreateValidMempoolTransaction",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T11:23:01Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-10-03T09:56:00Z"
      },
      "sha": "a248eb4617be4b78c57e63836d8b1e0190f8960b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdlMjVlMDAyMTAwZjU3ZDY5YTk2N2Y0NzVlYjQ4NGE4NjM3ZDlkY2I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e25e002100f57d69a967f475eb484a8637d9dcb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7e25e002100f57d69a967f475eb484a8637d9dcb",
      "tree": {
        "sha": "3914650bb8a70137c43237739176efffe0ea3288",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3914650bb8a70137c43237739176efffe0ea3288"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a248eb4617be4b78c57e63836d8b1e0190f8960b",
          "sha": "a248eb4617be4b78c57e63836d8b1e0190f8960b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a248eb4617be4b78c57e63836d8b1e0190f8960b"
        }
      ],
      "message": "[unit test] parent pay for child is not allowed\n\nCo-authored-by: Andrew Chow <achow101@gmail.com>",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-10T18:46:26Z"
      },
      "sha": "7e25e002100f57d69a967f475eb484a8637d9dcb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM0YTBiZGJiYTZlMjZmMDk2NDYwNWJlNGIzNTNiNWZiNWEwYWQzNTU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c4a0bdbba6e26f0964605be4b353b5fb5a0ad355",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c4a0bdbba6e26f0964605be4b353b5fb5a0ad355",
      "tree": {
        "sha": "aa7b8ad6b91d68005d14596329e0eaa4cbd2c57a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/aa7b8ad6b91d68005d14596329e0eaa4cbd2c57a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e25e002100f57d69a967f475eb484a8637d9dcb",
          "sha": "7e25e002100f57d69a967f475eb484a8637d9dcb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7e25e002100f57d69a967f475eb484a8637d9dcb"
        }
      ],
      "message": "[rpc] allow submitpackage to be called outside of regtest",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-04-11T15:07:34Z"
      },
      "sha": "c4a0bdbba6e26f0964605be4b353b5fb5a0ad355"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGY2YjkyOGIxMjQxZGU1YjBjZmRjZmQwY2ViYjNkNTZlZjhmZThjZTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f6b928b1241de5b0cfdcfd0cebb3d56ef8fe8ce4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f6b928b1241de5b0cfdcfd0cebb3d56ef8fe8ce4",
      "tree": {
        "sha": "fc0e98fc09f488f01f9bcd603ec863f8aa1447c6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fc0e98fc09f488f01f9bcd603ec863f8aa1447c6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c4a0bdbba6e26f0964605be4b353b5fb5a0ad355",
          "sha": "c4a0bdbba6e26f0964605be4b353b5fb5a0ad355",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c4a0bdbba6e26f0964605be4b353b5fb5a0ad355"
        }
      ],
      "message": "[doc] add release note for submitpackage",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-10T15:43:05Z"
      },
      "sha": "f6b928b1241de5b0cfdcfd0cebb3d56ef8fe8ce4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFiYWZmNjc3ZTY3MzEzOWRmYjAwZDExYjAxNmVhOWQ4OTE2YmZmMWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1baff677e673139dfb00d11b016ea9d8916bff1c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1baff677e673139dfb00d11b016ea9d8916bff1c",
      "tree": {
        "sha": "a8acf891beb5d5a2cbc2303686443e3b7e0cc88c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a8acf891beb5d5a2cbc2303686443e3b7e0cc88c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f6b928b1241de5b0cfdcfd0cebb3d56ef8fe8ce4",
          "sha": "f6b928b1241de5b0cfdcfd0cebb3d56ef8fe8ce4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f6b928b1241de5b0cfdcfd0cebb3d56ef8fe8ce4"
        }
      ],
      "message": "[validation] call AcceptSingleTransaction when only 1 package tx left\n\nAvoid calling PackageMempoolChecks() when there is only 1 transaction.\nNote to reviewers: there is a slight change in the error type returned,\nas shown in the txpackage_tests change.  When a transaction is the last\none left in the package and its fee is too low, this returns a PCKG_TX\ninstead of PCKG_POLICY. This interface is clearer;\n\"package-fee-too-low\" for 1 transaction would be a bit misleading.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-12-15T18:00:04Z"
      },
      "sha": "1baff677e673139dfb00d11b016ea9d8916bff1c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM5YmYzN2RlMmVlNTc2OWJjNDYyZWQwYzhjNDM3ZTBkM2QwMGE0MzE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c9bf37de2ee5769bc462ed0c8c437e0d3d00a431",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c9bf37de2ee5769bc462ed0c8c437e0d3d00a431",
      "tree": {
        "sha": "a8949798d6c4813379005f478e307097044942b4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a8949798d6c4813379005f478e307097044942b4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1baff677e673139dfb00d11b016ea9d8916bff1c",
          "sha": "1baff677e673139dfb00d11b016ea9d8916bff1c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1baff677e673139dfb00d11b016ea9d8916bff1c"
        }
      ],
      "message": "MOVEONLY: move package checks into helper functions",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-09-16T15:49:24Z"
      },
      "sha": "c9bf37de2ee5769bc462ed0c8c437e0d3d00a431"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhiMzc1YWEwMGMxMWQyNDZkYzEzMmFlNzk5OTZkMTVlM2VlZDVlZTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8b375aa00c11d246dc132ae79996d15e3eed5ee1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8b375aa00c11d246dc132ae79996d15e3eed5ee1",
      "tree": {
        "sha": "98fd0b2a11b8bac355e35ebea8ce603c0ddf3e13",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/98fd0b2a11b8bac355e35ebea8ce603c0ddf3e13"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c9bf37de2ee5769bc462ed0c8c437e0d3d00a431",
          "sha": "c9bf37de2ee5769bc462ed0c8c437e0d3d00a431",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c9bf37de2ee5769bc462ed0c8c437e0d3d00a431"
        }
      ],
      "message": "scripted-diff: rename CheckPackage to IsPackageWellFormed\n\n-BEGIN VERIFY SCRIPT-\nsed -i 's/CheckPackage(/IsPackageWellFormed(/g' $(git grep -l CheckPackage)\n-END VERIFY SCRIPT-",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-19T17:31:58Z"
      },
      "sha": "8b375aa00c11d246dc132ae79996d15e3eed5ee1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDAwNTU4MWI1ZWE2MWVkZDQ0NDQzOTkwMDEwOWM1MjdjNzExMmE2NTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/005581b5ea61edd444439900109c527c7112a650",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/005581b5ea61edd444439900109c527c7112a650",
      "tree": {
        "sha": "02195db6d68d6af2aac608e31f46e0010850e08d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/02195db6d68d6af2aac608e31f46e0010850e08d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8b375aa00c11d246dc132ae79996d15e3eed5ee1",
          "sha": "8b375aa00c11d246dc132ae79996d15e3eed5ee1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8b375aa00c11d246dc132ae79996d15e3eed5ee1"
        }
      ],
      "message": "[packages] AncestorPackage sorts and builds ancestor subsets\n\nWe cannot require that peers send topologically sorted lists, because we\ncannot check for this property without ensuring we have the same chain\ntip and ensuring we have the full ancestor set. Instead, add the ability\nto handle arbitrarily ordered transaction lists.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-09-16T15:51:36Z"
      },
      "sha": "005581b5ea61edd444439900109c527c7112a650"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU3NzIxMDJkODNjNDU5OTEwYWVlMDZmOWZkMWE1MDE3NmU3Njk5Nzg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e772102d83c459910aee06f9fd1a50176e769978",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e772102d83c459910aee06f9fd1a50176e769978",
      "tree": {
        "sha": "e0a95d12000745ebfd82f2261fd945fbe86c1bb6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e0a95d12000745ebfd82f2261fd945fbe86c1bb6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/005581b5ea61edd444439900109c527c7112a650",
          "sha": "005581b5ea61edd444439900109c527c7112a650",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/005581b5ea61edd444439900109c527c7112a650"
        }
      ],
      "message": "[fuzz] AncestorPackage",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-16T15:31:44Z"
      },
      "sha": "e772102d83c459910aee06f9fd1a50176e769978"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDMxOWU1ZWQ1MjIwZTkyNzg5OWU5NWI1OTNkODYzYjNlZDUwM2Q2ZGU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/319e5ed5220e927899e95b593d863b3ed503d6de",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/319e5ed5220e927899e95b593d863b3ed503d6de",
      "tree": {
        "sha": "7220245f152893635bbfa9491336144f2dc4558e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7220245f152893635bbfa9491336144f2dc4558e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e772102d83c459910aee06f9fd1a50176e769978",
          "sha": "e772102d83c459910aee06f9fd1a50176e769978",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e772102d83c459910aee06f9fd1a50176e769978"
        }
      ],
      "message": "[validation] skip and pre-fill txns with irreversibly invalid ancestors\n\nPackageifier calculates the in-package ancestors. We already know\nthis tx will fail because it depends on something invalid (specifically\nfor a non-policy reason). We also know that it is missing at least one\ninput (the tx that did not and will not make it into our mempool).\n\nNote to reviewers: slight behavior change. If this tx has multiple\nerrors, there may be a difference in which one is returned. For\nexample, if the tx has a dust output in addition to relying on\nthe invalid tx, we will return TX_MISSING_INPUTS when we previously\nwould have returned TX_NOT_STANDARD. This is simply because dust is\nchecked earlier within PreChecks().\n\nAdd a test that we don't quit *too* early and reject transactions we\nshould keep.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-12-14T13:38:32Z"
      },
      "sha": "319e5ed5220e927899e95b593d863b3ed503d6de"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg5NDMwNTc0YWM0ZjJlMDIyZWRkOWZkZGYxYmYwNTE1YWJjMzZjYzg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/89430574ac4f2e022edd9fddf1bf0515abc36cc8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/89430574ac4f2e022edd9fddf1bf0515abc36cc8",
      "tree": {
        "sha": "dba2b6dd5c6258cd59b6f04855aebda1f175f20f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dba2b6dd5c6258cd59b6f04855aebda1f175f20f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/319e5ed5220e927899e95b593d863b3ed503d6de",
          "sha": "319e5ed5220e927899e95b593d863b3ed503d6de",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/319e5ed5220e927899e95b593d863b3ed503d6de"
        }
      ],
      "message": "[validation] skip last tx in AcceptPackage \"submit individually\" loop\n\nPrior to this commit, if the last tx is invalid for a policy, missing\ninputs, or \"mempool full\", we validate it twice (once inside this loop,\nand then again afterwards). This is unnecessary.\nIf we come to the last transaction in the package, break.\n\nThis needs to be after the !subpackage quit early condition so that\nthat the child is present in the results map.\n\nsubfill the child state for missing inputs",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-12-16T10:31:52Z"
      },
      "sha": "89430574ac4f2e022edd9fddf1bf0515abc36cc8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYxN2ZlNzA5MmU0ZmQ3Yzk4N2UwNDgwOGFkZjk3ZTE2OWRjMjRmNDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/617fe7092e4fd7c987e04808adf97e169dc24f47",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/617fe7092e4fd7c987e04808adf97e169dc24f47",
      "tree": {
        "sha": "cbc2fd94da0c39c0e5350aff27f03025331ea7db",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cbc2fd94da0c39c0e5350aff27f03025331ea7db"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/89430574ac4f2e022edd9fddf1bf0515abc36cc8",
          "sha": "89430574ac4f2e022edd9fddf1bf0515abc36cc8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/89430574ac4f2e022edd9fddf1bf0515abc36cc8"
        }
      ],
      "message": "[validation] validate packages by submitting each tx's ancestor sub-packages\n\nThis results in the incentive-compatible transactions ending up in our\nmempool. Prior to this commit, if parents within the package relied on\neach other, we could end up (1) accepting a low-feerate child or (2)\nrejecting high-feerate parents. Instead of validating each transaction\n*individually* in turn, validate each one with their in-package ancestor\nset. This means parents with inter-dependencies are validated correctly,\nwhile we continue using aggregate totals for package feerate.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-12-15T18:17:47Z"
      },
      "sha": "617fe7092e4fd7c987e04808adf97e169dc24f47"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM0NGRmOWIwYmZhNjZjNzdlNWNiYmZmNjY4OGVhNzNjZjM5ZWMxZDM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c44df9b0bfa66c77e5cbbff6688ea73cf39ec1d3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c44df9b0bfa66c77e5cbbff6688ea73cf39ec1d3",
      "tree": {
        "sha": "d56d01ce3d1685141a7dcf713ec0c4abb8b83dc1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d56d01ce3d1685141a7dcf713ec0c4abb8b83dc1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/617fe7092e4fd7c987e04808adf97e169dc24f47",
          "sha": "617fe7092e4fd7c987e04808adf97e169dc24f47",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/617fe7092e4fd7c987e04808adf97e169dc24f47"
        }
      ],
      "message": "[policy] allow any ancestor package, not just child-with-unconfirmed-parents\n\nWe can safely allow any ancestor package since Packageifier can handle\nthings that are out of order. Remove the check that \"all unconfirmed\nparents are present\" because, even if a tx is missing inputs, the other\ntransactions may be worth validating.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-17T13:42:52Z"
      },
      "sha": "c44df9b0bfa66c77e5cbbff6688ea73cf39ec1d3"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGIyMzRmOTkzZGEzY2FhMTZmNzcxNjk0OGZiY2QxNmFiMWE1MDAxODA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b234f993da3caa16f7716948fbcd16ab1a500180",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b234f993da3caa16f7716948fbcd16ab1a500180",
      "tree": {
        "sha": "0e4c7278ae9198bf42d24ce8c634ff743d6fcc43",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0e4c7278ae9198bf42d24ce8c634ff743d6fcc43"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c44df9b0bfa66c77e5cbbff6688ea73cf39ec1d3",
          "sha": "c44df9b0bfa66c77e5cbbff6688ea73cf39ec1d3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c44df9b0bfa66c77e5cbbff6688ea73cf39ec1d3"
        }
      ],
      "message": "MOVEONLY: rename AcceptPackage to AcceptAncestorPackage",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-10T21:50:56Z"
      },
      "sha": "b234f993da3caa16f7716948fbcd16ab1a500180"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNlNjkwYTdmYjM1NjM1Y2IyMGYxZDU0N2NjYzE5MDU3ZGI3YThkMjU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ce690a7fb35635cb20f1d547ccc19057db7a8d25",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ce690a7fb35635cb20f1d547ccc19057db7a8d25",
      "tree": {
        "sha": "0e4c7278ae9198bf42d24ce8c634ff743d6fcc43",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0e4c7278ae9198bf42d24ce8c634ff743d6fcc43"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b234f993da3caa16f7716948fbcd16ab1a500180",
          "sha": "b234f993da3caa16f7716948fbcd16ab1a500180",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b234f993da3caa16f7716948fbcd16ab1a500180"
        }
      ],
      "message": "-- Part 1: Orphan Resolution Module --\n\nCreate TxPackageTracker module, responsible for handling orphan\nresolution. Enable node to retry orphan parent downloading from multiple\npeers who announced the tx. Use preferred peers and avoid overloading\npeers with too many requests.\n\nMaking the orphanage more reliable is also necessary because it becomes\npart of the \"critical path\" for some transactions.  A 0-fee parent\nbumped by a child *must* be relayed via package relay; if the orphanage\noverflows or is churned by a malicious peer, the package would be\ncensored from the network.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-20T10:45:56Z"
      },
      "sha": "ce690a7fb35635cb20f1d547ccc19057db7a8d25"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDUyODMwNWYyOTIyOGNjMzMxOGNkOWRlZGYyMjU4ZDJhYzYzYjY0MjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/528305f29228cc3318cd9dedf2258d2ac63b6424",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/528305f29228cc3318cd9dedf2258d2ac63b6424",
      "tree": {
        "sha": "5df995306d501bcb6358466f5382923ef6e51b45",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5df995306d501bcb6358466f5382923ef6e51b45"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ce690a7fb35635cb20f1d547ccc19057db7a8d25",
          "sha": "ce690a7fb35635cb20f1d547ccc19057db7a8d25",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ce690a7fb35635cb20f1d547ccc19057db7a8d25"
        }
      ],
      "message": "[p2p] add tx package tracker",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-05-01T17:41:53Z"
      },
      "sha": "528305f29228cc3318cd9dedf2258d2ac63b6424"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA1MTk3NGZmOWMxYzFiZjIxZmNhMjIzNjg0ZjQ2ODU3N2I3MjhmNGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/051974ff9c1c1bf21fca223684f468577b728f4d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/051974ff9c1c1bf21fca223684f468577b728f4d",
      "tree": {
        "sha": "6d170f4af7c96e5f431a45cd3e7162f6a027ca08",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6d170f4af7c96e5f431a45cd3e7162f6a027ca08"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/528305f29228cc3318cd9dedf2258d2ac63b6424",
          "sha": "528305f29228cc3318cd9dedf2258d2ac63b6424",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/528305f29228cc3318cd9dedf2258d2ac63b6424"
        }
      ],
      "message": "[refactor] wrap TxOrphanage inside TxPackageTracker",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:17:21Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-10-06T11:02:29Z"
      },
      "sha": "051974ff9c1c1bf21fca223684f468577b728f4d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIyZTkzZjA4YTUwYTIwNmI1NDcxN2IwNzY4MmU3M2E3NTFjYzY3NTU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/22e93f08a50a206b54717b07682e73a751cc6755",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/22e93f08a50a206b54717b07682e73a751cc6755",
      "tree": {
        "sha": "bb4dffc4a725667067cde10ac2b2f7e1b5d4a757",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bb4dffc4a725667067cde10ac2b2f7e1b5d4a757"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/051974ff9c1c1bf21fca223684f468577b728f4d",
          "sha": "051974ff9c1c1bf21fca223684f468577b728f4d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/051974ff9c1c1bf21fca223684f468577b728f4d"
        }
      ],
      "message": "[txorphange] use wtxid instead of txid, handle nullptr",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:30:41Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-24T13:14:31Z"
      },
      "sha": "22e93f08a50a206b54717b07682e73a751cc6755"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGUyZDg3MjlmNDc3NzgwZTUzZTk3MDE5NTljYzEzNGViNjQ4NTVkMmY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e2d8729f477780e53e9701959cc134eb64855d2f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e2d8729f477780e53e9701959cc134eb64855d2f",
      "tree": {
        "sha": "992d143f935affe5904562bb3b0144780371d17b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/992d143f935affe5904562bb3b0144780371d17b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/22e93f08a50a206b54717b07682e73a751cc6755",
          "sha": "22e93f08a50a206b54717b07682e73a751cc6755",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/22e93f08a50a206b54717b07682e73a751cc6755"
        }
      ],
      "message": "[txorphanage] return erased wtxids from EraseForBlock",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:30:41Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-20T09:59:14Z"
      },
      "sha": "e2d8729f477780e53e9701959cc134eb64855d2f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJhNDY2Y2M5NzRhYzUzM2VhNWM3MmJlY2Y2MGQ4YWE2MDE1YzFhZDg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ba466cc974ac533ea5c72becf60d8aa6015c1ad8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ba466cc974ac533ea5c72becf60d8aa6015c1ad8",
      "tree": {
        "sha": "b2712e97c6e554a69ea72c4cee3409ec11024866",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b2712e97c6e554a69ea72c4cee3409ec11024866"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e2d8729f477780e53e9701959cc134eb64855d2f",
          "sha": "e2d8729f477780e53e9701959cc134eb64855d2f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e2d8729f477780e53e9701959cc134eb64855d2f"
        }
      ],
      "message": "[log] add category TXPACKAGES for orphanage and package relay",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:30:41Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-03-06T16:46:18Z"
      },
      "sha": "ba466cc974ac533ea5c72becf60d8aa6015c1ad8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQxNzhjMGZiMzcyZmM1MDg1NzQzOGIxYjgyZDM0NGZlZDA2MzRhMTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d178c0fb372fc50857438b1b82d344fed0634a10",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d178c0fb372fc50857438b1b82d344fed0634a10",
      "tree": {
        "sha": "0da1b9edc1ab51169332ca5d9afd9bcc26e32c2e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0da1b9edc1ab51169332ca5d9afd9bcc26e32c2e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ba466cc974ac533ea5c72becf60d8aa6015c1ad8",
          "sha": "ba466cc974ac533ea5c72becf60d8aa6015c1ad8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ba466cc974ac533ea5c72becf60d8aa6015c1ad8"
        }
      ],
      "message": "[txorphanage] impose a maximum total size of orphans\n\nNo effect for now.\nTODO: add per-peer limits on orphan memory usage",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:30:41Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-03-31T09:58:09Z"
      },
      "sha": "d178c0fb372fc50857438b1b82d344fed0634a10"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk4NmY3NjIyZGFiZDQyMmQ2ZGMyMWJmYzMzMTlhMGQwNGQ0YzRlY2M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/986f7622dabd422d6dc21bfc3319a0d04d4c4ecc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/986f7622dabd422d6dc21bfc3319a0d04d4c4ecc",
      "tree": {
        "sha": "2d65d73562fd532af4cd472fce4e926cb3c677ae",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2d65d73562fd532af4cd472fce4e926cb3c677ae"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d178c0fb372fc50857438b1b82d344fed0634a10",
          "sha": "d178c0fb372fc50857438b1b82d344fed0634a10",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d178c0fb372fc50857438b1b82d344fed0634a10"
        }
      ],
      "message": "[txorphanage] track bytes provided per peer",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-24T14:30:41Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-04-18T10:06:51Z"
      },
      "sha": "986f7622dabd422d6dc21bfc3319a0d04d4c4ecc"
    },
    {
      "event": "commented",
      "id": 1561395468,
      "node_id": "IC_kwDOABII585dEQEM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1561395468",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-24T15:38:59Z",
      "updated_at": "2023-06-01T14:10:03Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27675](https://github.com/bitcoin/bitcoin/pull/27675) (net_processing: Drop m_recently_announced_invs bloom filter by ajtowns)\n* [#27596](https://github.com/bitcoin/bitcoin/pull/27596) (assumeutxo (2) by jamesob)\n* [#27509](https://github.com/bitcoin/bitcoin/pull/27509) (Relay own transactions only via short-lived Tor or I2P connections by vasild)\n* [#27499](https://github.com/bitcoin/bitcoin/pull/27499) (net processing, refactor: Decouple PeerManager from gArgs by dergoegge)\n* [#27385](https://github.com/bitcoin/bitcoin/pull/27385) (net, refactor: extract Network and BIP155Network logic to node/network by jonatack)\n* [#26697](https://github.com/bitcoin/bitcoin/pull/26697) (logging: use bitset for categories by LarryRuane)\n* [#26621](https://github.com/bitcoin/bitcoin/pull/26621) (refactor: Continue moving application data from CNode to Peer by dergoegge)\n* [#26451](https://github.com/bitcoin/bitcoin/pull/26451) (Enforce incentive compatibility for all RBF replacements by sdaftuar)\n* [#25572](https://github.com/bitcoin/bitcoin/pull/25572) (refactor: Introduce EvictionManager and use it for the inbound eviction logic by dergoegge)\n* [#25268](https://github.com/bitcoin/bitcoin/pull/25268) (refactor: Introduce EvictionManager by dergoegge)\n* [#20892](https://github.com/bitcoin/bitcoin/pull/20892) (tests: Run both descriptor and legacy tests within a single test invocation by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#issuecomment-1561395468",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27742"
    },
    {
      "event": "labeled",
      "id": 9329566212,
      "node_id": "LE_lADOABII585mxnIEzwAAAAIsFeIE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9329566212",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-24T15:39:40Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "labeled",
      "id": 9335701409,
      "node_id": "LE_lADOABII585mxnIEzwAAAAIsc3-h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9335701409",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-25T06:04:15Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9379839908,
      "node_id": "HRFPE_lADOABII585mxnIEzwAAAAIvFP-k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9379839908",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T15:18:57Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFjMTNmNjQ2NWMxNzA2Mzk0NjU5OTBlMzhhMTg4MTkzYzAzNjY0OGM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1c13f6465c170639465990e38a188193c036648c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1c13f6465c170639465990e38a188193c036648c",
      "tree": {
        "sha": "0bbf47541134ea515c9ad70bebc3703626e1a9ea",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0bbf47541134ea515c9ad70bebc3703626e1a9ea"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/986f7622dabd422d6dc21bfc3319a0d04d4c4ecc",
          "sha": "986f7622dabd422d6dc21bfc3319a0d04d4c4ecc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/986f7622dabd422d6dc21bfc3319a0d04d4c4ecc"
        }
      ],
      "message": "[txpackagetracker] add orphan resolution tracker",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T10:11:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-24T13:12:56Z"
      },
      "sha": "1c13f6465c170639465990e38a188193c036648c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ5OGUzNDNhNGQ3NjdkNWM2Mjk3NmQ3ZjQ4ZGJhYzdiODJkODYxNTc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/498e343a4d767d5c62976d7f48dbac7b82d86157",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/498e343a4d767d5c62976d7f48dbac7b82d86157",
      "tree": {
        "sha": "78ab65245bdfcf53d479f309272504835c5feea5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/78ab65245bdfcf53d479f309272504835c5feea5"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1c13f6465c170639465990e38a188193c036648c",
          "sha": "1c13f6465c170639465990e38a188193c036648c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1c13f6465c170639465990e38a188193c036648c"
        }
      ],
      "message": "[refactor] use txpackagetracker for orphan resolution\n\nNo behavior change in this commit.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T10:11:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-10-06T13:24:26Z"
      },
      "sha": "498e343a4d767d5c62976d7f48dbac7b82d86157"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRkMGU1OTJkYzJjNmM2YzhiZjBjYWJmM2JhNTIyNDk4ZjFhMGRlZWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dd0e592dc2c6c6c8bf0cabf3ba522498f1a0deec",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/dd0e592dc2c6c6c8bf0cabf3ba522498f1a0deec",
      "tree": {
        "sha": "e827e8fdeb2815d35c6e74219564b95e7af630f2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e827e8fdeb2815d35c6e74219564b95e7af630f2"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/498e343a4d767d5c62976d7f48dbac7b82d86157",
          "sha": "498e343a4d767d5c62976d7f48dbac7b82d86157",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/498e343a4d767d5c62976d7f48dbac7b82d86157"
        }
      ],
      "message": "[txpackagetracker] delete unused OrphanageAddTx\n\nAdding/deleting is now strictly handled by TxPackageTracker, and should\nnot be exposed to the public.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T10:11:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-04-18T12:46:08Z"
      },
      "sha": "dd0e592dc2c6c6c8bf0cabf3ba522498f1a0deec"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIxMmE3MDEwMjU3YjQzZWZmOWZhMDE3YmNmNjI1YWNmYzg0ZjY1MGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/212a7010257b43eff9fa017bcf625acfc84f650f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/212a7010257b43eff9fa017bcf625acfc84f650f",
      "tree": {
        "sha": "cbeca4d9fc158d8ab448dfb25ecfcddefa1fe2a4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cbeca4d9fc158d8ab448dfb25ecfcddefa1fe2a4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dd0e592dc2c6c6c8bf0cabf3ba522498f1a0deec",
          "sha": "dd0e592dc2c6c6c8bf0cabf3ba522498f1a0deec",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/dd0e592dc2c6c6c8bf0cabf3ba522498f1a0deec"
        }
      ],
      "message": "[txrequest] GetCandidatePeers and ResetRequestTimeout",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T10:11:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-03-20T10:37:23Z"
      },
      "sha": "212a7010257b43eff9fa017bcf625acfc84f650f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZlY2I1MjJhM2ZhODNlN2I0ODVmNWQxN2YwNzBlZDU2ZDQ3ZTNkOTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fecb522a3fa83e7b485f5d17f070ed56d47e3d90",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fecb522a3fa83e7b485f5d17f070ed56d47e3d90",
      "tree": {
        "sha": "fbd8fc4f4fedd4e758ea5e41b50bea19c3dfa56d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fbd8fc4f4fedd4e758ea5e41b50bea19c3dfa56d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/212a7010257b43eff9fa017bcf625acfc84f650f",
          "sha": "212a7010257b43eff9fa017bcf625acfc84f650f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/212a7010257b43eff9fa017bcf625acfc84f650f"
        }
      ],
      "message": "[txorphanage] support multiple announcers",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T10:11:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-04-18T15:02:58Z"
      },
      "sha": "fecb522a3fa83e7b485f5d17f070ed56d47e3d90"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDExYTkxMzQ5NDVkMTY5YWFmNTgwZGM2MWYwM2M5NWZhNzI0NTZiNzE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/11a9134945d169aaf580dc61f03c95fa72456b71",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/11a9134945d169aaf580dc61f03c95fa72456b71",
      "tree": {
        "sha": "38abfacd1e7712f4d83fdc6829c2e49be6482e77",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/38abfacd1e7712f4d83fdc6829c2e49be6482e77"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fecb522a3fa83e7b485f5d17f070ed56d47e3d90",
          "sha": "fecb522a3fa83e7b485f5d17f070ed56d47e3d90",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fecb522a3fa83e7b485f5d17f070ed56d47e3d90"
        }
      ],
      "message": "[unit test] orphanage: multiple announcers, eviction",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T10:11:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-04-18T18:12:35Z"
      },
      "sha": "11a9134945d169aaf580dc61f03c95fa72456b71"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA2NzFlMWMxNzgyNzAzNTBhYWRlYmE2MjVkYThiOTVkNmVmMmZmMDA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0671e1c178270350aadeba625da8b95d6ef2ff00",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0671e1c178270350aadeba625da8b95d6ef2ff00",
      "tree": {
        "sha": "c0c894addde9fea078ba809988bdfa39ad801963",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c0c894addde9fea078ba809988bdfa39ad801963"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/11a9134945d169aaf580dc61f03c95fa72456b71",
          "sha": "11a9134945d169aaf580dc61f03c95fa72456b71",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/11a9134945d169aaf580dc61f03c95fa72456b71"
        }
      ],
      "message": "[p2p] use all orphan announcers as potential parent sources\n\nMakes orphan handling more robust. We will also use the orphan\nresolution tracker for requesting ancpkginfo. The timeout in\np2p_segwit.py has been increased to account for the fact that parents\nare no longer immediately requested.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T10:11:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-10-06T13:24:26Z"
      },
      "sha": "0671e1c178270350aadeba625da8b95d6ef2ff00"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI2OTI4YjljNzZlYzY1ZThmODYwOWRmZTA3ZWFiNGJjYjhhNDU1ZWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/26928b9c76ec65e8f8609dfe07eab4bcb8a455ea",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/26928b9c76ec65e8f8609dfe07eab4bcb8a455ea",
      "tree": {
        "sha": "f4d7403bdc4a92385f1a7925180ab2678a0ba745",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f4d7403bdc4a92385f1a7925180ab2678a0ba745"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0671e1c178270350aadeba625da8b95d6ef2ff00",
          "sha": "0671e1c178270350aadeba625da8b95d6ef2ff00",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0671e1c178270350aadeba625da8b95d6ef2ff00"
        }
      ],
      "message": "[doc] no notfound handling for orphan resolution by parent txid\n\nNote this is status quo.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T10:11:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-04-19T14:39:11Z"
      },
      "sha": "26928b9c76ec65e8f8609dfe07eab4bcb8a455ea"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9388508780,
      "node_id": "HRFPE_lADOABII585mxnIEzwAAAAIvmUZs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9388508780",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-31T10:33:16Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDNkM2ZlYzhkNjU4MDVlMzM2MjI5OTM1YjI3NzM1OTA0MjhlZmQyZGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3d3fec8d65805e336229935b2773590428efd2df",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3d3fec8d65805e336229935b2773590428efd2df",
      "tree": {
        "sha": "91f4941bf034e87728f68c06253bbadc5767193b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/91f4941bf034e87728f68c06253bbadc5767193b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/26928b9c76ec65e8f8609dfe07eab4bcb8a455ea",
          "sha": "26928b9c76ec65e8f8609dfe07eab4bcb8a455ea",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/26928b9c76ec65e8f8609dfe07eab4bcb8a455ea"
        }
      ],
      "message": "[functional test] orphan handling with multiple announcers and dosers",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-04-19T14:40:18Z"
      },
      "sha": "3d3fec8d65805e336229935b2773590428efd2df"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc2YzU2NDc2MTY4N2VjYTg5ODA2MDk5OGQ2MGQ2MDg0YjRjZTM2MWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/76c564761687eca898060998d60d6084b4ce361d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/76c564761687eca898060998d60d6084b4ce361d",
      "tree": {
        "sha": "834aebe81a4894dc408dcef43af9ce8eb85e4bf2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/834aebe81a4894dc408dcef43af9ce8eb85e4bf2"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3d3fec8d65805e336229935b2773590428efd2df",
          "sha": "3d3fec8d65805e336229935b2773590428efd2df",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3d3fec8d65805e336229935b2773590428efd2df"
        }
      ],
      "message": "[txorphanage] add ability to protect from random eviction",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-05T16:24:39Z"
      },
      "sha": "76c564761687eca898060998d60d6084b4ce361d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdiNzZlZjk0Y2UxYWM1ZGM4YzJmMmI0NTU3MThjMGE5MzhiNjE1OWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7b76ef94ce1ac5dc8c2f2b455718c0a938b6159d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7b76ef94ce1ac5dc8c2f2b455718c0a938b6159d",
      "tree": {
        "sha": "b89a0a08374301457dff5bff8a114c1786192ecc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b89a0a08374301457dff5bff8a114c1786192ecc"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/76c564761687eca898060998d60d6084b4ce361d",
          "sha": "76c564761687eca898060998d60d6084b4ce361d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/76c564761687eca898060998d60d6084b4ce361d"
        }
      ],
      "message": "[unit test] orphanage protection",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-09T21:08:27Z"
      },
      "sha": "7b76ef94ce1ac5dc8c2f2b455718c0a938b6159d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRjODM0MzI2NGUzYmM0NGI2Njk1YzljNzdkZGNmZjRlODZhYjc1ZGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dc8343264e3bc44b6695c9c77ddcff4e86ab75da",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/dc8343264e3bc44b6695c9c77ddcff4e86ab75da",
      "tree": {
        "sha": "b89a0a08374301457dff5bff8a114c1786192ecc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b89a0a08374301457dff5bff8a114c1786192ecc"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7b76ef94ce1ac5dc8c2f2b455718c0a938b6159d",
          "sha": "7b76ef94ce1ac5dc8c2f2b455718c0a938b6159d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7b76ef94ce1ac5dc8c2f2b455718c0a938b6159d"
        }
      ],
      "message": "-- Part 2: Negotiate Package Relay, Request Ancestor Package Info For Orphans --",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-20T10:49:27Z"
      },
      "sha": "dc8343264e3bc44b6695c9c77ddcff4e86ab75da"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI2ZTExZTg3N2UyODQ4Zjk5NTkxODk0ZDZkNDZiN2JmNjk3NTZlNjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/26e11e877e2848f99591894d6d46b7bf69756e60",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/26e11e877e2848f99591894d6d46b7bf69756e60",
      "tree": {
        "sha": "a15bbcfc6a4215052527380aeb0339e5495ea601",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a15bbcfc6a4215052527380aeb0339e5495ea601"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dc8343264e3bc44b6695c9c77ddcff4e86ab75da",
          "sha": "dc8343264e3bc44b6695c9c77ddcff4e86ab75da",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/dc8343264e3bc44b6695c9c77ddcff4e86ab75da"
        }
      ],
      "message": "[txpackagetracker] negotiation logic",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-20T16:14:20Z"
      },
      "sha": "26e11e877e2848f99591894d6d46b7bf69756e60"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVlNWFmYzU1OTAxNzExNTdhOTgzYTEyM2E1YjgxNTBmOWVkYmU1ODI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5e5afc5590171157a983a123a5b8150f9edbe582",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5e5afc5590171157a983a123a5b8150f9edbe582",
      "tree": {
        "sha": "81e7300aebc761e547a666ba9081e7a5870e4f1b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/81e7300aebc761e547a666ba9081e7a5870e4f1b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/26e11e877e2848f99591894d6d46b7bf69756e60",
          "sha": "26e11e877e2848f99591894d6d46b7bf69756e60",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/26e11e877e2848f99591894d6d46b7bf69756e60"
        }
      ],
      "message": "[unit test] txpackagetracker tests",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-20T16:08:16Z"
      },
      "sha": "5e5afc5590171157a983a123a5b8150f9edbe582"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRhYTM4MDIyNzJmZTRiYjU5ZWFiYTE5YjAyY2EyYmIwMjg4Zjg1MjY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/daa3802272fe4bb59eaba19b02ca2bb0288f8526",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/daa3802272fe4bb59eaba19b02ca2bb0288f8526",
      "tree": {
        "sha": "0f11d2307b32bf1177eaf315b5e41ee51756265e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0f11d2307b32bf1177eaf315b5e41ee51756265e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5e5afc5590171157a983a123a5b8150f9edbe582",
          "sha": "5e5afc5590171157a983a123a5b8150f9edbe582",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5e5afc5590171157a983a123a5b8150f9edbe582"
        }
      ],
      "message": "[p2p] signal support for package relay",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-10-07T11:54:34Z"
      },
      "sha": "daa3802272fe4bb59eaba19b02ca2bb0288f8526"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ2MGI4MGVkZjBmMzQ3Y2IxZjBkOTFlZGU3N2ZjYzNhODViZWFkZDA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d60b80edf0f347cb1f0d91ede77fcc3a85beadd0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d60b80edf0f347cb1f0d91ede77fcc3a85beadd0",
      "tree": {
        "sha": "7c37d5c6d48014a0ef6f5cbede465bb9ca8e7023",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7c37d5c6d48014a0ef6f5cbede465bb9ca8e7023"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/daa3802272fe4bb59eaba19b02ca2bb0288f8526",
          "sha": "daa3802272fe4bb59eaba19b02ca2bb0288f8526",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/daa3802272fe4bb59eaba19b02ca2bb0288f8526"
        }
      ],
      "message": "[rpc] expose package relay on rpc",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-09-06T11:33:13Z"
      },
      "sha": "d60b80edf0f347cb1f0d91ede77fcc3a85beadd0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYxZWM4NjJjM2Y4OTliNGE1MTE0NWI0MDkwY2RmNjEzYmIxOWM4NGU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f1ec862c3f899b4a51145b4090cdf613bb19c84e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f1ec862c3f899b4a51145b4090cdf613bb19c84e",
      "tree": {
        "sha": "9f8b0853493eed7b5ba902c5cd09c75e8667dbf1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9f8b0853493eed7b5ba902c5cd09c75e8667dbf1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d60b80edf0f347cb1f0d91ede77fcc3a85beadd0",
          "sha": "d60b80edf0f347cb1f0d91ede77fcc3a85beadd0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d60b80edf0f347cb1f0d91ede77fcc3a85beadd0"
        }
      ],
      "message": "[packages] hash multiple transactions",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-09T14:54:34Z"
      },
      "sha": "f1ec862c3f899b4a51145b4090cdf613bb19c84e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk4NWIzNmFiNzFiZmZhNGE1M2FjNmVkZDAwMGZhODM4MGZhNzhlZjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/985b36ab71bffa4a53ac6edd000fa8380fa78ef7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/985b36ab71bffa4a53ac6edd000fa8380fa78ef7",
      "tree": {
        "sha": "b1013d2bc1506ed164a078ef1de2fd38e8e84b1a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b1013d2bc1506ed164a078ef1de2fd38e8e84b1a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f1ec862c3f899b4a51145b4090cdf613bb19c84e",
          "sha": "f1ec862c3f899b4a51145b4090cdf613bb19c84e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f1ec862c3f899b4a51145b4090cdf613bb19c84e"
        }
      ],
      "message": "[validation/p2p] separate TxValidationResult and rejects filter for low fees\n\nWe wouldn't want to add a low-feerate transaction to m_recent_rejects\nbecause usually that means we won't give the child a chance\n(`fRejectedParents`); we instead want to fetch this orphan's low-feerate\nparents and potentially accept them.  However, we also shouldn't\nrevalidate transactions/packages that have already been rejected.\nContinue to cache low-fee rejections, but separately.\n\nNote: when ephemeral anchor transaction fails due to a missing spender,\nwe should similarly put it in the reconsiderable filter.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-09-12T09:43:33Z"
      },
      "sha": "985b36ab71bffa4a53ac6edd000fa8380fa78ef7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGE5ODhiYTNmZGRmZWE1ODkwOGIzZGM3ZDY4YTcwODExMDIyZmY5N2Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a988ba3fddfea58908b3dc7d68a70811022ff97f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a988ba3fddfea58908b3dc7d68a70811022ff97f",
      "tree": {
        "sha": "67de3c9c2c2486a42a84d31b08c54c652ca512aa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/67de3c9c2c2486a42a84d31b08c54c652ca512aa"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/985b36ab71bffa4a53ac6edd000fa8380fa78ef7",
          "sha": "985b36ab71bffa4a53ac6edd000fa8380fa78ef7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/985b36ab71bffa4a53ac6edd000fa8380fa78ef7"
        }
      ],
      "message": "[p2p] respond to getdata(ancpkginfo) requests with ancpkginfo\n\nConditions for responding to an ancpkginfo request are identical to\nresponding to a tx. That is, we only provide ancpkginfo if we would have\nprovided tx data as well.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-09-06T16:54:19Z"
      },
      "sha": "a988ba3fddfea58908b3dc7d68a70811022ff97f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGY1ZjRiNmNkMGJkOGQ1NDVjZjNjYzE2ODIwYjExMWFhNDNlMjVlZTU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f5f4b6cd0bd8d545cf3cc16820b111aa43e25ee5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f5f4b6cd0bd8d545cf3cc16820b111aa43e25ee5",
      "tree": {
        "sha": "4f4814430fc89d3b9d55765d3e14b6e4a373e24b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4f4814430fc89d3b9d55765d3e14b6e4a373e24b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a988ba3fddfea58908b3dc7d68a70811022ff97f",
          "sha": "a988ba3fddfea58908b3dc7d68a70811022ff97f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a988ba3fddfea58908b3dc7d68a70811022ff97f"
        }
      ],
      "message": "[txpackagetracker] create ancpkginfo requests using orphan resolution tracker",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-24T13:12:56Z"
      },
      "sha": "f5f4b6cd0bd8d545cf3cc16820b111aa43e25ee5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNkNTUyMGNjZmE4NGYwYThkODc5MmRiM2U4NjdlNDEwOWVjOGZjYmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cd5520ccfa84f0a8d8792db3e867e4109ec8fcbe",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cd5520ccfa84f0a8d8792db3e867e4109ec8fcbe",
      "tree": {
        "sha": "b214dbe64c2845d7ba351d863ffa05b1d92ac164",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b214dbe64c2845d7ba351d863ffa05b1d92ac164"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f5f4b6cd0bd8d545cf3cc16820b111aa43e25ee5",
          "sha": "f5f4b6cd0bd8d545cf3cc16820b111aa43e25ee5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f5f4b6cd0bd8d545cf3cc16820b111aa43e25ee5"
        }
      ],
      "message": "[unit test] txpackagetracker orphan tracking",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-20T16:06:29Z"
      },
      "sha": "cd5520ccfa84f0a8d8792db3e867e4109ec8fcbe"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM5NDc2YWI4MDVhOTUwYzE4NGYyZGNkZWE0M2I2NTVhYWMxN2NiY2E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39476ab805a950c184f2dcdea43b655aac17cbca",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/39476ab805a950c184f2dcdea43b655aac17cbca",
      "tree": {
        "sha": "46b7ef6bb2fdfce4607e74f05a4971c3a8c3e553",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/46b7ef6bb2fdfce4607e74f05a4971c3a8c3e553"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cd5520ccfa84f0a8d8792db3e867e4109ec8fcbe",
          "sha": "cd5520ccfa84f0a8d8792db3e867e4109ec8fcbe",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cd5520ccfa84f0a8d8792db3e867e4109ec8fcbe"
        }
      ],
      "message": "[p2p] Resolve orphans by requesting ancpkginfo and requesting txdata\n\nFor now, each tx in ancpkginfo is treated like an individual tx\nannouncement. When the tx arrives, it is validated individually as well.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-10-06T13:24:26Z"
      },
      "sha": "39476ab805a950c184f2dcdea43b655aac17cbca"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYxMjhmMTVlODYzYTUzNGY1MDNiNTVhNGEwNjMyZTkzODdmYjljODU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f128f15e863a534f503b55a4a0632e9387fb9c85",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f128f15e863a534f503b55a4a0632e9387fb9c85",
      "tree": {
        "sha": "46b7ef6bb2fdfce4607e74f05a4971c3a8c3e553",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/46b7ef6bb2fdfce4607e74f05a4971c3a8c3e553"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39476ab805a950c184f2dcdea43b655aac17cbca",
          "sha": "39476ab805a950c184f2dcdea43b655aac17cbca",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/39476ab805a950c184f2dcdea43b655aac17cbca"
        }
      ],
      "message": "-- Part 3: Download and Validate Packages --",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-20T10:50:12Z"
      },
      "sha": "f128f15e863a534f503b55a4a0632e9387fb9c85"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE3MzhlYjRhMDk4MTYxZmQ2NzY0OTE2NGZmM2I5OTJhOWI3YzU3Njg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1738eb4a098161fd67649164ff3b992a9b7c5768",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1738eb4a098161fd67649164ff3b992a9b7c5768",
      "tree": {
        "sha": "f263496c8006850972bb6817ccb728cdf6f50945",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f263496c8006850972bb6817ccb728cdf6f50945"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f128f15e863a534f503b55a4a0632e9387fb9c85",
          "sha": "f128f15e863a534f503b55a4a0632e9387fb9c85",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f128f15e863a534f503b55a4a0632e9387fb9c85"
        }
      ],
      "message": "[p2p] respond to getpkgtxns with pkgtxns or notfound MSG_PKGTXNS",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-10-03T15:38:55Z"
      },
      "sha": "1738eb4a098161fd67649164ff3b992a9b7c5768"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVjMWIzMDM0OWIwNzAxYTViMjk3MTg5OTQ0ODFmMGQ5N2IzZTJmNDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ec1b30349b0701a5b29718994481f0d97b3e2f47",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ec1b30349b0701a5b29718994481f0d97b3e2f47",
      "tree": {
        "sha": "87d5860e9ceacb20480256f5d588bd05f5b79131",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/87d5860e9ceacb20480256f5d588bd05f5b79131"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1738eb4a098161fd67649164ff3b992a9b7c5768",
          "sha": "1738eb4a098161fd67649164ff3b992a9b7c5768",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1738eb4a098161fd67649164ff3b992a9b7c5768"
        }
      ],
      "message": "[txpackagetracker] track packages to download",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-05T16:57:00Z"
      },
      "sha": "ec1b30349b0701a5b29718994481f0d97b3e2f47"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZkNDlmODNmOWQwZGU3YmM0ZDNhMTNkZGQ3ZTQ4NGRjZGE0OTI5YWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6d49f83f9d0de7bc4d3a13ddd7e484dcda4929ac",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6d49f83f9d0de7bc4d3a13ddd7e484dcda4929ac",
      "tree": {
        "sha": "3b67a3b01e9876033514509bd099ec45072c2969",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3b67a3b01e9876033514509bd099ec45072c2969"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ec1b30349b0701a5b29718994481f0d97b3e2f47",
          "sha": "ec1b30349b0701a5b29718994481f0d97b3e2f47",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ec1b30349b0701a5b29718994481f0d97b3e2f47"
        }
      ],
      "message": "[txpackagetracker] handle pkgtxns/notfound, return validation work items",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-09T14:50:00Z"
      },
      "sha": "6d49f83f9d0de7bc4d3a13ddd7e484dcda4929ac"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ3NmJiOWRiYjg1ZDg0MGRmMzZmNmI3M2ZiODRhMmU1OGFkYTg0MzM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
      "tree": {
        "sha": "6ea324b54e318a6c906728b507b19aca9fdc5e4d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6ea324b54e318a6c906728b507b19aca9fdc5e4d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6d49f83f9d0de7bc4d3a13ddd7e484dcda4929ac",
          "sha": "6d49f83f9d0de7bc4d3a13ddd7e484dcda4929ac",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6d49f83f9d0de7bc4d3a13ddd7e484dcda4929ac"
        }
      ],
      "message": "[txpackagetracker] track protections and token bucket it",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-09T23:22:05Z"
      },
      "sha": "d76bb9dbb85d840df36f6b73fb84a2e58ada8433"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDJhMDZiY2I2NDM1Y2E4MGYyMzNiMGMzMGNlNmJiMmJkZWFkMjEzMWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2a06bcb6435ca80f233b0c30ce6bb2bdead2131e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2a06bcb6435ca80f233b0c30ce6bb2bdead2131e",
      "tree": {
        "sha": "888eb572d1201e919f2ae78a223085069b5b9740",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/888eb572d1201e919f2ae78a223085069b5b9740"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
          "sha": "d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d76bb9dbb85d840df36f6b73fb84a2e58ada8433"
        }
      ],
      "message": "[unit test] PkgInfoAllowed, ReceivedAncPkgInfo, ReceivedPkgTxns",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-02-20T16:33:09Z"
      },
      "sha": "2a06bcb6435ca80f233b0c30ce6bb2bdead2131e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDkzYzBiZWU2NGE4ZDcxYjE4NDBjZGU4ZGMyNzU4M2RkNTkxMTY0ZmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/93c0bee64a8d71b1840cde8dc27583dd591164fb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/93c0bee64a8d71b1840cde8dc27583dd591164fb",
      "tree": {
        "sha": "1999d195cf02da7ae4109a85fcbe35bf1ae88fd1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1999d195cf02da7ae4109a85fcbe35bf1ae88fd1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2a06bcb6435ca80f233b0c30ce6bb2bdead2131e",
          "sha": "2a06bcb6435ca80f233b0c30ce6bb2bdead2131e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2a06bcb6435ca80f233b0c30ce6bb2bdead2131e"
        }
      ],
      "message": "[p2p] use ancpkginfo to make getpkgtxns requests and validate packages",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-06T11:31:37Z"
      },
      "sha": "93c0bee64a8d71b1840cde8dc27583dd591164fb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA0MWZiNDY0ZjFlOWZhZjU0NGY4ZDJiMTZhMjQyOWY0NjY1ZWE1NDE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/041fb464f1e9faf544f8d2b16a2429f4665ea541",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/041fb464f1e9faf544f8d2b16a2429f4665ea541",
      "tree": {
        "sha": "c9f16b837b6449c353893fb591915d5897d36943",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c9f16b837b6449c353893fb591915d5897d36943"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/93c0bee64a8d71b1840cde8dc27583dd591164fb",
          "sha": "93c0bee64a8d71b1840cde8dc27583dd591164fb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/93c0bee64a8d71b1840cde8dc27583dd591164fb"
        }
      ],
      "message": "[p2p] don't inv fee-bumping children to non-pkgrelay peers\n\nThese transactions can be more common with package relay, but\nnon-package-relay peers will only waste bandwidth and orphanage space,\nthen end up not accepting them. Save their bandwidth by dropping\nannouncements of transactions that have below-fee-filter parents.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-04-04T09:01:00Z"
      },
      "sha": "041fb464f1e9faf544f8d2b16a2429f4665ea541"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNkYjViMTYzZDYyM2RiODAyZWQ3ZjhhMzM5NGIyNjc0MzYyZjQwOWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cdb5b163d623db802ed7f8a3394b2674362f409b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cdb5b163d623db802ed7f8a3394b2674362f409b",
      "tree": {
        "sha": "91ce435a587799e21a5d263727dfcad65d712a35",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/91ce435a587799e21a5d263727dfcad65d712a35"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/041fb464f1e9faf544f8d2b16a2429f4665ea541",
          "sha": "041fb464f1e9faf544f8d2b16a2429f4665ea541",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/041fb464f1e9faf544f8d2b16a2429f4665ea541"
        }
      ],
      "message": "[functional test] package relay works despite peers DoSing orphanage",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-31T14:04:14Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-05-18T19:32:05Z"
      },
      "sha": "cdb5b163d623db802ed7f8a3394b2674362f409b"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9391031418,
      "node_id": "HRFPE_lADOABII585mxnIEzwAAAAIvv8R6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9391031418",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-31T14:05:31Z"
    },
    {
      "event": "unlabeled",
      "id": 9397201008,
      "node_id": "UNLE_lADOABII585mxnIEzwAAAAIwHehw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9397201008",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-01T01:56:27Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1572135299,
      "node_id": "IC_kwDOABII585dtOGD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572135299",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-01T14:12:00Z",
      "updated_at": "2023-06-01T14:12:00Z",
      "author_association": "MEMBER",
      "body": "> Approach review is very welcome on this PR\r\n\r\ndidn't real whole OP until now. In my not expert opinion, the orphan handling seems reasonable, and I think it makes to open it ASAP to take it out of draft",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#issuecomment-1572135299",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27742"
    },
    {
      "event": "commented",
      "id": 1572205313,
      "node_id": "IC_kwDOABII585dtfMB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572205313",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-01T14:51:07Z",
      "updated_at": "2023-06-01T14:51:07Z",
      "author_association": "MEMBER",
      "body": "Offline feedback suggested I clarify what I mean by \"approach feedback welcome\" before \"I open separate PRs.\"\r\n\r\nThis is a large project, and the first few p2p commits essentially define the interface. I'd like to get rough consensus on approach before we start looking at code details and merging PRs, because I believe it will help us \"get useful stuff in\" faster and avoid premature optimizations.\r\n\r\nHere are some approach questions I think we should answer before diving in:\r\n1. Does the proposed protocol look sound?\r\n2. Are these 3 milestones appropriate?\r\n3. Is there important functionality that is in the \"todo improvements\" section but should be included in one of the 3 milestones? Alternatively, is there not-that-important stuff in the milestones that we should defer until later?\r\n4. Does it make sense to have this `PeerManager` <-> `TxPackageTracker` <-> `TxOrphanage` relationship?",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#issuecomment-1572205313",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27742"
    },
    {
      "event": "commented",
      "id": 1572526838,
      "node_id": "IC_kwDOABII585dutr2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572526838",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-01T17:50:43Z",
      "updated_at": "2023-06-01T17:51:18Z",
      "author_association": "MEMBER",
      "body": "> redownloading orphans if we cannot afford to protect them\r\n\r\nIs the idea here that protection is a bandiwdth optimization to avoid fetching an orphan twice in a row in the presence of malicious peers or random churn? Reasonable if so, just want this to be explicitly stated if so.",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#issuecomment-1572526838",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27742"
    },
    {
      "event": "commented",
      "id": 1573521731,
      "node_id": "IC_kwDOABII585dyglD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1573521731",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-02T10:38:52Z",
      "updated_at": "2023-06-02T10:38:52Z",
      "author_association": "MEMBER",
      "body": "> > redownloading orphans if we cannot afford to protect them\r\n> \r\n> Is the idea here that protection is a bandiwdth optimization to avoid fetching an orphan twice in a row in the presence of malicious peers or random churn? Reasonable if so, just want this to be explicitly stated if so.\r\n\r\nYes exactly. Worse is we want to avoid a situation where we requested the rest of the package while the orphan was in our orphanage, but then it fell out while we were waiting for the rest of the transactions. Then, we should re-download the orphan, but what do we do with the rest of them? We basically have to redownload the whole thing again, otherwise we might end up in an endless cycle of redownloading if we put them into an orphanage but don't necessarily protect them from eviction.\r\n\r\nHere is a more detailed doc for the orphanage protection and \"token bucket\" scheme: https://gist.github.com/glozow/7c0ff639f996e660146314edffa6f06c.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#issuecomment-1573521731",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27742"
    },
    {
      "event": "reviewed",
      "id": 1451533873,
      "node_id": "PRR_kwDOABII585WhKYx",
      "url": null,
      "actor": null,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Along with the gist, focused on orphan protection and bucketing for concept understanding. Dumping comments related to those, and left a note on the gist.",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#pullrequestreview-1451533873",
      "submitted_at": "2023-06-02T14:42:30Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
    },
    {
      "event": "reviewed",
      "id": 1457677374,
      "node_id": "PRR_kwDOABII585W4mQ-",
      "url": null,
      "actor": null,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Along with the gist, focused on orphan protection and bucketing for concept understanding. Dumping comments related to those, and left a note on the gist.",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#pullrequestreview-1457677374",
      "submitted_at": "2023-06-02T14:42:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
    },
    {
      "event": "reviewed",
      "id": 1458284571,
      "node_id": "PRR_kwDOABII585W66gb",
      "url": null,
      "actor": null,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#pullrequestreview-1458284571",
      "submitted_at": "2023-06-02T19:14:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210641158",
      "pull_request_review_id": 1451533873,
      "id": 1210641158,
      "node_id": "PRRC_kwDOABII585IKOsG",
      "diff_hunk": "@@ -24,6 +24,44 @@ class TxPackageTracker::Impl {\n     TxOrphanage m_orphanage;\n \n     mutable Mutex m_mutex;\n+    struct RegistrationState {\n+        // All of the following bools will need to be true",
      "path": "src/node/txpackagetracker.cpp",
      "position": 40,
      "original_position": 5,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "692e4baa4bc5d1198672b083f0de214575306477",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "or what?",
      "created_at": "2023-05-30T18:06:43Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1210641158",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210641158"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 40,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210682865",
      "pull_request_review_id": 1451533873,
      "id": 1210682865,
      "node_id": "PRRC_kwDOABII585IKY3x",
      "diff_hunk": "@@ -2932,7 +2932,7 @@ bool PeerManagerImpl::ProcessOrphanTx(Peer& peer)\n             LogPrint(BCLog::MEMPOOL, \"   accepted orphan tx %s\\n\", orphanHash.ToString());\n             RelayTransaction(orphanHash, porphanTx->GetWitnessHash());\n             m_txpackagetracker->AddChildrenToWorkSet(*porphanTx);\n-            m_txpackagetracker->EraseOrphanTx(orphanHash);",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "22e93f08a50a206b54717b07682e73a751cc6755",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "[[txorphange] use wtxid instead of txid, handle nullptr](https://github.com/bitcoin/bitcoin/pull/27742/commits/22e93f08a50a206b54717b07682e73a751cc6755)\r\n\r\nmaybe change commit message to be clearer we're erasing by wtxid, as the primary change?",
      "created_at": "2023-05-30T18:41:30Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1210682865",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210682865"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2935,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210707099",
      "pull_request_review_id": 1451533873,
      "id": 1210707099,
      "node_id": "PRRC_kwDOABII585IKeyb",
      "diff_hunk": "@@ -4,12 +4,33 @@\n \n #include <node/txpackagetracker.h>\n \n+#include <common/bloom.h>\n+#include <logging.h>\n #include <txorphanage.h>\n+#include <txrequest.h>\n+#include <util/hasher.h>\n \n namespace node {\n+    /** How long to wait before requesting orphan ancpkginfo/parents from an additional peer.\n+     * Same as GETDATA_TX_INTERVAL. */",
      "path": "src/node/txpackagetracker.cpp",
      "position": 16,
      "original_position": 12,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "4c72113677bea9c722070c73471ca27087985a6b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "wouldn't reference it in case it drifts? If it's exactly the same and always should be, just use this constant value?",
      "created_at": "2023-05-30T19:04:20Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1210707099",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210707099"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 16,
      "original_line": 16,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210708748",
      "pull_request_review_id": 1451533873,
      "id": 1210708748,
      "node_id": "PRRC_kwDOABII585IKfMM",
      "diff_hunk": "@@ -4,12 +4,33 @@\n \n #include <node/txpackagetracker.h>\n \n+#include <common/bloom.h>\n+#include <logging.h>\n #include <txorphanage.h>\n+#include <txrequest.h>\n+#include <util/hasher.h>\n \n namespace node {\n+    /** How long to wait before requesting orphan ancpkginfo/parents from an additional peer.\n+     * Same as GETDATA_TX_INTERVAL. */\n+    static constexpr auto ORPHAN_ANCESTOR_GETDATA_INTERVAL{60s};\n+\n+    /** Delay to add if an orphan resolution candidate is already using a lot of memory in the\n+     * orphanage. */\n+    static constexpr auto ORPHANAGE_OVERLOAD_DELAY{2s};\n+\n class TxPackageTracker::Impl {\n     /** Manages unvalidated tx data (orphan transactions for which we are downloading ancestors). */\n     TxOrphanage m_orphanage;\n+\n+    mutable Mutex m_mutex;\n+\n+    /** Tracks orphans for which we need to request ancestor information. All hashes stored are\n+     * wtxids, i.e., the wtxid of the orphan. However, the is_wtxid field is used to indicate",
      "path": "src/node/txpackagetracker.cpp",
      "position": 163,
      "original_position": 26,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "4c72113677bea9c722070c73471ca27087985a6b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> is_wtxid\r\n\r\nwhere is this defined?",
      "created_at": "2023-05-30T19:06:19Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1210708748",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210708748"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 163,
      "original_line": 163,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210724340",
      "pull_request_review_id": 1451533873,
      "id": 1210724340,
      "node_id": "PRRC_kwDOABII585IKi_0",
      "diff_hunk": "@@ -58,6 +59,36 @@ class TxPackageTracker {\n     /** Return how many entries exist in the orphange */\n     size_t OrphanageSize();\n \n+    /** Received an announcement from this peer for a tx we already know is an orphan; should be\n+     * called for every peer that announces the tx, even if they are not a package relay peer.\n+     * The orphan request tracker will decide when to request what from which peer - use\n+     * GetOrphanRequests().\n+     */\n+    void AddOrphanTx(NodeId nodeid, const uint256& wtxid, const CTransactionRef& tx, bool is_preferred, std::chrono::microseconds reqtime);",
      "path": "src/node/txpackagetracker.h",
      "position": 78,
      "original_position": 17,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "4c72113677bea9c722070c73471ca27087985a6b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "really close to `OrphanageAddTx` even though the comments are clear of its purpose here. Maybe `AddKnownOrphanTx` or `AddAlreadyKnownOrphanTx`?",
      "created_at": "2023-05-30T19:21:23Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1210724340",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210724340"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 78,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210729694",
      "pull_request_review_id": 1451533873,
      "id": 1210729694,
      "node_id": "PRRC_kwDOABII585IKkTe",
      "diff_hunk": "@@ -18,14 +39,119 @@ class TxPackageTracker::Impl {\n     bool OrphanageHaveTx(const GenTxid& gtxid) { return m_orphanage.HaveTx(gtxid); }\n     CTransactionRef GetTxToReconsider(NodeId peer) { return m_orphanage.GetTxToReconsider(peer); }\n     int EraseOrphanTx(const uint256& txid) { return m_orphanage.EraseTx(txid); }\n-    void DisconnectedPeer(NodeId peer) {\n-        m_orphanage.EraseForPeer(peer);\n+    void DisconnectedPeer(NodeId nodeid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        orphan_request_tracker.DisconnectedPeer(nodeid);\n+        m_orphanage.EraseForPeer(nodeid);\n+    }\n+    void BlockConnected(const CBlock& block) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        const auto wtxids_erased{m_orphanage.EraseForBlock(block)};\n+        std::set<uint256> block_wtxids;\n+        std::set<uint256> conflicted_wtxids;\n+        for (const CTransactionRef& ptx : block.vtx) {\n+            block_wtxids.insert(ptx->GetWitnessHash());\n+        }\n+        for (const auto& wtxid : wtxids_erased) {\n+            if (block_wtxids.count(wtxid) == 0) {\n+                conflicted_wtxids.insert(wtxid);\n+            }\n+        }\n+        FinalizeTransactions(block_wtxids, conflicted_wtxids);\n     }\n-    void BlockConnected(const CBlock& block) { m_orphanage.EraseForBlock(block); }\n     void LimitOrphans(unsigned int max_orphans) { m_orphanage.LimitOrphans(max_orphans); }\n     void AddChildrenToWorkSet(const CTransaction& tx) { m_orphanage.AddChildrenToWorkSet(tx); }\n     bool HaveTxToReconsider(NodeId peer) { return m_orphanage.HaveTxToReconsider(peer); }\n     size_t OrphanageSize() { return m_orphanage.Size(); }\n+    void AddOrphanTx(NodeId nodeid, const uint256& wtxid, const CTransactionRef& tx, bool is_preferred, std::chrono::microseconds reqtime)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        // Skip if we weren't provided the tx and can't find the wtxid in the orphanage.\n+        if (tx == nullptr && !m_orphanage.HaveTx(GenTxid::Wtxid(wtxid))) return;\n+\n+        // Even though this stores the orphan wtxid, is_wtxid=false because we will be requesting the parents via txid.",
      "path": "src/node/txpackagetracker.cpp",
      "position": null,
      "original_position": 76,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "4c72113677bea9c722070c73471ca27087985a6b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`is_wtxid=false`?",
      "created_at": "2023-05-30T19:26:05Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1210729694",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210729694"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 77,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210734976",
      "pull_request_review_id": 1451533873,
      "id": 1210734976,
      "node_id": "PRRC_kwDOABII585IKlmA",
      "diff_hunk": "@@ -58,6 +59,36 @@ class TxPackageTracker {\n     /** Return how many entries exist in the orphange */\n     size_t OrphanageSize();\n \n+    /** Received an announcement from this peer for a tx we already know is an orphan; should be\n+     * called for every peer that announces the tx, even if they are not a package relay peer.\n+     * The orphan request tracker will decide when to request what from which peer - use\n+     * GetOrphanRequests().\n+     */\n+    void AddOrphanTx(NodeId nodeid, const uint256& wtxid, const CTransactionRef& tx, bool is_preferred, std::chrono::microseconds reqtime);",
      "path": "src/node/txpackagetracker.h",
      "position": 78,
      "original_position": 17,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "4c72113677bea9c722070c73471ca27087985a6b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "When should `tx` be `NULL`?",
      "created_at": "2023-05-30T19:30:31Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1210734976",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210734976"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 78,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210736698",
      "pull_request_review_id": 1451533873,
      "id": 1210736698,
      "node_id": "PRRC_kwDOABII585IKmA6",
      "diff_hunk": "@@ -58,6 +59,36 @@ class TxPackageTracker {\n     /** Return how many entries exist in the orphange */\n     size_t OrphanageSize();\n \n+    /** Received an announcement from this peer for a tx we already know is an orphan; should be\n+     * called for every peer that announces the tx, even if they are not a package relay peer.\n+     * The orphan request tracker will decide when to request what from which peer - use\n+     * GetOrphanRequests().\n+     */\n+    void AddOrphanTx(NodeId nodeid, const uint256& wtxid, const CTransactionRef& tx, bool is_preferred, std::chrono::microseconds reqtime);\n+\n+    /** Number of packages we are working on with this peer. Includes any entries in the orphan\n+     * tracker, in-flight orphan parent requests (1 per orphan regardless of how many missing\n+     * parents were requested), package info requests, tx data download, and packages in the\n+     * validation queue. */\n+    size_t Count(NodeId nodeid) const;\n+\n+    /** Number of packages we are currently working on with this peer (i.e. reserving memory for\n+     * storing orphan(s)). Includes in-flight package info requests, tx data download, and packages\n+     * in the validation queue. Excludes entries in the orphan tracker that are just candidates. */",
      "path": "src/node/txpackagetracker.h",
      "position": 88,
      "original_position": 27,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "4c72113677bea9c722070c73471ca27087985a6b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What does this last sentence mean?",
      "created_at": "2023-05-30T19:32:29Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1210736698",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210736698"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210769183",
      "pull_request_review_id": 1451533873,
      "id": 1210769183,
      "node_id": "PRRC_kwDOABII585IKt8f",
      "diff_hunk": "@@ -5860,6 +5859,18 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n             }\n         }\n \n+        auto requestable_orphans = m_txpackagetracker->GetOrphanRequests(pto->GetId(), current_time);",
      "path": "src/net_processing.cpp",
      "position": 862,
      "original_position": 114,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "bb5e0b21520e6deebcfe9576ae17f4db15c31421",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "where did this behavior live prior, where this isn't a behavior change?",
      "created_at": "2023-05-30T20:04:00Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1210769183",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210769183"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 6259,
      "original_line": 6259,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1211763570",
      "pull_request_review_id": 1451533873,
      "id": 1211763570,
      "node_id": "PRRC_kwDOABII585IOgty",
      "diff_hunk": "@@ -667,6 +678,21 @@ class TxRequestTracker::Impl {\n         });\n     }\n \n+    void ResetRequestTimeout(NodeId peer, const uint256& txhash, std::chrono::microseconds new_expiry)\n+    {\n+        auto it = m_index.get<ByPeer>().find(ByPeerView{peer, false, txhash});",
      "path": "src/txrequest.cpp",
      "position": 24,
      "original_position": 24,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "212a7010257b43eff9fa017bcf625acfc84f650f",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "since we're touching this, would you mind annotating the bool as `/* best */` to make it clearer what this is doing? New to tx tracking; would be helpful",
      "created_at": "2023-05-31T13:56:26Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1211763570",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1211763570"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 683,
      "original_line": 683,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1211861912",
      "pull_request_review_id": 1451533873,
      "id": 1211861912,
      "node_id": "PRRC_kwDOABII585IO4uY",
      "diff_hunk": "@@ -176,9 +207,13 @@ void TxOrphanage::AddChildrenToWorkSet(const CTransaction& tx)\n         const auto it_by_prev = m_outpoint_to_orphan_it.find(COutPoint(tx.GetHash(), i));\n         if (it_by_prev != m_outpoint_to_orphan_it.end()) {\n             for (const auto& elem : it_by_prev->second) {\n+                Assume(elem->second.announcers.size() >= 1);\n+                if (elem->second.announcers.empty()) break;\n+                // Pick the first peer from announcers set.",
      "path": "src/txorphanage.cpp",
      "position": 210,
      "original_position": 94,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "fecb522a3fa83e7b485f5d17f070ed56d47e3d90",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "any reason for the first?",
      "created_at": "2023-05-31T14:59:41Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1211861912",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1211861912"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 215,
      "original_line": 212,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1211869199",
      "pull_request_review_id": 1451533873,
      "id": 1211869199,
      "node_id": "PRRC_kwDOABII585IO6gP",
      "diff_hunk": "@@ -24,7 +24,7 @@ static constexpr size_t MAX_ORPHAN_TOTAL_SIZE{100 * MAX_STANDARD_TX_WEIGHT};\n  */\n class TxOrphanage {\n public:\n-    /** Add a new orphan transaction */\n+    /** Add a new orphan transaction. If the tx already exists, add this peer to its list of announcers. */",
      "path": "src/txorphanage.h",
      "position": 23,
      "original_position": 5,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "fecb522a3fa83e7b485f5d17f070ed56d47e3d90",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should note that it only returns true if new",
      "created_at": "2023-05-31T15:04:44Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1211869199",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1211869199"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 27,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1211872666",
      "pull_request_review_id": 1451533873,
      "id": 1211872666,
      "node_id": "PRRC_kwDOABII585IO7Wa",
      "diff_hunk": "@@ -21,8 +21,14 @@ bool TxOrphanage::AddTx(const CTransactionRef& tx, NodeId peer)\n     if (tx == nullptr) return false;\n \n     const uint256& hash = tx->GetHash();\n-    if (m_orphans.count(hash))\n+    if (m_orphans.count(hash)) {",
      "path": "src/txorphanage.cpp",
      "position": 16,
      "original_position": 5,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "fecb522a3fa83e7b485f5d17f070ed56d47e3d90",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "can we `Assume` that there's already an entry in the announcer list?",
      "created_at": "2023-05-31T15:07:26Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1211872666",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1211872666"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212076537",
      "pull_request_review_id": 1451533873,
      "id": 1212076537,
      "node_id": "PRRC_kwDOABII585IPtH5",
      "diff_hunk": "@@ -1418,16 +1423,47 @@ void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n     }\n }\n \n-void PeerManagerImpl::AddOrphanResolutionCandidate(NodeId nodeid, const uint256& orphan_wtxid, const CTransactionRef& orphan, std::chrono::microseconds current_time)\n+void PeerManagerImpl::AddOrphanAnnouncer(NodeId nodeid, const uint256& orphan_wtxid, const CTransactionRef& tx, std::chrono::microseconds current_time)\n {\n-    AssertLockHeld(::cs_main);\n+    AssertLockHeld(::cs_main); // For m_txrequest\n+    const bool connected = m_connman.ForNode(nodeid, [](CNode* node) { return node->fSuccessfullyConnected && !node->fDisconnect; });\n+    if (!connected) return;\n+    if (m_txpackagetracker->Count(nodeid) + m_txrequest.Count(nodeid) >= MAX_PEER_TX_ANNOUNCEMENTS) {\n+        // Too many queued announcements. Request from a different peer.\n+        // TODO: Allow peers with Relay permissions to bypass this restriction.\n+        return;\n+    }\n     const CNodeState* state = State(nodeid);\n-    // Decide the TxRequestTracker parameters for this orphan resolution:\n+    // Decide the TxRequestTracker parameters for this orphan resolution.\n+    // TxPackageTracker may also increase the delay.\n     // - \"preferred\": if fPreferredDownload is set (= outbound, or NetPermissionFlags::NoBan permission)\n-    // - \"reqtime\": current time\n+    // - \"reqtime\": current time plus delays for:\n+    //   - NONPREF_PEER_TX_DELAY for announcements from non-preferred connections\n+    //   - OVERLOADED_PEER_TX_DELAY for announcements from peers which have at least\n+    //     MAX_PEER_TX_REQUEST_IN_FLIGHT requests in flight\n+    //     TODO: allow peers with Relay permissions to bypass this restiction\n     auto delay{0us};\n     const bool preferred = state->fPreferredDownload;\n-    m_txpackagetracker->AddOrphanTx(nodeid, orphan_wtxid, orphan, preferred, current_time + delay);\n+    if (!preferred) delay += NONPREF_PEER_TX_DELAY;\n+    const bool overloaded = m_txrequest.CountInFlight(nodeid) >= MAX_PEER_TX_REQUEST_IN_FLIGHT;\n+    if (overloaded) delay += OVERLOADED_PEER_TX_DELAY;\n+    m_txpackagetracker->AddOrphanTx(nodeid, orphan_wtxid, tx, preferred, current_time + delay);\n+}\n+void PeerManagerImpl::AddOrphanResolutionCandidates(const CTransactionRef& orphan, NodeId originator)\n+{\n+    const auto current_time{GetTime<std::chrono::microseconds>()};\n+\n+    // The originator will not show up in GetCandidatePeers() since we already requested from them.\n+    AddOrphanAnnouncer(originator, orphan->GetWitnessHash(), orphan, current_time);\n+    // We prefer to request the orphan's ancestors via package relay rather than txids",
      "path": "src/net_processing.cpp",
      "position": 211,
      "original_position": 58,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "0671e1c178270350aadeba625da8b95d6ef2ff00",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "How is this preferred precisely?",
      "created_at": "2023-05-31T17:41:23Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1212076537",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212076537"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1514,
      "original_line": 1458,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212089989",
      "pull_request_review_id": 1451533873,
      "id": 1212089989,
      "node_id": "PRRC_kwDOABII585IPwaF",
      "diff_hunk": "@@ -3748,6 +3784,9 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                 if (!fAlreadyHave && !m_chainman.ActiveChainstate().IsInitialBlockDownload()) {\n                     AddTxAnnouncement(pfrom, gtxid, current_time);\n                 }\n+                if (inv.IsMsgWtx() && m_txpackagetracker->OrphanageHaveTx(gtxid) && !m_chainman.ActiveChainstate().IsInitialBlockDownload()) {",
      "path": "src/net_processing.cpp",
      "position": 582,
      "original_position": 74,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "0671e1c178270350aadeba625da8b95d6ef2ff00",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "this seems mutually exclusive with the above conditional since it implies `!fAlreadyHave`, make an `else if` to make it clearer?",
      "created_at": "2023-05-31T17:53:26Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1212089989",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212089989"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3996,
      "original_line": 3787,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212101478",
      "pull_request_review_id": 1451533873,
      "id": 1212101478,
      "node_id": "PRRC_kwDOABII585IPzNm",
      "diff_hunk": "@@ -1418,16 +1423,47 @@ void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n     }\n }\n \n-void PeerManagerImpl::AddOrphanResolutionCandidate(NodeId nodeid, const uint256& orphan_wtxid, const CTransactionRef& orphan, std::chrono::microseconds current_time)\n+void PeerManagerImpl::AddOrphanAnnouncer(NodeId nodeid, const uint256& orphan_wtxid, const CTransactionRef& tx, std::chrono::microseconds current_time)\n {\n-    AssertLockHeld(::cs_main);\n+    AssertLockHeld(::cs_main); // For m_txrequest\n+    const bool connected = m_connman.ForNode(nodeid, [](CNode* node) { return node->fSuccessfullyConnected && !node->fDisconnect; });\n+    if (!connected) return;\n+    if (m_txpackagetracker->Count(nodeid) + m_txrequest.Count(nodeid) >= MAX_PEER_TX_ANNOUNCEMENTS) {\n+        // Too many queued announcements. Request from a different peer.\n+        // TODO: Allow peers with Relay permissions to bypass this restriction.\n+        return;\n+    }\n     const CNodeState* state = State(nodeid);\n-    // Decide the TxRequestTracker parameters for this orphan resolution:\n+    // Decide the TxRequestTracker parameters for this orphan resolution.\n+    // TxPackageTracker may also increase the delay.\n     // - \"preferred\": if fPreferredDownload is set (= outbound, or NetPermissionFlags::NoBan permission)\n-    // - \"reqtime\": current time\n+    // - \"reqtime\": current time plus delays for:\n+    //   - NONPREF_PEER_TX_DELAY for announcements from non-preferred connections\n+    //   - OVERLOADED_PEER_TX_DELAY for announcements from peers which have at least\n+    //     MAX_PEER_TX_REQUEST_IN_FLIGHT requests in flight\n+    //     TODO: allow peers with Relay permissions to bypass this restiction\n     auto delay{0us};\n     const bool preferred = state->fPreferredDownload;\n-    m_txpackagetracker->AddOrphanTx(nodeid, orphan_wtxid, orphan, preferred, current_time + delay);\n+    if (!preferred) delay += NONPREF_PEER_TX_DELAY;\n+    const bool overloaded = m_txrequest.CountInFlight(nodeid) >= MAX_PEER_TX_REQUEST_IN_FLIGHT;\n+    if (overloaded) delay += OVERLOADED_PEER_TX_DELAY;\n+    m_txpackagetracker->AddOrphanTx(nodeid, orphan_wtxid, tx, preferred, current_time + delay);\n+}\n+void PeerManagerImpl::AddOrphanResolutionCandidates(const CTransactionRef& orphan, NodeId originator)\n+{\n+    const auto current_time{GetTime<std::chrono::microseconds>()};\n+\n+    // The originator will not show up in GetCandidatePeers() since we already requested from them.\n+    AddOrphanAnnouncer(originator, orphan->GetWitnessHash(), orphan, current_time);\n+    // We prefer to request the orphan's ancestors via package relay rather than txids\n+    // of missing inputs. Also, if the first request fails, we should try again.\n+    // Get all peers that announced this transaction and prioritize accordingly...\n+    for (const auto nodeid : m_txrequest.GetCandidatePeers(orphan->GetWitnessHash())) {\n+        AddOrphanAnnouncer(nodeid, orphan->GetWitnessHash(), orphan, current_time);",
      "path": "src/net_processing.cpp",
      "position": 215,
      "original_position": 62,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "0671e1c178270350aadeba625da8b95d6ef2ff00",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Double checking that this is a no-op if the peer is already one the list of announcers? These seem to be called quite a bit as you get new announcements.",
      "created_at": "2023-05-31T18:02:00Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1212101478",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212101478"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1518,
      "original_line": 1462,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212157327",
      "pull_request_review_id": 1451533873,
      "id": 1212157327,
      "node_id": "PRRC_kwDOABII585IQA2P",
      "diff_hunk": "@@ -294,3 +297,57 @@ std::vector<uint256> TxOrphanage::EraseForBlock(const CBlock& block)\n     }\n     return vOrphanErase;\n }\n+\n+void TxOrphanage::ProtectOrphan(const uint256& wtxid)\n+{\n+    AssertLockNotHeld(m_mutex);\n+    LOCK(m_mutex);\n+    const auto it = m_wtxid_to_orphan_it.find(wtxid);\n+    if (it == m_wtxid_to_orphan_it.end()) return;\n+    // Already protected, increase its protection\n+    if (it->second->second.list_pos < 0) {\n+        it->second->second.list_pos -= 1;\n+        return;\n+    }\n+\n+    auto old_pos = it->second->second.list_pos;\n+    assert(m_orphan_list[old_pos] == it->second);\n+    if (old_pos + 1 != static_cast<int32_t>(m_orphan_list.size())) {\n+        // Unless we're deleting the last entry in m_orphan_list, move the last\n+        // entry to the position we're deleting.\n+        auto it_last = m_orphan_list.back();\n+        m_orphan_list[old_pos] = it_last;\n+        it_last->second.list_pos = old_pos;\n+    }\n+    m_orphan_list.pop_back();\n+    // Set list_pos to -1 to indicate this orphan is protected.\n+    it->second->second.list_pos = -1;\n+}\n+\n+void TxOrphanage::UndoProtectOrphan(const uint256& wtxid)\n+{\n+    AssertLockNotHeld(m_mutex);\n+    LOCK(m_mutex);\n+    const auto it = m_wtxid_to_orphan_it.find(wtxid);\n+    if (it == m_wtxid_to_orphan_it.end()) return;\n+    // Already not protected, nothing to do\n+    if (it->second->second.list_pos >= 0) {\n+        Assume(false);\n+        return;\n+    }\n+    // Protected by more than one peer. Remove one of the protections.\n+    if (it->second->second.list_pos < -1) {\n+        it->second->second.list_pos += 1;\n+        return;\n+    }\n+    // Add to the end or m_orphan_list",
      "path": "src/txorphanage.cpp",
      "position": 289,
      "original_position": 94,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "76c564761687eca898060998d60d6084b4ce361d",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "end of*",
      "created_at": "2023-05-31T18:46:14Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1212157327",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212157327"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 343,
      "original_line": 343,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212166925",
      "pull_request_review_id": 1451533873,
      "id": 1212166925,
      "node_id": "PRRC_kwDOABII585IQDMN",
      "diff_hunk": "@@ -294,3 +297,57 @@ std::vector<uint256> TxOrphanage::EraseForBlock(const CBlock& block)\n     }\n     return vOrphanErase;\n }\n+\n+void TxOrphanage::ProtectOrphan(const uint256& wtxid)\n+{\n+    AssertLockNotHeld(m_mutex);\n+    LOCK(m_mutex);\n+    const auto it = m_wtxid_to_orphan_it.find(wtxid);\n+    if (it == m_wtxid_to_orphan_it.end()) return;\n+    // Already protected, increase its protection\n+    if (it->second->second.list_pos < 0) {\n+        it->second->second.list_pos -= 1;\n+        return;\n+    }\n+\n+    auto old_pos = it->second->second.list_pos;\n+    assert(m_orphan_list[old_pos] == it->second);\n+    if (old_pos + 1 != static_cast<int32_t>(m_orphan_list.size())) {\n+        // Unless we're deleting the last entry in m_orphan_list, move the last\n+        // entry to the position we're deleting.\n+        auto it_last = m_orphan_list.back();\n+        m_orphan_list[old_pos] = it_last;\n+        it_last->second.list_pos = old_pos;\n+    }\n+    m_orphan_list.pop_back();\n+    // Set list_pos to -1 to indicate this orphan is protected.\n+    it->second->second.list_pos = -1;\n+}\n+\n+void TxOrphanage::UndoProtectOrphan(const uint256& wtxid)\n+{\n+    AssertLockNotHeld(m_mutex);\n+    LOCK(m_mutex);\n+    const auto it = m_wtxid_to_orphan_it.find(wtxid);\n+    if (it == m_wtxid_to_orphan_it.end()) return;\n+    // Already not protected, nothing to do\n+    if (it->second->second.list_pos >= 0) {\n+        Assume(false);\n+        return;\n+    }\n+    // Protected by more than one peer. Remove one of the protections.\n+    if (it->second->second.list_pos < -1) {\n+        it->second->second.list_pos += 1;\n+        return;\n+    }\n+    // Add to the end or m_orphan_list",
      "path": "src/txorphanage.cpp",
      "position": 289,
      "original_position": 94,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "76c564761687eca898060998d60d6084b4ce361d",
      "in_reply_to_id": 1212157327,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Say in comment the obvious \"protected by a single peer\" or add an `Assume` to that effect. Took me too long to figure this out even though it's obvious now.",
      "created_at": "2023-05-31T18:51:18Z",
      "updated_at": "2023-06-02T14:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1212166925",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1212166925"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 343,
      "original_line": 343,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213499613",
      "pull_request_review_id": 1451533873,
      "id": 1213499613,
      "node_id": "PRRC_kwDOABII585IVIjd",
      "diff_hunk": "@@ -256,12 +292,49 @@ class TxPackageTracker::Impl {\n             orphan_request_tracker.ReceivedInv(nodeid, GenTxid::Txid(wtxid), is_preferred, reqtime);\n         }\n \n-        if (tx != nullptr) {\n-            m_orphanage.AddTx(tx, nodeid);\n-        } else {\n-            m_orphanage.AddTx(m_orphanage.GetTx(wtxid), nodeid);\n-        }\n-\n+        m_orphanage.AddTx(ptx, nodeid);\n+        // Protection may or may not be possible. If the orphan is unprotected, it's possible it\n+        // will be evicted by the time we try to download ancestors. If we cannot protect now but",
      "path": "src/node/txpackagetracker.cpp",
      "position": 297,
      "original_position": 91,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "note: if child is evicted, will we attempt to process the rest of the package? will likely fail due to fee reasons, maybe this is just bandwidth loss?",
      "created_at": "2023-06-01T17:59:10Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1213499613",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213499613"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 297,
      "original_line": 297,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213504016",
      "pull_request_review_id": 1451533873,
      "id": 1213504016,
      "node_id": "PRRC_kwDOABII585IVJoQ",
      "diff_hunk": "@@ -256,12 +292,49 @@ class TxPackageTracker::Impl {\n             orphan_request_tracker.ReceivedInv(nodeid, GenTxid::Txid(wtxid), is_preferred, reqtime);\n         }\n \n-        if (tx != nullptr) {\n-            m_orphanage.AddTx(tx, nodeid);\n-        } else {\n-            m_orphanage.AddTx(m_orphanage.GetTx(wtxid), nodeid);\n-        }\n-\n+        m_orphanage.AddTx(ptx, nodeid);\n+        // Protection may or may not be possible. If the orphan is unprotected, it's possible it\n+        // will be evicted by the time we try to download ancestors. If we cannot protect now but\n+        // still have it later, we will attempt to protect it again.\n+        MaybeProtectOrphan(nodeid, wtxid);\n+    }\n+    void MaybeProtectOrphan(NodeId nodeid, const uint256& wtxid) EXCLUSIVE_LOCKS_REQUIRED(m_mutex)\n+    {\n+        AssertLockHeld(m_mutex);\n+        auto peer_info_it = info_per_peer.find(nodeid);\n+        // Skip if this isn't a package relay peer.\n+        if (peer_info_it == info_per_peer.end()) return;\n+        const auto orphan_tx = m_orphanage.GetTx(wtxid);\n+        // Skip if the orphanage doesn't have this transaction.\n+        if (!orphan_tx) return;\n+        const auto orphan_size{orphan_tx->GetTotalSize()};\n+        // Skip if this peer is already protecting this orphan.\n+        if (peer_info_it->second.m_protected_orphan_map.count(wtxid) > 0) return;\n+        // Skip if this peer is already protecting too many orphans.\n+        if (peer_info_it->second.AvailableProtectionTokens() < orphan_size) return;\n+\n+        // Protect this orphan.\n+        LogPrint(BCLog::TXPACKAGES, \"\\nProtecting orphan %s for peer=%d\\n\", wtxid.ToString(), nodeid);\n+        m_orphanage.ProtectOrphan(wtxid);\n+        peer_info_it->second.m_protected_orphans_size += orphan_tx->GetTotalSize();",
      "path": "src/node/txpackagetracker.cpp",
      "position": 319,
      "original_position": 113,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re-use `orphan_size`",
      "created_at": "2023-06-01T18:03:51Z",
      "updated_at": "2023-06-02T14:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1213504016",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213504016"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 319,
      "original_line": 319,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213509093",
      "pull_request_review_id": 1451533873,
      "id": 1213509093,
      "node_id": "PRRC_kwDOABII585IVK3l",
      "diff_hunk": "@@ -16,10 +16,21 @@ namespace node {\n      * Same as GETDATA_TX_INTERVAL. */\n     static constexpr auto ORPHAN_ANCESTOR_GETDATA_INTERVAL{60s};\n \n-    /** Delay to add if an orphan resolution candidate is already using a lot of memory in the\n+    /** Delay to add if an orphan resolution candidate is protecting a lot of memory in the\n      * orphanage. */\n     static constexpr auto ORPHANAGE_OVERLOAD_DELAY{1s};\n \n+    /** Maximum amount of orphans we may protect for an inbound peer when they first connect.\n+     * The number of \"protection tokens\" an inbound peer starts with. */\n+    static constexpr size_t MAX_ORPHANAGE_PROTECTION_INBOUND{50000};\n+    /** Maximum amount of orphans we may protect for an outbound peer when they first connect.\n+     * The number of \"protection tokens\" an inbound peer starts with. Equal to one maximum-size orphan. */",
      "path": "src/node/txpackagetracker.cpp",
      "position": 27,
      "original_position": 13,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "make it clear that all these units are in serialized transaction bytes, not WU or vsize.",
      "created_at": "2023-06-01T18:09:19Z",
      "updated_at": "2023-06-02T14:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1213509093",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213509093"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 27,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213527350",
      "pull_request_review_id": 1451533873,
      "id": 1213527350,
      "node_id": "PRRC_kwDOABII585IVPU2",
      "diff_hunk": "@@ -241,12 +267,22 @@ class TxPackageTracker::Impl {\n         LOCK(m_mutex);\n         // Skip if we weren't provided the tx and can't find the wtxid in the orphanage.\n         if (tx == nullptr && !m_orphanage.HaveTx(GenTxid::Wtxid(wtxid))) return;\n+        CTransactionRef ptx = tx ? tx : m_orphanage.GetTx(wtxid);\n \n         // Skip if already requested in the (recent-ish) past.\n         if (packageinfo_requested.contains(GetPackageInfoRequestId(nodeid, wtxid, PKG_RELAY_ANCPKG))) return;\n \n+        // Skip if this peer is already using a lot of space in the orphanage.\n+        if (m_orphanage.BytesFromPeer(nodeid) > MAX_ORPHANAGE_USAGE) return;",
      "path": "src/node/txpackagetracker.cpp",
      "position": 276,
      "original_position": 66,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`BytesFromPeer` counts all announced orphans, even if duplicates, correct?",
      "created_at": "2023-06-01T18:26:51Z",
      "updated_at": "2023-06-02T14:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1213527350",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213527350"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 276,
      "original_line": 276,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213537090",
      "pull_request_review_id": 1451533873,
      "id": 1213537090,
      "node_id": "PRRC_kwDOABII585IVRtC",
      "diff_hunk": "@@ -303,6 +376,9 @@ class TxPackageTracker::Impl {\n             auto pending_iter = pending_package_info.find(packageid);\n             Assume(pending_iter != pending_package_info.end());\n             if (pending_iter != pending_package_info.end()) {\n+                for (const auto& [wtxid, missing] : pending_iter->second.m_txdata_status) {\n+                    if (!missing) MaybeUnprotectOrphan(nodeid, wtxid);",
      "path": "src/node/txpackagetracker.cpp",
      "position": 380,
      "original_position": 140,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "what is the conditional guarding against?",
      "created_at": "2023-06-01T18:37:53Z",
      "updated_at": "2023-06-02T14:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1213537090",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213537090"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 380,
      "original_line": 380,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213551414",
      "pull_request_review_id": 1451533873,
      "id": 1213551414,
      "node_id": "PRRC_kwDOABII585IVVM2",
      "diff_hunk": "@@ -241,12 +267,22 @@ class TxPackageTracker::Impl {\n         LOCK(m_mutex);\n         // Skip if we weren't provided the tx and can't find the wtxid in the orphanage.\n         if (tx == nullptr && !m_orphanage.HaveTx(GenTxid::Wtxid(wtxid))) return;\n+        CTransactionRef ptx = tx ? tx : m_orphanage.GetTx(wtxid);\n \n         // Skip if already requested in the (recent-ish) past.\n         if (packageinfo_requested.contains(GetPackageInfoRequestId(nodeid, wtxid, PKG_RELAY_ANCPKG))) return;\n \n+        // Skip if this peer is already using a lot of space in the orphanage.\n+        if (m_orphanage.BytesFromPeer(nodeid) > MAX_ORPHANAGE_USAGE) return;",
      "path": "src/node/txpackagetracker.cpp",
      "position": 276,
      "original_position": 66,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "d76bb9dbb85d840df36f6b73fb84a2e58ada8433",
      "in_reply_to_id": 1213527350,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "also, think we should use the new orphan tx size as well here to avoid going past MAX_ORPHANAGE_USAGE?",
      "created_at": "2023-06-01T18:53:28Z",
      "updated_at": "2023-06-02T14:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1213551414",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213551414"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 276,
      "original_line": 276,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213639103",
      "pull_request_review_id": 1451533873,
      "id": 1213639103,
      "node_id": "PRRC_kwDOABII585IVqm_",
      "diff_hunk": "@@ -188,7 +191,7 @@ void TxOrphanage::LimitOrphans(unsigned int max_orphans)\n         if (nErased > 0) LogPrint(BCLog::TXPACKAGES, \"Erased %d orphan tx due to expiration\\n\", nErased);\n     }\n     FastRandomContext rng;\n-    while (m_orphans.size() > max_orphans || m_total_orphan_bytes > MAX_ORPHAN_TOTAL_SIZE)\n+    while (m_orphan_list.size() > max_orphans || m_total_orphan_bytes > MAX_ORPHAN_TOTAL_SIZE)",
      "path": "src/txorphanage.cpp",
      "position": 191,
      "original_position": 43,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "76c564761687eca898060998d60d6084b4ce361d",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`m_orphan_list` seems more aptly named `m_unprotected_orphan_list` after this",
      "created_at": "2023-06-01T20:19:34Z",
      "updated_at": "2023-06-02T14:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1213639103",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213639103"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 194,
      "original_line": 194,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213640730",
      "pull_request_review_id": 1451533873,
      "id": 1213640730,
      "node_id": "PRRC_kwDOABII585IVrAa",
      "diff_hunk": "@@ -188,7 +191,7 @@ void TxOrphanage::LimitOrphans(unsigned int max_orphans)\n         if (nErased > 0) LogPrint(BCLog::TXPACKAGES, \"Erased %d orphan tx due to expiration\\n\", nErased);\n     }\n     FastRandomContext rng;\n-    while (m_orphans.size() > max_orphans || m_total_orphan_bytes > MAX_ORPHAN_TOTAL_SIZE)\n+    while (m_orphan_list.size() > max_orphans || m_total_orphan_bytes > MAX_ORPHAN_TOTAL_SIZE)",
      "path": "src/txorphanage.cpp",
      "position": 191,
      "original_position": 43,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "76c564761687eca898060998d60d6084b4ce361d",
      "in_reply_to_id": 1213639103,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If we connect to enough peers and protect transactions beyond `MAX_ORPHAN_TOTAL_SIZE`, this will result in an assert with randrange arg of 0 once m_orphan_list is empty? Should either check m_orphan_list is non-empty, or only count non-protected bytes with `m_total_unprotected_orphan_bytes`?\r\n\r\n",
      "created_at": "2023-06-01T20:21:34Z",
      "updated_at": "2023-06-02T14:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1213640730",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213640730"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 194,
      "original_line": 194,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213651441",
      "pull_request_review_id": 1451533873,
      "id": 1213651441,
      "node_id": "PRRC_kwDOABII585IVtnx",
      "diff_hunk": "@@ -50,7 +50,12 @@ class TxOrphanage {\n     /** Erase all orphans included in or invalidated by a new block. Returns wtxids of erased txns. */\n     std::vector<uint256> EraseForBlock(const CBlock& block) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n \n-    /** Limit the orphanage to the given maximum */\n+    /** Limit the orphanage to the given maximum. Delete orphans whose expiry has been reached.\n+     * The maximum does not apply to protected transactions, i.e., LimitOrphans(100) ensures\n+     * that the number of non-protected orphan entries does not exceed 100. Afterward, Size() may\n+     * return a number greater than 100.  It is the caller's responsibility to ensure that not too\n+     * many orphans are protected.\n+     */\n     void LimitOrphans(unsigned int max_orphans) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);",
      "path": "src/txorphanage.h",
      "position": 58,
      "original_position": 11,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "76c564761687eca898060998d60d6084b4ce361d",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "rename arg `max_unprotected_orphans`?",
      "created_at": "2023-06-01T20:33:43Z",
      "updated_at": "2023-06-02T14:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1213651441",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213651441"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 59,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214465487",
      "pull_request_review_id": 1451533873,
      "id": 1214465487,
      "node_id": "PRRC_kwDOABII585IY0XP",
      "diff_hunk": "@@ -74,21 +99,43 @@ int TxOrphanage::_EraseTx(const uint256& txid)\n             m_outpoint_to_orphan_it.erase(itPrev);\n     }\n \n-    size_t old_pos = it->second.list_pos;\n-    assert(m_orphan_list[old_pos] == it);\n-    if (old_pos + 1 != m_orphan_list.size()) {\n-        // Unless we're deleting the last entry in m_orphan_list, move the last\n-        // entry to the position we're deleting.\n-        auto it_last = m_orphan_list.back();\n-        m_orphan_list[old_pos] = it_last;\n-        it_last->second.list_pos = old_pos;\n+    if (it->second.list_pos >= 0) {",
      "path": "src/txorphanage.cpp",
      "position": 103,
      "original_position": 103,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should this function ever be called with a protected orphan? Tests don't cover these lines for protected peers(added an assert, never hit), and seems suspect that it would delete things below this block if it's protected.",
      "created_at": "2023-06-02T14:38:20Z",
      "updated_at": "2023-06-02T14:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214465487",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214465487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 102,
      "original_line": 102,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214484568",
      "pull_request_review_id": 1457714296,
      "id": 1214484568,
      "node_id": "PRRC_kwDOABII585IY5BY",
      "diff_hunk": "@@ -74,21 +99,43 @@ int TxOrphanage::_EraseTx(const uint256& txid)\n             m_outpoint_to_orphan_it.erase(itPrev);\n     }\n \n-    size_t old_pos = it->second.list_pos;\n-    assert(m_orphan_list[old_pos] == it);\n-    if (old_pos + 1 != m_orphan_list.size()) {\n-        // Unless we're deleting the last entry in m_orphan_list, move the last\n-        // entry to the position we're deleting.\n-        auto it_last = m_orphan_list.back();\n-        m_orphan_list[old_pos] = it_last;\n-        it_last->second.list_pos = old_pos;\n+    if (it->second.list_pos >= 0) {",
      "path": "src/txorphanage.cpp",
      "position": 103,
      "original_position": 103,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "in_reply_to_id": 1214465487,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Should this function ever be called with a protected orphan?\r\n\r\nYes. It's called when orphans expire as well.\r\n\r\n> Tests don't cover these lines for protected peers\r\n\r\nSounds like I neglected to write a test for this. Expiry is pretty long, but theoretically we can hit this if we have multiple peers stalling us on the resolution of this orphan. We might happen to be trying package relay with one of the peers when the expiration is reached.",
      "created_at": "2023-06-02T14:55:32Z",
      "updated_at": "2023-06-02T14:55:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214484568",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214484568"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 102,
      "original_line": 102,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214486019",
      "pull_request_review_id": 1457717975,
      "id": 1214486019,
      "node_id": "PRRC_kwDOABII585IY5YD",
      "diff_hunk": "@@ -74,21 +99,43 @@ int TxOrphanage::_EraseTx(const uint256& txid)\n             m_outpoint_to_orphan_it.erase(itPrev);\n     }\n \n-    size_t old_pos = it->second.list_pos;\n-    assert(m_orphan_list[old_pos] == it);\n-    if (old_pos + 1 != m_orphan_list.size()) {\n-        // Unless we're deleting the last entry in m_orphan_list, move the last\n-        // entry to the position we're deleting.\n-        auto it_last = m_orphan_list.back();\n-        m_orphan_list[old_pos] = it_last;\n-        it_last->second.list_pos = old_pos;\n+    if (it->second.list_pos >= 0) {",
      "path": "src/txorphanage.cpp",
      "position": 103,
      "original_position": 103,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "in_reply_to_id": 1214465487,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah! Didn't put 2 and 2 together. Comment-worthy",
      "created_at": "2023-06-02T14:56:53Z",
      "updated_at": "2023-06-02T14:56:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214486019",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214486019"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 102,
      "original_line": 102,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214489207",
      "pull_request_review_id": 1457726341,
      "id": 1214489207,
      "node_id": "PRRC_kwDOABII585IY6J3",
      "diff_hunk": "@@ -188,7 +191,7 @@ void TxOrphanage::LimitOrphans(unsigned int max_orphans)\n         if (nErased > 0) LogPrint(BCLog::TXPACKAGES, \"Erased %d orphan tx due to expiration\\n\", nErased);\n     }\n     FastRandomContext rng;\n-    while (m_orphans.size() > max_orphans || m_total_orphan_bytes > MAX_ORPHAN_TOTAL_SIZE)\n+    while (m_orphan_list.size() > max_orphans || m_total_orphan_bytes > MAX_ORPHAN_TOTAL_SIZE)",
      "path": "src/txorphanage.cpp",
      "position": 191,
      "original_position": 43,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "76c564761687eca898060998d60d6084b4ce361d",
      "in_reply_to_id": 1213639103,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah yes, that's a bug! This `while` condition is very strange since one part applies to the unprotected orphanage and the other applies to the total orphanage. I think we should change the second condition to be on `m_total_unprotected_orphan_bytes`, yes.",
      "created_at": "2023-06-02T14:59:44Z",
      "updated_at": "2023-06-02T14:59:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214489207",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214489207"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 194,
      "original_line": 194,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214497418",
      "pull_request_review_id": 1457748132,
      "id": 1214497418,
      "node_id": "PRRC_kwDOABII585IY8KK",
      "diff_hunk": "@@ -176,9 +207,13 @@ void TxOrphanage::AddChildrenToWorkSet(const CTransaction& tx)\n         const auto it_by_prev = m_outpoint_to_orphan_it.find(COutPoint(tx.GetHash(), i));\n         if (it_by_prev != m_outpoint_to_orphan_it.end()) {\n             for (const auto& elem : it_by_prev->second) {\n+                Assume(elem->second.announcers.size() >= 1);\n+                if (elem->second.announcers.empty()) break;\n+                // Pick the first peer from announcers set.",
      "path": "src/txorphanage.cpp",
      "position": 210,
      "original_position": 94,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "fecb522a3fa83e7b485f5d17f070ed56d47e3d90",
      "in_reply_to_id": 1211861912,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Basically arbitrary. The relevance is basically which peer's message processing is blocked to process this, and would get a misbehaving score if the tx is invalid. Anyone who announced it is equally deserving of this burden imo. I suppose a more fair way to pick is uniformly randomly.",
      "created_at": "2023-06-02T15:07:28Z",
      "updated_at": "2023-06-02T15:07:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214497418",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214497418"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 215,
      "original_line": 212,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214696267",
      "pull_request_review_id": 1458284571,
      "id": 1214696267,
      "node_id": "PRRC_kwDOABII585IZstL",
      "diff_hunk": "@@ -72,6 +72,13 @@ class TxOrphanage {\n         LOCK(m_mutex);\n         return m_total_orphan_bytes;\n     }\n+    size_t BytesFromPeer(NodeId peer) const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/txorphanage.h",
      "position": 83,
      "original_position": 4,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "986f7622dabd422d6dc21bfc3319a0d04d4c4ecc",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think this introduces an interdependency between the number of outgoing transaction bytes we can receive from a peer and the maximum flow of LN commitment transaction+CPFP in weight a direct transaction-relay peer can announce to us and therefore we can validate. An `option_anchors_zero_fee_htlc_tx` LN commitment transaction weight is 900 WU with no pending HTLCs. As the orphan memory usage is implemented, its unclear if there is any processing guarantees for a peer announcing transaction to us, such processing guarantees are hard to enforce as we would be dependent on the full-node host performance.\r\n\r\nNote current `MAX_ORPHANAGE_USAGE` is defined as `MAX_ORPHANAGE_USAGE{10*MAX_ORPHANAGE_PROTECTION_OUTBOUND}` though it sounds applied on processing inbound announcement (L276 in `src/node/txpackagetracker.cpp`).",
      "created_at": "2023-06-02T18:42:45Z",
      "updated_at": "2023-06-02T19:14:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214696267",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214696267"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 91,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214712117",
      "pull_request_review_id": 1458284571,
      "id": 1214712117,
      "node_id": "PRRC_kwDOABII585IZwk1",
      "diff_hunk": "@@ -58,6 +59,36 @@ class TxPackageTracker {\n     /** Return how many entries exist in the orphange */\n     size_t OrphanageSize();\n \n+    /** Received an announcement from this peer for a tx we already know is an orphan; should be\n+     * called for every peer that announces the tx, even if they are not a package relay peer.",
      "path": "src/node/txpackagetracker.h",
      "position": 74,
      "original_position": 13,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "1c13f6465c170639465990e38a188193c036648c",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "There is a argument that can be made if memory and throughputs limits (e.g `MAX_PEER_ANNOUNCEMENTS`) are applied in function of the type of transactions received (e.g v3 transactions) and that can be used to nudge multi-party and contracting protocols transactions broadcasters to use fee-bumping efficient mechanism such as one CPFP covering multiple parents due to the package limits. This would be a discount incentive by analogy with SegWit spending discounted by consensus validation rules.\r\n\r\nOn the other hand, such incentive might have bad incentives as such package topology might be unsafe (i.e if all the parents confirmation are time-sensitive) and this can become a further complication of our transaction-relay stack.\r\n\r\nThere is still a last open question if such lack of dissociation between type of traffic (e.g packages from simple transactions) could be abused when package validation is deployed, and CPU performance processing asymmetries (i.e `AcceptSingleTransaction` vs `AcceptMultipleTransactions` vs `AcceptPackageWrappingSingle` vs `AcceptAncestorPackage`) between our code paths could be exploited by a transaction-relay jamming adversary.",
      "created_at": "2023-06-02T18:57:00Z",
      "updated_at": "2023-06-02T19:14:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214712117",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214712117"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 74,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214720397",
      "pull_request_review_id": 1458284571,
      "id": 1214720397,
      "node_id": "PRRC_kwDOABII585IZymN",
      "diff_hunk": "@@ -58,6 +59,36 @@ class TxPackageTracker {\n     /** Return how many entries exist in the orphange */\n     size_t OrphanageSize();\n \n+    /** Received an announcement from this peer for a tx we already know is an orphan; should be\n+     * called for every peer that announces the tx, even if they are not a package relay peer.\n+     * The orphan request tracker will decide when to request what from which peer - use\n+     * GetOrphanRequests().\n+     */\n+    void AddOrphanTx(NodeId nodeid, const uint256& wtxid, const CTransactionRef& tx, bool is_preferred, std::chrono::microseconds reqtime);\n+\n+    /** Number of packages we are working on with this peer. Includes any entries in the orphan\n+     * tracker, in-flight orphan parent requests (1 per orphan regardless of how many missing",
      "path": "src/node/txpackagetracker.h",
      "position": 81,
      "original_position": 20,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "1c13f6465c170639465990e38a188193c036648c",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If I understand correctly the rate-limiting accounting introduced here, whatever the number of orphan parent missing, there will be an in-flight orphan parent requests issued (i.e if were missing 10 parents, were going to issue 10 in-flight orphan parent requests).\r\n\r\nI think this should be documented as multi-party applications and contracting protocols transactions issuers might have to assemble their packages in function.",
      "created_at": "2023-06-02T19:03:32Z",
      "updated_at": "2023-06-02T19:14:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214720397",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214720397"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 81,
      "original_line": 70,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214728153",
      "pull_request_review_id": 1458284571,
      "id": 1214728153,
      "node_id": "PRRC_kwDOABII585IZ0fZ",
      "diff_hunk": "@@ -58,6 +59,36 @@ class TxPackageTracker {\n     /** Return how many entries exist in the orphange */\n     size_t OrphanageSize();\n \n+    /** Received an announcement from this peer for a tx we already know is an orphan; should be\n+     * called for every peer that announces the tx, even if they are not a package relay peer.\n+     * The orphan request tracker will decide when to request what from which peer - use\n+     * GetOrphanRequests().\n+     */\n+    void AddOrphanTx(NodeId nodeid, const uint256& wtxid, const CTransactionRef& tx, bool is_preferred, std::chrono::microseconds reqtime);\n+\n+    /** Number of packages we are working on with this peer. Includes any entries in the orphan\n+     * tracker, in-flight orphan parent requests (1 per orphan regardless of how many missing\n+     * parents were requested), package info requests, tx data download, and packages in the\n+     * validation queue. */\n+    size_t Count(NodeId nodeid) const;\n+\n+    /** Number of packages we are currently working on with this peer (i.e. reserving memory for\n+     * storing orphan(s)). Includes in-flight package info requests, tx data download, and packages\n+     * in the validation queue. Excludes entries in the orphan tracker that are just candidates. */\n+    size_t CountInFlight(NodeId nodeid) const;\n+\n+    /** Get list of requests that should be sent to resolve orphans. These may be wtxids to send\n+     * getdata(ANCPKGINFO) or txids corresponding to parents. Automatically marks the orphans as\n+     * having outgoing requests. */\n+    std::vector<GenTxid> GetOrphanRequests(NodeId nodeid, std::chrono::microseconds current_time);\n+\n+    /** Update transactions for which we have made \"final\" decisions: transactions that have\n+     * confirmed in a block, conflicted due to a block, or added to the mempool already.\n+     * Should be called on new block: valid=block transactions, invalid=conflicts.\n+     * Should be called when tx is added to mempool.\n+     * Should not be called when a tx fails validation.\n+     * */\n+    void FinalizeTransactions(const std::set<uint256>& valid, const std::set<uint256>& invalid);",
      "path": "src/node/txpackagetracker.h",
      "position": 102,
      "original_position": 41,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "1c13f6465c170639465990e38a188193c036648c",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is unclear what level of enforcement is granted to a final decision, if the transactions are added to any transaction-relay download filters such as `m_recent_rejects` or `m_recently_announced_invs`. Otherwise, in case of blocks re-orgs dropping out the first package component and a second package component still stuck in filters, this can be source of package propagation failure.",
      "created_at": "2023-06-02T19:10:09Z",
      "updated_at": "2023-06-02T19:14:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214728153",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214728153"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 102,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214732393",
      "pull_request_review_id": 1458284571,
      "id": 1214732393,
      "node_id": "PRRC_kwDOABII585IZ1hp",
      "diff_hunk": "@@ -43,7 +43,8 @@ class TxOrphanage {\n     /** Erase an orphan by wtxid */\n     int EraseTx(const uint256& wtxid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n \n-    /** Erase all orphans announced by a peer (eg, after that peer disconnects) */\n+    /** Maybe erase all orphans announced by a peer (eg, after that peer disconnects). If an orphan",
      "path": "src/txorphanage.h",
      "position": 42,
      "original_position": 14,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "fecb522a3fa83e7b485f5d17f070ed56d47e3d90",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think there can be a source of concerns if all the announced orphans are second components from a single common parent. All our peers would announce those second-stage components, only one of them will succeed in the mempool validation and other will be refused as conflicts, I think.",
      "created_at": "2023-06-02T19:14:42Z",
      "updated_at": "2023-06-02T19:14:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214732393",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214732393"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 46,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214751567",
      "pull_request_review_id": 1458376374,
      "id": 1214751567,
      "node_id": "PRRC_kwDOABII585IZ6NP",
      "diff_hunk": "@@ -72,6 +72,13 @@ class TxOrphanage {\n         LOCK(m_mutex);\n         return m_total_orphan_bytes;\n     }\n+    size_t BytesFromPeer(NodeId peer) const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/txorphanage.h",
      "position": 83,
      "original_position": 4,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "986f7622dabd422d6dc21bfc3319a0d04d4c4ecc",
      "in_reply_to_id": 1214696267,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Orphan usage would effect the CPFP transactions, IIUC, not the commitment transactions. The CPFP is deemed high enough, sent to the peer, the peer holds the child tx in orphan set and requests the full package, which isn't size-bound(beyond current mempool limits).",
      "created_at": "2023-06-02T19:34:01Z",
      "updated_at": "2023-06-02T19:34:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1214751567",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214751567"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 91,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218144248",
      "pull_request_review_id": 1462664683,
      "id": 1218144248,
      "node_id": "PRRC_kwDOABII585Im2f4",
      "diff_hunk": "@@ -58,6 +59,36 @@ class TxPackageTracker {\n     /** Return how many entries exist in the orphange */\n     size_t OrphanageSize();\n \n+    /** Received an announcement from this peer for a tx we already know is an orphan; should be\n+     * called for every peer that announces the tx, even if they are not a package relay peer.\n+     * The orphan request tracker will decide when to request what from which peer - use\n+     * GetOrphanRequests().\n+     */\n+    void AddOrphanTx(NodeId nodeid, const uint256& wtxid, const CTransactionRef& tx, bool is_preferred, std::chrono::microseconds reqtime);\n+\n+    /** Number of packages we are working on with this peer. Includes any entries in the orphan\n+     * tracker, in-flight orphan parent requests (1 per orphan regardless of how many missing",
      "path": "src/node/txpackagetracker.h",
      "position": 81,
      "original_position": 20,
      "commit_id": "cdb5b163d623db802ed7f8a3394b2674362f409b",
      "original_commit_id": "1c13f6465c170639465990e38a188193c036648c",
      "in_reply_to_id": 1214720397,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "IIUC\r\n\r\ntotal number of inflights doesn't appear to be changed here, it's still `MAX_PEER_TX_ANNOUNCEMENTS`\r\n\r\nIf the protected buckets are taken by attackers, an honest party can still insert an orphan into the unprotected bucket(under the MAX_PEER_TX_ANNOUNCEMENTS limit), and the whole package including the child should get fetched after a short delay.\r\n\r\nSo from a time-sensitive contract perspective, things should be strictly better than today?",
      "created_at": "2023-06-05T14:19:36Z",
      "updated_at": "2023-06-05T14:19:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27742#discussion_r1218144248",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218144248"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 81,
      "original_line": 70,
      "side": "RIGHT"
    }
  ]
}