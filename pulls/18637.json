{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "id": 403356564,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDAzMzU2NTY0",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/18637.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/18637.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "number": 18637,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "coins: allow cache resize after init",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is part of the [assumeutxo project](https://github.com/bitcoin/bitcoin/projects/11):\r\n\r\nParent PR: #15606 \r\nIssue: #15605 \r\nSpecification: https://github.com/jamesob/assumeutxo-docs/tree/master/proposal\r\n\r\n---\r\n\r\nIn the assumeutxo implementation draft (#15056), once a UTXO snapshot is loaded, a new chainstate object is created after initialization. This means that we have to reclaim some of the cache that we've allocated to the original chainstate (per `dbcache=`) to repurpose for the snapshot chainstate.\r\n\r\nFurthermore, it makes sense to have different cache allocations depending on which chainstate is more active. While the snapshot chainstate is working to get to the network tip (and the background validation chainstate is idle), it makes sense that the snapshot chainstate should have the majority of cache allocation. And contrariwise once the snapshot has reached network tip, most of the cache should be given to the background validation chainstate.\r\n\r\nThis set of changes (detailed in the commit messages) allows us to dynamically resize the various coins caches. None of the functionality introduced here is used at the moment, but will be in the next AU PR (which introduces `ActivateSnapshot`).\r\n\r\n`ChainstateManager::MaybeRebalanceCaches()` defines the (somewhat normative) cache allocations between the snapshot and background validation chainstates. I'd be interested in feedback if anyone has thoughts on the proportions I've set there.",
    "labels": [
      {
        "id": 97470796,
        "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
        "name": "UTXO Db and Indexes",
        "color": "fbca04",
        "default": false
      },
      {
        "id": 118379652,
        "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
        "name": "Validation",
        "color": "6060aa",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2020-04-14T18:54:22Z",
    "updated_at": "2022-02-15T10:46:39Z",
    "closed_at": "2020-07-29T05:55:09Z",
    "mergeable_state": "unknown",
    "merged_at": "2020-07-29T05:55:09Z",
    "merge_commit_sha": "2f71a1ea35667b3873197201531e7ae198ec5bf4",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "jamesob:2020-04-au.cache-resize",
      "ref": "2020-04-au.cache-resize",
      "sha": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 42077031,
        "node_id": "MDEwOlJlcG9zaXRvcnk0MjA3NzAzMQ==",
        "name": "bitcoin",
        "full_name": "jamesob/bitcoin",
        "owner": {
          "login": "jamesob",
          "id": 73197,
          "node_id": "MDQ6VXNlcjczMTk3",
          "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/jamesob",
          "html_url": "https://github.com/jamesob",
          "followers_url": "https://api.github.com/users/jamesob/followers",
          "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
          "organizations_url": "https://api.github.com/users/jamesob/orgs",
          "repos_url": "https://api.github.com/users/jamesob/repos",
          "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/jamesob/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/jamesob/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/jamesob/bitcoin",
        "archive_url": "https://api.github.com/repos/jamesob/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/jamesob/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/jamesob/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/jamesob/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/jamesob/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/jamesob/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/jamesob/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/jamesob/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/jamesob/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/jamesob/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/jamesob/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/jamesob/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/jamesob/bitcoin/events",
        "forks_url": "https://api.github.com/repos/jamesob/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/jamesob/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/jamesob/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/jamesob/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/jamesob/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/jamesob/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/jamesob/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/jamesob/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/jamesob/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/jamesob/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/jamesob/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/jamesob/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/jamesob/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/jamesob/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/jamesob/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/jamesob/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:jamesob/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/jamesob/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/jamesob/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/jamesob/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/jamesob/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/jamesob/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/jamesob/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/jamesob/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/jamesob/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/jamesob/bitcoin/hooks",
        "svn_url": "https://github.com/jamesob/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 2,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 252891,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-05-31T19:20:56Z",
        "created_at": "2015-09-07T22:18:03Z",
        "updated_at": "2023-05-05T06:31:51Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "85a68952f86dea04c797a7c060f25cc7e626a47e",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69818,
        "watchers_count": 69818,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T22:42:00Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T03:51:27Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 285,
    "deletions": 33,
    "changed_files": 12,
    "commits": 4,
    "review_comments": 33,
    "comments": 7
  },
  "events": [
    {
      "event": "labeled",
      "id": 3232797173,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMyMzI3OTcxNzM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3232797173",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-14T20:31:35Z",
      "label": {
        "name": "Build system",
        "color": "5319e7"
      }
    },
    {
      "event": "labeled",
      "id": 3232797174,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMyMzI3OTcxNzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3232797174",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-14T20:31:35Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "labeled",
      "id": 3232797175,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMyMzI3OTcxNzU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3232797175",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-14T20:31:35Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "labeled",
      "id": 3232797177,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMyMzI3OTcxNzc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3232797177",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-14T20:31:35Z",
      "label": {
        "name": "Validation",
        "color": "6060aa"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3232905620,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzIzMjkwNTYyMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3232905620",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-14T21:05:03Z"
    },
    {
      "event": "commented",
      "id": 613683149,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYxMzY4MzE0OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/613683149",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-14T21:10:15Z",
      "updated_at": "2020-07-28T21:49:49Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19604 (Pass mempool pointer to UnloadBlockIndex/GetCoinsCacheSizeState by MarcoFalke)\n* #19556 (Remove mempool global by MarcoFalke)\n* #17487 (coins: allow write to disk without cache drop by jamesob)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-613683149",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637"
    },
    {
      "event": "reviewed",
      "id": 393914341,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzOTE0MzQx",
      "url": null,
      "actor": null,
      "commit_id": "03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-393914341",
      "submitted_at": "2020-04-15T15:58:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "reviewed",
      "id": 394808868,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0ODA4ODY4",
      "url": null,
      "actor": null,
      "commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK 03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5. Very clean, straightforward changes. Feel free to ignore suggestions below, but one I'd consider more is passing up FlushStateToDisk return false status, to be able to log more context information if it fails for some reason",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-394808868",
      "submitted_at": "2020-04-16T17:29:03Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3261147714,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzI2MTE0NzcxNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3261147714",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-22T15:26:59Z"
    },
    {
      "event": "commented",
      "id": 617849721,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYxNzg0OTcyMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/617849721",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-22T15:28:09Z",
      "updated_at": "2020-04-22T15:28:09Z",
      "author_association": "MEMBER",
      "body": "Thanks for the review and good suggestions, @ryanofsky. I've incorporated your feedback in the latest revision.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-617849721",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637"
    },
    {
      "event": "mentioned",
      "id": 3261152784,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzI2MTE1Mjc4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3261152784",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-22T15:28:09Z"
    },
    {
      "event": "subscribed",
      "id": 3261152786,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMyNjExNTI3ODY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3261152786",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-22T15:28:09Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3301319172,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzMwMTMxOTE3Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3301319172",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-04T19:14:01Z"
    },
    {
      "event": "reviewed",
      "id": 414759782,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NzU5Nzgy",
      "url": null,
      "actor": null,
      "commit_id": "db5e36a033e642599db808f59d16d03a40860f17",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK 4cc7b612d1413451d500c5fd6eefebea34216460. Changes since previous review were suggested things: using MakeUnique instead of new, renaming db to m_db while all lines are changing anyway, returning failure from FlushStateToDisk, and adding rebalance test",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-414759782",
      "submitted_at": "2020-05-19T19:32:50Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "commented",
      "id": 632821018,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzMjgyMTAxOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/632821018",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-22T17:32:30Z",
      "updated_at": "2020-05-22T17:32:30Z",
      "author_association": "MEMBER",
      "body": "Should this be added to in progress column https://github.com/bitcoin/bitcoin/projects/11? \r\n\r\nAlso maybe if there's a main assumeutxo pr you'd prioritize for review now it could go on high priority reviews https://github.com/bitcoin/bitcoin/projects/8",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-632821018",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637"
    },
    {
      "event": "labeled",
      "id": 3366980719,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMzNjY5ODA3MTk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3366980719",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-23T12:06:23Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 417275042,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3Mjc1MDQy",
      "url": null,
      "actor": null,
      "commit_id": "4cc7b612d1413451d500c5fd6eefebea34216460",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-417275042",
      "submitted_at": "2020-05-23T12:26:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3383913443,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzM4MzkxMzQ0Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3383913443",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-28T17:37:48Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3383920302,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzM4MzkyMDMwMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3383920302",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-28T17:39:45Z"
    },
    {
      "event": "unlabeled",
      "id": 3384242039,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50MzM4NDI0MjAzOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3384242039",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-28T19:09:32Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "added_to_project",
      "id": 3384256564,
      "node_id": "MDE5OkFkZGVkVG9Qcm9qZWN0RXZlbnQzMzg0MjU2NTY0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3384256564",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-28T19:13:46Z",
      "project_card": {
        "id": 39101264,
        "url": "https://api.github.com/projects/columns/cards/39101264",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "commented",
      "id": 636468316,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjQ2ODMxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636468316",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-31T12:59:37Z",
      "updated_at": "2020-05-31T12:59:37Z",
      "author_association": "MEMBER",
      "body": "This doesn't compile\r\n\r\n```\r\nvalidation.cpp: In member function ‘bool CChainState::ResizeCoinsCaches(size_t, size_t)’:\r\n\r\nvalidation.cpp:4990:23: error: comparison of integer expressions of different signedness: ‘size_t’ {aka ‘unsigned int’} and ‘int’ [-Werror=sign-compare]\r\n\r\n     if (coinstip_size > old_coinstip_size) {\r\n\r\n         ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~\r\n\r\ncc1plus: some warnings being treated as errors",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-636468316",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637"
    },
    {
      "event": "commented",
      "id": 636468355,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjQ2ODM1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636468355",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-31T13:00:07Z",
      "updated_at": "2020-05-31T13:00:07Z",
      "author_association": "MEMBER",
      "body": "It does compile locally, so I am not sure how to reproduce this failure :(",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-636468355",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637"
    },
    {
      "event": "reviewed",
      "id": 421492649,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDkyNjQ5",
      "url": null,
      "actor": null,
      "commit_id": "1e6e0b9af6c5470dbf1e61f54900ac9a21f147a2",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-421492649",
      "submitted_at": "2020-05-31T13:04:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3390699639,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzM5MDY5OTYzOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3390699639",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-31T15:17:59Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3390797462,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzM5MDc5NzQ2Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3390797462",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-31T17:09:31Z"
    },
    {
      "event": "unlabeled",
      "id": 3434988642,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50MzQzNDk4ODY0Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3434988642",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-11T16:29:02Z",
      "label": {
        "name": "Build system",
        "color": "5319e7"
      }
    },
    {
      "event": "unlabeled",
      "id": 3434988643,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50MzQzNDk4ODY0Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3434988643",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-11T16:29:02Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "reviewed",
      "id": 430951947,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwOTUxOTQ3",
      "url": null,
      "actor": null,
      "commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code looks great but the warning should be fixed. Will do another pass then.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-430951947",
      "submitted_at": "2020-06-15T20:09:31Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "reviewed",
      "id": 440229633,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMjI5NjMz",
      "url": null,
      "actor": null,
      "commit_id": "bb6ba5ff781e54eb83dc271c335031c7e9488f86",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK bb6ba5ff781e54eb83dc271c335031c7e9488f86. Only changes since last review are rebase, replacing int with size_t, replacing ENTER_CRITICAL_SECTION with WITH_LOCK.\r\n\r\nThere are some open review suggestions above but they seem pretty minor and fine to save for a followup",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-440229633",
      "submitted_at": "2020-06-30T17:19:09Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "commented",
      "id": 651932209,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY1MTkzMjIwOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/651932209",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-30T17:20:44Z",
      "updated_at": "2020-06-30T17:20:44Z",
      "author_association": "MEMBER",
      "body": "[\"if anyone wants to see forward motion on assumeutxo, #18637 is the one to review\"](http://www.erisian.com.au/bitcoin-core-dev/log-2020-06-11.html#l-442)",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-651932209",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiMjIzMTExZGEyZTBlOWNlY2NlZjc1ZGY4YTIwMjUyYjAwOTRiN2Jj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b223111da2e0e9ceccef75df8a20252b0094b7bc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b223111da2e0e9ceccef75df8a20252b0094b7bc",
      "tree": {
        "sha": "db40a92d85a7bd7a3dd8ff413abad13f21062220",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/db40a92d85a7bd7a3dd8ff413abad13f21062220"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea3e9e0b84c57df4110ca9e5ccced65c5bbe4611",
          "sha": "ea3e9e0b84c57df4110ca9e5ccced65c5bbe4611",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ea3e9e0b84c57df4110ca9e5ccced65c5bbe4611"
        }
      ],
      "message": "txdb: add CCoinsViewDB::ChangeCacheSize\n\nWe'll need this to dynamically update the cache size of the existing\nCCoinsViewDB instance when we create a new one during snapshot activation.\n\nThis requires us to keep the CDBWrapper instance as a pointer instead of\na reference so that we're able to destruct it and create a new instance\nwhen the cache size changes.\n\nAlso renames `db` to `m_db` since we're already modifying each usage.\n\nIncludes feedback from Russ Yanofsky.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2020-07-01T18:44:24Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2019-04-17T14:07:15Z"
      },
      "sha": "b223111da2e0e9ceccef75df8a20252b0094b7bc"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmMzZhYWE2MzkyZmRiZGFjNjg5MWQ5MjIwMmQzZWZlZmY5ODc1NGY0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f36aaa6392fdbdac6891d92202d3efeff98754f4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f36aaa6392fdbdac6891d92202d3efeff98754f4",
      "tree": {
        "sha": "4cebab3fa566f6f9dc53228b92264f1cda6095b1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4cebab3fa566f6f9dc53228b92264f1cda6095b1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b223111da2e0e9ceccef75df8a20252b0094b7bc",
          "sha": "b223111da2e0e9ceccef75df8a20252b0094b7bc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b223111da2e0e9ceccef75df8a20252b0094b7bc"
        }
      ],
      "message": "Add CChainState::ResizeCoinsCaches\n\nAlso adds CCoinsViewCache::ReallocateCache() to attempt to free\nmemory that the cacheCoins's allocator may be hanging onto when\ndownsizing the cache.\n\nAdds `CChainState::m_coins{tip,db}_cache_size_bytes` data members\nso that we can reference cache size on a per-chainstate basis for\nflushing.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2020-07-01T18:44:28Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2019-09-16T19:01:12Z"
      },
      "sha": "f36aaa6392fdbdac6891d92202d3efeff98754f4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4YWMzZWY0Njk5OWVkNjc2Y2EzNzc1ZjdiMmY0NjFkOTJmMDlhNTQy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8ac3ef46999ed676ca3775f7b2f461d92f09a542",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8ac3ef46999ed676ca3775f7b2f461d92f09a542",
      "tree": {
        "sha": "3bace2a0a4de841a555e04052de69e7cae6ba1de",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3bace2a0a4de841a555e04052de69e7cae6ba1de"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f36aaa6392fdbdac6891d92202d3efeff98754f4",
          "sha": "f36aaa6392fdbdac6891d92202d3efeff98754f4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f36aaa6392fdbdac6891d92202d3efeff98754f4"
        }
      ],
      "message": "add ChainstateManager::MaybeRebalanceCaches()\n\nAside from in unittests, this method is unused at the moment. It will be used\nin upcoming commits that enable utxo snapshot activation.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2020-07-01T18:44:28Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2019-09-16T17:37:29Z"
      },
      "sha": "8ac3ef46999ed676ca3775f7b2f461d92f09a542"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmMTlmZGQ0N2E2MzcxZGNiZTA3NjBlZjZmM2MzYzVhZGIzMWIxYmI0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "tree": {
        "sha": "432370dfe2f8d0df7e1b6f7e4f40da57b1479de0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/432370dfe2f8d0df7e1b6f7e4f40da57b1479de0"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8ac3ef46999ed676ca3775f7b2f461d92f09a542",
          "sha": "8ac3ef46999ed676ca3775f7b2f461d92f09a542",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8ac3ef46999ed676ca3775f7b2f461d92f09a542"
        }
      ],
      "message": "test: add test for CChainState::ResizeCoinsCaches()",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2020-07-01T18:44:28Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2020-04-14T18:00:37Z"
      },
      "sha": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3503770984,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzUwMzc3MDk4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3503770984",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-07-01T18:46:51Z"
    },
    {
      "event": "reviewed",
      "id": 441023103,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMDIzMTAz",
      "url": null,
      "actor": null,
      "commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "weak utACK f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4 -- didn't find any major problems, but not super confident that I didn't miss anything\r\n\r\nEDIT: (update commit fixes init order)",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-441023103",
      "submitted_at": "2020-07-01T18:47:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "reviewed",
      "id": 442566498,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNTY2NDk4",
      "url": null,
      "actor": null,
      "commit_id": "8ac3ef46999ed676ca3775f7b2f461d92f09a542",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK f19fdd4",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-442566498",
      "submitted_at": "2020-07-03T22:00:33Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "reviewed",
      "id": 445010486,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MDEwNDg2",
      "url": null,
      "actor": null,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4. Only change since last review is constructor cleanup (no change in behavior). I think the suggestions here from ajtowns and others are good, but shouldn't delay merging the PR (and hold up assumeutxo)",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-445010486",
      "submitted_at": "2020-07-08T18:06:27Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "commented",
      "id": 663469178,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY2MzQ2OTE3OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/663469178",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-07-24T10:15:42Z",
      "updated_at": "2020-07-24T10:15:42Z",
      "author_association": "MEMBER",
      "body": "This looks ready to merge",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-663469178",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637"
    },
    {
      "event": "merged",
      "id": 3597390045,
      "node_id": "MDExOk1lcmdlZEV2ZW50MzU5NzM5MDA0NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3597390045",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "2f71a1ea35667b3873197201531e7ae198ec5bf4",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2f71a1ea35667b3873197201531e7ae198ec5bf4",
      "created_at": "2020-07-29T05:55:09Z"
    },
    {
      "event": "closed",
      "id": 3597390050,
      "node_id": "MDExOkNsb3NlZEV2ZW50MzU5NzM5MDA1MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3597390050",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-07-29T05:55:09Z"
    },
    {
      "event": "reviewed",
      "id": 457483812,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NDgzODEy",
      "url": null,
      "actor": null,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#pullrequestreview-457483812",
      "submitted_at": "2020-07-29T12:46:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
    },
    {
      "event": "removed_from_project",
      "id": 3599040883,
      "node_id": "MDIzOlJlbW92ZWRGcm9tUHJvamVjdEV2ZW50MzU5OTA0MDg4Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3599040883",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-07-29T13:26:33Z",
      "project_card": {
        "id": 39101264,
        "url": "https://api.github.com/projects/columns/cards/39101264",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "referenced",
      "id": 3606894947,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM2MDY4OTQ5NDc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3606894947",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "191c48d32d5955d0757fdc02c20fdf7183ffd62f",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/191c48d32d5955d0757fdc02c20fdf7183ffd62f",
      "created_at": "2020-07-31T05:10:52Z"
    },
    {
      "event": "added_to_project",
      "id": 3627452951,
      "node_id": "MDE5OkFkZGVkVG9Qcm9qZWN0RXZlbnQzNjI3NDUyOTUx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3627452951",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-06T05:35:46Z",
      "project_card": {
        "id": 36303670,
        "url": "https://api.github.com/projects/columns/cards/36303670",
        "project_id": 2564674,
        "project_url": "https://api.github.com/projects/2564674",
        "column_name": "Done"
      }
    },
    {
      "event": "referenced",
      "id": 4365761443,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQzNjU3NjE0NDM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4365761443",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "8af6d9df957b4895881885c3750310b564c23124",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/8af6d9df957b4895881885c3750310b564c23124",
      "created_at": "2021-02-23T15:20:09Z"
    },
    {
      "event": "referenced",
      "id": 4577879549,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ1Nzc4Nzk1NDk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4577879549",
      "actor": {
        "login": "EyeOfPython",
        "id": 5587711,
        "node_id": "MDQ6VXNlcjU1ODc3MTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5587711?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/EyeOfPython",
        "html_url": "https://github.com/EyeOfPython",
        "followers_url": "https://api.github.com/users/EyeOfPython/followers",
        "following_url": "https://api.github.com/users/EyeOfPython/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/EyeOfPython/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/EyeOfPython/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/EyeOfPython/subscriptions",
        "organizations_url": "https://api.github.com/users/EyeOfPython/orgs",
        "repos_url": "https://api.github.com/users/EyeOfPython/repos",
        "events_url": "https://api.github.com/users/EyeOfPython/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/EyeOfPython/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7a7219e18beb3189c105b5d2d8bf17fe92fdb813",
      "commit_url": "https://api.github.com/repos/EyeOfPython/cashd/commits/7a7219e18beb3189c105b5d2d8bf17fe92fdb813",
      "created_at": "2021-04-10T20:59:08Z"
    },
    {
      "event": "referenced",
      "id": 4577882074,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ1Nzc4ODIwNzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4577882074",
      "actor": {
        "login": "EyeOfPython",
        "id": 5587711,
        "node_id": "MDQ6VXNlcjU1ODc3MTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5587711?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/EyeOfPython",
        "html_url": "https://github.com/EyeOfPython",
        "followers_url": "https://api.github.com/users/EyeOfPython/followers",
        "following_url": "https://api.github.com/users/EyeOfPython/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/EyeOfPython/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/EyeOfPython/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/EyeOfPython/subscriptions",
        "organizations_url": "https://api.github.com/users/EyeOfPython/orgs",
        "repos_url": "https://api.github.com/users/EyeOfPython/repos",
        "events_url": "https://api.github.com/users/EyeOfPython/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/EyeOfPython/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "cd94d41e6dfc3dfc499a1842498e18e884a49b6f",
      "commit_url": "https://api.github.com/repos/EyeOfPython/cashd/commits/cd94d41e6dfc3dfc499a1842498e18e884a49b6f",
      "created_at": "2021-04-10T21:02:36Z"
    },
    {
      "event": "referenced",
      "id": 4577886874,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ1Nzc4ODY4NzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4577886874",
      "actor": {
        "login": "EyeOfPython",
        "id": 5587711,
        "node_id": "MDQ6VXNlcjU1ODc3MTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5587711?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/EyeOfPython",
        "html_url": "https://github.com/EyeOfPython",
        "followers_url": "https://api.github.com/users/EyeOfPython/followers",
        "following_url": "https://api.github.com/users/EyeOfPython/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/EyeOfPython/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/EyeOfPython/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/EyeOfPython/subscriptions",
        "organizations_url": "https://api.github.com/users/EyeOfPython/orgs",
        "repos_url": "https://api.github.com/users/EyeOfPython/repos",
        "events_url": "https://api.github.com/users/EyeOfPython/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/EyeOfPython/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "3b4b7cde43f2ae04f064fe004d0088733bd28e99",
      "commit_url": "https://api.github.com/repos/EyeOfPython/cashd/commits/3b4b7cde43f2ae04f064fe004d0088733bd28e99",
      "created_at": "2021-04-10T21:08:56Z"
    },
    {
      "event": "locked",
      "id": 6073895012,
      "node_id": "LOE_lADOABII584jwAk0zwAAAAFqCEhk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6073895012",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-15T10:46:39Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408954497",
      "pull_request_review_id": 393914341,
      "id": 408954497,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk1NDQ5Nw==",
      "diff_hunk": "@@ -0,0 +1,76 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#include <random.h>\n+#include <uint256.h>\n+#include <consensus/validation.h>\n+#include <sync.h>\n+#include <test/util/setup_common.h>\n+#include <validation.h>\n+\n+#include <vector>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(validation_chainstate_tests, TestingSetup)\n+\n+//! Test resizing coins-related CChainState caches during runtime.\n+//!\n+BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n+{\n+    ChainstateManager manager;\n+\n+    //! Create and add a Coin with DynamicMemoryUsage of 80 bytes to the given view.\n+    auto add_coin = [](CCoinsViewCache& coins_view) -> COutPoint {\n+        Coin newcoin;\n+        uint256 txid = InsecureRand256();\n+        COutPoint outp{txid, 0};\n+        newcoin.nHeight = 1;\n+        newcoin.out.nValue = InsecureRand32();\n+        newcoin.out.scriptPubKey.assign((uint32_t)56, 1);\n+        coins_view.AddCoin(outp, std::move(newcoin), false);\n+\n+        return outp;\n+    };\n+\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);\n+    c1.InitCoinsDB(\n+        /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n+    WITH_LOCK(::cs_main, c1.InitCoinsCache(1 << 23));\n+\n+    // Add a coin to the in-memory cache, upsize once, then downsize.\n+    {\n+        LOCK(::cs_main);\n+        auto outpoint = add_coin(c1.CoinsTip());\n+\n+        // Set a meaningless bestblock value in the coinsview cache - otherwise we won't\n+        // flush during ResizecoinsCaches() and will subsequently hit an assertion.\n+        c1.CoinsTip().SetBestBlock(InsecureRand256());\n+\n+        BOOST_CHECK(c1.CoinsTip().HaveCoinInCache(outpoint));\n+\n+        c1.ResizeCoinsCaches(\n+            1 << 24,  // upsizing the coinsview cache\n+            1 << 22  // downsizing the coinsdb cache\n+        );\n+\n+        // View should still have the coin cached, since we haven't destructed the cache on upsize.\n+        BOOST_CHECK(c1.CoinsTip().HaveCoinInCache(outpoint));\n+\n+        c1.ResizeCoinsCaches(\n+            1 << 22,  // downsizing the coinsview cache\n+            1 << 23  // upsizing the coinsdb cache\n+        );\n+\n+        // The view cache should be empty since we had to destruct to downsize.\n+        BOOST_CHECK(!c1.CoinsTip().HaveCoinInCache(outpoint));\n+    }\n+\n+    // Avoid triggering the address sanitizer.\n+    WITH_LOCK(::cs_main, manager.Unload());",
      "path": "src/test/validation_chainstate_tests.cpp",
      "position": 73,
      "original_position": 73,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This will need to be modified with the change that @MarcoFalke has made in https://github.com/bitcoin/bitcoin/pull/18615.",
      "created_at": "2020-04-15T15:57:58Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r408954497",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408954497"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 73,
      "original_line": 73,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409694987",
      "pull_request_review_id": 394808868,
      "id": 409694987,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY5NDk4Nw==",
      "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory)\n {\n+    db.reset(new CDBWrapper(ldb_path, nCacheSize, fMemory, fWipe, true));\n+}\n+\n+// XXX this should never be called without holding cs_main. Maybe figure out\n+// a better way of articulating this (lock annotations can't be used due to\n+// circular dep. with validation).",
      "path": "src/txdb.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"coins: add Sync() method to allow flush without cacheCoins drop\" (b2abb396c64e96585a0c38a269372b35cced08bd)\r\n\r\nAssertLockHeld would be one option",
      "created_at": "2020-04-16T16:36:13Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409694987",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409694987"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": 63,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409697186",
      "pull_request_review_id": 394808868,
      "id": 409697186,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY5NzE4Ng==",
      "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),",
      "path": "src/txdb.cpp",
      "position": 15,
      "original_position": 6,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"coins: add Sync() method to allow flush without cacheCoins drop\" (b2abb396c64e96585a0c38a269372b35cced08bd)\r\n\r\nWould be nice to stick to member initialization and keep empty constructor body `db(MakeUnique<CDBWrapper>(...)))`",
      "created_at": "2020-04-16T16:39:29Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409697186",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409697186"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 47,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409699250",
      "pull_request_review_id": 394808868,
      "id": 409699250,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY5OTI1MA==",
      "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory)\n {\n+    db.reset(new CDBWrapper(ldb_path, nCacheSize, fMemory, fWipe, true));\n+}\n+\n+// XXX this should never be called without holding cs_main. Maybe figure out\n+// a better way of articulating this (lock annotations can't be used due to\n+// circular dep. with validation).\n+void CCoinsViewDB::ResizeCache(size_t new_cache_size)\n+{\n+    // Have to do a reset first to get the original `db` state to release its\n+    // filesystem lock.\n+    db.reset();\n+    db.reset(new CDBWrapper(",
      "path": "src/txdb.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"coins: add Sync() method to allow flush without cacheCoins drop\" (b2abb396c64e96585a0c38a269372b35cced08bd)\r\n\r\nDoesn't really matter but general better to avoid `new` with `MakeUnique`\r\nhttps://isocpp.org/blog/2019/06/quick-q-differences-between-stdmake-unique-and-stdunique-ptr-with-new",
      "created_at": "2020-04-16T16:42:36Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409699250",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409699250"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 71,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409701315",
      "pull_request_review_id": 394808868,
      "id": 409701315,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcwMTMxNQ==",
      "diff_hunk": "@@ -43,7 +43,9 @@ static const int64_t nMaxCoinsDBCache = 8;\n class CCoinsViewDB final : public CCoinsView\n {\n protected:\n-    CDBWrapper db;\n+    std::unique_ptr<CDBWrapper> db;",
      "path": "src/txdb.h",
      "position": null,
      "original_position": 5,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"coins: add Sync() method to allow flush without cacheCoins drop\" (b2abb396c64e96585a0c38a269372b35cced08bd)\r\n\r\nSince this commit is already changing the type of `db` and updating every single line where it's referenced, it'd be nice to rename it to `m_db` at the same time",
      "created_at": "2020-04-16T16:45:45Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409701315",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409701315"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409705135",
      "pull_request_review_id": 394808868,
      "id": 409705135,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcwNTEzNQ==",
      "diff_hunk": "@@ -0,0 +1,76 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#include <random.h>\n+#include <uint256.h>\n+#include <consensus/validation.h>\n+#include <sync.h>\n+#include <test/util/setup_common.h>\n+#include <validation.h>\n+\n+#include <vector>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(validation_chainstate_tests, TestingSetup)\n+\n+//! Test resizing coins-related CChainState caches during runtime.\n+//!\n+BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)",
      "path": "src/test/validation_chainstate_tests.cpp",
      "position": 20,
      "original_position": 20,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"test: add test for CChainState::ResizeCoinsCaches()\" (03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5)\r\n\r\nNice test!",
      "created_at": "2020-04-16T16:51:46Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409705135",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409705135"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 20,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409709750",
      "pull_request_review_id": 394808868,
      "id": 409709750,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcwOTc1MA==",
      "diff_hunk": "@@ -4924,6 +4924,36 @@ std::string CChainState::ToString()\n         tip ? tip->nHeight : -1, tip ? tip->GetBlockHash().ToString() : \"null\");\n }\n \n+void CChainState::ResizeCoinsCaches(size_t coinstip_size, size_t coinsdb_size)\n+{\n+    if (coinstip_size == m_coinstip_cache_size_bytes &&\n+            coinsdb_size == m_coinsdb_cache_size_bytes) {\n+        // Cache sizes are unchanged, no need to continue.\n+        return;\n+    }\n+    int old_coinstip_size = m_coinstip_cache_size_bytes;\n+    m_coinstip_cache_size_bytes = coinstip_size;\n+    m_coinsdb_cache_size_bytes = coinsdb_size;\n+    CoinsDB().ResizeCache(coinsdb_size);\n+\n+    LogPrintf(\"[%s] resized coinsdb cache to %.1f MiB\\n\",\n+        this->ToString(), coinsdb_size * (1.0 / 1024 / 1024));\n+    LogPrintf(\"[%s] resized coinstip cache to %.1f MiB\\n\",\n+        this->ToString(), coinstip_size * (1.0 / 1024 / 1024));\n+\n+    BlockValidationState state;\n+    const CChainParams& chainparams = Params();\n+\n+    if (coinstip_size > old_coinstip_size) {\n+        // Likely no need to flush if cache sizes have grown.\n+        FlushStateToDisk(chainparams, state, FlushStateMode::IF_NEEDED);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "df0f720cfdcc1ad70d5ef2656039f008b3bc4bba",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"Add CChainState::ResizeCoinsCaches\" (df0f720cfdcc1ad70d5ef2656039f008b3bc4bba)\r\n\r\nWould be good to pass along false return value to caller in case this fails",
      "created_at": "2020-04-16T16:59:10Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409709750",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409709750"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4949,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409714771",
      "pull_request_review_id": 394808868,
      "id": 409714771,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcxNDc3MQ==",
      "diff_hunk": "@@ -116,7 +116,6 @@ bool fPruneMode = false;\n bool fRequireStandard = true;\n bool fCheckBlockIndex = false;\n bool fCheckpointsEnabled = DEFAULT_CHECKPOINTS_ENABLED;\n-size_t nCoinCacheUsage = 5000 * 300;",
      "path": "src/validation.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "df0f720cfdcc1ad70d5ef2656039f008b3bc4bba",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"Add CChainState::ResizeCoinsCaches\" (df0f720cfdcc1ad70d5ef2656039f008b3bc4bba)\r\n\r\nJust confirming but looks like this 1.5MB default cache size was only used by test cases previously, which are now using 8MB or 1KB caches depending on the case.",
      "created_at": "2020-04-16T17:07:19Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409714771",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409714771"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 138,
      "original_line": 138,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409719460",
      "pull_request_review_id": 394808868,
      "id": 409719460,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcxOTQ2MA==",
      "diff_hunk": "@@ -4924,6 +4924,36 @@ std::string CChainState::ToString()\n         tip ? tip->nHeight : -1, tip ? tip->GetBlockHash().ToString() : \"null\");\n }\n \n+void CChainState::ResizeCoinsCaches(size_t coinstip_size, size_t coinsdb_size)\n+{\n+    if (coinstip_size == m_coinstip_cache_size_bytes &&\n+            coinsdb_size == m_coinsdb_cache_size_bytes) {\n+        // Cache sizes are unchanged, no need to continue.\n+        return;\n+    }\n+    int old_coinstip_size = m_coinstip_cache_size_bytes;\n+    m_coinstip_cache_size_bytes = coinstip_size;\n+    m_coinsdb_cache_size_bytes = coinsdb_size;\n+    CoinsDB().ResizeCache(coinsdb_size);",
      "path": "src/validation.cpp",
      "position": 52,
      "original_position": 52,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "df0f720cfdcc1ad70d5ef2656039f008b3bc4bba",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"Add CChainState::ResizeCoinsCaches\" (df0f720cfdcc1ad70d5ef2656039f008b3bc4bba)\r\n\r\nJust curious, but would it make sense to call FlushStateToDisk before resetting CoinsDB instead of after? Thought would be that maybe live CDBWrapper object has cached state that would make the flush faster, or maybe it could be good to start with a new CDBWrapper after the flush",
      "created_at": "2020-04-16T17:15:24Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409719460",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409719460"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4978,
      "original_line": 4978,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409723518",
      "pull_request_review_id": 394808868,
      "id": 409723518,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcyMzUxOA==",
      "diff_hunk": "@@ -5237,3 +5237,33 @@ void ChainstateManager::Reset()\n     m_active_chainstate = nullptr;\n     m_snapshot_validated = false;\n }\n+\n+void ChainstateManager::MaybeRebalanceCaches()",
      "path": "src/validation.cpp",
      "position": 83,
      "original_position": 5,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "69514bd9fce0f867256bd08ec9f1b616a3ece573",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"add ChainstateManager::MaybeRebalanceCaches()\" (69514bd9fce0f867256bd08ec9f1b616a3ece573)\r\n\r\nCould probably write a short unit test exercising this (checking m_coins{tip,db}_cache_size_bytes)",
      "created_at": "2020-04-16T17:22:01Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409723518",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409723518"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5301,
      "original_line": 5301,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083482",
      "pull_request_review_id": 398310433,
      "id": 413083482,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzA4MzQ4Mg==",
      "diff_hunk": "@@ -5237,3 +5237,33 @@ void ChainstateManager::Reset()\n     m_active_chainstate = nullptr;\n     m_snapshot_validated = false;\n }\n+\n+void ChainstateManager::MaybeRebalanceCaches()",
      "path": "src/validation.cpp",
      "position": 83,
      "original_position": 5,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "69514bd9fce0f867256bd08ec9f1b616a3ece573",
      "in_reply_to_id": 409723518,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good idea, done.",
      "created_at": "2020-04-22T15:28:29Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r413083482",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5301,
      "original_line": 5301,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083886",
      "pull_request_review_id": 398310897,
      "id": 413083886,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzA4Mzg4Ng==",
      "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory)\n {\n+    db.reset(new CDBWrapper(ldb_path, nCacheSize, fMemory, fWipe, true));\n+}\n+\n+// XXX this should never be called without holding cs_main. Maybe figure out\n+// a better way of articulating this (lock annotations can't be used due to\n+// circular dep. with validation).\n+void CCoinsViewDB::ResizeCache(size_t new_cache_size)\n+{\n+    // Have to do a reset first to get the original `db` state to release its\n+    // filesystem lock.\n+    db.reset();\n+    db.reset(new CDBWrapper(",
      "path": "src/txdb.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
      "in_reply_to_id": 409699250,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah thanks, didn't know that.",
      "created_at": "2020-04-22T15:28:56Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r413083886",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083886"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 71,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413084378",
      "pull_request_review_id": 398311456,
      "id": 413084378,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzA4NDM3OA==",
      "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory)\n {\n+    db.reset(new CDBWrapper(ldb_path, nCacheSize, fMemory, fWipe, true));\n+}\n+\n+// XXX this should never be called without holding cs_main. Maybe figure out\n+// a better way of articulating this (lock annotations can't be used due to\n+// circular dep. with validation).",
      "path": "src/txdb.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
      "in_reply_to_id": 409694987,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I just ended up using an `extern` declaration for the lock and adding an annotation. Not sure why I didn't do that in the first place.",
      "created_at": "2020-04-22T15:29:29Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r413084378",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413084378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": 63,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427549224",
      "pull_request_review_id": 414759782,
      "id": 427549224,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU0OTIyNA==",
      "diff_hunk": "@@ -101,4 +101,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 50,
      "original_position": 18,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "db5e36a033e642599db808f59d16d03a40860f17",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"add ChainstateManager::MaybeRebalanceCaches()\" (db5e36a033e642599db808f59d16d03a40860f17)\r\n\r\nThis is interesting. Once we update to c++14 or 17 we should be able to use WITH_LOCK like\r\n\r\n```c++\r\nCChainState& c1 = WITH_LOCK(cs_main, return manager.InitializeChainstate());\r\n```\r\n\r\nI think it changing it wouldn't work now without decltype(auto)",
      "created_at": "2020-05-19T19:31:36Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r427549224",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427549224"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": 118,
      "original_start_line": 116,
      "start_side": "RIGHT",
      "line": 120,
      "original_line": 120,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429373795",
      "pull_request_review_id": 417080272,
      "id": 429373795,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM3Mzc5NQ==",
      "diff_hunk": "@@ -101,4 +101,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 50,
      "original_position": 18,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "db5e36a033e642599db808f59d16d03a40860f17",
      "in_reply_to_id": 427549224,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What is different between this potential WITH_LOCK use, and the existing ones that return a value?",
      "created_at": "2020-05-22T17:37:12Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429373795",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429373795"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": 118,
      "original_start_line": 116,
      "start_side": "RIGHT",
      "line": 120,
      "original_line": 120,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429383887",
      "pull_request_review_id": 417093545,
      "id": 429383887,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM4Mzg4Nw==",
      "diff_hunk": "@@ -101,4 +101,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 50,
      "original_position": 18,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "db5e36a033e642599db808f59d16d03a40860f17",
      "in_reply_to_id": 427549224,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't know, but maybe C++11 lambda can not return references? If yes, this can be solved with\r\n\r\n\r\n```cpp\r\nCChainState& c1 = *WITH_LOCK(cs_main, return &manager.InitializeChainstate());",
      "created_at": "2020-05-22T18:00:00Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429383887",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429383887"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": 118,
      "original_start_line": 116,
      "start_side": "RIGHT",
      "line": 120,
      "original_line": 120,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429401621",
      "pull_request_review_id": 417117008,
      "id": 429401621,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQwMTYyMQ==",
      "diff_hunk": "@@ -101,4 +101,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 50,
      "original_position": 18,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "db5e36a033e642599db808f59d16d03a40860f17",
      "in_reply_to_id": 427549224,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, just what marco said, auto return type won't deduce a reference, and I think the pointer trick would work here, so it might nice to incorporate if the PR is gets updated again",
      "created_at": "2020-05-22T18:44:01Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429401621",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429401621"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": 118,
      "original_start_line": 116,
      "start_side": "RIGHT",
      "line": 120,
      "original_line": 120,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541761",
      "pull_request_review_id": 417275042,
      "id": 429541761,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU0MTc2MQ==",
      "diff_hunk": "@@ -1532,6 +1532,9 @@ bool AppInitMain(NodeContext& node)\n             try {\n                 LOCK(cs_main);\n                 g_chainman.InitializeChainstate();\n+                g_chainman.m_total_coinstip_cache = nCoinCacheUsage;\n+                g_chainman.m_total_coinsdb_cache = nCoinDBCache;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "4cc7b612d1413451d500c5fd6eefebea34216460",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n                chainman.m_total_coinsdb_cache = nCoinDBCache;\r\n```\r\n\r\nNeeds rebase to remove the `g_` prefix in this line",
      "created_at": "2020-05-23T12:26:35Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429541761",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541761"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1536,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541868",
      "pull_request_review_id": 417275131,
      "id": 429541868,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU0MTg2OA==",
      "diff_hunk": "@@ -0,0 +1,76 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#include <random.h>\n+#include <uint256.h>\n+#include <consensus/validation.h>\n+#include <sync.h>\n+#include <test/util/setup_common.h>\n+#include <validation.h>\n+\n+#include <vector>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(validation_chainstate_tests, TestingSetup)\n+\n+//! Test resizing coins-related CChainState caches during runtime.\n+//!\n+BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n+{\n+    ChainstateManager manager;\n+\n+    //! Create and add a Coin with DynamicMemoryUsage of 80 bytes to the given view.\n+    auto add_coin = [](CCoinsViewCache& coins_view) -> COutPoint {\n+        Coin newcoin;\n+        uint256 txid = InsecureRand256();\n+        COutPoint outp{txid, 0};\n+        newcoin.nHeight = 1;\n+        newcoin.out.nValue = InsecureRand32();\n+        newcoin.out.scriptPubKey.assign((uint32_t)56, 1);\n+        coins_view.AddCoin(outp, std::move(newcoin), false);\n+\n+        return outp;\n+    };\n+\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);\n+    c1.InitCoinsDB(\n+        /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n+    WITH_LOCK(::cs_main, c1.InitCoinsCache(1 << 23));\n+\n+    // Add a coin to the in-memory cache, upsize once, then downsize.\n+    {\n+        LOCK(::cs_main);\n+        auto outpoint = add_coin(c1.CoinsTip());\n+\n+        // Set a meaningless bestblock value in the coinsview cache - otherwise we won't\n+        // flush during ResizecoinsCaches() and will subsequently hit an assertion.\n+        c1.CoinsTip().SetBestBlock(InsecureRand256());\n+\n+        BOOST_CHECK(c1.CoinsTip().HaveCoinInCache(outpoint));\n+\n+        c1.ResizeCoinsCaches(\n+            1 << 24,  // upsizing the coinsview cache\n+            1 << 22  // downsizing the coinsdb cache\n+        );\n+\n+        // View should still have the coin cached, since we haven't destructed the cache on upsize.\n+        BOOST_CHECK(c1.CoinsTip().HaveCoinInCache(outpoint));\n+\n+        c1.ResizeCoinsCaches(\n+            1 << 22,  // downsizing the coinsview cache\n+            1 << 23  // upsizing the coinsdb cache\n+        );\n+\n+        // The view cache should be empty since we had to destruct to downsize.\n+        BOOST_CHECK(!c1.CoinsTip().HaveCoinInCache(outpoint));\n+    }\n+\n+    // Avoid triggering the address sanitizer.\n+    WITH_LOCK(::cs_main, manager.Unload());",
      "path": "src/test/validation_chainstate_tests.cpp",
      "position": 73,
      "original_position": 73,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5",
      "in_reply_to_id": 408954497,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't think this needs a `SyncWithValidationInterfaceQueue` before the unload because in this test not blocks are mined and no txs are added to the mempool.",
      "created_at": "2020-05-23T12:28:17Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429541868",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 73,
      "original_line": 73,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432009502",
      "pull_request_review_id": 420343465,
      "id": 432009502,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjAwOTUwMg==",
      "diff_hunk": "@@ -1532,6 +1532,9 @@ bool AppInitMain(NodeContext& node)\n             try {\n                 LOCK(cs_main);\n                 g_chainman.InitializeChainstate();\n+                g_chainman.m_total_coinstip_cache = nCoinCacheUsage;\n+                g_chainman.m_total_coinsdb_cache = nCoinDBCache;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "4cc7b612d1413451d500c5fd6eefebea34216460",
      "in_reply_to_id": 429541761,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Pushed, thanks!",
      "created_at": "2020-05-28T17:37:49Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r432009502",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432009502"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1536,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432944978",
      "pull_request_review_id": 421492649,
      "id": 432944978,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0NDk3OA==",
      "diff_hunk": "@@ -104,4 +104,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 50,
      "original_position": 18,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "1e6e0b9af6c5470dbf1e61f54900ac9a21f147a2",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "style-nit in commit 1e6e0b9af6c5470dbf1e61:\r\n\r\nNow that you have to force push anyway, might as well remove the clumsy `ENTER_CRITICAL_SECTION`?\r\n\r\n```suggestion\r\n    CChainState& c1 = *WITH_LOCK(cs_main, return &manager.InitializeChainstate());\r\n```",
      "created_at": "2020-05-31T13:02:50Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r432944978",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432944978"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": 118,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 120,
      "original_line": 120,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432945053",
      "pull_request_review_id": 421492649,
      "id": 432945053,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0NTA1Mw==",
      "diff_hunk": "@@ -104,4 +104,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);\n+    chainstates.push_back(&c1);\n+    c1.InitCoinsDB(\n+        /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n+\n+    {\n+        LOCK(::cs_main);\n+        c1.InitCoinsCache(1 << 23);\n+        c1.CoinsTip().SetBestBlock(InsecureRand256());\n+        manager.MaybeRebalanceCaches();\n+    }\n+\n+    BOOST_CHECK_EQUAL(c1.m_coinstip_cache_size_bytes, max_cache);\n+    BOOST_CHECK_EQUAL(c1.m_coinsdb_cache_size_bytes, max_cache);\n+\n+    // Create a snapshot-based chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c2 = manager.InitializeChainstate(GetRandHash());\n+    LEAVE_CRITICAL_SECTION(cs_main);",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 69,
      "original_position": 37,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "1e6e0b9af6c5470dbf1e61f54900ac9a21f147a2",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    CChainState& c2 = *WITH_LOCK(cs_main, return &manager.InitializeChainstate(GetRandHash()));\r\n```\r\n\r\nSame",
      "created_at": "2020-05-31T13:03:51Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r432945053",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432945053"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": 137,
      "original_start_line": 138,
      "start_side": "RIGHT",
      "line": 139,
      "original_line": 139,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440414525",
      "pull_request_review_id": 430951947,
      "id": 440414525,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxNDUyNQ==",
      "diff_hunk": "@@ -41,35 +42,45 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory),",
      "path": "src/txdb.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43\r\n\r\nThis currently introduces a new compiler warning. The initializer list should be in the same order as they members are declared.\r\n\r\n```\r\ntxdb.cpp:47:5: warning: field 'm_is_memory' will be initialized after field 'm_db' [-Wreorder]\r\n    m_is_memory(fMemory),\r\n```",
      "created_at": "2020-06-15T20:01:25Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r440414525",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440414525"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440415231",
      "pull_request_review_id": 430951947,
      "id": 440415231,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxNTIzMQ==",
      "diff_hunk": "@@ -139,7 +139,7 @@ TestingSetup::TestingSetup(const std::string& chainName, const std::vector<const\n     ::ChainstateActive().InitCoinsDB(\n         /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n     assert(!::ChainstateActive().CanFlushToDisk());\n-    ::ChainstateActive().InitCoinsCache();\n+    ::ChainstateActive().InitCoinsCache(1 << 23);",
      "path": "src/test/util/setup_common.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "1bf9a836713b44d873dd6f2b99ce8ab343808ffe",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "1bf9a836713b44d873dd6f2b99ce8ab343808ffe\r\n\r\nThis looks like it could be a constant?",
      "created_at": "2020-06-15T20:02:47Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r440415231",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440415231"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 142,
      "original_line": 142,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440416684",
      "pull_request_review_id": 430951947,
      "id": 440416684,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxNjY4NA==",
      "diff_hunk": "@@ -103,4 +103,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    size_t max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);\n+    chainstates.push_back(&c1);\n+    c1.InitCoinsDB(\n+        /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n+\n+    {\n+        LOCK(::cs_main);\n+        c1.InitCoinsCache(1 << 23);",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 57,
      "original_position": 25,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "6df742f093de1c1360e3f37d011fbdf0a3888017",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "6df742f093de1c1360e3f37d011fbdf0a3888017\r\n\r\nIn the test I think `1 << 23` could also be a variable to help a little bit with readability.",
      "created_at": "2020-06-15T20:05:53Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r440416684",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440416684"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 127,
      "original_line": 127,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/447889705",
      "pull_request_review_id": 440275077,
      "id": 447889705,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg4OTcwNQ==",
      "diff_hunk": "@@ -41,35 +42,45 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory),",
      "path": "src/txdb.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
      "in_reply_to_id": 440414525,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "FWIW I can't reproduce this locally with either clang or gcc:\r\n\r\n```\r\nCC            = /usr/bin/ccache /usr/bin/clang\r\nCFLAGS        = -g -O2\r\nCPPFLAGS      =  -DDEBUG -DDEBUG_LOCKORDER  -I/home/james/src/bitcoin/db4/include/ -DHAVE_BUILD_INFO -D__STDC_FORMAT_MACROS\r\nCXX           = /usr/bin/ccache /usr/bin/clang++ -std=c++11\r\nCXXFLAGS      =  -O0 -g3 -ftrapv  -Wstack-protector -fstack-protector-all     -std=c++11 -Wthread-safety-analysis -Werror\r\n\r\n% clang++ --version\r\nclang version 7.0.1-8 (tags/RELEASE_701/final)\r\nTarget: x86_64-pc-linux-gnu\r\nThread model: posix\r\nInstalledDir: /usr/bin\r\n\r\n% gcc --version\r\ngcc (Debian 8.3.0-6) 8.3.0\r\nCopyright (C) 2018 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n```",
      "created_at": "2020-06-30T18:20:51Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r447889705",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/447889705"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448459247",
      "pull_request_review_id": 440997107,
      "id": 448459247,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ1OTI0Nw==",
      "diff_hunk": "@@ -41,35 +42,45 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory),",
      "path": "src/txdb.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
      "in_reply_to_id": 440414525,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You just need to move `m_db` to be the first thing initialized, just as it's the first thing declared in txdb.h. Warning appears for me with clang 9.0 fwiw. cf https://en.cppreference.com/w/cpp/language/constructor#Initialization_order",
      "created_at": "2020-07-01T15:52:42Z",
      "updated_at": "2020-07-01T18:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r448459247",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448459247"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448479334",
      "pull_request_review_id": 441023103,
      "id": 448479334,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ3OTMzNA==",
      "diff_hunk": "@@ -60,6 +65,9 @@ class CCoinsViewDB final : public CCoinsView\n     //! Attempt to update from an older database format. Returns whether an error occurred.\n     bool Upgrade();\n     size_t EstimateSize() const override;\n+\n+    //! Dynamically alter the underlying leveldb cache size.\n+    void ResizeCache(size_t new_cache_size) EXCLUSIVE_LOCKS_REQUIRED(cs_main);",
      "path": "src/txdb.h",
      "position": 24,
      "original_position": 24,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This seems a bit of an anti-pattern -- it's not ResizeCache() that needs cs_main, it's the fact that when it's called it ends up operating on `m_coins_views->m_dbview` which does need cs_main, but that's not enforced because the constraint is thrown away by CoinsDB() returning a reference to the guarded object.\r\n\r\nI think it might be better to replace `CoinsDB()` by a `GetCoinsViews()` that returns a reference to `m_coins_views`, and then have `auto& x = GetCoinsViews(); LOCK(cs_main); x.m_dbview.ResizeCache(y);` ? No need to address in this PR though, I think.",
      "created_at": "2020-07-01T16:26:23Z",
      "updated_at": "2020-07-01T18:47:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r448479334",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448479334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 70,
      "original_line": 70,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448552717",
      "pull_request_review_id": 441115809,
      "id": 448552717,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODU1MjcxNw==",
      "diff_hunk": "@@ -41,35 +42,45 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory),",
      "path": "src/txdb.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
      "in_reply_to_id": 440414525,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, thanks",
      "created_at": "2020-07-01T18:47:04Z",
      "updated_at": "2020-07-01T18:47:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r448552717",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448552717"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/449710524",
      "pull_request_review_id": 442566498,
      "id": 449710524,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTcxMDUyNA==",
      "diff_hunk": "@@ -5297,3 +5297,33 @@ void ChainstateManager::Reset()\n     m_active_chainstate = nullptr;\n     m_snapshot_validated = false;\n }\n+\n+void ChainstateManager::MaybeRebalanceCaches()\n+{\n+    if (m_ibd_chainstate && !m_snapshot_chainstate) {\n+        LogPrintf(\"[snapshot] allocating all cache to the IBD chainstate\\n\");\n+        // Allocate everything to the IBD chainstate.\n+        m_ibd_chainstate->ResizeCoinsCaches(m_total_coinstip_cache, m_total_coinsdb_cache);\n+    }\n+    else if (m_snapshot_chainstate && !m_ibd_chainstate) {\n+        LogPrintf(\"[snapshot] allocating all cache to the snapshot chainstate\\n\");\n+        // Allocate everything to the snapshot chainstate.\n+        m_snapshot_chainstate->ResizeCoinsCaches(m_total_coinstip_cache, m_total_coinsdb_cache);\n+    }\n+    else if (m_ibd_chainstate && m_snapshot_chainstate) {\n+        // If both chainstates exist, determine who needs more cache based on IBD status.",
      "path": "src/validation.cpp",
      "position": 96,
      "original_position": 18,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "8ac3ef46999ed676ca3775f7b2f461d92f09a542",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "super-nit: A bit more info on the rationale behind 0.05/0.95 would be nice. Also, the values could be constants. But that can be considered for a follow-up.",
      "created_at": "2020-07-03T21:59:03Z",
      "updated_at": "2020-07-03T22:00:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r449710524",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/449710524"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5314,
      "original_line": 5314,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462269791",
      "pull_request_review_id": 457483812,
      "id": 462269791,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI2OTc5MQ==",
      "diff_hunk": "@@ -57,12 +55,13 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     // Create a snapshot-based chainstate.\n     //\n     ENTER_CRITICAL_SECTION(cs_main);\n-    CChainState& c2 = manager.InitializeChainstate(GetRandHash());\n+    CChainState& c2 = *WITH_LOCK(::cs_main,\n+        return &manager.InitializeChainstate(GetRandHash()));",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 22,
      "original_position": 22,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "in_reply_to_id": null,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Doesn't this lock `cs_main` twice ?",
      "created_at": "2020-07-29T12:45:58Z",
      "updated_at": "2020-07-29T12:46:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r462269791",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462269791"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": 57,
      "original_start_line": 57,
      "start_side": "RIGHT",
      "line": 59,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462271342",
      "pull_request_review_id": 457485909,
      "id": 462271342,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI3MTM0Mg==",
      "diff_hunk": "@@ -57,12 +55,13 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     // Create a snapshot-based chainstate.\n     //\n     ENTER_CRITICAL_SECTION(cs_main);\n-    CChainState& c2 = manager.InitializeChainstate(GetRandHash());\n+    CChainState& c2 = *WITH_LOCK(::cs_main,\n+        return &manager.InitializeChainstate(GetRandHash()));",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 22,
      "original_position": 22,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "in_reply_to_id": 462269791,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The test nits are fixed in the first commit of #19604 ",
      "created_at": "2020-07-29T12:48:35Z",
      "updated_at": "2020-07-29T12:48:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r462271342",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462271342"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": 57,
      "original_start_line": 57,
      "start_side": "RIGHT",
      "line": 59,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462275500",
      "pull_request_review_id": 457491435,
      "id": 462275500,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI3NTUwMA==",
      "diff_hunk": "@@ -57,12 +55,13 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     // Create a snapshot-based chainstate.\n     //\n     ENTER_CRITICAL_SECTION(cs_main);\n-    CChainState& c2 = manager.InitializeChainstate(GetRandHash());\n+    CChainState& c2 = *WITH_LOCK(::cs_main,\n+        return &manager.InitializeChainstate(GetRandHash()));",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 22,
      "original_position": 22,
      "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "original_commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
      "in_reply_to_id": 462269791,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yep. Brainfart. Just noticed while rebasing https://github.com/bitcoin/bitcoin/pull/19556 and commented without thinking.",
      "created_at": "2020-07-29T12:55:18Z",
      "updated_at": "2020-07-29T12:55:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r462275500",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462275500"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
        }
      },
      "start_line": 57,
      "original_start_line": 57,
      "start_side": "RIGHT",
      "line": 59,
      "original_line": 59,
      "side": "RIGHT"
    }
  ]
}