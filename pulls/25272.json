{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272",
    "id": 957505891,
    "node_id": "PR_kwDOABII5845EmFj",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/25272",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/25272.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/25272.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
    "number": 25272,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "wallet: guard and alert about a wallet invalid state during chain sync",
    "user": {
      "login": "furszy",
      "id": 5377650,
      "node_id": "MDQ6VXNlcjUzNzc2NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/furszy",
      "html_url": "https://github.com/furszy",
      "followers_url": "https://api.github.com/users/furszy/followers",
      "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
      "organizations_url": "https://api.github.com/users/furszy/orgs",
      "repos_url": "https://api.github.com/users/furszy/repos",
      "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/furszy/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Follow-up work to my comment in #25239.\r\n\r\nGuarding and alerting the user about a wallet invalid state during chain synchronization.\r\n\r\n#### Explanation\r\nif the `AddToWallet` tx write fails, the method returns a wtx `nullptr` without removing the recently added transaction from the wallet's map.\r\n\r\nWhich makes that `AddToWalletIfInvolvingMe` return false (even when the tx is on the wallet's map already), --> which makes `SyncTransaction` skip the `MarkInputsDirty` call --> which leads to a wallet invalid state where the inputs of this new transaction are not marked dirty, while the transaction that spends them still exist on the in-memory wallet tx map.\r\n\r\nPlus, as we only store the arriving transaction inside `AddToWalletIfInvolvingMe` when we synchronize/scan block/s from the chain and nowhere else, it makes sense to treat the transaction db write error as a runtime error to notify the user about the problem. Otherwise, the user will lose all the not stored transactions after a wallet shutdown (without be able to recover them automatically on the next startup because the chain sync would be above the block where the txs arrived).\r\n\r\nNote:\r\nOn purpose, the first commit adds test coverage for it. Showing how the wallet can end up in an invalid state. The second commit corrects it with the proposed solution.",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2022-06-03T14:06:15Z",
    "updated_at": "2023-05-27T01:50:31Z",
    "closed_at": "2022-08-02T18:07:00Z",
    "mergeable_state": "unknown",
    "merged_at": "2022-08-02T18:07:00Z",
    "merge_commit_sha": "de3c46c93818c6e4000175bcdbf7dd332f54768d",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "furszy:2022_wallet_invalid_state",
      "ref": "2022_wallet_invalid_state",
      "sha": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 143624913,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDM2MjQ5MTM=",
        "name": "bitcoin-core",
        "full_name": "furszy/bitcoin-core",
        "owner": {
          "login": "furszy",
          "id": 5377650,
          "node_id": "MDQ6VXNlcjUzNzc2NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/furszy",
          "html_url": "https://github.com/furszy",
          "followers_url": "https://api.github.com/users/furszy/followers",
          "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
          "organizations_url": "https://api.github.com/users/furszy/orgs",
          "repos_url": "https://api.github.com/users/furszy/repos",
          "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/furszy/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/furszy/bitcoin-core",
        "description": "Bitcoin-Core",
        "fork": true,
        "url": "https://api.github.com/repos/furszy/bitcoin-core",
        "archive_url": "https://api.github.com/repos/furszy/bitcoin-core/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/furszy/bitcoin-core/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/furszy/bitcoin-core/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/furszy/bitcoin-core/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/furszy/bitcoin-core/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/furszy/bitcoin-core/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/furszy/bitcoin-core/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/furszy/bitcoin-core/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/furszy/bitcoin-core/contributors",
        "deployments_url": "https://api.github.com/repos/furszy/bitcoin-core/deployments",
        "downloads_url": "https://api.github.com/repos/furszy/bitcoin-core/downloads",
        "events_url": "https://api.github.com/repos/furszy/bitcoin-core/events",
        "forks_url": "https://api.github.com/repos/furszy/bitcoin-core/forks",
        "git_commits_url": "https://api.github.com/repos/furszy/bitcoin-core/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/furszy/bitcoin-core/git/tags%7B/sha%7D",
        "git_url": "git://github.com/furszy/bitcoin-core.git",
        "issue_comment_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/furszy/bitcoin-core/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/furszy/bitcoin-core/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/furszy/bitcoin-core/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/furszy/bitcoin-core/languages",
        "merges_url": "https://api.github.com/repos/furszy/bitcoin-core/merges",
        "milestones_url": "https://api.github.com/repos/furszy/bitcoin-core/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/furszy/bitcoin-core/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/furszy/bitcoin-core/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/furszy/bitcoin-core/releases%7B/id%7D",
        "ssh_url": "git@github.com:furszy/bitcoin-core.git",
        "stargazers_url": "https://api.github.com/repos/furszy/bitcoin-core/stargazers",
        "statuses_url": "https://api.github.com/repos/furszy/bitcoin-core/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/furszy/bitcoin-core/subscribers",
        "subscription_url": "https://api.github.com/repos/furszy/bitcoin-core/subscription",
        "tags_url": "https://api.github.com/repos/furszy/bitcoin-core/tags",
        "teams_url": "https://api.github.com/repos/furszy/bitcoin-core/teams",
        "trees_url": "https://api.github.com/repos/furszy/bitcoin-core/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/furszy/bitcoin-core.git",
        "hooks_url": "https://api.github.com/repos/furszy/bitcoin-core/hooks",
        "svn_url": "https://github.com/furszy/bitcoin-core",
        "homepage": "",
        "language": "C++",
        "forks_count": 2,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 380259,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T20:18:24Z",
        "created_at": "2018-08-05T15:28:43Z",
        "updated_at": "2023-02-27T18:01:49Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "c395c8d6bbd0afc836eac4e58c00a816fb967104",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69818,
        "watchers_count": 69818,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T05:35:10Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T06:49:43Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 117,
    "deletions": 1,
    "changed_files": 3,
    "commits": 2,
    "review_comments": 8,
    "comments": 11
  },
  "events": [
    {
      "event": "labeled",
      "id": 6737637068,
      "node_id": "LE_lADOABII585LGXGEzwAAAAGRmC7M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6737637068",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-03T15:14:38Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6737834002,
      "node_id": "HRFPE_lADOABII585LGXGEzwAAAAGRmzAS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6737834002",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-03T15:47:14Z"
    },
    {
      "event": "commented",
      "id": 1146098556,
      "node_id": "IC_kwDOABII585EUBN8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1146098556",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-03T15:53:26Z",
      "updated_at": "2022-06-03T15:53:26Z",
      "author_association": "MEMBER",
      "body": "Update:\r\nAdded test coverage for it in the first commit. Showing how the wallet can end up in the invalid state. The second commit corrects it with the proposed solution.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1146098556",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6741797699,
      "node_id": "HRFPE_lADOABII585LGXGEzwAAAAGR16tD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6741797699",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-04T14:14:09Z"
    },
    {
      "event": "commented",
      "id": 1146640263,
      "node_id": "IC_kwDOABII585EWFeH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1146640263",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-04T15:58:07Z",
      "updated_at": "2022-07-20T19:27:42Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25297](https://github.com/bitcoin/bitcoin/pull/25297) (wallet: speedup transactions sync, rescan and load by grouping all independent db writes on a single batched db transaction by furszy)\n* [#24897](https://github.com/bitcoin/bitcoin/pull/24897) ([Draft / POC] Silent Payments by w0xlt)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1146640263",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "commented",
      "id": 1147558610,
      "node_id": "IC_kwDOABII585EZlrS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1147558610",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T15:11:53Z",
      "updated_at": "2022-06-06T15:11:53Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1147558610",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "reviewed",
      "id": 996863007,
      "node_id": "PRR_kwDOABII5847auwf",
      "url": null,
      "actor": null,
      "commit_id": "d15e9f7fc0ca3b8ab775ca218e146b3238578484",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK d15e9f7fc0ca3b8ab775ca218e146b3238578484. Nice find and test, and clear description of the problem. This change will raise an explicit error in a failure case that was previously ignored, so in theory it could lead to worse outcomes in some cases. But status quo results in inconsistent in-memory state, and the error seems pretty unlikely to happen to begin with so this is probably the right move.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#pullrequestreview-996863007",
      "submitted_at": "2022-06-06T17:33:36Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6755510789,
      "node_id": "HRFPE_lADOABII585LGXGEzwAAAAGSqOoF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6755510789",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T19:19:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6755558519,
      "node_id": "HRFPE_lADOABII585LGXGEzwAAAAGSqaR3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6755558519",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T19:26:19Z"
    },
    {
      "event": "commented",
      "id": 1147824717,
      "node_id": "IC_kwDOABII585EampN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1147824717",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T19:31:29Z",
      "updated_at": "2022-06-06T19:31:29Z",
      "author_association": "MEMBER",
      "body": "Thanks for the feedback!\r\n\r\nApplied the following changes:\r\n\r\n1) Moved `dynamic_cast` to `static_cast`.\r\n2) Set same default value for \"m_pass\" field in both classes `FailDatabase` and `FailBatch`.\r\n3) Shorted the commit subject.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1147824717",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "reviewed",
      "id": 1004930263,
      "node_id": "PRR_kwDOABII58475gTX",
      "url": null,
      "actor": null,
      "commit_id": "4bd0d0140e2a27e604ca0febcd485f468705c0ed",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "It's preferable that each commit passes the test suite. Currently the first commit fails as the code currently fails the test that you have added. So it would be preferable if that test were added after the fix is implemented.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#pullrequestreview-1004930263",
      "submitted_at": "2022-06-13T21:03:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
    },
    {
      "event": "commented",
      "id": 1155127945,
      "node_id": "IC_kwDOABII585E2dqJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1155127945",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-14T12:36:39Z",
      "updated_at": "2022-06-14T19:15:26Z",
      "author_association": "MEMBER",
      "body": "> It's preferable that each commit passes the test suite. Currently the first commit fails as the code currently fails the test that you have added. So it would be preferable if that test were added after the fix is implemented.\r\n\r\nOk. I actually did that on purpose so it was easier for reviewers to replicate/understand the problem (I wrote it in the PR description); just compiling the first commit, see/verify the failure, then compile the fix and see it passing (Test Driven Approach).\r\n\r\nAt least for me, it make more sense (and feels more natural) than have tests always passing when we actually have problems in the sources.\r\n\r\nBut.. that is probably not a discussion for this PR, will just re-order the commits :).",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1155127945",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6804056148,
      "node_id": "HRFPE_lADOABII585LGXGEzwAAAAGVjahU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6804056148",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-14T12:48:28Z"
    },
    {
      "event": "commented",
      "id": 1155150200,
      "node_id": "IC_kwDOABII585E2jF4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1155150200",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-14T12:56:44Z",
      "updated_at": "2022-06-14T12:56:44Z",
      "author_association": "MEMBER",
      "body": "Updated per achow101 feedback:\r\n\r\n- Re-ordered the commits, so test suite always passes.\r\n   Note about this change: now we only have the final version of the test. The one that fails due a `runtime_error` and not the intermediary one that was showing the wallet invalid state error (which, for reviewers, can still be found at https://github.com/furszy/bitcoin-core/commit/c9c9466dd0ab77bcce52ebe4b4d5f89787bd6542).",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1155150200",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "reviewed",
      "id": 1007671300,
      "node_id": "PRR_kwDOABII5848D9gE",
      "url": null,
      "actor": null,
      "commit_id": "7027e94801686064eef806b10df141ebca3ea2b8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK 7027e94801686064eef806b10df141ebca3ea2b8. Only changes since last review are internal changes to commits, and making suggested static_cast and m_pass default changes",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#pullrequestreview-1007671300",
      "submitted_at": "2022-06-15T15:03:08Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
    },
    {
      "event": "reviewed",
      "id": 1017534297,
      "node_id": "PRR_kwDOABII5848pldZ",
      "url": null,
      "actor": null,
      "commit_id": "7027e94801686064eef806b10df141ebca3ea2b8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#pullrequestreview-1017534297",
      "submitted_at": "2022-06-23T19:25:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
    },
    {
      "event": "commented",
      "id": 1167789341,
      "node_id": "IC_kwDOABII585Fmw0d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1167789341",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-27T19:27:42Z",
      "updated_at": "2022-06-27T19:27:42Z",
      "author_association": "MEMBER",
      "body": "ACK 7027e94801686064eef806b10df141ebca3ea2b8",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1167789341",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc3ZGU1YzY5M2ZmZThkYzBhZmE1ZTQwMTI2ZTliMGU5Y2M1NDdlMDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77de5c693ffe8dc0afa5e40126e9b0e9cc547e04",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/77de5c693ffe8dc0afa5e40126e9b0e9cc547e04",
      "tree": {
        "sha": "1388b466e79633945232cd60c8571e8aa53e2ea6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1388b466e79633945232cd60c8571e8aa53e2ea6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 1388b466e79633945232cd60c8571e8aa53e2ea6\nparent c395c8d6bbd0afc836eac4e58c00a816fb967104\nauthor furszy <matiasfurszyfer@protonmail.com> 1654263974 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1658154567 -0300\n\nwallet: guard and alert about a wallet invalid state during chain sync\n\n-Context:\nIf `AddToWallet` db write fails, the method returns a wtx nullptr without\nremoving the recently added transaction from the wallet's map.\n\n-Problem:\nWhen a db write error occurs, `AddToWalletIfInvolvingMe` return false even\nwhen the tx is on the wallet's map already --> which makes `SyncTransaction`\nskip the `MarkInputsDirty` call --> which leads to a wallet invalid state\nwhere the inputs of this new transaction are not marked dirty, while the\ntransaction that spends them still exist on the in-memory wallet tx map.\n\nPlus, as we only store arriving transaction inside `AddToWalletIfInvolvingMe`\nwhen we synchronize/scan blocks from the chain and nowhere else, it makes sense\nto treat the tx db write error as a runtime error to notify the user about the\nproblem. Otherwise, the user will lose all the not stored transactions after a\nwallet shutdown (without be able to recover them automatically on the next\nstartup because the chain sync would be above the block where the txs arrived).\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmLVbkcACgkQXdI8zGhq\npiNvBxAAxvh0dwEkrxDCOhbcTJiHHU6R5BRbwlPeTGKlW01Tej4lp1x0PVf4Q31e\nsp11RwxjAmIGk8gzZijq6Z2peo7c8YeDrWCid9/BXuNUIgkaFpAyfMwpjptCWbKb\nPaFcsPuqLZkHbd2X3vvwt/IYMncXg+aCCwlUqk8a4k8emf3zdk6dAQlMrTXqNaNN\nAnlZuVmGmedEMOq2L/owOv2P3/lBZi2SZv7xLukNYRYXWyX7Zw6heU+oE9vT8vsd\ngYkJ8LFVa6xVucFFXDosD2n/ZsZQcGPa8IjD3n6UFNpZy8l/XXNhbooMaJsTkwdx\nLHDSTVyVVWxM+g+QV2b1IXLoUc94wcWACgHSzUS9o5KZ68X/7KPPH54sPMGqYjVY\nJPWDEa38nwxl/G1wcWDIo3p1YFio8USE8vKhTOngYFET2LHy5wf8ljPGsSRXqTiA\noewTnkxyK7FnZ1e5uM4KrahcGuKErIMPiBtSQifJ7N2IirnZMC/McphZ68eqkjdw\nkMUBSXXEsh7l/6GweBRrOwQn/yayYl2kCaCaiUqFeRWvx67CgcGStLgvyNvvhPNM\nhUmQWhszzt2U7DVCoAdJuSmdbdfCtNzfsIDVdsa19xN3+0khkiXKWjE9IKihyIzC\nu0WnYzRpyZt4Fk+lVyGNn5/YcPgw2jaUFXOzHPGM+WcAwnJsBRM=\n=surA\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c395c8d6bbd0afc836eac4e58c00a816fb967104",
          "sha": "c395c8d6bbd0afc836eac4e58c00a816fb967104",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c395c8d6bbd0afc836eac4e58c00a816fb967104"
        }
      ],
      "message": "wallet: guard and alert about a wallet invalid state during chain sync\n\n-Context:\nIf `AddToWallet` db write fails, the method returns a wtx nullptr without\nremoving the recently added transaction from the wallet's map.\n\n-Problem:\nWhen a db write error occurs, `AddToWalletIfInvolvingMe` return false even\nwhen the tx is on the wallet's map already --> which makes `SyncTransaction`\nskip the `MarkInputsDirty` call --> which leads to a wallet invalid state\nwhere the inputs of this new transaction are not marked dirty, while the\ntransaction that spends them still exist on the in-memory wallet tx map.\n\nPlus, as we only store arriving transaction inside `AddToWalletIfInvolvingMe`\nwhen we synchronize/scan blocks from the chain and nowhere else, it makes sense\nto treat the tx db write error as a runtime error to notify the user about the\nproblem. Otherwise, the user will lose all the not stored transactions after a\nwallet shutdown (without be able to recover them automatically on the next\nstartup because the chain sync would be above the block where the txs arrived).",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-07-18T14:29:27Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-06-03T13:46:14Z"
      },
      "sha": "77de5c693ffe8dc0afa5e40126e9b0e9cc547e04"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDllMDRjZmFhNzZjZjlkZGEyN2YxMDM1OWRkNDNlNzhkZDMyNjhlMDk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "tree": {
        "sha": "3004e185800124d06ddcb0111f548b5162cd417b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3004e185800124d06ddcb0111f548b5162cd417b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 3004e185800124d06ddcb0111f548b5162cd417b\nparent 77de5c693ffe8dc0afa5e40126e9b0e9cc547e04\nauthor furszy <matiasfurszyfer@protonmail.com> 1654270016 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1658156688 -0300\n\ntest: add coverage for wallet inconsistent state during sync\n\nWhen a transaction arrives, the wallet mark its inputs (prev-txs) as dirty.\nClearing the wallet transaction cache, triggering a balance recalculation.\n\nIf this does not happen due a db write error during `AddToWallet`, the wallet\nwill be in an invalid state: The transaction that spends certain wallet UTXO will\nexist inside the in-memory wallet tx map, having the credit/debit calculated,\nwhile its inputs will still have the old cached data (like if them were never\nspent).\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmLVdpAACgkQXdI8zGhq\npiOB+xAAn2mEIFY2XaDpoBpz+Ve0LNAKl0lZL72PhpLircHGuT2+d6+zrhA2sBhM\n3GvGOetOSwmaMFR+W90ABF+w18jXdRYvSLfMzRjjmna08eSqh2YriE1P/zRXDFae\nqhZhvrux/ojD288lImrTz6VLHjemwiUftHbxYrA5BEM0jeRERJu1XwRBjIp5DwDQ\nlWh/SJYo+hK7ZoVB8bUNuJ9M4uMhQYBH1QaCVgZ6oTjr1yJRxRDW7TA2GawmyVGy\nUOl+BmUrbwpSFZngfuyIu4wZfwR60kTvcn63u9z3FEXi7hgmMp4x/YIK4pRRu4o3\n7h/4hs4ytnsclox4ZK25cnJZz6pBGrUy5FydEanZDfsu1NgDKNUNVLreHGDpwR20\n/HE4oYeJH/E5f7syv3FRXDHShof7wdUwXxekcd9AboYyuMG6iPmG95+KC3HV9jXn\nBZQxXn6vsrA8LQ+M9WMCuGuPZ9O5XATN237pGwaSJ6sDsEZb+5OrTIfyUBEOX/9Y\n8MyXGaZKMggtG/Zti/OcWy/TZgKiqwyQGCqVdJ1W9y2+cs0ls5xvMb2MMidxgv9q\nigPH1uPJ1aleCpPi6axJYsWtN/PGGn3ddisqbExaNMw+/oSAzzmMAaofgE75E8Wj\nZX/1qrdLusSetzhh9F7Nj7ulOtiG9x2VUgJn4lGBDRENeOow8Ps=\n=cwDk\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77de5c693ffe8dc0afa5e40126e9b0e9cc547e04",
          "sha": "77de5c693ffe8dc0afa5e40126e9b0e9cc547e04",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/77de5c693ffe8dc0afa5e40126e9b0e9cc547e04"
        }
      ],
      "message": "test: add coverage for wallet inconsistent state during sync\n\nWhen a transaction arrives, the wallet mark its inputs (prev-txs) as dirty.\nClearing the wallet transaction cache, triggering a balance recalculation.\n\nIf this does not happen due a db write error during `AddToWallet`, the wallet\nwill be in an invalid state: The transaction that spends certain wallet UTXO will\nexist inside the in-memory wallet tx map, having the credit/debit calculated,\nwhile its inputs will still have the old cached data (like if them were never\nspent).",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-07-18T15:04:48Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-06-03T15:26:56Z"
      },
      "sha": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7012959593,
      "node_id": "HRFPE_lADOABII585LGXGEzwAAAAGiAUVp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7012959593",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T15:07:02Z"
    },
    {
      "event": "commented",
      "id": 1187621471,
      "node_id": "IC_kwDOABII585Gyapf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1187621471",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T15:10:28Z",
      "updated_at": "2022-07-18T15:10:28Z",
      "author_association": "MEMBER",
      "body": "Sadly had to rebase it on master, got a silent merge conflict with the `GetNewDestination` changes.\r\n\r\nReady to go again.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1187621471",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "commented",
      "id": 1188265039,
      "node_id": "IC_kwDOABII585G03xP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1188265039",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T20:21:38Z",
      "updated_at": "2022-07-18T20:21:38Z",
      "author_association": "MEMBER",
      "body": "re-ACK 9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1188265039",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "review_requested",
      "id": 7015348738,
      "node_id": "RRE_lADOABII585LGXGEzwAAAAGiJboC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7015348738",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T20:21:47Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 7015349958,
      "node_id": "RRE_lADOABII585LGXGEzwAAAAGiJb7G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7015349958",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T20:21:58Z",
      "requested_reviewer": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 1043270642,
      "node_id": "PRR_kwDOABII584-Lwvy",
      "url": null,
      "actor": null,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Quick review of the patch only LGTM with one question. Did not build, nor review/verify the passing/failing test yet, will do.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#pullrequestreview-1043270642",
      "submitted_at": "2022-07-19T11:33:01Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
    },
    {
      "event": "commented",
      "id": 1190618031,
      "node_id": "IC_kwDOABII585G92Ov",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190618031",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-20T18:30:31Z",
      "updated_at": "2022-07-20T18:30:31Z",
      "author_association": "MEMBER",
      "body": "ACK 9e04cfaa76cf9dda27f10359dd43e78dd3268e09 \r\n\r\nmodulo https://github.com/bitcoin/bitcoin/pull/25272#discussion_r924384046 regarding the error message",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1190618031",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "commented",
      "id": 1194196071,
      "node_id": "IC_kwDOABII585HLfxn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1194196071",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-25T15:23:40Z",
      "updated_at": "2022-07-25T15:23:40Z",
      "author_association": "MEMBER",
      "body": "Hey, thanks for the review.\r\n\r\nabout your point @jonatack:\r\n\r\n> Would it make sense to follow this existing error message format in `src/wallet/wallet.cpp:2157`, e.g. provide the function name?\r\n\r\nProbably would make more sense to go into the opposite direction and change line 2157 to describe the context where the runtime error occurred properly. Something like `\"DB error committing transaction to wallet, write failed\"`.\r\n\r\nSo if this edge case happens, and the runtime error string gets presented to the user before shutdown, the text is more descriptive than having the function name on it (which, looking it at the user's perspective, provides zero information).\r\n\r\nStill, we could probably merge this PR as is now and tackle it in a short follow-up PR.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#issuecomment-1194196071",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25272"
    },
    {
      "event": "mentioned",
      "id": 7057563533,
      "node_id": "MEE_lADOABII585LGXGEzwAAAAGkqd-N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7057563533",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-25T15:23:41Z"
    },
    {
      "event": "subscribed",
      "id": 7057563539,
      "node_id": "SE_lADOABII585LGXGEzwAAAAGkqd-T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7057563539",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-25T15:23:41Z"
    },
    {
      "event": "merged",
      "id": 7112184432,
      "node_id": "ME_lADOABII585LGXGEzwAAAAGn61Jw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7112184432",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "de3c46c93818c6e4000175bcdbf7dd332f54768d",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/de3c46c93818c6e4000175bcdbf7dd332f54768d",
      "created_at": "2022-08-02T18:07:00Z"
    },
    {
      "event": "closed",
      "id": 7112184468,
      "node_id": "CE_lADOABII585LGXGEzwAAAAGn61KU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7112184468",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-02T18:07:00Z"
    },
    {
      "event": "referenced",
      "id": 7113613074,
      "node_id": "REFE_lADOABII585LGXGEzwAAAAGoAR8S",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7113613074",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "4d6eeb03877056dc3bbe25b3e4b196ef6a526a13",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/4d6eeb03877056dc3bbe25b3e4b196ef6a526a13",
      "created_at": "2022-08-02T21:31:02Z"
    },
    {
      "event": "reviewed",
      "id": 1059494878,
      "node_id": "PRR_kwDOABII584_Jpve",
      "url": null,
      "actor": null,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Post-merge ACK https://github.com/bitcoin/bitcoin/pull/25272/commits/9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#pullrequestreview-1059494878",
      "submitted_at": "2022-08-02T22:29:37Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
    },
    {
      "event": "head_ref_deleted",
      "id": 9355565921,
      "node_id": "HRDE_lADOABII585LGXGEzwAAAAItopth",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9355565921",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-27T01:50:31Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/890320253",
      "pull_request_review_id": 996863007,
      "id": 890320253,
      "node_id": "PRRC_kwDOABII5841ETV9",
      "diff_hunk": "@@ -856,5 +856,111 @@ BOOST_FIXTURE_TEST_CASE(ZapSelectTx, TestChain100Setup)\n     TestUnloadWallet(std::move(wallet));\n }\n \n+/** RAII class that provides access to a FailDatabase. Which fails if needed. */\n+class FailBatch : public DatabaseBatch\n+{\n+private:\n+    bool m_pass{false};\n+    bool ReadKey(CDataStream&& key, CDataStream& value) override { return m_pass; }\n+    bool WriteKey(CDataStream&& key, CDataStream&& value, bool overwrite=true) override { return m_pass; }\n+    bool EraseKey(CDataStream&& key) override { return m_pass; }\n+    bool HasKey(CDataStream&& key) override { return m_pass; }\n+\n+public:\n+    explicit FailBatch(bool pass) : m_pass(pass) {}\n+    void Flush() override {}\n+    void Close() override {}\n+\n+    bool StartCursor() override { return true; }\n+    bool ReadAtCursor(CDataStream& ssKey, CDataStream& ssValue, bool& complete) override { return false; }\n+    void CloseCursor() override {}\n+    bool TxnBegin() override { return false; }\n+    bool TxnCommit() override { return false; }\n+    bool TxnAbort() override { return false; }\n+};\n+\n+/** A dummy WalletDatabase that does nothing, only fails if needed.**/\n+class FailDatabase : public WalletDatabase\n+{\n+public:\n+    bool m_pass{true}; // false when this db should fail\n+\n+    void Open() override {};\n+    void AddRef() override {}\n+    void RemoveRef() override {}\n+    bool Rewrite(const char* pszSkip=nullptr) override { return true; }\n+    bool Backup(const std::string& strDest) const override { return true; }\n+    void Close() override {}\n+    void Flush() override {}\n+    bool PeriodicFlush() override { return true; }\n+    void IncrementUpdateCounter() override { ++nUpdateCounter; }\n+    void ReloadDbEnv() override {}\n+    std::string Filename() override { return \"faildb\"; }\n+    std::string Format() override { return \"faildb\"; }\n+    std::unique_ptr<DatabaseBatch> MakeBatch(bool flush_on_close = true) override { return std::make_unique<FailBatch>(m_pass); }\n+};\n+\n+/**\n+ * Checks a wallet invalid state where the inputs (prev-txs) of a new arriving transaction are not marked dirty,\n+ * while the transaction that spends them exist inside the in-memory wallet tx map (not stored on db due a db write failure).\n+ */\n+BOOST_FIXTURE_TEST_CASE(wallet_sync_tx_invalid_state_test, TestingSetup)\n+{\n+    CWallet wallet(m_node.chain.get(), \"\", m_args, std::make_unique<FailDatabase>());\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.SetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetupDescriptorScriptPubKeyMans();\n+    }\n+\n+    // Add tx to wallet\n+    CTxDestination dest;\n+    bilingual_str error;\n+    BOOST_ASSERT(wallet.GetNewDestination(OutputType::BECH32M, \"\", dest, error));\n+\n+    CMutableTransaction mtx;\n+    mtx.vout.push_back({COIN, GetScriptForDestination(dest)});\n+    mtx.vin.push_back(CTxIn(g_insecure_rand_ctx.rand256(), 0));\n+    const auto& tx_id_to_spend = wallet.AddToWallet(MakeTransactionRef(mtx), TxStateInMempool{})->GetHash();\n+\n+    {\n+        // Cache and verify available balance for the wtx\n+        LOCK(wallet.cs_wallet);\n+        const CWalletTx* wtx_to_spend = wallet.GetWalletTx(tx_id_to_spend);\n+        BOOST_CHECK_EQUAL(CachedTxGetAvailableCredit(wallet, *wtx_to_spend), 1 * COIN);\n+    }\n+\n+    // Now the good case:\n+    // 1) Add a transaction that spends the previously created transaction\n+    // 2) Verify that the available balance of this new tx and the old one is updated (prev tx is marked dirty)\n+\n+    mtx.vin.clear();\n+    mtx.vin.push_back(CTxIn(tx_id_to_spend, 0));\n+    wallet.transactionAddedToMempool(MakeTransactionRef(mtx), 0);\n+    const uint256& good_tx_id = mtx.GetHash();\n+\n+    {\n+        // Verify balance update for the new tx and the old one\n+        LOCK(wallet.cs_wallet);\n+        const CWalletTx* new_wtx = wallet.GetWalletTx(good_tx_id);\n+        BOOST_CHECK_EQUAL(CachedTxGetAvailableCredit(wallet, *new_wtx), 1 * COIN);\n+\n+        // Now the old wtx\n+        const CWalletTx* wtx_to_spend = wallet.GetWalletTx(tx_id_to_spend);\n+        BOOST_CHECK_EQUAL(CachedTxGetAvailableCredit(wallet, *wtx_to_spend), 0 * COIN);\n+    }\n+\n+    // Now the bad case:\n+    // 1) Make db always fail\n+    // 2) Try to add a transaction that spends the previously created transaction and\n+    //    verify that we are not moving forward if the wallet cannot store it\n+    dynamic_cast<FailDatabase&>(wallet.GetDatabase()).m_pass = false;",
      "path": "src/wallet/test/wallet_tests.cpp",
      "position": null,
      "original_position": 102,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "original_commit_id": "d15e9f7fc0ca3b8ab775ca218e146b3238578484",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"test: add case for wallet invalid state where the inputs (prev-txs) of a new arriving transaction are not marked dirty, while the transaction that spends them exist inside the in-memory wallet tx map (not stored on db due a db write failure).\" (742cd0b4898b06798d9cbac0f272d7aed0fb2d3f)\r\n\r\nThink you just want a static_cast here if you already know the type. (dynamic_cast is for when you are unsure what the type will be at runtime)",
      "created_at": "2022-06-06T16:23:15Z",
      "updated_at": "2022-06-06T17:33:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#discussion_r890320253",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/890320253"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 957,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/890365213",
      "pull_request_review_id": 996863007,
      "id": 890365213,
      "node_id": "PRRC_kwDOABII5841EeUd",
      "diff_hunk": "@@ -856,5 +856,111 @@ BOOST_FIXTURE_TEST_CASE(ZapSelectTx, TestChain100Setup)\n     TestUnloadWallet(std::move(wallet));\n }\n \n+/** RAII class that provides access to a FailDatabase. Which fails if needed. */\n+class FailBatch : public DatabaseBatch\n+{\n+private:\n+    bool m_pass{false};\n+    bool ReadKey(CDataStream&& key, CDataStream& value) override { return m_pass; }\n+    bool WriteKey(CDataStream&& key, CDataStream&& value, bool overwrite=true) override { return m_pass; }\n+    bool EraseKey(CDataStream&& key) override { return m_pass; }\n+    bool HasKey(CDataStream&& key) override { return m_pass; }\n+\n+public:\n+    explicit FailBatch(bool pass) : m_pass(pass) {}\n+    void Flush() override {}\n+    void Close() override {}\n+\n+    bool StartCursor() override { return true; }\n+    bool ReadAtCursor(CDataStream& ssKey, CDataStream& ssValue, bool& complete) override { return false; }\n+    void CloseCursor() override {}\n+    bool TxnBegin() override { return false; }\n+    bool TxnCommit() override { return false; }\n+    bool TxnAbort() override { return false; }\n+};\n+\n+/** A dummy WalletDatabase that does nothing, only fails if needed.**/\n+class FailDatabase : public WalletDatabase\n+{\n+public:\n+    bool m_pass{true}; // false when this db should fail",
      "path": "src/wallet/test/wallet_tests.cpp",
      "position": 31,
      "original_position": 31,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "original_commit_id": "d15e9f7fc0ca3b8ab775ca218e146b3238578484",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"test: add case for wallet invalid state where the inputs (prev-txs) of a new arriving transaction are not marked dirty, while the transaction that spends them exist inside the in-memory wallet tx map (not stored on db due a db write failure).\" (742cd0b4898b06798d9cbac0f272d7aed0fb2d3f)\r\n\r\nDefault is true here, but false in the other class. Would suggest sticking choosing one default just to avoid confusion and having to remember which class has which default.\r\n\r\n(Also maybe use a shorter commit subject, https://cbea.ms/git-commit/ has nice guidelines)",
      "created_at": "2022-06-06T17:19:46Z",
      "updated_at": "2022-06-06T17:35:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#discussion_r890365213",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/890365213"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 889,
      "original_line": 889,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/890455670",
      "pull_request_review_id": 997066060,
      "id": 890455670,
      "node_id": "PRRC_kwDOABII5841E0Z2",
      "diff_hunk": "@@ -856,5 +856,111 @@ BOOST_FIXTURE_TEST_CASE(ZapSelectTx, TestChain100Setup)\n     TestUnloadWallet(std::move(wallet));\n }\n \n+/** RAII class that provides access to a FailDatabase. Which fails if needed. */\n+class FailBatch : public DatabaseBatch\n+{\n+private:\n+    bool m_pass{false};\n+    bool ReadKey(CDataStream&& key, CDataStream& value) override { return m_pass; }\n+    bool WriteKey(CDataStream&& key, CDataStream&& value, bool overwrite=true) override { return m_pass; }\n+    bool EraseKey(CDataStream&& key) override { return m_pass; }\n+    bool HasKey(CDataStream&& key) override { return m_pass; }\n+\n+public:\n+    explicit FailBatch(bool pass) : m_pass(pass) {}\n+    void Flush() override {}\n+    void Close() override {}\n+\n+    bool StartCursor() override { return true; }\n+    bool ReadAtCursor(CDataStream& ssKey, CDataStream& ssValue, bool& complete) override { return false; }\n+    void CloseCursor() override {}\n+    bool TxnBegin() override { return false; }\n+    bool TxnCommit() override { return false; }\n+    bool TxnAbort() override { return false; }\n+};\n+\n+/** A dummy WalletDatabase that does nothing, only fails if needed.**/\n+class FailDatabase : public WalletDatabase\n+{\n+public:\n+    bool m_pass{true}; // false when this db should fail\n+\n+    void Open() override {};\n+    void AddRef() override {}\n+    void RemoveRef() override {}\n+    bool Rewrite(const char* pszSkip=nullptr) override { return true; }\n+    bool Backup(const std::string& strDest) const override { return true; }\n+    void Close() override {}\n+    void Flush() override {}\n+    bool PeriodicFlush() override { return true; }\n+    void IncrementUpdateCounter() override { ++nUpdateCounter; }\n+    void ReloadDbEnv() override {}\n+    std::string Filename() override { return \"faildb\"; }\n+    std::string Format() override { return \"faildb\"; }\n+    std::unique_ptr<DatabaseBatch> MakeBatch(bool flush_on_close = true) override { return std::make_unique<FailBatch>(m_pass); }\n+};\n+\n+/**\n+ * Checks a wallet invalid state where the inputs (prev-txs) of a new arriving transaction are not marked dirty,\n+ * while the transaction that spends them exist inside the in-memory wallet tx map (not stored on db due a db write failure).\n+ */\n+BOOST_FIXTURE_TEST_CASE(wallet_sync_tx_invalid_state_test, TestingSetup)\n+{\n+    CWallet wallet(m_node.chain.get(), \"\", m_args, std::make_unique<FailDatabase>());\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.SetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetupDescriptorScriptPubKeyMans();\n+    }\n+\n+    // Add tx to wallet\n+    CTxDestination dest;\n+    bilingual_str error;\n+    BOOST_ASSERT(wallet.GetNewDestination(OutputType::BECH32M, \"\", dest, error));\n+\n+    CMutableTransaction mtx;\n+    mtx.vout.push_back({COIN, GetScriptForDestination(dest)});\n+    mtx.vin.push_back(CTxIn(g_insecure_rand_ctx.rand256(), 0));\n+    const auto& tx_id_to_spend = wallet.AddToWallet(MakeTransactionRef(mtx), TxStateInMempool{})->GetHash();\n+\n+    {\n+        // Cache and verify available balance for the wtx\n+        LOCK(wallet.cs_wallet);\n+        const CWalletTx* wtx_to_spend = wallet.GetWalletTx(tx_id_to_spend);\n+        BOOST_CHECK_EQUAL(CachedTxGetAvailableCredit(wallet, *wtx_to_spend), 1 * COIN);\n+    }\n+\n+    // Now the good case:\n+    // 1) Add a transaction that spends the previously created transaction\n+    // 2) Verify that the available balance of this new tx and the old one is updated (prev tx is marked dirty)\n+\n+    mtx.vin.clear();\n+    mtx.vin.push_back(CTxIn(tx_id_to_spend, 0));\n+    wallet.transactionAddedToMempool(MakeTransactionRef(mtx), 0);\n+    const uint256& good_tx_id = mtx.GetHash();\n+\n+    {\n+        // Verify balance update for the new tx and the old one\n+        LOCK(wallet.cs_wallet);\n+        const CWalletTx* new_wtx = wallet.GetWalletTx(good_tx_id);\n+        BOOST_CHECK_EQUAL(CachedTxGetAvailableCredit(wallet, *new_wtx), 1 * COIN);\n+\n+        // Now the old wtx\n+        const CWalletTx* wtx_to_spend = wallet.GetWalletTx(tx_id_to_spend);\n+        BOOST_CHECK_EQUAL(CachedTxGetAvailableCredit(wallet, *wtx_to_spend), 0 * COIN);\n+    }\n+\n+    // Now the bad case:\n+    // 1) Make db always fail\n+    // 2) Try to add a transaction that spends the previously created transaction and\n+    //    verify that we are not moving forward if the wallet cannot store it\n+    dynamic_cast<FailDatabase&>(wallet.GetDatabase()).m_pass = false;",
      "path": "src/wallet/test/wallet_tests.cpp",
      "position": null,
      "original_position": 102,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "original_commit_id": "d15e9f7fc0ca3b8ab775ca218e146b3238578484",
      "in_reply_to_id": 890320253,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "yeah 👍🏼 .",
      "created_at": "2022-06-06T19:07:31Z",
      "updated_at": "2022-06-06T19:07:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#discussion_r890455670",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/890455670"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 957,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/890463244",
      "pull_request_review_id": 997077356,
      "id": 890463244,
      "node_id": "PRRC_kwDOABII5841E2QM",
      "diff_hunk": "@@ -856,5 +856,111 @@ BOOST_FIXTURE_TEST_CASE(ZapSelectTx, TestChain100Setup)\n     TestUnloadWallet(std::move(wallet));\n }\n \n+/** RAII class that provides access to a FailDatabase. Which fails if needed. */\n+class FailBatch : public DatabaseBatch\n+{\n+private:\n+    bool m_pass{false};\n+    bool ReadKey(CDataStream&& key, CDataStream& value) override { return m_pass; }\n+    bool WriteKey(CDataStream&& key, CDataStream&& value, bool overwrite=true) override { return m_pass; }\n+    bool EraseKey(CDataStream&& key) override { return m_pass; }\n+    bool HasKey(CDataStream&& key) override { return m_pass; }\n+\n+public:\n+    explicit FailBatch(bool pass) : m_pass(pass) {}\n+    void Flush() override {}\n+    void Close() override {}\n+\n+    bool StartCursor() override { return true; }\n+    bool ReadAtCursor(CDataStream& ssKey, CDataStream& ssValue, bool& complete) override { return false; }\n+    void CloseCursor() override {}\n+    bool TxnBegin() override { return false; }\n+    bool TxnCommit() override { return false; }\n+    bool TxnAbort() override { return false; }\n+};\n+\n+/** A dummy WalletDatabase that does nothing, only fails if needed.**/\n+class FailDatabase : public WalletDatabase\n+{\n+public:\n+    bool m_pass{true}; // false when this db should fail",
      "path": "src/wallet/test/wallet_tests.cpp",
      "position": 31,
      "original_position": 31,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "original_commit_id": "d15e9f7fc0ca3b8ab775ca218e146b3238578484",
      "in_reply_to_id": 890365213,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Default is true here, but false in the other class. Would suggest sticking choosing one default just to avoid confusion and having to remember which class has which default.\r\n\r\nyeah, good catch. I wrote the test differently first, this is a remnant of the first approach.\r\n\r\n> (Also maybe use a shorter commit subject, https://cbea.ms/git-commit/ has nice guidelines)\r\n\r\nawesome reading :), thanks!",
      "created_at": "2022-06-06T19:11:53Z",
      "updated_at": "2022-06-06T19:11:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#discussion_r890463244",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/890463244"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 889,
      "original_line": 889,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896132326",
      "pull_request_review_id": 1004930263,
      "id": 896132326,
      "node_id": "PRRC_kwDOABII5841aeTm",
      "diff_hunk": "@@ -952,29 +952,14 @@ BOOST_FIXTURE_TEST_CASE(wallet_sync_tx_invalid_state_test, TestingSetup)\n \n     // Now the bad case:\n     // 1) Make db always fail\n-    // 2) Add transaction that spends the previously created transaction\n-    // 3) Check what happen now that the db failed to write the tx. Verifying\n-    //    the available balance of this new tx and the old one (which, as the\n-    //    output is spent, should at least, be marked dirty)\n-\n-    dynamic_cast<FailDatabase&>(wallet.GetDatabase()).m_pass = false;\n+    // 2) Try to add a transaction that spends the previously created transaction and\n+    //    verify that we are not moving forward if the wallet cannot store it\n+    static_cast<FailDatabase&>(wallet.GetDatabase()).m_pass = false;",
      "path": "src/wallet/test/wallet_tests.cpp",
      "position": 102,
      "original_position": 12,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "original_commit_id": "4bd0d0140e2a27e604ca0febcd485f468705c0ed",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 4bd0d0140e2a27e604ca0febcd485f468705c0ed \"wallet: guard and alert about a wallet invalid state during chain sync\"\r\n\r\n`static_cast` change should be in the previous commit.",
      "created_at": "2022-06-13T21:01:10Z",
      "updated_at": "2022-06-13T21:03:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#discussion_r896132326",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896132326"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 960,
      "original_line": 960,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905382073",
      "pull_request_review_id": 1017534297,
      "id": 905382073,
      "node_id": "PRRC_kwDOABII58419wi5",
      "diff_hunk": "@@ -1139,7 +1139,13 @@ bool CWallet::AddToWalletIfInvolvingMe(const CTransactionRef& ptx, const SyncTxS\n             // Block disconnection override an abandoned tx as unconfirmed\n             // which means user may have to call abandontransaction again\n             TxState tx_state = std::visit([](auto&& s) -> TxState { return s; }, state);\n-            return AddToWallet(MakeTransactionRef(tx), tx_state, /*update_wtx=*/nullptr, /*fFlushOnClose=*/false, rescanning_old_block);\n+            CWalletTx* wtx = AddToWallet(MakeTransactionRef(tx), tx_state, /*update_wtx=*/nullptr, /*fFlushOnClose=*/false, rescanning_old_block);\n+            if (!wtx) {\n+                // Can only be nullptr if there was a db write error (missing db, read-only db or a db engine internal writing error).\n+                // As we only store arriving transaction in this process, and we don't want an inconsistent state, let's throw an error.\n+                throw std::runtime_error(\"DB error adding transaction to wallet, write failed\");",
      "path": "src/wallet/wallet.cpp",
      "position": 9,
      "original_position": 9,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "original_commit_id": "7027e94801686064eef806b10df141ebca3ea2b8",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Where is the exception handler?",
      "created_at": "2022-06-23T19:25:13Z",
      "updated_at": "2022-06-23T19:25:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#discussion_r905382073",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905382073"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1137,
      "original_line": 1137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906240021",
      "pull_request_review_id": 1018736931,
      "id": 906240021,
      "node_id": "PRRC_kwDOABII5842BCAV",
      "diff_hunk": "@@ -1139,7 +1139,13 @@ bool CWallet::AddToWalletIfInvolvingMe(const CTransactionRef& ptx, const SyncTxS\n             // Block disconnection override an abandoned tx as unconfirmed\n             // which means user may have to call abandontransaction again\n             TxState tx_state = std::visit([](auto&& s) -> TxState { return s; }, state);\n-            return AddToWallet(MakeTransactionRef(tx), tx_state, /*update_wtx=*/nullptr, /*fFlushOnClose=*/false, rescanning_old_block);\n+            CWalletTx* wtx = AddToWallet(MakeTransactionRef(tx), tx_state, /*update_wtx=*/nullptr, /*fFlushOnClose=*/false, rescanning_old_block);\n+            if (!wtx) {\n+                // Can only be nullptr if there was a db write error (missing db, read-only db or a db engine internal writing error).\n+                // As we only store arriving transaction in this process, and we don't want an inconsistent state, let's throw an error.\n+                throw std::runtime_error(\"DB error adding transaction to wallet, write failed\");",
      "path": "src/wallet/wallet.cpp",
      "position": 9,
      "original_position": 9,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "original_commit_id": "7027e94801686064eef806b10df141ebca3ea2b8",
      "in_reply_to_id": 905382073,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This runs on the scheduler thread, it's caught by the try/catch inside `serviceQueue()`.\r\n\r\nIt's a direct node/wallet abortion cause, because the wallet cannot recover alone from this invalid state. If it continues running is only for worst.",
      "created_at": "2022-06-24T16:54:33Z",
      "updated_at": "2022-06-30T23:58:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#discussion_r906240021",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906240021"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1137,
      "original_line": 1137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/924384046",
      "pull_request_review_id": 1043270642,
      "id": 924384046,
      "node_id": "PRRC_kwDOABII5843GPsu",
      "diff_hunk": "@@ -1130,7 +1130,13 @@ bool CWallet::AddToWalletIfInvolvingMe(const CTransactionRef& ptx, const SyncTxS\n             // Block disconnection override an abandoned tx as unconfirmed\n             // which means user may have to call abandontransaction again\n             TxState tx_state = std::visit([](auto&& s) -> TxState { return s; }, state);\n-            return AddToWallet(MakeTransactionRef(tx), tx_state, /*update_wtx=*/nullptr, /*fFlushOnClose=*/false, rescanning_old_block);\n+            CWalletTx* wtx = AddToWallet(MakeTransactionRef(tx), tx_state, /*update_wtx=*/nullptr, /*fFlushOnClose=*/false, rescanning_old_block);\n+            if (!wtx) {\n+                // Can only be nullptr if there was a db write error (missing db, read-only db or a db engine internal writing error).\n+                // As we only store arriving transaction in this process, and we don't want an inconsistent state, let's throw an error.\n+                throw std::runtime_error(\"DB error adding transaction to wallet, write failed\");",
      "path": "src/wallet/wallet.cpp",
      "position": 9,
      "original_position": 9,
      "commit_id": "9e04cfaa76cf9dda27f10359dd43e78dd3268e09",
      "original_commit_id": "77de5c693ffe8dc0afa5e40126e9b0e9cc547e04",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Would it make sense to follow this existing error message format in `src/wallet/wallet.cpp:2157`, e.g. provide the function name?\r\n\r\n```cpp\r\nthrow std::runtime_error(std::string(__func__) + \": Wallet db error, transaction commit failed\");\r\n```\r\n(modulo `s/db/DB/`)\r\n",
      "created_at": "2022-07-19T11:31:19Z",
      "updated_at": "2022-07-19T11:34:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/25272#discussion_r924384046",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/924384046"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25272"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1137,
      "original_line": 1137,
      "side": "RIGHT"
    }
  ]
}