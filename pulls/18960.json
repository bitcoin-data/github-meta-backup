{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960",
    "id": 416786284,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDE2Nzg2Mjg0",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18960",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/18960.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/18960.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
    "number": 18960,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "indexes: Add compact block filter headers cache",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Cache block filter headers at heights of multiples of 1000 in memory.\r\n\r\nBlock filter headers at height 1000x are checkpointed, and will be the most frequently requested. Cache them in memory to avoid costly disk reads.",
    "labels": [
      {
        "id": 97470796,
        "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
        "name": "UTXO Db and Indexes",
        "color": "fbca04",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2020-05-12T15:04:56Z",
    "updated_at": "2022-02-15T10:31:19Z",
    "closed_at": "2020-05-21T17:35:02Z",
    "mergeable_state": "unknown",
    "merged_at": "2020-05-21T17:35:02Z",
    "merge_commit_sha": "4479eb04d92806633aa3ad3e413f6a7166863638",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "jnewbery:2020-05-cfcheckpts-cache",
      "ref": "2020-05-cfcheckpts-cache",
      "sha": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 68248485,
        "node_id": "MDEwOlJlcG9zaXRvcnk2ODI0ODQ4NQ==",
        "name": "bitcoin",
        "full_name": "jnewbery/bitcoin",
        "owner": {
          "login": "jnewbery",
          "id": 1063656,
          "node_id": "MDQ6VXNlcjEwNjM2NTY=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/jnewbery",
          "html_url": "https://github.com/jnewbery",
          "followers_url": "https://api.github.com/users/jnewbery/followers",
          "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
          "organizations_url": "https://api.github.com/users/jnewbery/orgs",
          "repos_url": "https://api.github.com/users/jnewbery/repos",
          "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/jnewbery/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/jnewbery/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/jnewbery/bitcoin",
        "archive_url": "https://api.github.com/repos/jnewbery/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/jnewbery/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/jnewbery/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/jnewbery/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/jnewbery/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/jnewbery/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/jnewbery/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/jnewbery/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/jnewbery/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/jnewbery/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/jnewbery/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/jnewbery/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/jnewbery/bitcoin/events",
        "forks_url": "https://api.github.com/repos/jnewbery/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/jnewbery/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/jnewbery/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/jnewbery/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/jnewbery/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/jnewbery/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/jnewbery/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/jnewbery/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/jnewbery/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/jnewbery/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/jnewbery/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/jnewbery/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/jnewbery/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/jnewbery/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/jnewbery/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/jnewbery/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:jnewbery/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/jnewbery/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/jnewbery/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/jnewbery/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/jnewbery/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/jnewbery/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/jnewbery/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/jnewbery/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/jnewbery/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/jnewbery/bitcoin/hooks",
        "svn_url": "https://github.com/jnewbery/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 219109,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-04-21T11:07:55Z",
        "created_at": "2016-09-14T22:29:05Z",
        "updated_at": "2021-07-06T16:23:27Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "dc5333d31f280e09bb1e8cdacfbe842f4ab9e69b",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69818,
        "watchers_count": 69818,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T22:42:00Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T03:51:27Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 40,
    "deletions": 6,
    "changed_files": 3,
    "commits": 1,
    "review_comments": 29,
    "comments": 23
  },
  "events": [
    {
      "event": "labeled",
      "id": 3327951672,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMzMjc5NTE2NzI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3327951672",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-12T15:05:53Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "commented",
      "id": 627403715,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzQwMzcxNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/627403715",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-12T15:06:17Z",
      "updated_at": "2020-05-12T15:06:17Z",
      "author_association": "MEMBER",
      "body": "This takes a different approach from the caching in #16442. I prefer it because it isolates all of the caching logic inside the indexer rather than in net processing. I'll put the other approach up as a different branch for comparison.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-627403715",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "reviewed",
      "id": 410152048,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMTUyMDQ4",
      "url": null,
      "actor": null,
      "commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK -- I didn't look very deeply into the proposed solution from the original PR (#16442, commit https://github.com/bitcoin/bitcoin/pull/16442/commits/be5f7c5f8e98416f95d3bd91ab5639b67b28eef2), but this solution here seems to be way simpler.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#pullrequestreview-410152048",
      "submitted_at": "2020-05-12T15:21:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
    },
    {
      "event": "commented",
      "id": 627814619,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzgxNDYxOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/627814619",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T07:52:38Z",
      "updated_at": "2020-05-20T20:02:34Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18354 (Protect wallet by using shared pointers by bvbfan)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-627814619",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "commented",
      "id": 627939760,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzkzOTc2MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/627939760",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T12:10:16Z",
      "updated_at": "2020-05-13T12:13:31Z",
      "author_association": "MEMBER",
      "body": "I'm almost ready for ACKing this PR, just have some minor suggestion/discussion points:\r\n- Would it make sense to also only check the cache if we have checkpoints, i.e. a method structure like\r\n```\r\nbool is_checkpoint = (block_index->nHeight % CFCHECKPT_INTERVAL == 0); \r\nif (is_checkpoint)\r\n    // Check the headers cache\r\n\r\n// Regular lookup\r\n\r\nif (is_checkpoint)\r\n    // Add to the headers cache\r\n```\r\n? Of course, the drawback of this approach is that the condition for checking needs to be removed if the cache is ever used for other filter headers than those from the checkpoints. Also not sure if its really worth it from a performance point of view. But in 999 out of 1000 times the lookup in the map could be skipped.\r\n- In the regular case the cache should never get full, considering that this would by plan only happen in the far future (block 2000000, >25 years from now, with the current maximum size constant of 2000). If it gets full however, should we take some action like putting a debug output or even an assert, to get noticed that we either have some memory exhaustion bug or that the maximum size needs to be increased?\r\n- Any idea how to effectively test performance improvements like this? I don't know anything better than just putting some `LogPrintf`s in the cache hit / cache add cases, run the (maybe slightly modified) functional test and analyze the log output to check if it behaves as expected.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-627939760",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "reviewed",
      "id": 410883693,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwODgzNjkz",
      "url": null,
      "actor": null,
      "commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Agree with @theStack that performance improvements should be benchmarked. This could turn into another improvement that is actually a slow-down, see #18352.",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#pullrequestreview-410883693",
      "submitted_at": "2020-05-13T12:46:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
    },
    {
      "event": "reviewed",
      "id": 411014712,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMDE0NzEy",
      "url": null,
      "actor": null,
      "commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Agree with previous comments: I prefer this to the previous approach. I think it would be good to have some benchmarks. Otherwise, code looks very good to me.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#pullrequestreview-411014712",
      "submitted_at": "2020-05-13T15:31:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
    },
    {
      "event": "reviewed",
      "id": 411187904,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMTg3OTA0",
      "url": null,
      "actor": null,
      "commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#pullrequestreview-411187904",
      "submitted_at": "2020-05-13T18:24:51Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
    },
    {
      "event": "commented",
      "id": 628166454,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyODE2NjQ1NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628166454",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T18:25:49Z",
      "updated_at": "2020-05-13T18:25:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628166454",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3334175911,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzMzNDE3NTkxMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3334175911",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T22:43:33Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3334176693,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzMzNDE3NjY5Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3334176693",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T22:43:56Z"
    },
    {
      "event": "commented",
      "id": 628285474,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyODI4NTQ3NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628285474",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T22:48:06Z",
      "updated_at": "2020-05-13T22:48:06Z",
      "author_association": "MEMBER",
      "body": "@theStack \r\n> Would it make sense to also only check the cache if we have checkpoints, i.e. a method structure like\r\n\r\nDone\r\n\r\n@MarcoFalke \r\n> a non-recursive mutex should be sufficient.\r\n\r\nChanged `RecursiveMutex` -> `Mutex`\r\n\r\nI'm still working on adding a microbench, although it's not clear to me that it'll show any improvement since the disk reads may be cached by the OS for the microbench.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628285474",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "mentioned",
      "id": 3334185539,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzMzNDE4NTUzOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3334185539",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T22:48:06Z"
    },
    {
      "event": "subscribed",
      "id": 3334185541,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzMzQxODU1NDE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3334185541",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T22:48:06Z"
    },
    {
      "event": "mentioned",
      "id": 3334185544,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzMzNDE4NTU0NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3334185544",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T22:48:07Z"
    },
    {
      "event": "subscribed",
      "id": 3334185545,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzMzQxODU1NDU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3334185545",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-13T22:48:07Z"
    },
    {
      "event": "reviewed",
      "id": 411485876,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNDg1ODc2",
      "url": null,
      "actor": null,
      "commit_id": "7ad83ed252914d6d5b8ed81f103aecf052c68fb7",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK.\r\n\r\nKudos on the simplicity of this approach!",
      "user": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#pullrequestreview-411485876",
      "submitted_at": "2020-05-14T06:05:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
    },
    {
      "event": "referenced",
      "id": 3337489155,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDMzMzc0ODkxNTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3337489155",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e7bb43ec6d3dbaeaa718c4763b2c20a20cd81e03",
      "commit_url": "https://api.github.com/repos/theStack/bitcoin/commits/e7bb43ec6d3dbaeaa718c4763b2c20a20cd81e03",
      "created_at": "2020-05-14T16:44:02Z"
    },
    {
      "event": "referenced",
      "id": 3337489161,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDMzMzc0ODkxNjE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3337489161",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1d504570d1e090c1e076e8f433e7aabdb50cc1d9",
      "commit_url": "https://api.github.com/repos/theStack/bitcoin/commits/1d504570d1e090c1e076e8f433e7aabdb50cc1d9",
      "created_at": "2020-05-14T16:44:02Z"
    },
    {
      "event": "commented",
      "id": 628761578,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyODc2MTU3OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628761578",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-14T16:56:36Z",
      "updated_at": "2020-05-14T18:18:43Z",
      "author_association": "MEMBER",
      "body": "Using jnewbery's nice [node-shell module](https://github.com/jnewbery/bitcoin/tree/node-shell) (a modification of test-shell that allows to connect with the functional test framework to a running full-node) I crafted up a quick and dirty [test-script](https://github.com/theStack/bitcoin/blob/pr18960_test/test/functional/p2p_18960.py) (see branch https://github.com/theStack/bitcoin/tree/pr18960_test) that sends `getcfcheckpt` requests with the stop-hash of the halving block 630000 and measures the processing time.\r\n\r\nFreshly started bitcoind from master branch (w/o checkpoint headers cache implementation), after mempool imports are done:\r\n```\r\ngetcfcheckpt request processing times\r\n=====================================\r\n-> first:     53.75ms\r\n-> following: 50.70ms (average)\r\n=====================================\r\n```\r\n\r\nFreshly started bitcoind from PR branch (with checkpoint headers cache implementation), after mempool imports are done:\r\n```\r\ngetcfcheckpt request processing times\r\n=====================================\r\n-> first:     50.92ms\r\n-> following: 50.80ms (average)\r\n=====================================\r\n```\r\nThere doesn't seem to be a noticable difference. I don't know if my methodology is flawed though. Maybe all the processing around is taking so much more time that the actual part of fetching the header (from the cache or from disk) is neglectible. If anyone has an idea how to improve the benchmark script, happy to hear suggestions!\r\n\r\n// EDIT: As jnewbery found out in the course of today's PR review club meeting, there is a good explanation on why the values are always close to 50ms:\r\n```\r\n19:36 < jnewbery> There are 100ms sleeps in the messagehandler thread between looping through all peers:\r\n                  https://github.com/jnewbery/bitcoin/blob/7ad83ed252914d6d5b8ed81f103aecf052c68fb7/src/net.cpp#L2061\r\n19:37 < jnewbery> on a non-busy node, 50ms is the average time you have to wait for the message handler thread to wake up\r\n```",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628761578",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "commented",
      "id": 628815890,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyODgxNTg5MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628815890",
      "actor": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-14T18:36:34Z",
      "updated_at": "2020-05-14T18:36:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK",
      "user": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628815890",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "added_to_project",
      "id": 3338024052,
      "node_id": "MDE5OkFkZGVkVG9Qcm9qZWN0RXZlbnQzMzM4MDI0MDUy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3338024052",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-14T19:05:57Z",
      "project_card": {
        "id": 38241777,
        "url": "https://api.github.com/projects/columns/cards/38241777",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "commented",
      "id": 628918187,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyODkxODE4Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628918187",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-14T22:26:37Z",
      "updated_at": "2020-05-14T22:26:37Z",
      "author_association": "MEMBER",
      "body": "@theStack I believe in between the requests you can drop the cache to simulate eviction (which may occasionally happen during normal operation). See https://unix.stackexchange.com/questions/17936/setting-proc-sys-vm-drop-caches-to-clear-cache",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628918187",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "mentioned",
      "id": 3338654424,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzMzODY1NDQyNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3338654424",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-14T22:26:37Z"
    },
    {
      "event": "subscribed",
      "id": 3338654426,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzMzg2NTQ0MjY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3338654426",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-14T22:26:37Z"
    },
    {
      "event": "commented",
      "id": 628974368,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyODk3NDM2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628974368",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:36:30Z",
      "updated_at": "2020-05-15T01:36:30Z",
      "author_association": "MEMBER",
      "body": "@narula suggested in today's PR Review Club meeting that it'd be less cognitive overhead to simply take the `m_cs_headers_cache` for the entirety of the `LookupFilterHeader()` function, rather than taking, releasing and taking it again. That seem like a reasonable request to me. We can't ever block important work with this lock, so holding it a bit longer than strictly necessary is not an issue.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628974368",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "mentioned",
      "id": 3339007947,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzMzOTAwNzk0Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339007947",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:36:30Z"
    },
    {
      "event": "subscribed",
      "id": 3339007949,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzMzkwMDc5NDk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339007949",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:36:30Z"
    },
    {
      "event": "commented",
      "id": 628980196,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyODk4MDE5Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628980196",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:56:31Z",
      "updated_at": "2020-05-15T01:56:31Z",
      "author_association": "MEMBER",
      "body": "@theStack - thank you for doing some benching of this. Your approach inspired me to do something similar myself, using debug logs to find the exact time to construct a cfcheckpt response. I've added a [`debug_log_delta` context wrapper](https://github.com/jnewbery/bitcoin/commit/99ea8d5b228c3c5ddec5de76bbf830c666738485#diff-86294e5ae5283eebdd9f98d79007a0e1R386) to the node_shell, which allows me to provide two debug log messages, then do actions on the node and extract the time delta between those two logs. I applied that patch to:\r\n\r\n- without a cache\r\n- with this cache\r\n- with @narula's suggestion of taking the lock only once (I was interested to see if there were any performance differences).\r\n\r\nAnd then ran the following node-shell script:\r\n\r\n```\r\nREPO_PATH=\"<path_to_repo>\"\r\nDATADIR_PATH=\"<path_to_datadir>\"\r\nimport sys\r\nsys.path.insert(0, f\"{REPO_PATH}/test/functional\")\r\nfrom test_framework.node_shell import NodeShell\r\ntest = NodeShell()\r\ntest.setup(datadir=DATADIR_PATH)\r\n# <test_framework.node_shell.NodeShell.__TestShell object at 0x7f7704820490>\r\nnode = test.nodes[0]\r\nbb = node.getbestblockhash()\r\nfrom test_framework.messages import FILTER_TYPE_BASIC, msg_getcfcheckpt\r\nrequest = msg_getcfcheckpt(filter_type=FILTER_TYPE_BASIC, stop_hash=int(bb, 16))\r\nfor i in range(15):\r\n    with node.debug_log_delta(\"getcfcheckpt request received\", \"cfcheckpt response constructed\"):\r\n        node.p2ps[0].send_and_ping(request)\r\ntest.shutdown()\r\n```\r\n\r\n### [no cache](https://github.com/jnewbery/bitcoin/tree/2020-05-nocfcheckpts-cache-debug)\r\n\r\n```\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.824ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.054ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.021ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.303ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.355ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.26ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.169ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.166ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.194ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 8.574ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.119ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 7.156ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 4.153ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 8.162ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 6.485ms\r\n```\r\n\r\nThere does seem to be a very slight performance improvement after the first request. Maybe around 5-10% from the mean, but variance is quite high, so it might be noise.\r\n\r\n### [cache (taking locks twice)](https://github.com/jnewbery/bitcoin/tree/2020-05-cfcheckpts-cache-debug)\r\n\r\n```\r\ngetcfcheckpt request received to cfcheckpt response constructed: 12.2ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.855ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.992ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.869ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.141ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.692ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.452ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.916ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.413ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.648ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.816ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.84ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.812ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.869ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.445ms\r\n```\r\n\r\nThe initial request is slower (presumably because the cache needs to be warmed), but subsequent requests are on average >50% faster than with no cache.\r\n\r\n### [cache (taking lock once)](https://github.com/jnewbery/bitcoin/tree/2020-05-cfcheckpts-onelock-cache-debug)\r\n\r\n```\r\ngetcfcheckpt request received to cfcheckpt response constructed: 11.785ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.35ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.19ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.475ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.175ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.345ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.274ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.161ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.259ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.217ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.238ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.253ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.33ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.32ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.36ms\r\n```\r\n\r\nThe first request is slightly faster than when taking locks twice (although that might be noise). Subsequent requests are the same speed as the 'taking locks twice' branch, which is what we'd expect because locks are only taken once in that branch if the header is found in the cache.\r\n\r\n@MarcoFalke - I think these full node manual benches are more meaningful than microbenches, so I'm not planning to add any automated benches to `/src/bench`.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628980196",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "mentioned",
      "id": 3339041906,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzMzOTA0MTkwNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339041906",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:56:32Z"
    },
    {
      "event": "subscribed",
      "id": 3339041909,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzMzkwNDE5MDk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339041909",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:56:32Z"
    },
    {
      "event": "mentioned",
      "id": 3339041911,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzMzOTA0MTkxMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339041911",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:56:32Z"
    },
    {
      "event": "subscribed",
      "id": 3339041912,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzMzkwNDE5MTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339041912",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:56:32Z"
    },
    {
      "event": "mentioned",
      "id": 3339041913,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzMzOTA0MTkxMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339041913",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:56:32Z"
    },
    {
      "event": "subscribed",
      "id": 3339041916,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzMzkwNDE5MTY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339041916",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T01:56:32Z"
    },
    {
      "event": "commented",
      "id": 628983530,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyODk4MzUzMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628983530",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T02:08:18Z",
      "updated_at": "2020-05-15T02:08:18Z",
      "author_association": "MEMBER",
      "body": "> @narula suggested in today's PR Review Club meeting that it'd be less cognitive overhead to simply take the m_cs_headers_cache for the entirety of the LookupFilterHeader() function, rather than taking, releasing and taking it again.\r\n\r\nI'll make this change tomorrow.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628983530",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "mentioned",
      "id": 3339062226,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzMzOTA2MjIyNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339062226",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T02:08:18Z"
    },
    {
      "event": "subscribed",
      "id": 3339062228,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzMzkwNjIyMjg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3339062228",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T02:08:18Z"
    },
    {
      "event": "commented",
      "id": 629163428,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTE2MzQyOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629163428",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T10:37:19Z",
      "updated_at": "2020-05-15T10:40:40Z",
      "author_association": "MEMBER",
      "body": "In yesterday's [review club meeting on this PR](https://bitcoincore.reviews/18960.html), it was suggested to put LogPrintf() directly into the network processing code parts to measure the execution time of getcfcheckpt requests. (My previous approach of [measuring the request response time from the test framework](https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628761578) was not precise enough, as the time also included python overhead and the time for the message handler to wake up.) I did some testing with this refined approach and can roughly confirm the [results from jnewbery](https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-628980196) (see commit https://github.com/theStack/bitcoin/commit/48cff1bb4d27ef0040b18a860a3c897752e3c296):\r\n\r\n*without cache*:\r\n```\r\n2020-05-14T20:15:11Z getcfcheckpt processing took 10247us\r\n2020-05-14T20:15:11Z getcfcheckpt processing took 6105us\r\n2020-05-14T20:15:11Z getcfcheckpt processing took 6437us\r\n2020-05-14T20:15:11Z getcfcheckpt processing took 5330us\r\n2020-05-14T20:15:11Z getcfcheckpt processing took 6964us\r\n2020-05-14T20:15:11Z getcfcheckpt processing took 5523us\r\n2020-05-14T20:15:12Z getcfcheckpt processing took 5413us\r\n2020-05-14T20:15:12Z getcfcheckpt processing took 5843us\r\n2020-05-14T20:15:12Z getcfcheckpt processing took 7060us\r\n2020-05-14T20:15:12Z getcfcheckpt processing took 6165us\r\n...\r\n```\r\n*with cache*:\r\n```\r\n2020-05-14T20:21:26Z getcfcheckpt processing took 9801us\r\n2020-05-14T20:21:26Z getcfcheckpt processing took 2619us\r\n2020-05-14T20:21:26Z getcfcheckpt processing took 3338us\r\n2020-05-14T20:21:26Z getcfcheckpt processing took 2446us\r\n2020-05-14T20:21:26Z getcfcheckpt processing took 2560us\r\n2020-05-14T20:21:27Z getcfcheckpt processing took 2331us\r\n2020-05-14T20:21:27Z getcfcheckpt processing took 2703us\r\n2020-05-14T20:21:27Z getcfcheckpt processing took 2614us\r\n2020-05-14T20:21:27Z getcfcheckpt processing took 2598us\r\n2020-05-14T20:21:27Z getcfcheckpt processing took 2444us\r\n...\r\n```\r\nOne can see that there's a speedup of at least 2x with the cache.\r\n\r\nNote that my approach to get these numbers was slightly different, as I directly measured the time in bitcoind via `GetTimeMicros()` (commit https://github.com/theStack/bitcoin/commit/49f5f3d5444ed6c872dd41be910e2149308b35e7):\r\n```diff\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex 1df1fab..6e620d9 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -3380,7 +3380,10 @@ bool ProcessMessage(CNode* pfrom, const std::string& msg_type, CDataStream& vRec\r\n     }\r\n\r\n     if (msg_type == NetMsgType::GETCFCHECKPT) {\r\n+        int64_t start_time = GetTimeMicros();\r\n         ProcessGetCFCheckPt(pfrom, vRecv, chainparams, connman);\r\n+        int64_t processing_duration = GetTimeMicros() - start_time;\r\n+        LogPrintf(\"getcfcheckpt processing took %lldus\\n\", processing_duration);\r\n         return true;\r\n     }\r\n```\r\n\r\nbut the idea is the same.\r\n\r\nNow I'm very curious if the change from `std::map` to `std::unordered_map` shows a noticable difference in performance.\r\n\r\n@MarcoFalke: Nice idea to drop the cache between the requests. Unfortunately, on my current development box I don't have the permissions (root rights) to do this :/ if anyone having the possibility, the results would be very interesting.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-629163428",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "mentioned",
      "id": 3340361270,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzM0MDM2MTI3MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3340361270",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T10:37:19Z"
    },
    {
      "event": "subscribed",
      "id": 3340361271,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzNDAzNjEyNzE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3340361271",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T10:37:19Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3341533106,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzM0MTUzMzEwNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3341533106",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:00:03Z"
    },
    {
      "event": "commented",
      "id": 629351023,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTM1MTAyMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629351023",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:17:49Z",
      "updated_at": "2020-05-15T16:17:49Z",
      "author_association": "MEMBER",
      "body": "> it'd be less cognitive overhead to simply take the m_cs_headers_cache for the entirety of the LookupFilterHeader() function\r\n\r\n@narula \r\n\r\nDone.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-629351023",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "mentioned",
      "id": 3341610889,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzM0MTYxMDg4OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3341610889",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:17:49Z"
    },
    {
      "event": "subscribed",
      "id": 3341610894,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzNDE2MTA4OTQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3341610894",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:17:49Z"
    },
    {
      "event": "reviewed",
      "id": 412792135,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyNzkyMTM1",
      "url": null,
      "actor": null,
      "commit_id": "4018953ee9d190188b0b10ef1463f7b64b4e59bb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#pullrequestreview-412792135",
      "submitted_at": "2020-05-15T16:24:18Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
    },
    {
      "event": "reviewed",
      "id": 412800070,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyODAwMDcw",
      "url": null,
      "actor": null,
      "commit_id": "4018953ee9d190188b0b10ef1463f7b64b4e59bb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#pullrequestreview-412800070",
      "submitted_at": "2020-05-15T16:34:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
    },
    {
      "event": "commented",
      "id": 629361597,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTM2MTU5Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629361597",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:40:38Z",
      "updated_at": "2020-05-15T16:40:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "utACK",
      "user": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-629361597",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "commented",
      "id": 629361873,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTM2MTg3Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629361873",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:41:15Z",
      "updated_at": "2020-05-15T16:41:15Z",
      "author_association": "MEMBER",
      "body": "I've force-pushed a branch that changes this to use an unordered_map and only lock once.\r\n\r\nComparing the unordered map implementation to map:\r\n\r\n#### unordered_map\r\n\r\n<details><summary>Log</summary>\r\n\r\n```\r\ngetcfcheckpt request received to cfcheckpt response constructed: 12.808ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.783ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.712ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.656ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.672ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.82ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.994ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.068ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.335ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.444ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.159ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.194ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.601ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.692ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.982ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.209ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.116ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.136ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.666ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.091ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.444ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.385ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.147ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.145ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.053ms\r\n```\r\n</p></details>\r\nFirst lookup: 12.8ms, average subsequent lookup: 3.02ms\r\n\r\n#### map\r\n\r\n<details><summary>Log</summary>\r\n\r\n```\r\ngetcfcheckpt request received to cfcheckpt response constructed: 12.959ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.001ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.656ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.07ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.537ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.838ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 2.994ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.143ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.383ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.666ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.889ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.553ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.394ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.3ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.5ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.372ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.329ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.308ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.564ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.746ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.714ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.423ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.517ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.636ms\r\ngetcfcheckpt request received to cfcheckpt response constructed: 3.595ms\r\n```\r\n</details>\r\nFirst lookup: 13.0ms, average subsequent lookup: 3.60s\r\n\r\nSo from this single test, it appears that an unordered_map is indeed faster. That's what we'd expect, since lookup is O(1) and number of lookups required for a single getcfcheckpt request is O(n), so total is O(n). For a map, a single lookup is O(logn), so total is O(nlogn).\r\n\r\nThe original implementation is faster still, since it's storing the checkpts in a single vector, but the aim of this PR is to avoid disk reads for getcfcheckpt messages, which the simple unordered_map implementation does. Further performance improvements could be done as a follow-up if required.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-629361873",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3341735555,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzM0MTczNTU1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3341735555",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:48:00Z"
    },
    {
      "event": "commented",
      "id": 629365265,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTM2NTI2NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629365265",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:48:25Z",
      "updated_at": "2020-05-15T16:48:25Z",
      "author_association": "MEMBER",
      "body": "Feedback from @narula and @jkczyz addressed. Thanks!",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-629365265",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "mentioned",
      "id": 3341737191,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzM0MTczNzE5MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3341737191",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:48:25Z"
    },
    {
      "event": "subscribed",
      "id": 3341737197,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzNDE3MzcxOTc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3341737197",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:48:25Z"
    },
    {
      "event": "mentioned",
      "id": 3341737199,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzM0MTczNzE5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3341737199",
      "actor": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:48:25Z"
    },
    {
      "event": "subscribed",
      "id": 3341737201,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzNDE3MzcyMDE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3341737201",
      "actor": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T16:48:25Z"
    },
    {
      "event": "commented",
      "id": 629397391,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTM5NzM5MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629397391",
      "actor": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T17:55:23Z",
      "updated_at": "2020-05-15T17:55:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK b6eba9e492e1dfb38baec894bfda1cfb4d709e5d\r\n\r\nRan all tests.",
      "user": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-629397391",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "commented",
      "id": 629439397,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTQzOTM5Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629439397",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-15T19:30:33Z",
      "updated_at": "2020-05-15T19:30:33Z",
      "author_association": "MEMBER",
      "body": "utACK b6eba9e492e1dfb38baec894bfda1cfb4d709e5d",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-629439397",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "reviewed",
      "id": 413149842,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMTQ5ODQy",
      "url": null,
      "actor": null,
      "commit_id": "b6eba9e492e1dfb38baec894bfda1cfb4d709e5d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#pullrequestreview-413149842",
      "submitted_at": "2020-05-17T10:51:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3348239341,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzM0ODIzOTM0MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3348239341",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-18T16:53:01Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzowMTg3ZDRjMTE4YWI0YzBmNWMyZDRmYjE4MGMyYThkZWE4YWM1M2Nm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "tree": {
        "sha": "606fe9d9496a2270afefe0f7ac7ffe6513f07614",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/606fe9d9496a2270afefe0f7ac7ffe6513f07614"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8da1e43b63cb36759eeb1fcfd6768163265c44e2",
          "sha": "8da1e43b63cb36759eeb1fcfd6768163265c44e2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8da1e43b63cb36759eeb1fcfd6768163265c44e2"
        }
      ],
      "message": "[indexes] Add compact block filter headers cache\n\nCache block filter headers at heights of multiples of 1000 in memory.\n\nBlock filter headers at height 1000x are checkpointed, and will be the\nmost frequently requested. Cache them in memory to avoid costly disk\nreads.",
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2020-05-18T16:54:07Z"
      },
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2020-05-11T02:28:21Z"
      },
      "sha": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3348243886,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzM0ODI0Mzg4Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3348243886",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-18T16:54:14Z"
    },
    {
      "event": "commented",
      "id": 630310732,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzMDMxMDczMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630310732",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-18T16:55:26Z",
      "updated_at": "2020-05-18T16:55:26Z",
      "author_association": "MEMBER",
      "body": "Thanks for the rereview @jkczyz and @theStack , and for catching the problems with checking checkpoint heights. Should be fixed now.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-630310732",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "mentioned",
      "id": 3348248630,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzM0ODI0ODYzMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3348248630",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-18T16:55:26Z"
    },
    {
      "event": "subscribed",
      "id": 3348248631,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzNDgyNDg2MzE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3348248631",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-18T16:55:26Z"
    },
    {
      "event": "mentioned",
      "id": 3348248640,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzM0ODI0ODY0MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3348248640",
      "actor": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-18T16:55:26Z"
    },
    {
      "event": "subscribed",
      "id": 3348248645,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzNDgyNDg2NDU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3348248645",
      "actor": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-18T16:55:26Z"
    },
    {
      "event": "commented",
      "id": 630325155,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzMDMyNTE1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630325155",
      "actor": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-18T17:22:26Z",
      "updated_at": "2020-05-18T17:22:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "user": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-630325155",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "renamed",
      "id": 3348695368,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50MzM0ODY5NTM2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3348695368",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-18T18:58:59Z",
      "rename": {
        "from": "[indexes] Add compact block filter headers cache",
        "to": "indexes: Add compact block filter headers cache"
      }
    },
    {
      "event": "commented",
      "id": 630706114,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzMDcwNjExNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630706114",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-19T09:33:31Z",
      "updated_at": "2020-05-19T09:33:31Z",
      "author_association": "MEMBER",
      "body": "ACK 0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf :tada: \r\n\r\nBy the way, I'm neutral to the question on whether to use `std::map` or `std::unordered_map` for the cache -- `std::unordered_map` does indeed seem to lead to some performance improvement (my tests show a rough 10% improvement, see numbers below; [jnewberys tests](https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-629361873) show an even higher improvement of close to 20%), but on the other hand takes both more space (as [pointed out by MarcoFalke](https://github.com/bitcoin/bitcoin/pull/18960#discussion_r425708660)) and also more code due to the need to provide a hash function. Maybe someone has a more clear opinion on the choice, personally I'm okay with ACKing either version.\r\n\r\nTest with `std::map`:\r\n```\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 13817us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 2855us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 3573us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 3444us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 3236us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 3385us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 3543us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 3378us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 3450us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 3041us\r\n2020-05-19T09:09:01Z getcfcheckpt processing took 3561us\r\n...\r\n```\r\n:arrow_right: Average subsequent lookup: 3,346ms\r\n\r\nTest with `std::unordered_map`:\r\n```\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 12205us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 3650us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 4660us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 3393us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 3669us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 2919us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 2565us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 2804us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 2348us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 2511us\r\n2020-05-19T08:59:53Z getcfcheckpt processing took 2264us\r\n...\r\n```\r\n:arrow_right: Average subsequent lookup: 3,078ms",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-630706114",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "commented",
      "id": 630843553,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzMDg0MzU1Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630843553",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-19T14:08:37Z",
      "updated_at": "2020-05-19T14:08:37Z",
      "author_association": "MEMBER",
      "body": "re-utACK 0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf\r\n\r\nCompared to my last review `is_checkpoint` variable is introduced for better readability and if statement that was removed in error is added back: https://github.com/bitcoin/bitcoin/compare/b6eba9e492e1dfb38baec894bfda1cfb4d709e5d..0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-630843553",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "reviewed",
      "id": 415819860,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1ODE5ODYw",
      "url": null,
      "actor": null,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code Review ACK 0187d4c.\r\n\r\nI prefer this approach of caching inside index instead of net_processing compare to #16442, it reduces cognitive load. I also assent with ignoring reorg as argued, probability of the event is rare enough and overhead cheap enough to justify having some junk in cache. ",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#pullrequestreview-415819860",
      "submitted_at": "2020-05-21T01:29:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
    },
    {
      "event": "commented",
      "id": 632242849,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzMjI0Mjg0OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/632242849",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-21T17:34:20Z",
      "updated_at": "2020-05-21T17:34:20Z",
      "author_association": "MEMBER",
      "body": "code review ACK 0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#issuecomment-632242849",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18960"
    },
    {
      "event": "merged",
      "id": 3361616141,
      "node_id": "MDExOk1lcmdlZEV2ZW50MzM2MTYxNjE0MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3361616141",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "4479eb04d92806633aa3ad3e413f6a7166863638",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4479eb04d92806633aa3ad3e413f6a7166863638",
      "created_at": "2020-05-21T17:35:02Z"
    },
    {
      "event": "closed",
      "id": 3361616154,
      "node_id": "MDExOkNsb3NlZEV2ZW50MzM2MTYxNjE1NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3361616154",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-21T17:35:02Z"
    },
    {
      "event": "removed_from_project",
      "id": 3361657384,
      "node_id": "MDIzOlJlbW92ZWRGcm9tUHJvamVjdEV2ZW50MzM2MTY1NzM4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3361657384",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-21T17:46:59Z",
      "project_card": {
        "id": 38241777,
        "url": "https://api.github.com/projects/columns/cards/38241777",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "head_ref_deleted",
      "id": 3361801611,
      "node_id": "MDE5OkhlYWRSZWZEZWxldGVkRXZlbnQzMzYxODAxNjEx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3361801611",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-21T18:30:20Z"
    },
    {
      "event": "referenced",
      "id": 3361906446,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDMzNjE5MDY0NDY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3361906446",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ba41194e480ff77c2238e926cf61e2d9d62cd8a4",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/ba41194e480ff77c2238e926cf61e2d9d62cd8a4",
      "created_at": "2020-05-21T19:01:14Z"
    },
    {
      "event": "referenced",
      "id": 4016963278,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQwMTY5NjMyNzg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4016963278",
      "actor": {
        "login": "jasonbcox",
        "id": 602513,
        "node_id": "MDQ6VXNlcjYwMjUxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/602513?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jasonbcox",
        "html_url": "https://github.com/jasonbcox",
        "followers_url": "https://api.github.com/users/jasonbcox/followers",
        "following_url": "https://api.github.com/users/jasonbcox/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jasonbcox/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jasonbcox/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jasonbcox/subscriptions",
        "organizations_url": "https://api.github.com/users/jasonbcox/orgs",
        "repos_url": "https://api.github.com/users/jasonbcox/repos",
        "events_url": "https://api.github.com/users/jasonbcox/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jasonbcox/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a4c5ff8ec7a29fc81dbd13e2c0a34305ff4eddd9",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/a4c5ff8ec7a29fc81dbd13e2c0a34305ff4eddd9",
      "created_at": "2020-11-19T17:08:34Z"
    },
    {
      "event": "referenced",
      "id": 5191065237,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxOTEwNjUyMzc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5191065237",
      "actor": {
        "login": "kittywhiskers",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kittywhiskers",
        "html_url": "https://github.com/kittywhiskers",
        "followers_url": "https://api.github.com/users/kittywhiskers/followers",
        "following_url": "https://api.github.com/users/kittywhiskers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kittywhiskers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kittywhiskers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kittywhiskers/subscriptions",
        "organizations_url": "https://api.github.com/users/kittywhiskers/orgs",
        "repos_url": "https://api.github.com/users/kittywhiskers/repos",
        "events_url": "https://api.github.com/users/kittywhiskers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kittywhiskers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "3dfe7bd4d565f290b85c85122e29da79fff180d9",
      "commit_url": "https://api.github.com/repos/kittywhiskers/dash/commits/3dfe7bd4d565f290b85c85122e29da79fff180d9",
      "created_at": "2021-08-22T17:22:44Z"
    },
    {
      "event": "referenced",
      "id": 5191067247,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxOTEwNjcyNDc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5191067247",
      "actor": {
        "login": "kittywhiskers",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kittywhiskers",
        "html_url": "https://github.com/kittywhiskers",
        "followers_url": "https://api.github.com/users/kittywhiskers/followers",
        "following_url": "https://api.github.com/users/kittywhiskers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kittywhiskers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kittywhiskers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kittywhiskers/subscriptions",
        "organizations_url": "https://api.github.com/users/kittywhiskers/orgs",
        "repos_url": "https://api.github.com/users/kittywhiskers/repos",
        "events_url": "https://api.github.com/users/kittywhiskers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kittywhiskers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "bd73a6b004c68614a1f00297ba3adf7cf34e5527",
      "commit_url": "https://api.github.com/repos/kittywhiskers/dash/commits/bd73a6b004c68614a1f00297ba3adf7cf34e5527",
      "created_at": "2021-08-22T17:25:11Z"
    },
    {
      "event": "referenced",
      "id": 5312845423,
      "node_id": "REFE_lADOABII584kwpDgzwAAAAE8q5Zv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5312845423",
      "actor": {
        "login": "kittywhiskers",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kittywhiskers",
        "html_url": "https://github.com/kittywhiskers",
        "followers_url": "https://api.github.com/users/kittywhiskers/followers",
        "following_url": "https://api.github.com/users/kittywhiskers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kittywhiskers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kittywhiskers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kittywhiskers/subscriptions",
        "organizations_url": "https://api.github.com/users/kittywhiskers/orgs",
        "repos_url": "https://api.github.com/users/kittywhiskers/repos",
        "events_url": "https://api.github.com/users/kittywhiskers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kittywhiskers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "26f05134c8336b52bbbc5add3de9bc91aab25d8a",
      "commit_url": "https://api.github.com/repos/kittywhiskers/dash/commits/26f05134c8336b52bbbc5add3de9bc91aab25d8a",
      "created_at": "2021-09-16T14:03:44Z"
    },
    {
      "event": "referenced",
      "id": 5322318615,
      "node_id": "REFE_lADOABII584kwpDgzwAAAAE9PCMX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5322318615",
      "actor": {
        "login": "kittywhiskers",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kittywhiskers",
        "html_url": "https://github.com/kittywhiskers",
        "followers_url": "https://api.github.com/users/kittywhiskers/followers",
        "following_url": "https://api.github.com/users/kittywhiskers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kittywhiskers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kittywhiskers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kittywhiskers/subscriptions",
        "organizations_url": "https://api.github.com/users/kittywhiskers/orgs",
        "repos_url": "https://api.github.com/users/kittywhiskers/repos",
        "events_url": "https://api.github.com/users/kittywhiskers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kittywhiskers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "b5c3500676568288dabdc93bec75af41d4458e83",
      "commit_url": "https://api.github.com/repos/kittywhiskers/dash/commits/b5c3500676568288dabdc93bec75af41d4458e83",
      "created_at": "2021-09-18T04:14:06Z"
    },
    {
      "event": "referenced",
      "id": 5324162790,
      "node_id": "REFE_lADOABII584kwpDgzwAAAAE9WEbm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5324162790",
      "actor": {
        "login": "kittywhiskers",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kittywhiskers",
        "html_url": "https://github.com/kittywhiskers",
        "followers_url": "https://api.github.com/users/kittywhiskers/followers",
        "following_url": "https://api.github.com/users/kittywhiskers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kittywhiskers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kittywhiskers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kittywhiskers/subscriptions",
        "organizations_url": "https://api.github.com/users/kittywhiskers/orgs",
        "repos_url": "https://api.github.com/users/kittywhiskers/repos",
        "events_url": "https://api.github.com/users/kittywhiskers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kittywhiskers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "5996dbe6869391f22868f6fbbf9e751279d03ac1",
      "commit_url": "https://api.github.com/repos/kittywhiskers/dash/commits/5996dbe6869391f22868f6fbbf9e751279d03ac1",
      "created_at": "2021-09-19T04:36:46Z"
    },
    {
      "event": "referenced",
      "id": 5335026610,
      "node_id": "REFE_lADOABII584kwpDgzwAAAAE9_guy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5335026610",
      "actor": {
        "login": "UdjinM6",
        "id": 1935069,
        "node_id": "MDQ6VXNlcjE5MzUwNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1935069?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/UdjinM6",
        "html_url": "https://github.com/UdjinM6",
        "followers_url": "https://api.github.com/users/UdjinM6/followers",
        "following_url": "https://api.github.com/users/UdjinM6/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/UdjinM6/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/UdjinM6/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/UdjinM6/subscriptions",
        "organizations_url": "https://api.github.com/users/UdjinM6/orgs",
        "repos_url": "https://api.github.com/users/UdjinM6/repos",
        "events_url": "https://api.github.com/users/UdjinM6/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/UdjinM6/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "4ffd42de635a8b6e81409bd47144a1816a23327a",
      "commit_url": "https://api.github.com/repos/dashpay/dash/commits/4ffd42de635a8b6e81409bd47144a1816a23327a",
      "created_at": "2021-09-21T12:05:15Z"
    },
    {
      "event": "referenced",
      "id": 5359186894,
      "node_id": "REFE_lADOABII584kwpDgzwAAAAE_brPO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5359186894",
      "actor": {
        "login": "thelazier",
        "id": 10759339,
        "node_id": "MDQ6VXNlcjEwNzU5MzM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/10759339?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/thelazier",
        "html_url": "https://github.com/thelazier",
        "followers_url": "https://api.github.com/users/thelazier/followers",
        "following_url": "https://api.github.com/users/thelazier/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/thelazier/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/thelazier/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/thelazier/subscriptions",
        "organizations_url": "https://api.github.com/users/thelazier/orgs",
        "repos_url": "https://api.github.com/users/thelazier/repos",
        "events_url": "https://api.github.com/users/thelazier/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/thelazier/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "853c6f587b15a9bd18d9d774725e5128819dd835",
      "commit_url": "https://api.github.com/repos/thelazier/dash/commits/853c6f587b15a9bd18d9d774725e5128819dd835",
      "created_at": "2021-09-25T05:24:09Z"
    },
    {
      "event": "referenced",
      "id": 5446824465,
      "node_id": "REFE_lADOABII584kwpDgzwAAAAFEp_IR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5446824465",
      "actor": {
        "login": "kittywhiskers",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kittywhiskers",
        "html_url": "https://github.com/kittywhiskers",
        "followers_url": "https://api.github.com/users/kittywhiskers/followers",
        "following_url": "https://api.github.com/users/kittywhiskers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kittywhiskers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kittywhiskers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kittywhiskers/subscriptions",
        "organizations_url": "https://api.github.com/users/kittywhiskers/orgs",
        "repos_url": "https://api.github.com/users/kittywhiskers/repos",
        "events_url": "https://api.github.com/users/kittywhiskers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kittywhiskers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "6cedb20e18b1e9a0ee45f65b2018a5a066b87fe8",
      "commit_url": "https://api.github.com/repos/kittywhiskers/dash/commits/6cedb20e18b1e9a0ee45f65b2018a5a066b87fe8",
      "created_at": "2021-10-12T04:14:05Z"
    },
    {
      "event": "locked",
      "id": 6073789538,
      "node_id": "LOE_lADOABII584kwpDgzwAAAAFqBqxi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6073789538",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-15T10:31:19Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423819184",
      "pull_request_review_id": 410152048,
      "id": 423819184,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzgxOTE4NA==",
      "diff_hunk": "@@ -31,6 +31,8 @@ constexpr char DB_FILTER_POS = 'P';\n constexpr unsigned int MAX_FLTR_FILE_SIZE = 0x1000000; // 16 MiB\n /** The pre-allocation chunk size for fltr?????.dat files */\n constexpr unsigned int FLTR_FILE_CHUNK_SIZE = 0x100000; // 1 MiB\n+/** Maximum size of the cfheaders cache */\n+constexpr size_t CF_HEADERS_CACHE_MAX_SZ{2000};",
      "path": "src/index/blockfilterindex.cpp",
      "position": 9,
      "original_position": 5,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is there any particular reason for limiting the size of the cache? With this numbers it would be full at block 2000000, i.e. in (2000000-630000)/(6 * 24 * 365) ~ 26 years.",
      "created_at": "2020-05-12T15:18:56Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r423819184",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423819184"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 39,
      "original_line": 39,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424002630",
      "pull_request_review_id": 410383758,
      "id": 424002630,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwMjYzMA==",
      "diff_hunk": "@@ -31,6 +31,8 @@ constexpr char DB_FILTER_POS = 'P';\n constexpr unsigned int MAX_FLTR_FILE_SIZE = 0x1000000; // 16 MiB\n /** The pre-allocation chunk size for fltr?????.dat files */\n constexpr unsigned int FLTR_FILE_CHUNK_SIZE = 0x100000; // 1 MiB\n+/** Maximum size of the cfheaders cache */\n+constexpr size_t CF_HEADERS_CACHE_MAX_SZ{2000};",
      "path": "src/index/blockfilterindex.cpp",
      "position": 9,
      "original_position": 5,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 423819184,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I wanted to have some limit so that a bug doesn't turn into a memory exhaustion possibility (since we only ever add to this map, and never remove). I don't think the exact number matters. Presumably in 26 years, anyone who wants to serve compact block filters from a v0.21 Bitcoin Core server will be able to patch their own code.",
      "created_at": "2020-05-12T20:08:44Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424002630",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424002630"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 39,
      "original_line": 39,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424364005",
      "pull_request_review_id": 410830038,
      "id": 424364005,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM2NDAwNQ==",
      "diff_hunk": "@@ -31,6 +31,8 @@ constexpr char DB_FILTER_POS = 'P';\n constexpr unsigned int MAX_FLTR_FILE_SIZE = 0x1000000; // 16 MiB\n /** The pre-allocation chunk size for fltr?????.dat files */\n constexpr unsigned int FLTR_FILE_CHUNK_SIZE = 0x100000; // 1 MiB\n+/** Maximum size of the cfheaders cache */\n+constexpr size_t CF_HEADERS_CACHE_MAX_SZ{2000};",
      "path": "src/index/blockfilterindex.cpp",
      "position": 9,
      "original_position": 5,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 423819184,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I agree that when in doubt, it's better to be overcautious than risking introducing a memory exhaustion bug -- I just wanted to get sure there are no other reasons for the limit that I'm not aware of.",
      "created_at": "2020-05-13T11:26:57Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424364005",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424364005"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 39,
      "original_line": 39,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424406311",
      "pull_request_review_id": 410883693,
      "id": 424406311,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDQwNjMxMQ==",
      "diff_hunk": "@@ -30,6 +33,9 @@ class BlockFilterIndex final : public BaseIndex\n     bool ReadFilterFromDisk(const FlatFilePos& pos, BlockFilter& filter) const;\n     size_t WriteFilterToDisk(FlatFilePos& pos, const BlockFilter& filter);\n \n+    RecursiveMutex m_cs_headers_cache;",
      "path": "src/index/blockfilterindex.h",
      "position": null,
      "original_position": 14,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    Mutex m_cs_headers_cache;\r\n```\r\n\r\nnit (feel free to ignore). I haven't tested this, but from reading the code, a non-recursive mutex should be sufficient.",
      "created_at": "2020-05-13T12:43:33Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424406311",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424406311"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 36,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424507108",
      "pull_request_review_id": 411014712,
      "id": 424507108,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUwNzEwOA==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {\n+            m_headers_cache.emplace(block_index->GetBlockHash(), entry.header);",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is a very minor issue but if we use the hash instead of the height as the key we could end up with headers of orphaned blocks in the cache since they will not be overridden or removed. This could also be the case if `CFCHECKPT_INTERVAL` would ever change. I know the chances for that happening are slim and if it happens we can deal with it then, just wanted to put it there.",
      "created_at": "2020-05-13T14:59:39Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424507108",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424507108"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 414,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424637193",
      "pull_request_review_id": 411180373,
      "id": 424637193,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDYzNzE5Mw==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {\n+            m_headers_cache.emplace(block_index->GetBlockHash(), entry.header);",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424507108,
      "user": {
        "login": "clarkmoody",
        "id": 1562417,
        "node_id": "MDQ6VXNlcjE1NjI0MTc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1562417?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/clarkmoody",
        "html_url": "https://github.com/clarkmoody",
        "followers_url": "https://api.github.com/users/clarkmoody/followers",
        "following_url": "https://api.github.com/users/clarkmoody/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/clarkmoody/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/clarkmoody/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/clarkmoody/subscriptions",
        "organizations_url": "https://api.github.com/users/clarkmoody/orgs",
        "repos_url": "https://api.github.com/users/clarkmoody/repos",
        "events_url": "https://api.github.com/users/clarkmoody/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/clarkmoody/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The test suite explicitly checks that filters for stale blocks may still be fetched.\r\n\r\nhttps://github.com/jnewbery/bitcoin/blob/2020-05-cfcheckpts-cache/test/functional/p2p_blockfilters.py#L89-L101",
      "created_at": "2020-05-13T18:14:51Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424637193",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424637193"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 414,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424643299",
      "pull_request_review_id": 411187904,
      "id": 424643299,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0MzI5OQ==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": null,
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "doesn't this statically cap (and freeze forever) the cache after inserting 2000 entries? Wouldn't it make sense to have some sort of invalidation logic? (I can't come up with a good one though)",
      "created_at": "2020-05-13T18:24:51Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424643299",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424643299"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424648190",
      "pull_request_review_id": 411193878,
      "id": 424648190,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0ODE5MA==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424643299,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If someone can mine enough blocks to fill up this cache, we have other problems. I think an adversary needs to mine blocks in the order of the 2000th triangle number to fill this up.\r\n\r\nAnd when this cache is full due to natural reasons (in 20 years), disks will be fast enough that we won't need a cache.",
      "created_at": "2020-05-13T18:32:45Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424648190",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424648190"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424648698",
      "pull_request_review_id": 411194523,
      "id": 424648698,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0ODY5OA==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424643299,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe disks are fast enough or smart enough with caching today already, so it might not be needed after all. A benchmark would be nice...",
      "created_at": "2020-05-13T18:33:41Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424648698",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424648698"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424651189",
      "pull_request_review_id": 411197656,
      "id": 424651189,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY1MTE4OQ==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424643299,
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Oh. You'r right. \r\nI missed the `% CFCHECKPT_INTERVAL == 0`.",
      "created_at": "2020-05-13T18:38:10Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424651189",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424651189"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424680456",
      "pull_request_review_id": 411234636,
      "id": 424680456,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY4MDQ1Ng==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {\n+            m_headers_cache.emplace(block_index->GetBlockHash(), entry.header);",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424507108,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> we could end up with headers of orphaned blocks in the cache\r\n\r\nCorrect. If there's a re-org across checkpoint block, then the disconnect block's filter header stays in the cache. That's an explicit design decision, since:\r\n- the cost is very small (32 bytes for header + map overhead so < 100 bytes)\r\n- it's an infrequent event\r\n- it saves on the complexity of having to recalculate the cache on re-orgs (eg compare with https://github.com/bitcoin-core-review-club/bitcoin/commit/af3bddfbdfb7de06d6e63a0a425da483c435521a#diff-eff7adeaec73a769788bb78858815c91R1258)\r\n\r\n> if CFCHECKPT_INTERVAL would ever change\r\n\r\nIn that case, we'd need to change the software, which would involve a stop/start. This is an in-memory cache so gets dropped on shutdown.",
      "created_at": "2020-05-13T19:29:50Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424680456",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424680456"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 414,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424680741",
      "pull_request_review_id": 411235010,
      "id": 424680741,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY4MDc0MQ==",
      "diff_hunk": "@@ -30,6 +33,9 @@ class BlockFilterIndex final : public BaseIndex\n     bool ReadFilterFromDisk(const FlatFilePos& pos, BlockFilter& filter) const;\n     size_t WriteFilterToDisk(FlatFilePos& pos, const BlockFilter& filter);\n \n+    RecursiveMutex m_cs_headers_cache;",
      "path": "src/index/blockfilterindex.h",
      "position": null,
      "original_position": 14,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424406311,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agree. I'll change to `Mutex`.",
      "created_at": "2020-05-13T19:30:23Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424680741",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424680741"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 36,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424681368",
      "pull_request_review_id": 411235844,
      "id": 424681368,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY4MTM2OA==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424643299,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Remind me to change this to 4000 in 2026 :)\r\n\r\nI agree that a benchmark would be nice.",
      "created_at": "2020-05-13T19:31:36Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424681368",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424681368"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424682225",
      "pull_request_review_id": 411237025,
      "id": 424682225,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY4MjIyNQ==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424643299,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```cpp\r\n// TODO change to 4000 in 2026\r\n```\r\n\r\n;)",
      "created_at": "2020-05-13T19:33:17Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424682225",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424682225"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424685028",
      "pull_request_review_id": 411240539,
      "id": 424685028,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY4NTAyOA==",
      "diff_hunk": "@@ -387,13 +389,30 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    {\n+        // Check the headers cache\n+        LOCK(m_cs_headers_cache);\n+        auto header = m_headers_cache.find(block_index->GetBlockHash());\n+        if (header != m_headers_cache.end()) {\n+            header_out = header->second;\n+            return true;\n+        }\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    if (block_index->nHeight % CFCHECKPT_INTERVAL == 0) {\n+        // Add to the headers cache\n+        LOCK(m_cs_headers_cache);\n+        if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424643299,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "oops sorry, I meant 2046",
      "created_at": "2020-05-13T19:38:25Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424685028",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424685028"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424772712",
      "pull_request_review_id": 411349975,
      "id": 424772712,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3MjcxMg==",
      "diff_hunk": "@@ -30,6 +33,9 @@ class BlockFilterIndex final : public BaseIndex\n     bool ReadFilterFromDisk(const FlatFilePos& pos, BlockFilter& filter) const;\n     size_t WriteFilterToDisk(FlatFilePos& pos, const BlockFilter& filter);\n \n+    RecursiveMutex m_cs_headers_cache;",
      "path": "src/index/blockfilterindex.h",
      "position": null,
      "original_position": 14,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "6fe202209efe97d2f1f6ede8d679c38aa3fa7429",
      "in_reply_to_id": 424406311,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2020-05-13T22:44:08Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424772712",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424772712"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 36,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424888402",
      "pull_request_review_id": 411485876,
      "id": 424888402,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDg4ODQwMg==",
      "diff_hunk": "@@ -30,6 +33,9 @@ class BlockFilterIndex final : public BaseIndex\n     bool ReadFilterFromDisk(const FlatFilePos& pos, BlockFilter& filter) const;\n     size_t WriteFilterToDisk(FlatFilePos& pos, const BlockFilter& filter);\n \n+    Mutex m_cs_headers_cache;\n+    std::map<uint256, uint256> m_headers_cache GUARDED_BY(m_cs_headers_cache);",
      "path": "src/index/blockfilterindex.h",
      "position": null,
      "original_position": 15,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "7ad83ed252914d6d5b8ed81f103aecf052c68fb7",
      "in_reply_to_id": null,
      "user": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Any reason `std::unordered_map` can't be used? I see that the tree-based `std::map` and `std::set` are used primarily throughout the codebase, but figured it may just be historical. Is there another reason these are preferred?",
      "created_at": "2020-05-14T06:00:57Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r424888402",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424888402"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 37,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425526443",
      "pull_request_review_id": 412300367,
      "id": 425526443,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTUyNjQ0Mw==",
      "diff_hunk": "@@ -30,6 +33,9 @@ class BlockFilterIndex final : public BaseIndex\n     bool ReadFilterFromDisk(const FlatFilePos& pos, BlockFilter& filter) const;\n     size_t WriteFilterToDisk(FlatFilePos& pos, const BlockFilter& filter);\n \n+    Mutex m_cs_headers_cache;\n+    std::map<uint256, uint256> m_headers_cache GUARDED_BY(m_cs_headers_cache);",
      "path": "src/index/blockfilterindex.h",
      "position": null,
      "original_position": 15,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "7ad83ed252914d6d5b8ed81f103aecf052c68fb7",
      "in_reply_to_id": 424888402,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I expect mostly laziness. With an `unordered_map`, you need to provide a hash function. In this case, it's easy. The data is all hash digests from block chain data, so I can just take the first 8 bytes from the uint256 filter header.\r\n\r\nI'll make that change tomorrow.",
      "created_at": "2020-05-15T02:07:31Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r425526443",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425526443"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 37,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425708660",
      "pull_request_review_id": 412526565,
      "id": 425708660,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTcwODY2MA==",
      "diff_hunk": "@@ -30,6 +33,9 @@ class BlockFilterIndex final : public BaseIndex\n     bool ReadFilterFromDisk(const FlatFilePos& pos, BlockFilter& filter) const;\n     size_t WriteFilterToDisk(FlatFilePos& pos, const BlockFilter& filter);\n \n+    Mutex m_cs_headers_cache;\n+    std::map<uint256, uint256> m_headers_cache GUARDED_BY(m_cs_headers_cache);",
      "path": "src/index/blockfilterindex.h",
      "position": null,
      "original_position": 15,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "7ad83ed252914d6d5b8ed81f103aecf052c68fb7",
      "in_reply_to_id": 424888402,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Just as a reminder: There is no free lunch and unordered_map comes with a size penalty",
      "created_at": "2020-05-15T10:23:09Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r425708660",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425708660"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 37,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425907876",
      "pull_request_review_id": 412787017,
      "id": 425907876,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkwNzg3Ng==",
      "diff_hunk": "@@ -30,6 +33,9 @@ class BlockFilterIndex final : public BaseIndex\n     bool ReadFilterFromDisk(const FlatFilePos& pos, BlockFilter& filter) const;\n     size_t WriteFilterToDisk(FlatFilePos& pos, const BlockFilter& filter);\n \n+    Mutex m_cs_headers_cache;\n+    std::map<uint256, uint256> m_headers_cache GUARDED_BY(m_cs_headers_cache);",
      "path": "src/index/blockfilterindex.h",
      "position": null,
      "original_position": 15,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "7ad83ed252914d6d5b8ed81f103aecf052c68fb7",
      "in_reply_to_id": 424888402,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I've reimplemented this as an unordered_map",
      "created_at": "2020-05-15T16:17:09Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r425907876",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425907876"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 37,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425911921",
      "pull_request_review_id": 412792135,
      "id": 425911921,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkxMTkyMQ==",
      "diff_hunk": "@@ -31,6 +31,8 @@ constexpr char DB_FILTER_POS = 'P';\n constexpr unsigned int MAX_FLTR_FILE_SIZE = 0x1000000; // 16 MiB\n /** The pre-allocation chunk size for fltr?????.dat files */\n constexpr unsigned int FLTR_FILE_CHUNK_SIZE = 0x100000; // 1 MiB\n+/** Maximum size of the cfheaders cache */",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "4018953ee9d190188b0b10ef1463f7b64b4e59bb",
      "in_reply_to_id": null,
      "user": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: give justification in comments for magic numbers so future readers have some idea how this was chosen and if/when it will need to be adjusted.",
      "created_at": "2020-05-15T16:24:18Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r425911921",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425911921"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 34,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425918218",
      "pull_request_review_id": 412800070,
      "id": 425918218,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkxODIxOA==",
      "diff_hunk": "@@ -387,13 +389,25 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    LOCK(m_cs_headers_cache);\n+    auto header = m_headers_cache.find(block_index->GetBlockHash());\n+    if (header != m_headers_cache.end()) {\n+        header_out = header->second;\n+        return true;\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    // Add to the headers cache\n+    if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {\n+        m_headers_cache.emplace(block_index->GetBlockHash(), entry.header);\n+    }\n+",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "4018953ee9d190188b0b10ef1463f7b64b4e59bb",
      "in_reply_to_id": null,
      "user": {
        "login": "jkczyz",
        "id": 4015903,
        "node_id": "MDQ6VXNlcjQwMTU5MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4015903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jkczyz",
        "html_url": "https://github.com/jkczyz",
        "followers_url": "https://api.github.com/users/jkczyz/followers",
        "following_url": "https://api.github.com/users/jkczyz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jkczyz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jkczyz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jkczyz/subscriptions",
        "organizations_url": "https://api.github.com/users/jkczyz/orgs",
        "repos_url": "https://api.github.com/users/jkczyz/repos",
        "events_url": "https://api.github.com/users/jkczyz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jkczyz/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You'll still want to condition this on `block_index->nHeight % CFCHECKPT_INTERVAL == 0`, otherwise the most recent 2000 requested headers will be cached rather than the desired ones.",
      "created_at": "2020-05-15T16:34:43Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r425918218",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425918218"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": 406,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 421,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425918731",
      "pull_request_review_id": 412800738,
      "id": 425918731,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkxODczMQ==",
      "diff_hunk": "@@ -387,13 +389,25 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    LOCK(m_cs_headers_cache);\n+    auto header = m_headers_cache.find(block_index->GetBlockHash());\n+    if (header != m_headers_cache.end()) {\n+        header_out = header->second;\n+        return true;\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    // Add to the headers cache\n+    if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {\n+        m_headers_cache.emplace(block_index->GetBlockHash(), entry.header);\n+    }\n+",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "4018953ee9d190188b0b10ef1463f7b64b4e59bb",
      "in_reply_to_id": 425918218,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "yikes. Thanks",
      "created_at": "2020-05-15T16:35:39Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r425918731",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425918731"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": 406,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 421,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425925522",
      "pull_request_review_id": 412809145,
      "id": 425925522,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkyNTUyMg==",
      "diff_hunk": "@@ -31,6 +31,8 @@ constexpr char DB_FILTER_POS = 'P';\n constexpr unsigned int MAX_FLTR_FILE_SIZE = 0x1000000; // 16 MiB\n /** The pre-allocation chunk size for fltr?????.dat files */\n constexpr unsigned int FLTR_FILE_CHUNK_SIZE = 0x100000; // 1 MiB\n+/** Maximum size of the cfheaders cache */",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "4018953ee9d190188b0b10ef1463f7b64b4e59bb",
      "in_reply_to_id": 425911921,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2020-05-15T16:48:01Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r425925522",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425925522"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 34,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425925547",
      "pull_request_review_id": 412809181,
      "id": 425925547,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkyNTU0Nw==",
      "diff_hunk": "@@ -387,13 +389,25 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    LOCK(m_cs_headers_cache);\n+    auto header = m_headers_cache.find(block_index->GetBlockHash());\n+    if (header != m_headers_cache.end()) {\n+        header_out = header->second;\n+        return true;\n+    }\n+\n     DBVal entry;\n     if (!LookupOne(*m_db, block_index, entry)) {\n         return false;\n     }\n \n+    // Add to the headers cache\n+    if (m_headers_cache.size() < CF_HEADERS_CACHE_MAX_SZ) {\n+        m_headers_cache.emplace(block_index->GetBlockHash(), entry.header);\n+    }\n+",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "4018953ee9d190188b0b10ef1463f7b64b4e59bb",
      "in_reply_to_id": 425918218,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2020-05-15T16:48:05Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r425925547",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425925547"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": 406,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 421,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426246248",
      "pull_request_review_id": 413149842,
      "id": 426246248,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI0NjI0OA==",
      "diff_hunk": "@@ -387,13 +393,26 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    LOCK(m_cs_headers_cache);\n+    auto header = m_headers_cache.find(block_index->GetBlockHash());",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "b6eba9e492e1dfb38baec894bfda1cfb4d709e5d",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Before the last change, the cache lookup only happened for checkpoint blocks (i.e. block number modulo 1000 is zero). Is this removal of the condition intended?",
      "created_at": "2020-05-17T10:49:38Z",
      "updated_at": "2020-05-18T16:54:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r426246248",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426246248"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 399,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426766679",
      "pull_request_review_id": 413774709,
      "id": 426766679,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc2NjY3OQ==",
      "diff_hunk": "@@ -387,13 +393,26 @@ bool BlockFilterIndex::LookupFilter(const CBlockIndex* block_index, BlockFilter&\n     return ReadFilterFromDisk(entry.pos, filter_out);\n }\n \n-bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out) const\n+bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint256& header_out)\n {\n+    LOCK(m_cs_headers_cache);\n+    auto header = m_headers_cache.find(block_index->GetBlockHash());",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "b6eba9e492e1dfb38baec894bfda1cfb4d709e5d",
      "in_reply_to_id": 426246248,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No. Not intentional. I just messed up splitting out the `LOCK(m_cs_headers_cache)`. Thanks for catching this.",
      "created_at": "2020-05-18T16:54:54Z",
      "updated_at": "2020-05-18T16:54:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r426766679",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426766679"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 399,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428395728",
      "pull_request_review_id": 415819860,
      "id": 428395728,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM5NTcyOA==",
      "diff_hunk": "@@ -30,6 +38,9 @@ class BlockFilterIndex final : public BaseIndex\n     bool ReadFilterFromDisk(const FlatFilePos& pos, BlockFilter& filter) const;\n     size_t WriteFilterToDisk(FlatFilePos& pos, const BlockFilter& filter);\n \n+    Mutex m_cs_headers_cache;\n+    std::unordered_map<uint256, uint256, FilterHeaderHasher> m_headers_cache GUARDED_BY(m_cs_headers_cache);",
      "path": "src/index/blockfilterindex.h",
      "position": 20,
      "original_position": 20,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If you have to change PR again, you may comment that key value is block hash and mapped value filter-header, type being the same it may be confusing at first look.",
      "created_at": "2020-05-21T01:25:22Z",
      "updated_at": "2020-05-21T01:29:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r428395728",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428395728"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 42,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428714115",
      "pull_request_review_id": 416230929,
      "id": 428714115,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODcxNDExNQ==",
      "diff_hunk": "@@ -30,6 +38,9 @@ class BlockFilterIndex final : public BaseIndex\n     bool ReadFilterFromDisk(const FlatFilePos& pos, BlockFilter& filter) const;\n     size_t WriteFilterToDisk(FlatFilePos& pos, const BlockFilter& filter);\n \n+    Mutex m_cs_headers_cache;\n+    std::unordered_map<uint256, uint256, FilterHeaderHasher> m_headers_cache GUARDED_BY(m_cs_headers_cache);",
      "path": "src/index/blockfilterindex.h",
      "position": 20,
      "original_position": 20,
      "commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "original_commit_id": "0187d4c118ab4c0f5c2d4fb180c2a8dea8ac53cf",
      "in_reply_to_id": 428395728,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point. I'll add a comment if I need to retouch the branch.",
      "created_at": "2020-05-21T15:06:27Z",
      "updated_at": "2020-05-21T15:06:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/18960#discussion_r428714115",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428714115"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18960"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 42,
      "original_line": 42,
      "side": "RIGHT"
    }
  ]
}