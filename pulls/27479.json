{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479",
    "id": 1317409075,
    "node_id": "PR_kwDOABII585OhhEz",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/27479",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/27479.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/27479.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27479",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27479/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/c5c91e4c901c0a6873284b0572b78f80427eef9a",
    "number": 27479,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "BIP324: ElligatorSwift integrations",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This replaces #23432 and part of #23561.\r\n\r\nThis PR introduces all of the ElligatorSwift-related changes (libsecp256k1 updates, generation, decoding, ECDH, tests, fuzzing, benchmarks) needed for BIP324.\r\n\r\nElligatorSwift is a special 64-byte encoding format for public keys introduced in libsecp256k1 in https://github.com/bitcoin-core/secp256k1/pull/1129. It has the property that *every* 64-byte array is a valid encoding for some public key, and every key has approximately $2^{256}$ encodings. Furthermore, it is possible to efficiently generate a uniformly random encoding for a given public key or private key. This is used for the key exchange phase in BIP324, to achieve a byte stream that is entirely pseudorandom, even before the shared encryption key is established.",
    "labels": [],
    "created_at": "2023-04-17T22:17:40Z",
    "updated_at": "2023-06-05T23:21:28Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "eb8eccd7e9ff36acbfeb9ab39f912fbbf49405d7",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "sipa:202304_bip324_ellswift",
      "ref": "202304_bip324_ellswift",
      "sha": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 1458655,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDU4NjU1",
        "name": "bitcoin",
        "full_name": "sipa/bitcoin",
        "owner": {
          "login": "sipa",
          "id": 548488,
          "node_id": "MDQ6VXNlcjU0ODQ4OA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/sipa",
          "html_url": "https://github.com/sipa",
          "followers_url": "https://api.github.com/users/sipa/followers",
          "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
          "organizations_url": "https://api.github.com/users/sipa/orgs",
          "repos_url": "https://api.github.com/users/sipa/repos",
          "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/sipa/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/sipa/bitcoin",
        "description": "Bitcoin integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/sipa/bitcoin",
        "archive_url": "https://api.github.com/repos/sipa/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/sipa/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/sipa/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/sipa/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/sipa/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/sipa/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/sipa/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/sipa/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/sipa/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/sipa/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/sipa/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/sipa/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/sipa/bitcoin/events",
        "forks_url": "https://api.github.com/repos/sipa/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/sipa/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/sipa/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/sipa/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/sipa/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/sipa/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/sipa/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/sipa/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/sipa/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/sipa/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/sipa/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/sipa/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/sipa/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/sipa/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/sipa/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/sipa/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:sipa/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/sipa/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/sipa/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/sipa/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/sipa/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/sipa/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/sipa/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/sipa/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/sipa/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/sipa/bitcoin/hooks",
        "svn_url": "https://github.com/sipa/bitcoin",
        "homepage": "http://www.bitcoin.org",
        "language": "TypeScript",
        "forks_count": 20,
        "stargazers_count": 81,
        "watchers_count": 81,
        "size": 215860,
        "default_branch": "lows",
        "open_issues_count": 16,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T11:52:48Z",
        "created_at": "2011-03-09T10:46:59Z",
        "updated_at": "2023-04-30T00:52:17Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "9d85c03620bf660cfa7d13080f5c0b191579cbc3",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34325,
        "stargazers_count": 69819,
        "watchers_count": 69819,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 626,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T07:29:24Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T07:34:31Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 3802,
    "deletions": 1045,
    "changed_files": 81,
    "commits": 9,
    "review_comments": 17,
    "comments": 3
  },
  "events": [
    {
      "event": "commented",
      "id": 1512159343,
      "node_id": "IC_kwDOABII585aIbhv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1512159343",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-17T22:17:43Z",
      "updated_at": "2023-06-05T23:21:28Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [theStack](https://github.com/bitcoin/bitcoin/pull/27479#pullrequestreview-1396744957) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27827](https://github.com/bitcoin/bitcoin/pull/27827) ([Silent Payments]: Base functionality by josibake)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#issuecomment-1512159343",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27479"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9029689837,
      "node_id": "HRFPE_lADOABII585jqXTIzwAAAAIaNiHt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9029689837",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-17T22:32:57Z"
    },
    {
      "event": "commented",
      "id": 1512175200,
      "node_id": "IC_kwDOABII585aIfZg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1512175200",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-17T22:34:59Z",
      "updated_at": "2023-04-17T22:35:44Z",
      "author_association": "MEMBER",
      "body": "I'm in the process of taking over the BIP324 PRs from @dhruv.\r\n\r\nNote for reviewers:\r\n* Previously, the EllSwift encoding/decoding/creation was in #23432, while the ECDH logic was in #23561. I've opted here to merge all EllSwift-related functionality into 1 PR, as the integration is now tighter at the libsecp256k1 too compared to when the PRs were first opened (libsecp256k1 has functions for directly performing ECDH on the EllSwift-encoded keys).\r\n* `EllSwiftPubKey` is now a proper class that exposes a few utility functions, and only read-only access to the encoding.\r\n* Introduction of `FastRandomContext::fillrand` to fill `Span<std::byte>` with randomness.\r\n* Extended `UCharCast` to support `std::byte*` -> `unsigned char*` conversion, which removes the need for lots of `reinterpret_cast`s.\r\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#issuecomment-1512175200",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27479"
    },
    {
      "event": "mentioned",
      "id": 9029699100,
      "node_id": "MEE_lADOABII585jqXTIzwAAAAIaNkYc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9029699100",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-17T22:34:59Z"
    },
    {
      "event": "subscribed",
      "id": 9029699110,
      "node_id": "SE_lADOABII585jqXTIzwAAAAIaNkYm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9029699110",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-17T22:34:59Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9036034885,
      "node_id": "HRFPE_lADOABII585jqXTIzwAAAAIalvNF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9036034885",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-18T13:35:38Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9037892205,
      "node_id": "HRFPE_lADOABII585jqXTIzwAAAAIas0pt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9037892205",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-18T16:17:01Z"
    },
    {
      "event": "labeled",
      "id": 9046390027,
      "node_id": "LE_lADOABII585jqXTIzwAAAAIbNPUL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9046390027",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-19T13:04:29Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1392091186,
      "node_id": "PRR_kwDOABII585S-aAy",
      "url": null,
      "actor": null,
      "commit_id": "d859de66014f4a9b5a976604c6cbac88f0e4e93a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#pullrequestreview-1392091186",
      "submitted_at": "2023-04-19T14:04:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9049898423,
      "node_id": "HRFPE_lADOABII585jqXTIzwAAAAIban23",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9049898423",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-19T18:54:44Z"
    },
    {
      "event": "unlabeled",
      "id": 9050439754,
      "node_id": "UNLE_lADOABII585jqXTIzwAAAAIbcsBK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9050439754",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-19T20:02:22Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1393040022,
      "node_id": "PRR_kwDOABII585TCBqW",
      "url": null,
      "actor": null,
      "commit_id": "37d31e334f80f21d612b120418e19c3ac48962e0",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#pullrequestreview-1393040022",
      "submitted_at": "2023-04-20T00:46:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9058598238,
      "node_id": "HRFPE_lADOABII585jqXTIzwAAAAIb7z1e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9058598238",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-20T15:09:43Z"
    },
    {
      "event": "reviewed",
      "id": 1396744957,
      "node_id": "PRR_kwDOABII585TQKL9",
      "url": null,
      "actor": null,
      "commit_id": "818acac23295d526d9f85f0218949c817f5df964",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code-review ACK 818acac23295d526d9f85f0218949c817f5df964 (starting from commit fd04a2baec77b97cfb36ec488cec58811ea1ad45; didn't review any of the secp256k1 changes introduced in https://github.com/bitcoin-core/secp256k1/pull/1129)",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#pullrequestreview-1396744957",
      "submitted_at": "2023-04-22T14:14:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
    },
    {
      "event": "reviewed",
      "id": 1413629831,
      "node_id": "PRR_kwDOABII585UQkeH",
      "url": null,
      "actor": null,
      "commit_id": "818acac23295d526d9f85f0218949c817f5df964",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Looking good, have not reviewed the secp PRs yet",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#pullrequestreview-1413629831",
      "submitted_at": "2023-05-04T18:15:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
    },
    {
      "event": "subscribed",
      "id": 9182770979,
      "node_id": "SE_lADOABII585jqXTIzwAAAAIjVfcj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9182770979",
      "actor": {
        "login": "ExperiBass",
        "id": 33764485,
        "node_id": "MDQ6VXNlcjMzNzY0NDg1",
        "avatar_url": "https://avatars.githubusercontent.com/u/33764485?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ExperiBass",
        "html_url": "https://github.com/ExperiBass",
        "followers_url": "https://api.github.com/users/ExperiBass/followers",
        "following_url": "https://api.github.com/users/ExperiBass/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ExperiBass/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ExperiBass/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ExperiBass/subscriptions",
        "organizations_url": "https://api.github.com/users/ExperiBass/orgs",
        "repos_url": "https://api.github.com/users/ExperiBass/repos",
        "events_url": "https://api.github.com/users/ExperiBass/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ExperiBass/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-06T15:10:14Z"
    },
    {
      "event": "labeled",
      "id": 9191623892,
      "node_id": "LE_lADOABII585jqXTIzwAAAAIj3QzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9191623892",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-08T15:20:51Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGI0ZWI2NDRiNmNiYTA4MjA4MTJmZTYyNDhkZjljODQ0MDIxZWJmNTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b4eb644b6cba0820812fe6248df9c844021ebf50",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b4eb644b6cba0820812fe6248df9c844021ebf50",
      "tree": {
        "sha": "20dcc634d14dfeb9f0b4f5ae05553e5278facaa9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/20dcc634d14dfeb9f0b4f5ae05553e5278facaa9"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c981671e9b206de4681a2e0d06996b800fcc985b",
          "sha": "c981671e9b206de4681a2e0d06996b800fcc985b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c981671e9b206de4681a2e0d06996b800fcc985b"
        }
      ],
      "message": "Squashed 'src/secp256k1/' changes from 4258c54f4eb..a91ad4864dc\n\na91ad4864dc Add doc/ellswift.md with ElligatorSwift explanation\n874134adaa8 Add ellswift testing to CI\ne616ba578dd Add benchmarks for ellswift module\n0ef5317416a Add ctime tests for ellswift module\n4c758e426ea Add _prefix and _bip324 ellswift_xdh hash functions\n6048c780b2f Add tests for ellswift module\n1c369b8e718 Add ellswift module implementing ElligatorSwift\n8576bad51d3 Add functions to test if X coordinate is valid\n8ae11550d54 Add benchmark for key generation\n3353d3c7533 Merge bitcoin-core/secp256k1#1207: Split fe_set_b32 into reducing and normalizing variants\n5b32602295f Split fe_set_b32 into reducing and normalizing variants\n006ddc1f428 Merge bitcoin-core/secp256k1#1306: build: Make tests work with external default callbacks\n1907f0f1664 build: Make tests work with external default callbacks\nfb3a8063657 Merge bitcoin-core/secp256k1#1133: schnorrsig: Add test vectors for variable-length messages\ncd54ac7c1cc schnorrsig: Improve docs of schnorrsig_sign_custom\n28687b03128 schnorrsig: Add BIP340 varlen test vectors\n97a98bed1ed schnorrsig: Refactor test vector code to allow varlen messages\nab5a9171286 Merge bitcoin-core/secp256k1#1303: ct: Use more volatile\n9eb6934f696 Merge bitcoin-core/secp256k1#1305: Remove unused scratch space from API\n073d98a0760 Merge bitcoin-core/secp256k1#1292: refactor: Make 64-bit shift explicit\n17fa21733aa ct: Be cautious and use volatile trick in more \"conditional\" paths\n5fb336f9ce7 ct: Use volatile trick in scalar_cond_negate\n712e7f8722e Remove unused scratch space from API\n54d34b6c248 Merge bitcoin-core/secp256k1#1300: Avoid normalize conditional on VERIFY\nc63ec88ebf9 Merge bitcoin-core/secp256k1#1066: Abstract out and merge all the magnitude/normalized logic\n7fc642fa25a Simplify secp256k1_fe_{impl_,}verify\n4e176ad5b94 Abstract out verify logic for fe_is_square_var\n4371f98346b Abstract out verify logic for fe_add_int\n89e324c6b9d Abstract out verify logic for fe_half\n283cd80ab47 Abstract out verify logic for fe_get_bounds\nd5aa2f03580 Abstract out verify logic for fe_inv{,_var}\n31676460725 Abstract out verify logic for fe_from_storage\n76d31e5047c Abstract out verify logic for fe_to_storage\n1e6894bdd74 Abstract out verify logic for fe_cmov\nbe82bd8e034 Improve comments/checks for fe_sqrt\n6ab35082efe Abstract out verify logic for fe_sqr\n4c25f6efbd5 Abstract out verify logic for fe_mul\ne179e651cbb Abstract out verify logic for fe_add\n7e7ad7ff570 Abstract out verify logic for fe_mul_int\n65d82a34452 Abstract out verify logic for fe_negate\n144670893ec Abstract out verify logic for fe_get_b32\nf7a7666aeb8 Abstract out verify logic for fe_set_b32\nce4d2093e86 Abstract out verify logic for fe_cmp_var\n7d7d43c6dd2 Improve comments/check for fe_equal{,_var}\nc5e788d672d Abstract out verify logic for fe_is_odd\nd3f3fe8616d Abstract out verify logic for fe_is_zero\nc701d9a4719 Abstract out verify logic for fe_clear\n19a2bfeeeac Abstract out verify logic for fe_set_int\n864f9db491b Abstract out verify logic for fe_normalizes_to_zero{,_var}\n6c31371120b Abstract out verify logic for fe_normalize_var\ne28b51f5225 Abstract out verify logic for fe_normalize_weak\nb6b6f9cb97f Abstract out verify logic for fe_normalize\n7fa51955592 Bugfix: correct SECP256K1_FE_CONST mag/norm fields\nb29566c51b2 Merge magnitude/normalized fields, move/improve comments\n97c63b90390 Avoid normalize conditional on VERIFY\n341cc197264 Merge bitcoin-core/secp256k1#1299: Infinity handling: ecmult_const(infinity) works, and group verification\nbbc834467c5 Avoid secp256k1_ge_set_gej_zinv with uninitialized z\n0a2e0b2ae45 Make secp256k1_{fe,ge,gej}_verify work as no-op if non-VERIFY\nf20266722ac Add invariant checking to group elements\na18821d5b1d Always initialize output coordinates in secp256k1_ge_set_gej\n3086cb90acd Expose secp256k1_fe_verify to other modules\na0e696fd4da Make secp256k1_ecmult_const handle infinity\n24c768ae097 Merge bitcoin-core/secp256k1#1301: Avoid using bench_verify_data as bench_sign_data; merge them\n2e65f1fdbcc Avoid using bench_verify_data as bench_sign_data; merge them\n1cf15ebd94a Merge bitcoin-core/secp256k1#1296: docs: complete interface description for `secp256k1_schnorrsig_sign_custom`\n149c41cee11 docs: complete interface description for `secp256k1_schnorrsig_sign_custom`\nf30c74866b8 Merge bitcoin-core/secp256k1#1270: cmake: Fix library ABI versioning\nd1e48e5474a refactor: Make 64-bit shift explicit\nb2e29e43d0e ci: Treat all compiler warnings as errors in \"Windows (VS 2022)\" task\n3c818388563 Merge bitcoin-core/secp256k1#1289: cmake: Use full signature of `add_test()` command\n755629bc032 cmake: Use full signature of `add_test()` command\nbef448f9af2 cmake: Fix library ABI versioning\n4b0f711d46d Merge bitcoin-core/secp256k1#1277: autotools: Clean up after adding Wycheproof\n222ecaf661b Merge bitcoin-core/secp256k1#1284: cmake: Some improvements using `PROJECT_IS_TOP_LEVEL` variable\n71f746c057a cmake: Include `include` directory for subtree builds\n024a4094848 Merge bitcoin-core/secp256k1#1240: cmake: Improve and document compiler flag checks\na8d059f76cb cmake, doc: Document compiler flags\n6ece1507cb1 cmake, refactor: Rename `try_add_compile_option` to `try_append_cflags`\n19516ed3e9e cmake: Use `add_compile_options()` in `try_add_compile_option()`\n4b84f4bf0fb Merge bitcoin-core/secp256k1#1239: cmake: Bugfix and other improvements after bumping CMake up to 3.13\n596b336ff63 Merge bitcoin-core/secp256k1#1234: cmake: Add dev-mode\n6b7e5b717dd Merge bitcoin-core/secp256k1#1275: build: Fix C4005 \"macro redefinition\" MSVC warnings in examples\n1c895367184 Merge bitcoin-core/secp256k1#1286: tests: remove extra semicolon in macro\nc4062d6b5d8 debug: move helper for printing buffers into util.h\n7e977b3c507 autotools: Take VPATH builds into account when generating testvectors\n2418d3260ac autotools: Create src/wycheproof dir before creating file in it\n8764034ed55 autotools: Make all \"pregenerated\" targets .PHONY\ne1b9ce88115 autotools: Use same conventions for all pregenerated files\n3858bad2c64 tests: remove extra semicolon in macro\n1f33bb2b1c5 Merge bitcoin-core/secp256k1#1205: field: Improve docs +tests of secp256k1_fe_set_b32\n162da73e9a4 tests: Add debug helper for printing buffers\ne9fd3dff76e field: Improve docs and tests of secp256k1_fe_set_b32\nf6bef03c0a2 Merge bitcoin-core/secp256k1#1283: Get rid of secp256k1_fe_const_b\n5431b9decdb cmake: Make `SECP256K1_INSTALL` default depend on `PROJECT_IS_TOP_LEVEL`\n5ec1333d4f2 Merge bitcoin-core/secp256k1#1285: bench: Make sys/time.h a system include\n68b16a1662a bench: Make sys/time.h a system include\n162608cc982 cmake: Emulate `PROJECT_IS_TOP_LEVEL` for CMake<3.21\n69e1ec03312 Get rid of secp256k1_fe_const_b\nce5ba9e24df gitignore: Add CMakeUserPresets.json\n0a446a312fd cmake: Add dev-mode CMake preset\na6f4bcf6e10 Merge bitcoin-core/secp256k1#1231: Move `SECP256K1_INLINE` macro definition out from `include/secp256k1.h`\na273d74b2ea cmake: Improve version comparison\n6a58b483efb cmake: Use `if(... IN_LIST ...)` command\n2445808c020 cmake: Use dedicated `GENERATOR_IS_MULTI_CONFIG` property\n9f8703ef17d cmake: Use dedicated `CMAKE_HOST_APPLE` variable\n8c2017035a9 cmake: Use recommended `add_compile_definitions` command\n04d4cc071a7 cmake: Add `DESCRIPTION` and `HOMEPAGE_URL` options to `project` command\n8a8b6536ef5 cmake: Use `SameMinorVersion` compatibility mode\n5b0444a3b5e Merge bitcoin-core/secp256k1#1263: cmake: Make installation optional\n47ac3d63cd5 cmake: Make installation optional\n2e035af251a Merge bitcoin-core/secp256k1#1273: build: Make `SECP_VALGRIND_CHECK` preserve `CPPFLAGS`\n5be353d658a Merge bitcoin-core/secp256k1#1279: tests: lint wycheproof's python script\n08f4b1632d0 autotools: Move code around to tidy Makefile\n04bf3f67780 Merge bitcoin-core/secp256k1#1230: Build: allow static or shared but not both\n9ce9984f320 Merge bitcoin-core/secp256k1#1265: Remove bits argument from secp256k1_wnaf_const{_xonly}\n566faa17d34 Merge bitcoin-core/secp256k1#1267: doc: clarify process for patch releases\nef49a11d296 build: allow static or shared but not both\n35ada3b954c tests: lint wycheproof's python script\n529b54d9224 autotools: Move Wycheproof header from EXTRA_DIST to noinst_HEADERS\ndc0657c7622 build: Fix C4005 \"macro redefinition\" MSVC warnings in examples\n1ecb94ebe98 build: Make `SECP_VALGRIND_CHECK` preserve `CPPFLAGS`\n1b6fb5593c3 doc: clarify process for patch releases\na575339c028 Remove bits argument from secp256k1_wnaf_const (always 256)\n36b0adf1b90 build: remove warning until it's reproducible\n8e142ca4102 Move `SECP256K1_INLINE` macro definition out from `include/secp256k1.h`\n77445898a58 Remove `SECP256K1_INLINE` usage from examples\nca92a35d019 field: Simplify code in secp256k1_fe_set_b32\nd93f62e3693 field: Verify field element even after secp256k1_fe_set_b32 fails\n\ngit-subtree-dir: src/secp256k1\ngit-subtree-split: a91ad4864dc6945f7eefa3b82de31ce01e2b9b22",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:43:51Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:43:51Z"
      },
      "sha": "b4eb644b6cba0820812fe6248df9c844021ebf50"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY3OGQ5MGU0YTJhZGM0ZjdhNTE1NTMwYzBlZDc2NzBjMDZiZTAwYTc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/678d90e4a2adc4f7a515530c0ed7670c06be00a7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/678d90e4a2adc4f7a515530c0ed7670c06be00a7",
      "tree": {
        "sha": "39b81cd32fe513d3085c3ff13d98bb62cbb16f95",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/39b81cd32fe513d3085c3ff13d98bb62cbb16f95"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9d85c03620bf660cfa7d13080f5c0b191579cbc3",
          "sha": "9d85c03620bf660cfa7d13080f5c0b191579cbc3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9d85c03620bf660cfa7d13080f5c0b191579cbc3"
        },
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b4eb644b6cba0820812fe6248df9c844021ebf50",
          "sha": "b4eb644b6cba0820812fe6248df9c844021ebf50",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b4eb644b6cba0820812fe6248df9c844021ebf50"
        }
      ],
      "message": "Update src/secp256k1 subtree to version with ellswift support",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:43:51Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:43:51Z"
      },
      "sha": "678d90e4a2adc4f7a515530c0ed7670c06be00a7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhjMTJkMWUwMjE5MjE1YTA4ODg3ZjAwZjdlMDk2ZDg3ZWMzYmU3YTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8c12d1e0219215a08887f00f7e096d87ec3be7a9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8c12d1e0219215a08887f00f7e096d87ec3be7a9",
      "tree": {
        "sha": "f0ceca17c8c807bb7e1684ee1d27c601dc93fc22",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f0ceca17c8c807bb7e1684ee1d27c601dc93fc22"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/678d90e4a2adc4f7a515530c0ed7670c06be00a7",
          "sha": "678d90e4a2adc4f7a515530c0ed7670c06be00a7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/678d90e4a2adc4f7a515530c0ed7670c06be00a7"
        }
      ],
      "message": "Enable ellswift module in libsecp256k1",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:47:54Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2021-11-02T21:44:06Z"
      },
      "sha": "8c12d1e0219215a08887f00f7e096d87ec3be7a9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJlYThhNGY3Mzc1NDBlZjcyZTc5NWJjYzRjYTYwYjI0OWU4YzU3Y2E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bea8a4f737540ef72e795bcc4ca60b249e8c57ca",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/bea8a4f737540ef72e795bcc4ca60b249e8c57ca",
      "tree": {
        "sha": "ebc48d82a2602fcdd54f8e21384f0aa81649b10c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ebc48d82a2602fcdd54f8e21384f0aa81649b10c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8c12d1e0219215a08887f00f7e096d87ec3be7a9",
          "sha": "8c12d1e0219215a08887f00f7e096d87ec3be7a9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8c12d1e0219215a08887f00f7e096d87ec3be7a9"
        }
      ],
      "message": "Add ElligatorSwift key creation and ECDH logic\n\nCo-authored-by: Dhruv Mehta <856960+dhruv@users.noreply.github.com>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:50:38Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-04-17T18:25:41Z"
      },
      "sha": "bea8a4f737540ef72e795bcc4ca60b249e8c57ca"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIyMDFiMTU3YzE3MTUxYmVlNTMzNWI4OTMyMGQwNDk3NjUyZDQ5YTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2201b157c17151bee5335b89320d0497652d49a2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2201b157c17151bee5335b89320d0497652d49a2",
      "tree": {
        "sha": "cb40c3306d9184bbe084d486fa79580e65499521",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cb40c3306d9184bbe084d486fa79580e65499521"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bea8a4f737540ef72e795bcc4ca60b249e8c57ca",
          "sha": "bea8a4f737540ef72e795bcc4ca60b249e8c57ca",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/bea8a4f737540ef72e795bcc4ca60b249e8c57ca"
        }
      ],
      "message": "Unit test for ellswift creation/decoding roundtrip\n\nCo-authored-by: Pieter Wuille <bitcoin-dev@wuille.net>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:50:42Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-04-17T22:04:11Z"
      },
      "sha": "2201b157c17151bee5335b89320d0497652d49a2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGEzZWQ2NWE4Njg4ODg0OTQ1YmE5MDY1M2I4YzUxYjk4ODhjMWI1OTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a3ed65a8688884945ba90653b8c51b9888c1b591",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a3ed65a8688884945ba90653b8c51b9888c1b591",
      "tree": {
        "sha": "ab6b8040b8c9378766af65accf62c69a588cbba8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ab6b8040b8c9378766af65accf62c69a588cbba8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2201b157c17151bee5335b89320d0497652d49a2",
          "sha": "2201b157c17151bee5335b89320d0497652d49a2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2201b157c17151bee5335b89320d0497652d49a2"
        }
      ],
      "message": "Fuzz test for CKey->EllSwift->CPubKey creation/decoding\n\nCo-authored-by: Pieter Wuille <bitcoin-dev@wuille.net>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:50:42Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2021-11-03T17:10:10Z"
      },
      "sha": "a3ed65a8688884945ba90653b8c51b9888c1b591"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDliMDk1MjliODEyNGJjMjY3NzY4MmRlMDkyODIzNTA0M2I0MGI5YzA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9b09529b8124bc2677682de0928235043b40b9c0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9b09529b8124bc2677682de0928235043b40b9c0",
      "tree": {
        "sha": "c3e61eda517eaba57c1ef5e722b3566f6773b38e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c3e61eda517eaba57c1ef5e722b3566f6773b38e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a3ed65a8688884945ba90653b8c51b9888c1b591",
          "sha": "a3ed65a8688884945ba90653b8c51b9888c1b591",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a3ed65a8688884945ba90653b8c51b9888c1b591"
        }
      ],
      "message": "Fuzz test for Ellswift ECDH\n\nCo-authored-by: Pieter Wuille <bitcoin-dev@wuille.net>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:50:42Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2022-07-22T17:08:01Z"
      },
      "sha": "9b09529b8124bc2677682de0928235043b40b9c0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDgxNWFhMDc4MmMyOWQyMGIyNjk4YjhiYTUwY2QwMGVkOWQ4YWQ2MDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/815aa0782c29d20b2698b8ba50cd00ed9d8ad604",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/815aa0782c29d20b2698b8ba50cd00ed9d8ad604",
      "tree": {
        "sha": "083d6391b65d1e2ad9759624d759fd203bccd121",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/083d6391b65d1e2ad9759624d759fd203bccd121"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9b09529b8124bc2677682de0928235043b40b9c0",
          "sha": "9b09529b8124bc2677682de0928235043b40b9c0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9b09529b8124bc2677682de0928235043b40b9c0"
        }
      ],
      "message": "Bench tests for CKey->EllSwift\n\nCo-Authored-By: Pieter Wuille <bitcoin-dev@wuille.net>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:50:42Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2021-11-03T17:08:51Z"
      },
      "sha": "815aa0782c29d20b2698b8ba50cd00ed9d8ad604"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM1YzkxZTRjOTAxYzBhNjg3MzI4NGIwNTcyYjc4ZjgwNDI3ZWVmOWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "tree": {
        "sha": "6f700544e7ec6aebd45bb5aa9950843cf7d6eb24",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6f700544e7ec6aebd45bb5aa9950843cf7d6eb24"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/815aa0782c29d20b2698b8ba50cd00ed9d8ad604",
          "sha": "815aa0782c29d20b2698b8ba50cd00ed9d8ad604",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/815aa0782c29d20b2698b8ba50cd00ed9d8ad604"
        }
      ],
      "message": "Bench test for EllSwift ECDH\n\nCo-authored-by: Dhruv Mehta <856960+dhruv@users.noreply.github.com>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-05-12T05:50:42Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-04-18T16:16:45Z"
      },
      "sha": "c5c91e4c901c0a6873284b0572b78f80427eef9a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9229255768,
      "node_id": "HRFPE_lADOABII585jqXTIzwAAAAImG0RY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9229255768",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-12T06:02:08Z"
    },
    {
      "event": "unlabeled",
      "id": 9229844365,
      "node_id": "UNLE_lADOABII585jqXTIzwAAAAImJD-N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9229844365",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-12T07:18:41Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1545400377,
      "node_id": "IC_kwDOABII585cHPA5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545400377",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-12T08:49:21Z",
      "updated_at": "2023-05-12T08:49:21Z",
      "author_association": "MEMBER",
      "body": "cc @stratospher ",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#issuecomment-1545400377",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27479"
    },
    {
      "event": "mentioned",
      "id": 9230656914,
      "node_id": "MEE_lADOABII585jqXTIzwAAAAImMKWS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9230656914",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-12T08:49:21Z"
    },
    {
      "event": "subscribed",
      "id": 9230656937,
      "node_id": "SE_lADOABII585jqXTIzwAAAAImMKWp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9230656937",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-12T08:49:22Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171357368",
      "pull_request_review_id": 1392091186,
      "id": 1171357368,
      "node_id": "PRRC_kwDOABII585F0X64",
      "diff_hunk": "@@ -291,6 +291,30 @@ class XOnlyPubKey\n     SERIALIZE_METHODS(XOnlyPubKey, obj) { READWRITE(obj.m_keydata); }\n };\n \n+/** An ElligatorSwift-encoded public key. */\n+struct EllSwiftPubKey\n+{\n+public:\n+    static constexpr size_t ELLSWIFT_ENCODED_SIZE = 64;\n+\n+private:\n+    std::array<std::byte, ELLSWIFT_ENCODED_SIZE> m_pubkey;\n+\n+public:\n+    /** Construct a new ellswift public key from a given serialization. */\n+    EllSwiftPubKey(const std::array<std::byte, ELLSWIFT_ENCODED_SIZE>& ellswift) :\n+        m_pubkey(ellswift) {}\n+\n+    /** Decode to normal key (for debugging purposes). */",
      "path": "src/pubkey.h",
      "position": null,
      "original_position": 18,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "normal *compressed* key",
      "created_at": "2023-04-19T13:36:51Z",
      "updated_at": "2023-04-19T14:04:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171357368",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171357368"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 311,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171362440",
      "pull_request_review_id": 1392091186,
      "id": 1171362440,
      "node_id": "PRRC_kwDOABII585F0ZKI",
      "diff_hunk": "@@ -156,6 +162,21 @@ class CKey\n \n     //! Load private key and check that public key matches.\n     bool Load(const CPrivKey& privkey, const CPubKey& vchPubKey, bool fSkipCheck);\n+\n+    /** Create an ellswift-encoded public key for this key, with specified entropy.\n+     *  This must be a valid private key. Ent32 must be 32 bytes. */",
      "path": "src/key.h",
      "position": null,
      "original_position": 19,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Took me too long to figure out what \"ent\" referred to, just putting the full word \"entropy\" in the comment would help. If the entropy is not unpredictable this would result in a not uniformly random(?) series of bytes in the resulting pubkey?",
      "created_at": "2023-04-19T13:40:31Z",
      "updated_at": "2023-04-19T14:04:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171362440",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171362440"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373891",
      "pull_request_review_id": 1392091186,
      "id": 1171373891,
      "node_id": "PRRC_kwDOABII585F0b9D",
      "diff_hunk": "@@ -331,6 +332,57 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+EllSwiftPubKey CKey::EllSwiftCreate(Span<const std::byte> ent32) const\n+{\n+    assert(fValid);\n+    assert(ent32.size() == 32);\n+    std::array<std::byte, EllSwiftPubKey::size()> encoded_pubkey;\n+\n+    auto success = secp256k1_ellswift_create(secp256k1_context_sign,\n+                                             UCharCast(encoded_pubkey.data()),\n+                                             keydata.data(),\n+                                             UCharCast(ent32.data()));\n+\n+    // Should always succeed for valid keys (asserted above).\n+    assert(success);\n+    return {encoded_pubkey};\n+}\n+\n+static const HashWriter HASHER_BIP324_ECDH = TaggedHash(\"bip324_ellswift_xonly_ecdh\");\n+\n+extern \"C\" {\n+\n+static int BIP324ECDHHash(unsigned char* output, const unsigned char* x32, const unsigned char* ours, const unsigned char* theirs, void* data)\n+{\n+    bool initiating = *(bool*)data;\n+    HashWriter writer{HASHER_BIP324_ECDH};\n+    writer << Span{initiating ? ours : theirs, 64};",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "s/64/EllSwiftPubKey::size()/",
      "created_at": "2023-04-19T13:48:55Z",
      "updated_at": "2023-04-19T14:04:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171373891",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373891"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 359,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373986",
      "pull_request_review_id": 1392091186,
      "id": 1171373986,
      "node_id": "PRRC_kwDOABII585F0b-i",
      "diff_hunk": "@@ -331,6 +332,57 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+EllSwiftPubKey CKey::EllSwiftCreate(Span<const std::byte> ent32) const\n+{\n+    assert(fValid);\n+    assert(ent32.size() == 32);\n+    std::array<std::byte, EllSwiftPubKey::size()> encoded_pubkey;\n+\n+    auto success = secp256k1_ellswift_create(secp256k1_context_sign,\n+                                             UCharCast(encoded_pubkey.data()),\n+                                             keydata.data(),\n+                                             UCharCast(ent32.data()));\n+\n+    // Should always succeed for valid keys (asserted above).\n+    assert(success);\n+    return {encoded_pubkey};\n+}\n+\n+static const HashWriter HASHER_BIP324_ECDH = TaggedHash(\"bip324_ellswift_xonly_ecdh\");\n+\n+extern \"C\" {\n+\n+static int BIP324ECDHHash(unsigned char* output, const unsigned char* x32, const unsigned char* ours, const unsigned char* theirs, void* data)\n+{\n+    bool initiating = *(bool*)data;\n+    HashWriter writer{HASHER_BIP324_ECDH};\n+    writer << Span{initiating ? ours : theirs, 64};\n+    writer << Span{initiating ? theirs : ours, 64};",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "s/64/EllSwiftPubKey::size()/",
      "created_at": "2023-04-19T13:48:59Z",
      "updated_at": "2023-04-19T14:04:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171373986",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373986"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 360,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171402620",
      "pull_request_review_id": 1392161620,
      "id": 1171402620,
      "node_id": "PRRC_kwDOABII585F0i98",
      "diff_hunk": "@@ -156,6 +162,21 @@ class CKey\n \n     //! Load private key and check that public key matches.\n     bool Load(const CPrivKey& privkey, const CPubKey& vchPubKey, bool fSkipCheck);\n+\n+    /** Create an ellswift-encoded public key for this key, with specified entropy.\n+     *  This must be a valid private key. Ent32 must be 32 bytes. */",
      "path": "src/key.h",
      "position": null,
      "original_position": 19,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": 1171362440,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Actually, no, the \"create ellswift encoding\" algorithm in libsecp256k1 uses an internal RNG which is always at least seeded with the private key; the `ent32` argument here is just auxiliary randomness that gets fed to that RNG.\r\n\r\nThe output of the encoding is in fact indistinguishable from uniformly random to anyone who doesn't know the private key already, even without additional entropy. Adding actual randomness is a more belt-and-suspenders step to make sure the result is actually close to uniformly random, rather than just indistinguishable from random.\r\n\r\nThis deserves some extra comments, will add soon.",
      "created_at": "2023-04-19T14:08:36Z",
      "updated_at": "2023-04-19T14:11:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171402620",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171402620"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171962843",
      "pull_request_review_id": 1393040022,
      "id": 1171962843,
      "node_id": "PRRC_kwDOABII585F2rvb",
      "diff_hunk": "@@ -291,6 +291,30 @@ class XOnlyPubKey\n     SERIALIZE_METHODS(XOnlyPubKey, obj) { READWRITE(obj.m_keydata); }\n };\n \n+/** An ElligatorSwift-encoded public key. */\n+struct EllSwiftPubKey\n+{\n+public:\n+    static constexpr size_t ELLSWIFT_ENCODED_SIZE = 64;",
      "path": "src/pubkey.h",
      "position": null,
      "original_position": 8,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "fd04a2baec77b97cfb36ec488cec58811ea1ad45",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "tiny nit: could be put in the \"private:\" section, since there is a static constexpr `size()` function returning this value below anyway.",
      "created_at": "2023-04-20T00:19:10Z",
      "updated_at": "2023-04-20T00:46:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171962843",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171962843"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": 297,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 298,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171972333",
      "pull_request_review_id": 1393040022,
      "id": 1171972333,
      "node_id": "PRRC_kwDOABII585F2uDt",
      "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2022-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+\n+#include <key.h>\n+#include <random.h>\n+\n+#include <array>\n+\n+static void EllSwiftCreate(benchmark::Bench& bench)\n+{\n+    ECC_Start();\n+\n+    CKey key;\n+    key.MakeNewKey(true);\n+\n+    uint256 entropy = GetRandHash();\n+\n+    bench.batch(1).unit(\"pubkey\").run([&] {\n+        auto ret = key.EllSwiftCreate(AsBytes(Span{entropy}));",
      "path": "src/bench/ellswift.cpp",
      "position": 22,
      "original_position": 22,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "e1ddcb416ace0c4a8d7da29c89454928b93c2c9e",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "There's a theoretical possibility that this call crashes due to failed assertion `assert(fValid)`, if the generated key from the previous round (=first 32 bytes of ellswift encoded pubkey) was not valid. Due to the practical low probably for this to ever happen (if my math isn't off, on average every 2^(127,65) randomly generated key is invalid), I guess it's not worth it to add any checks here, especially since it's only a benchmark?",
      "created_at": "2023-04-20T00:43:15Z",
      "updated_at": "2023-04-20T00:50:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171972333",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171972333"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 22,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739143",
      "pull_request_review_id": 1394227026,
      "id": 1172739143,
      "node_id": "PRRC_kwDOABII585F5pRH",
      "diff_hunk": "@@ -291,6 +291,30 @@ class XOnlyPubKey\n     SERIALIZE_METHODS(XOnlyPubKey, obj) { READWRITE(obj.m_keydata); }\n };\n \n+/** An ElligatorSwift-encoded public key. */\n+struct EllSwiftPubKey\n+{\n+public:\n+    static constexpr size_t ELLSWIFT_ENCODED_SIZE = 64;\n+\n+private:\n+    std::array<std::byte, ELLSWIFT_ENCODED_SIZE> m_pubkey;\n+\n+public:\n+    /** Construct a new ellswift public key from a given serialization. */\n+    EllSwiftPubKey(const std::array<std::byte, ELLSWIFT_ENCODED_SIZE>& ellswift) :\n+        m_pubkey(ellswift) {}\n+\n+    /** Decode to normal key (for debugging purposes). */",
      "path": "src/pubkey.h",
      "position": null,
      "original_position": 18,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": 1171357368,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2023-04-20T15:09:51Z",
      "updated_at": "2023-04-20T15:09:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1172739143",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739143"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 311,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739437",
      "pull_request_review_id": 1394227420,
      "id": 1172739437,
      "node_id": "PRRC_kwDOABII585F5pVt",
      "diff_hunk": "@@ -156,6 +162,21 @@ class CKey\n \n     //! Load private key and check that public key matches.\n     bool Load(const CPrivKey& privkey, const CPubKey& vchPubKey, bool fSkipCheck);\n+\n+    /** Create an ellswift-encoded public key for this key, with specified entropy.\n+     *  This must be a valid private key. Ent32 must be 32 bytes. */",
      "path": "src/key.h",
      "position": null,
      "original_position": 19,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": 1171362440,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Added some comments. Please have a look.",
      "created_at": "2023-04-20T15:10:03Z",
      "updated_at": "2023-04-20T15:10:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1172739437",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739437"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739546",
      "pull_request_review_id": 1394227583,
      "id": 1172739546,
      "node_id": "PRRC_kwDOABII585F5pXa",
      "diff_hunk": "@@ -331,6 +332,57 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+EllSwiftPubKey CKey::EllSwiftCreate(Span<const std::byte> ent32) const\n+{\n+    assert(fValid);\n+    assert(ent32.size() == 32);\n+    std::array<std::byte, EllSwiftPubKey::size()> encoded_pubkey;\n+\n+    auto success = secp256k1_ellswift_create(secp256k1_context_sign,\n+                                             UCharCast(encoded_pubkey.data()),\n+                                             keydata.data(),\n+                                             UCharCast(ent32.data()));\n+\n+    // Should always succeed for valid keys (asserted above).\n+    assert(success);\n+    return {encoded_pubkey};\n+}\n+\n+static const HashWriter HASHER_BIP324_ECDH = TaggedHash(\"bip324_ellswift_xonly_ecdh\");\n+\n+extern \"C\" {\n+\n+static int BIP324ECDHHash(unsigned char* output, const unsigned char* x32, const unsigned char* ours, const unsigned char* theirs, void* data)\n+{\n+    bool initiating = *(bool*)data;\n+    HashWriter writer{HASHER_BIP324_ECDH};\n+    writer << Span{initiating ? ours : theirs, 64};",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": 1171373891,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2023-04-20T15:10:08Z",
      "updated_at": "2023-04-20T15:10:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1172739546",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739546"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 359,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739678",
      "pull_request_review_id": 1394227761,
      "id": 1172739678,
      "node_id": "PRRC_kwDOABII585F5pZe",
      "diff_hunk": "@@ -331,6 +332,57 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+EllSwiftPubKey CKey::EllSwiftCreate(Span<const std::byte> ent32) const\n+{\n+    assert(fValid);\n+    assert(ent32.size() == 32);\n+    std::array<std::byte, EllSwiftPubKey::size()> encoded_pubkey;\n+\n+    auto success = secp256k1_ellswift_create(secp256k1_context_sign,\n+                                             UCharCast(encoded_pubkey.data()),\n+                                             keydata.data(),\n+                                             UCharCast(ent32.data()));\n+\n+    // Should always succeed for valid keys (asserted above).\n+    assert(success);\n+    return {encoded_pubkey};\n+}\n+\n+static const HashWriter HASHER_BIP324_ECDH = TaggedHash(\"bip324_ellswift_xonly_ecdh\");\n+\n+extern \"C\" {\n+\n+static int BIP324ECDHHash(unsigned char* output, const unsigned char* x32, const unsigned char* ours, const unsigned char* theirs, void* data)\n+{\n+    bool initiating = *(bool*)data;\n+    HashWriter writer{HASHER_BIP324_ECDH};\n+    writer << Span{initiating ? ours : theirs, 64};\n+    writer << Span{initiating ? theirs : ours, 64};",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": 1171373986,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2023-04-20T15:10:14Z",
      "updated_at": "2023-04-20T15:10:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1172739678",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739678"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 360,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739938",
      "pull_request_review_id": 1394228168,
      "id": 1172739938,
      "node_id": "PRRC_kwDOABII585F5pdi",
      "diff_hunk": "@@ -291,6 +291,30 @@ class XOnlyPubKey\n     SERIALIZE_METHODS(XOnlyPubKey, obj) { READWRITE(obj.m_keydata); }\n };\n \n+/** An ElligatorSwift-encoded public key. */\n+struct EllSwiftPubKey\n+{\n+public:\n+    static constexpr size_t ELLSWIFT_ENCODED_SIZE = 64;",
      "path": "src/pubkey.h",
      "position": null,
      "original_position": 8,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "fd04a2baec77b97cfb36ec488cec58811ea1ad45",
      "in_reply_to_id": 1171962843,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done. Also renamed to just `SIZE`.",
      "created_at": "2023-04-20T15:10:26Z",
      "updated_at": "2023-04-20T15:10:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1172739938",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172739938"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": 297,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 298,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172741182",
      "pull_request_review_id": 1394230117,
      "id": 1172741182,
      "node_id": "PRRC_kwDOABII585F5pw-",
      "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2022-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+\n+#include <key.h>\n+#include <random.h>\n+\n+#include <array>\n+\n+static void EllSwiftCreate(benchmark::Bench& bench)\n+{\n+    ECC_Start();\n+\n+    CKey key;\n+    key.MakeNewKey(true);\n+\n+    uint256 entropy = GetRandHash();\n+\n+    bench.batch(1).unit(\"pubkey\").run([&] {\n+        auto ret = key.EllSwiftCreate(AsBytes(Span{entropy}));",
      "path": "src/bench/ellswift.cpp",
      "position": 22,
      "original_position": 22,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "e1ddcb416ace0c4a8d7da29c89454928b93c2c9e",
      "in_reply_to_id": 1171972333,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Your math is correct. And indeed, it's such a low probability event that it's not worth adding code to deal with it (even outside of a benchmark, I'd say). Still, I've added an assert to make it clear to the reader this is always supposed to be the case.",
      "created_at": "2023-04-20T15:11:26Z",
      "updated_at": "2023-04-20T15:11:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1172741182",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172741182"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 22,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172742351",
      "pull_request_review_id": 1394232011,
      "id": 1172742351,
      "node_id": "PRRC_kwDOABII585F5qDP",
      "diff_hunk": "@@ -156,6 +162,21 @@ class CKey\n \n     //! Load private key and check that public key matches.\n     bool Load(const CPrivKey& privkey, const CPubKey& vchPubKey, bool fSkipCheck);\n+\n+    /** Create an ellswift-encoded public key for this key, with specified entropy.\n+     *  This must be a valid private key. Ent32 must be 32 bytes. */",
      "path": "src/key.h",
      "position": null,
      "original_position": 19,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "2ecd571c958db45608cae0361d14552a11fb709b",
      "in_reply_to_id": 1171362440,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "significantly clearer, thanks",
      "created_at": "2023-04-20T15:12:24Z",
      "updated_at": "2023-04-20T15:12:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1172742351",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1172742351"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1185343503",
      "pull_request_review_id": 1413629831,
      "id": 1185343503,
      "node_id": "PRRC_kwDOABII585GpugP",
      "diff_hunk": "@@ -326,3 +328,33 @@ FUZZ_TARGET_INIT(ellswift_roundtrip, initialize_key)\n \n     assert(key.VerifyPubKey(decoded_pubkey));\n }\n+\n+FUZZ_TARGET_INIT(bip324_ecdh, initialize_key)\n+{\n+    FuzzedDataProvider fdp{buffer.data(), buffer.size()};\n+\n+    auto rnd32 = fdp.ConsumeBytes<uint8_t>(32);\n+    rnd32.resize(32);\n+    CKey k1;\n+    k1.Set(rnd32.begin(), rnd32.end(), true);\n+    if (!k1.IsValid()) return;\n+\n+    rnd32 = fdp.ConsumeBytes<uint8_t>(32);\n+    rnd32.resize(32);\n+    CKey k2;\n+    k2.Set(rnd32.begin(), rnd32.end(), true);\n+    if (!k2.IsValid()) return;\n+\n+    auto ent32 = fdp.ConsumeBytes<std::byte>(32);\n+    ent32.resize(32);\n+    auto k1_ellswift = k1.EllSwiftCreate(ent32);\n+\n+    ent32 = fdp.ConsumeBytes<std::byte>(32);\n+    ent32.resize(32);\n+    auto k2_ellswift = k2.EllSwiftCreate(ent32);\n+\n+    bool initiating = fdp.ConsumeBool();\n+    auto ecdh_secret_1 = k1.ComputeBIP324ECDHSecret(k2_ellswift, k1_ellswift, initiating);\n+    auto ecdh_secret_2 = k2.ComputeBIP324ECDHSecret(k1_ellswift, k2_ellswift, !initiating);",
      "path": "src/test/fuzz/key.cpp",
      "position": 71,
      "original_position": 42,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "7acde7393660ec5ee3652e811190ce4fa8fa86be",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "throwing it out there: could also have the `initiating` match erroneously, and assert that the secret *should not match* unless both privkeys/ent32s match?",
      "created_at": "2023-05-04T18:03:31Z",
      "updated_at": "2023-05-04T18:15:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1185343503",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1185343503"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 358,
      "original_line": 358,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1185352230",
      "pull_request_review_id": 1413629831,
      "id": 1185352230,
      "node_id": "PRRC_kwDOABII585Gpwom",
      "diff_hunk": "@@ -299,6 +299,9 @@ struct EllSwiftPubKey\n     std::array<std::byte, SIZE> m_pubkey;\n \n public:\n+    /** Construct an all 0x00 public key. Note that that is a valid pubkey. */",
      "path": "src/pubkey.h",
      "position": 12,
      "original_position": 4,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "818acac23295d526d9f85f0218949c817f5df964",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "where is this used?",
      "created_at": "2023-05-04T18:13:33Z",
      "updated_at": "2023-05-04T18:15:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1185352230",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1185352230"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 302,
      "original_line": 302,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1193210027",
      "pull_request_review_id": 1425604677,
      "id": 1193210027,
      "node_id": "PRRC_kwDOABII585HHvCr",
      "diff_hunk": "@@ -326,3 +328,33 @@ FUZZ_TARGET_INIT(ellswift_roundtrip, initialize_key)\n \n     assert(key.VerifyPubKey(decoded_pubkey));\n }\n+\n+FUZZ_TARGET_INIT(bip324_ecdh, initialize_key)\n+{\n+    FuzzedDataProvider fdp{buffer.data(), buffer.size()};\n+\n+    auto rnd32 = fdp.ConsumeBytes<uint8_t>(32);\n+    rnd32.resize(32);\n+    CKey k1;\n+    k1.Set(rnd32.begin(), rnd32.end(), true);\n+    if (!k1.IsValid()) return;\n+\n+    rnd32 = fdp.ConsumeBytes<uint8_t>(32);\n+    rnd32.resize(32);\n+    CKey k2;\n+    k2.Set(rnd32.begin(), rnd32.end(), true);\n+    if (!k2.IsValid()) return;\n+\n+    auto ent32 = fdp.ConsumeBytes<std::byte>(32);\n+    ent32.resize(32);\n+    auto k1_ellswift = k1.EllSwiftCreate(ent32);\n+\n+    ent32 = fdp.ConsumeBytes<std::byte>(32);\n+    ent32.resize(32);\n+    auto k2_ellswift = k2.EllSwiftCreate(ent32);\n+\n+    bool initiating = fdp.ConsumeBool();\n+    auto ecdh_secret_1 = k1.ComputeBIP324ECDHSecret(k2_ellswift, k1_ellswift, initiating);\n+    auto ecdh_secret_2 = k2.ComputeBIP324ECDHSecret(k1_ellswift, k2_ellswift, !initiating);",
      "path": "src/test/fuzz/key.cpp",
      "position": 71,
      "original_position": 42,
      "commit_id": "c5c91e4c901c0a6873284b0572b78f80427eef9a",
      "original_commit_id": "7acde7393660ec5ee3652e811190ce4fa8fa86be",
      "in_reply_to_id": 1185343503,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I've just added a test for this on the libsecp256k1 side: https://github.com/bitcoin-core/secp256k1/pull/1129/files#diff-d7678006ab19bb19a4a8dfb5f497cab0127e33730791c6e0597db203751322d9R365\r\n\r\nI may do something similar here when I update again.",
      "created_at": "2023-05-14T21:12:20Z",
      "updated_at": "2023-05-14T21:12:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1193210027",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1193210027"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 358,
      "original_line": 358,
      "side": "RIGHT"
    }
  ]
}