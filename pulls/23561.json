{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "id": 785288913,
    "node_id": "PR_kwDOABII584uzo7R",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/23561.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/23561.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/178ef757bab6db437c8ebecd6fa7009b16da40d6",
    "number": 23561,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "BIP324: Handshake prerequisites",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Depends on #25361 for some constants, and on https://github.com/bitcoin-core/secp256k1/pull/1129 for ellswift integrated XDH but can be reviewed independently. Only the last 5 commits belong to this PR.\r\n\r\nThis PR adds xonly [ECDH](https://gist.github.com/dhruv/5b1275751bc98f3b64bcafce7876b489#Initial_handshake) and [HKDF](https://gist.github.com/dhruv/5b1275751bc98f3b64bcafce7876b489#keys-and-session-id-derivation) key derivation code for BIP324. Unit, bench and fuzz tests are included.\r\n\r\nThe dependency tree for BIP324 PRs is [here](https://bip324.com/sections/code-review/).",
    "labels": [
      {
        "id": 61889416,
        "node_id": "MDU6TGFiZWw2MTg4OTQxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system",
        "name": "Build system",
        "color": "5319e7",
        "default": false
      },
      {
        "id": 241832923,
        "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
        "name": "Utils/log/libs",
        "description": "",
        "color": "5319e7",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2021-11-20T22:50:38Z",
    "updated_at": "2023-04-18T08:50:23Z",
    "closed_at": "2023-04-18T08:50:23Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merge_commit_sha": "63496e31310294f9a9dbe0ef8e3ea9016fa38f70",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "dhruv:bip324-handshake",
      "ref": "bip324-handshake",
      "sha": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 286919086,
        "node_id": "MDEwOlJlcG9zaXRvcnkyODY5MTkwODY=",
        "name": "bitcoin",
        "full_name": "dhruv/bitcoin",
        "owner": {
          "login": "dhruv",
          "id": 856960,
          "node_id": "MDQ6VXNlcjg1Njk2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/dhruv",
          "html_url": "https://github.com/dhruv",
          "followers_url": "https://api.github.com/users/dhruv/followers",
          "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
          "organizations_url": "https://api.github.com/users/dhruv/orgs",
          "repos_url": "https://api.github.com/users/dhruv/repos",
          "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/dhruv/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/dhruv/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/dhruv/bitcoin",
        "archive_url": "https://api.github.com/repos/dhruv/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/dhruv/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/dhruv/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/dhruv/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/dhruv/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/dhruv/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/dhruv/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/dhruv/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/dhruv/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/dhruv/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/dhruv/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/dhruv/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/dhruv/bitcoin/events",
        "forks_url": "https://api.github.com/repos/dhruv/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/dhruv/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/dhruv/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/dhruv/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/dhruv/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/dhruv/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/dhruv/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/dhruv/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/dhruv/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/dhruv/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/dhruv/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/dhruv/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/dhruv/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/dhruv/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/dhruv/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/dhruv/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:dhruv/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/dhruv/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/dhruv/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/dhruv/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/dhruv/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/dhruv/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/dhruv/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/dhruv/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/dhruv/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/dhruv/bitcoin/hooks",
        "svn_url": "https://github.com/dhruv/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 217679,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-03-21T04:04:31Z",
        "created_at": "2020-08-12T04:49:16Z",
        "updated_at": "2022-11-08T22:13:25Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "f4e42a78c75719ad6a99962360ec67d92a563a9d",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69819,
        "watchers_count": 69819,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T05:35:10Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T04:47:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 3272,
    "deletions": 615,
    "changed_files": 50,
    "commits": 13,
    "review_comments": 72,
    "comments": 31
  },
  "events": [
    {
      "event": "added_to_project",
      "id": 5649402650,
      "node_id": "ATPE_lADOABII584_Is2OzwAAAAFQuwsa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5649402650",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-20T22:50:48Z",
      "project_card": {
        "id": 73277923,
        "url": "https://api.github.com/projects/columns/cards/73277923",
        "project_id": 13452186,
        "project_url": "https://api.github.com/projects/13452186",
        "column_name": "Needs review"
      }
    },
    {
      "event": "labeled",
      "id": 5649421825,
      "node_id": "LE_lADOABII584_Is2OzwAAAAFQu1YB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5649421825",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-20T23:22:47Z",
      "label": {
        "name": "Build system",
        "color": "5319e7"
      }
    },
    {
      "event": "labeled",
      "id": 5649421826,
      "node_id": "LE_lADOABII584_Is2OzwAAAAFQu1YC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5649421826",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-20T23:22:47Z",
      "label": {
        "name": "Utils/log/libs",
        "color": "5319e7"
      }
    },
    {
      "event": "commented",
      "id": 974790491,
      "node_id": "IC_kwDOABII5846Gh9b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974790491",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-21T10:27:18Z",
      "updated_at": "2023-04-01T11:08:32Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [naumenkogs](https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-975194275), [PastaPastaPasta](https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-874403910), [theStack](https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-993386102) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27385](https://github.com/bitcoin/bitcoin/pull/27385) (net: extract Network and BIP155Network logic to node/network by jonatack)\n* [#27294](https://github.com/bitcoin/bitcoin/pull/27294) (refactor: Move chain names to the util library by TheCharlatan)\n* [#27254](https://github.com/bitcoin/bitcoin/pull/27254) (refactor: Extract util/fs from util/system by TheCharlatan)\n* [#26684](https://github.com/bitcoin/bitcoin/pull/26684) (bench: add readblock benchmark by andrewtoth)\n* [#25572](https://github.com/bitcoin/bitcoin/pull/25572) (refactor: Introduce EvictionManager and use it for the inbound eviction logic by dergoegge)\n* [#25390](https://github.com/bitcoin/bitcoin/pull/25390) (sync: introduce a thread-safe generic container and use it to remove a bunch of \"GlobalMutex\"es by vasild)\n* [#25268](https://github.com/bitcoin/bitcoin/pull/25268) (refactor: Introduce EvictionManager by dergoegge)\n* [#23432](https://github.com/bitcoin/bitcoin/pull/23432) (BIP324: CKey encode/decode to elligator-swift by dhruv)\n* [#23233](https://github.com/bitcoin/bitcoin/pull/23233) (BIP324: Add encrypted p2p transport {de}serializer by dhruv)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-974790491",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "commented",
      "id": 975194275,
      "node_id": "IC_kwDOABII5846IEij",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975194275",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-22T07:14:31Z",
      "updated_at": "2021-11-22T07:14:31Z",
      "author_association": "MEMBER",
      "body": "Concept ACK.\r\nMoving forward with BIP324 is a good idea, and this code seems to not have any negative/unexpected side-effects.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-975194275",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "renamed",
      "id": 5662813613,
      "node_id": "RTE_lADOABII584_Is2OzwAAAAFRh62t",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5662813613",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T20:29:15Z",
      "rename": {
        "from": "BIP324 handshake prerequisites",
        "to": "BIP324: Handshake prerequisites"
      }
    },
    {
      "event": "reviewed",
      "id": 814167558,
      "node_id": "PRR_kwDOABII584whzYG",
      "url": null,
      "actor": null,
      "commit_id": "2d58b293461c0b8890ce82eb5683c06ff805b85e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-814167558",
      "submitted_at": "2021-11-23T21:19:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5674684755,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAFSPNFT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5674684755",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-25T20:24:19Z"
    },
    {
      "event": "commented",
      "id": 979455585,
      "node_id": "IC_kwDOABII5846YU5h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979455585",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-25T20:25:45Z",
      "updated_at": "2021-11-25T20:25:45Z",
      "author_association": "MEMBER",
      "body": "Addressed review comments from @sipa. Ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-979455585",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "mentioned",
      "id": 5674688196,
      "node_id": "MEE_lADOABII584_Is2OzwAAAAFSPN7E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5674688196",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-25T20:25:45Z"
    },
    {
      "event": "subscribed",
      "id": 5674688199,
      "node_id": "SE_lADOABII584_Is2OzwAAAAFSPN7H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5674688199",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-25T20:25:45Z"
    },
    {
      "event": "reviewed",
      "id": 823656777,
      "node_id": "PRR_kwDOABII584xGAFJ",
      "url": null,
      "actor": null,
      "commit_id": "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-823656777",
      "submitted_at": "2021-12-06T08:31:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "reviewed",
      "id": 823660440,
      "node_id": "PRR_kwDOABII584xGA-Y",
      "url": null,
      "actor": null,
      "commit_id": "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-823660440",
      "submitted_at": "2021-12-06T08:35:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "referenced",
      "id": 5726043247,
      "node_id": "REFE_lADOABII584_Is2OzwAAAAFVTHxv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5726043247",
      "actor": {
        "login": "alirezaayande",
        "id": 95385523,
        "node_id": "U_kgDOBa93sw",
        "avatar_url": "https://avatars.githubusercontent.com/u/95385523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alirezaayande",
        "html_url": "https://github.com/alirezaayande",
        "followers_url": "https://api.github.com/users/alirezaayande/followers",
        "following_url": "https://api.github.com/users/alirezaayande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alirezaayande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alirezaayande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alirezaayande/subscriptions",
        "organizations_url": "https://api.github.com/users/alirezaayande/orgs",
        "repos_url": "https://api.github.com/users/alirezaayande/repos",
        "events_url": "https://api.github.com/users/alirezaayande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alirezaayande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "0c85dc30e6b628f7538a67776c7eefcb84ef4f82",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0c85dc30e6b628f7538a67776c7eefcb84ef4f82",
      "created_at": "2021-12-07T09:19:57Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5736938881,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAFV8r2B",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5736938881",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-12-08T22:19:47Z"
    },
    {
      "event": "commented",
      "id": 989463355,
      "node_id": "IC_kwDOABII5846-gM7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989463355",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-12-09T03:02:47Z",
      "updated_at": "2021-12-09T03:05:14Z",
      "author_association": "MEMBER",
      "body": "Addressed comments; Rebased with master to incorporate #23413. I am still investigating CI failures which seem like a timeout on Cirrus CI but re-running hasn't helped (other recent open PRs seem to be seeing this error as well). Meanwhile, ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-989463355",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "labeled",
      "id": 5787774134,
      "node_id": "LE_lADOABII584_Is2OzwAAAAFY-my2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5787774134",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-12-18T07:51:59Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5932918445,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAFhoSat",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5932918445",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-21T15:34:06Z"
    },
    {
      "event": "unlabeled",
      "id": 5933466107,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAFhqYH7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5933466107",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-21T17:06:00Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1019020541,
      "node_id": "IC_kwDOABII5848vQT9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019020541",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T02:27:00Z",
      "updated_at": "2022-01-22T02:27:00Z",
      "author_association": "MEMBER",
      "body": "Rebased against master. Ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1019020541",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "reviewed",
      "id": 874403910,
      "node_id": "PRR_kwDOABII5840HlhG",
      "url": null,
      "actor": null,
      "commit_id": "773cbc93b102a87a3ec8f852e7aca595489222a7",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "concept ACK / light utACK. I did a high level review, and everything makes sense to me.\r\n\r\nI do have 1 tiny nit",
      "user": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-874403910",
      "submitted_at": "2022-02-07T09:38:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "labeled",
      "id": 6178531860,
      "node_id": "LE_lADOABII584_Is2OzwAAAAFwROoU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6178531860",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-03T14:28:12Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6221143221,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAFyzxy1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6221143221",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-10T22:27:55Z"
    },
    {
      "event": "unlabeled",
      "id": 6221166140,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAFyz3Y8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6221166140",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-10T22:31:33Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1064681972,
      "node_id": "IC_kwDOABII584_dcH0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1064681972",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T01:30:16Z",
      "updated_at": "2022-03-11T01:30:16Z",
      "author_association": "MEMBER",
      "body": "Rebased. Ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1064681972",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "labeled",
      "id": 6396937122,
      "node_id": "LE_lADOABII584_Is2OzwAAAAF9SYOi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6396937122",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-08T14:34:01Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6401862234,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAF9lKpa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6401862234",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-09T15:47:11Z"
    },
    {
      "event": "commented",
      "id": 1094072090,
      "node_id": "IC_kwDOABII585BNjca",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1094072090",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-09T15:48:18Z",
      "updated_at": "2022-04-09T15:48:18Z",
      "author_association": "MEMBER",
      "body": "Rebased. `git range-diff e0680bbce ea94adb 2a2cbfc1e`\r\n\r\nReady for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1094072090",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "unlabeled",
      "id": 6402188298,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAF9maQK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6402188298",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-09T17:42:02Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 6402352623,
      "node_id": "LE_lADOABII584_Is2OzwAAAAF9nCXv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6402352623",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-09T19:47:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6430066918,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAF_Qwjm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6430066918",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-13T20:11:24Z"
    },
    {
      "event": "commented",
      "id": 1098440610,
      "node_id": "IC_kwDOABII585BeN-i",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1098440610",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-13T20:11:40Z",
      "updated_at": "2022-04-13T20:11:40Z",
      "author_association": "MEMBER",
      "body": "Rebased. Ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1098440610",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "unlabeled",
      "id": 6430668667,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAF_TDd7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6430668667",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-13T22:12:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6435714661,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAF_mTZl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6435714661",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-14T16:08:09Z"
    },
    {
      "event": "commented",
      "id": 1099350904,
      "node_id": "IC_kwDOABII585BhsN4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099350904",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-14T16:10:05Z",
      "updated_at": "2022-04-14T16:11:06Z",
      "author_association": "MEMBER",
      "body": "Updated to use xonly ECDH as per changes being made to BIP324 before publication. Ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1099350904",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "reviewed",
      "id": 942511239,
      "node_id": "PRR_kwDOABII5844LZSH",
      "url": null,
      "actor": null,
      "commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-942511239",
      "submitted_at": "2022-04-14T16:17:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "reviewed",
      "id": 942563365,
      "node_id": "PRR_kwDOABII5844LmAl",
      "url": null,
      "actor": null,
      "commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-942563365",
      "submitted_at": "2022-04-14T17:07:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "reviewed",
      "id": 942692576,
      "node_id": "PRR_kwDOABII5844MFjg",
      "url": null,
      "actor": null,
      "commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-942692576",
      "submitted_at": "2022-04-14T19:06:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "reviewed",
      "id": 942693537,
      "node_id": "PRR_kwDOABII5844MFyh",
      "url": null,
      "actor": null,
      "commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-942693537",
      "submitted_at": "2022-04-14T19:07:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "reviewed",
      "id": 942704299,
      "node_id": "PRR_kwDOABII5844MIar",
      "url": null,
      "actor": null,
      "commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-942704299",
      "submitted_at": "2022-04-14T19:19:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "reviewed",
      "id": 942708102,
      "node_id": "PRR_kwDOABII5844MJWG",
      "url": null,
      "actor": null,
      "commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-942708102",
      "submitted_at": "2022-04-14T19:23:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6438121123,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAF_ve6j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6438121123",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T01:09:34Z"
    },
    {
      "event": "commented",
      "id": 1099765312,
      "node_id": "IC_kwDOABII585BjRZA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099765312",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T01:11:59Z",
      "updated_at": "2022-04-15T01:11:59Z",
      "author_association": "MEMBER",
      "body": "Addressed review comments from @fanquake and @sipa. Ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1099765312",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "mentioned",
      "id": 6438127524,
      "node_id": "MEE_lADOABII584_Is2OzwAAAAF_vgek",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6438127524",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T01:11:59Z"
    },
    {
      "event": "subscribed",
      "id": 6438127525,
      "node_id": "SE_lADOABII584_Is2OzwAAAAF_vgel",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6438127525",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T01:11:59Z"
    },
    {
      "event": "mentioned",
      "id": 6438127529,
      "node_id": "MEE_lADOABII584_Is2OzwAAAAF_vgep",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6438127529",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T01:11:59Z"
    },
    {
      "event": "subscribed",
      "id": 6438127530,
      "node_id": "SE_lADOABII584_Is2OzwAAAAF_vgeq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6438127530",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T01:11:59Z"
    },
    {
      "event": "reviewed",
      "id": 965298394,
      "node_id": "PRR_kwDOABII5845iUja",
      "url": null,
      "actor": null,
      "commit_id": "69dc0985490da8513206718a97fb4400847b6481",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-965298394",
      "submitted_at": "2022-05-07T06:39:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "labeled",
      "id": 6603555754,
      "node_id": "LE_lADOABII584_Is2OzwAAAAGJmkOq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6603555754",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-13T07:39:57Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 993386102,
      "node_id": "PRR_kwDOABII5847Nd52",
      "url": null,
      "actor": null,
      "commit_id": "69dc0985490da8513206718a97fb4400847b6481",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nnit: Considering that `ECDHSecret` always has a fixed size, do we really need to use a `std::vector`? An alternative would be to use `std::array` and remove the `.resize()` calls. The following diff on the top-commit seems to work fine:\r\n```diff\r\ndiff --git a/src/key.cpp b/src/key.cpp\r\nindex aab8bbda1..791c4c878 100644\r\n--- a/src/key.cpp\r\n+++ b/src/key.cpp\r\n@@ -357,7 +357,6 @@ bool CKey::ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<const uint8\r\n     hasher << initiator_hdata << responder_hdata << xonly_ecdh;\r\n     auto secret_uint256 = hasher.GetSHA256();\r\n\r\n-    secret.resize(ECDH_SECRET_SIZE);\r\n     memcpy(secret.data(), &secret_uint256, CSHA256::OUTPUT_SIZE);\r\n     memory_cleanse(xonly_ecdh, ECDH_SECRET_SIZE);\r\n     return true;\r\ndiff --git a/src/key.h b/src/key.h\r\nindex 0fdaef1eb..60f6cce3f 100644\r\n--- a/src/key.h\r\n+++ b/src/key.h\r\n@@ -29,7 +29,7 @@ constexpr static size_t ECDH_SECRET_SIZE = CSHA256::OUTPUT_SIZE;\r\n const CHashWriter HASHER_BIP324_ECDH = TaggedHash(\"secp256k1_ellsq_xonly_ecdh\");\r\n\r\n // Used to represent a ECDH secret (ECDH_SECRET_SIZE bytes)\r\n-using ECDHSecret = std::vector<uint8_t, secure_allocator<uint8_t>>;\r\n+using ECDHSecret = std::array<uint8_t, ECDH_SECRET_SIZE>;\r\n\r\n /** An encapsulated private key. */\r\n class CKey\r\ndiff --git a/src/test/fuzz/net.cpp b/src/test/fuzz/net.cpp\r\nindex 09dac0f17..2ca07b7d7 100644\r\n--- a/src/test/fuzz/net.cpp\r\n+++ b/src/test/fuzz/net.cpp\r\n@@ -89,7 +89,6 @@ FUZZ_TARGET_INIT(bip324, initialize_chainparams)\r\n     FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\r\n\r\n     ECDHSecret ecdh_secret;\r\n-    ecdh_secret.resize(ECDH_SECRET_SIZE);\r\n     auto ecdh_secret_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(ECDH_SECRET_SIZE);\r\n     ecdh_secret_bytes.resize(ECDH_SECRET_SIZE);\r\n\r\n```\r\nNot sure though what security implications this has without the `secure_allocator` being involved.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-993386102",
      "submitted_at": "2022-06-02T11:23:25Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6981766759,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAGgJU5n",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6981766759",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-12T23:58:34Z"
    },
    {
      "event": "commented",
      "id": 1182609473,
      "node_id": "IC_kwDOABII585GfTBB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182609473",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-13T00:01:17Z",
      "updated_at": "2022-07-13T00:01:17Z",
      "author_association": "MEMBER",
      "body": "This push:\r\n- Rebased\r\n- Addressed comment from @theStack - there's cleansing in the right place and tests for it so we can indeed use `std::array` instead of a secure vector.\r\n- Addressed comment from @stratospher \r\n- Added a couple more derived secrets per new spec in the working group\r\n\r\nReady for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1182609473",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "mentioned",
      "id": 6981774753,
      "node_id": "MEE_lADOABII584_Is2OzwAAAAGgJW2h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6981774753",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-13T00:01:17Z"
    },
    {
      "event": "subscribed",
      "id": 6981774754,
      "node_id": "SE_lADOABII584_Is2OzwAAAAGgJW2i",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6981774754",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-13T00:01:18Z"
    },
    {
      "event": "mentioned",
      "id": 6981774755,
      "node_id": "MEE_lADOABII584_Is2OzwAAAAGgJW2j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6981774755",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-13T00:01:18Z"
    },
    {
      "event": "subscribed",
      "id": 6981774757,
      "node_id": "SE_lADOABII584_Is2OzwAAAAGgJW2l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6981774757",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-13T00:01:18Z"
    },
    {
      "event": "unlabeled",
      "id": 6982141826,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAGgKweC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6982141826",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-13T01:48:41Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 6987502941,
      "node_id": "LE_lADOABII584_Is2OzwAAAAGgfNVd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6987502941",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-13T16:28:58Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1038661558,
      "node_id": "PRR_kwDOABII58496Le2",
      "url": null,
      "actor": null,
      "commit_id": "5f6ca968fbeba9ecc6a56159532c4834920d9d8c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-1038661558",
      "submitted_at": "2022-07-14T11:02:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7013433639,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAGiCIEn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7013433639",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T16:05:37Z"
    },
    {
      "event": "commented",
      "id": 1187687305,
      "node_id": "IC_kwDOABII585GyquJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1187687305",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T16:07:30Z",
      "updated_at": "2022-07-18T16:14:21Z",
      "author_association": "MEMBER",
      "body": "Latest push:\r\n- Rebased\r\n- Addressed comments form @theStack\r\n- The new HKDF derivation no longer needs the elligator swift bytes from the handshake as those are committed to in the initial ECDH.\r\n- This PR now depends on it's anagram #25361 for some constants which simplify the downstream PR #24545. Only last 5 commits belong to this PR.\r\n\r\nReady for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1187687305",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "mentioned",
      "id": 7013449738,
      "node_id": "MEE_lADOABII584_Is2OzwAAAAGiCMAK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7013449738",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T16:07:31Z"
    },
    {
      "event": "subscribed",
      "id": 7013449751,
      "node_id": "SE_lADOABII584_Is2OzwAAAAGiCMAX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7013449751",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T16:07:31Z"
    },
    {
      "event": "unlabeled",
      "id": 7014239417,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAGiFMy5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7014239417",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T17:59:42Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7048756761,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAGkI34Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7048756761",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-22T19:51:26Z"
    },
    {
      "event": "commented",
      "id": 1192890201,
      "node_id": "IC_kwDOABII585HGg9Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1192890201",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-22T19:53:36Z",
      "updated_at": "2022-07-22T20:45:41Z",
      "author_association": "MEMBER",
      "body": "Latest push:\r\n- This PR now depends on [integrated XDH](https://github.com/bitcoin-core/secp256k1/pull/1129) rather than the ECDH module in libsecp256k1\r\n\r\nReady for further review. I don't yet know what's happening with the vs2022 tests on CI, but I will address that once https://github.com/bitcoin-core/secp256k1/pull/1129 is merged.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1192890201",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "reviewed",
      "id": 1048536180,
      "node_id": "PRR_kwDOABII584-f2R0",
      "url": null,
      "actor": null,
      "commit_id": "9f1b84c2830d64bedc3e0c8b1014d581048274cd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-1048536180",
      "submitted_at": "2022-07-23T13:14:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7067743160,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAGlRTO4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7067743160",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-26T19:54:03Z"
    },
    {
      "event": "commented",
      "id": 1195915880,
      "node_id": "IC_kwDOABII585HSDpo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1195915880",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-26T19:54:36Z",
      "updated_at": "2022-07-26T19:54:36Z",
      "author_association": "MEMBER",
      "body": "Addressed comments. Ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1195915880",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7103455231,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAGnZh__",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7103455231",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-01T17:22:29Z"
    },
    {
      "event": "commented",
      "id": 1201494401,
      "node_id": "IC_kwDOABII585HnVmB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1201494401",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-01T17:22:47Z",
      "updated_at": "2022-08-01T17:22:47Z",
      "author_association": "MEMBER",
      "body": "Added rekeying salt to key derivation. Ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1201494401",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "reviewed",
      "id": 1090383174,
      "node_id": "PRR_kwDOABII585A_e1G",
      "url": null,
      "actor": null,
      "commit_id": "cf75ae780b91fe12c625063e7975ef17eb901a21",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-1090383174",
      "submitted_at": "2022-08-30T18:16:03Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7362908760,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAG23RJY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7362908760",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-11T20:29:59Z"
    },
    {
      "event": "commented",
      "id": 1243037383,
      "node_id": "IC_kwDOABII585KFz7H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1243037383",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-11T20:30:21Z",
      "updated_at": "2022-09-11T20:30:21Z",
      "author_association": "MEMBER",
      "body": "Addressed comments from @stratospher and a clang-tidy issue. Ready for further review.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1243037383",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "mentioned",
      "id": 7362909171,
      "node_id": "MEE_lADOABII584_Is2OzwAAAAG23RPz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7362909171",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-11T20:30:21Z"
    },
    {
      "event": "subscribed",
      "id": 7362909174,
      "node_id": "SE_lADOABII584_Is2OzwAAAAG23RP2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7362909174",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-11T20:30:21Z"
    },
    {
      "event": "reviewed",
      "id": 1115947374,
      "node_id": "PRR_kwDOABII585ChAFu",
      "url": null,
      "actor": null,
      "commit_id": "4805bcb2015c236de299ab97adc798f524e4d162",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-1115947374",
      "submitted_at": "2022-09-21T19:06:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "reviewed",
      "id": 1115967334,
      "node_id": "PRR_kwDOABII585ChE9m",
      "url": null,
      "actor": null,
      "commit_id": "4805bcb2015c236de299ab97adc798f524e4d162",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#pullrequestreview-1115967334",
      "submitted_at": "2022-09-21T19:12:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
    },
    {
      "event": "labeled",
      "id": 7453643413,
      "node_id": "LE_lADOABII584_Is2OzwAAAAG8RZKV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7453643413",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-25T15:57:14Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7501070466,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAG_GUCC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7501070466",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-01T21:15:46Z"
    },
    {
      "event": "commented",
      "id": 1264483781,
      "node_id": "IC_kwDOABII585LXn3F",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1264483781",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-01T21:17:22Z",
      "updated_at": "2022-10-01T21:17:41Z",
      "author_association": "MEMBER",
      "body": "Latest push:\r\n- Rebased\r\n- Brought in upstream updates\r\n- Addressed comments from @stratospher \r\n- Changed ECDH tag for better domain separation\r\n- Rekey salt is now 23 bytes instead of 32 bytes to allow rekeying in a single SHA256 compression\r\n\r\nWindows tests failing - but should get resolved once secp/PR 1129 is merged.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1264483781",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "mentioned",
      "id": 7501072374,
      "node_id": "MEE_lADOABII584_Is2OzwAAAAG_GUf2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7501072374",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-01T21:17:22Z"
    },
    {
      "event": "subscribed",
      "id": 7501072376,
      "node_id": "SE_lADOABII584_Is2OzwAAAAG_GUf4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7501072376",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-01T21:17:22Z"
    },
    {
      "event": "unlabeled",
      "id": 7501196167,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAG_GyuH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7501196167",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-01T23:21:27Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7594397621,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAHEqU-1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7594397621",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-15T04:17:00Z"
    },
    {
      "event": "commented",
      "id": 1279653297,
      "node_id": "IC_kwDOABII585MRfWx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1279653297",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-15T04:17:48Z",
      "updated_at": "2022-10-15T04:31:14Z",
      "author_association": "MEMBER",
      "body": "Latest push:\r\n- garbage terminator length is now 16 bytes instead of 8 bytes\r\n- bidirectional garbage  terminators in derivation in accordance with the recently released BIP draft",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1279653297",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "labeled",
      "id": 7619641988,
      "node_id": "LE_lADOABII584_Is2OzwAAAAHGKoKE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7619641988",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-19T09:32:15Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7637416542,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAHHObpe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7637416542",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-21T05:48:12Z"
    },
    {
      "event": "commented",
      "id": 1286490727,
      "node_id": "IC_kwDOABII585Mrkpn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1286490727",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-21T05:49:15Z",
      "updated_at": "2022-10-21T05:49:15Z",
      "author_association": "MEMBER",
      "body": "Rebased.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1286490727",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "unlabeled",
      "id": 7638161862,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAHHRRnG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7638161862",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-21T07:48:59Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7840234110,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAHTUHp-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7840234110",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-18T05:14:59Z"
    },
    {
      "event": "commented",
      "id": 1319559690,
      "node_id": "IC_kwDOABII585OpuIK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319559690",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-18T05:18:43Z",
      "updated_at": "2022-11-18T05:18:43Z",
      "author_association": "MEMBER",
      "body": "Latest push:\r\n- Bringing in upstream optimizations to https://github.com/bitcoin-core/secp256k1/pull/1129",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1319559690",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "labeled",
      "id": 7848568810,
      "node_id": "LE_lADOABII584_Is2OzwAAAAHTz6fq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7848568810",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-19T01:49:20Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 7860111786,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAHUf8mq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7860111786",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-21T18:23:49Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7873651226,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAHVTmIa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7873651226",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-23T05:10:09Z"
    },
    {
      "event": "commented",
      "id": 1324562262,
      "node_id": "IC_kwDOABII585O8zdW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1324562262",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-23T05:12:28Z",
      "updated_at": "2022-11-23T05:12:28Z",
      "author_association": "MEMBER",
      "body": "Bringing in upstream rebase (#26153)",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1324562262",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "labeled",
      "id": 7917766924,
      "node_id": "LE_lADOABII584_Is2OzwAAAAHX74kM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7917766924",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-30T01:22:05Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8049200084,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAHfxQvU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8049200084",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-15T16:52:43Z"
    },
    {
      "event": "commented",
      "id": 1353395420,
      "node_id": "IC_kwDOABII585Qqyzc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1353395420",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-15T16:53:36Z",
      "updated_at": "2022-12-15T16:53:36Z",
      "author_association": "MEMBER",
      "body": "Latest push:\r\n- Rebased upstream changes\r\n- Upstream changes include a new rekey ratchet mechanism (forward security) based on ChaCha20 instead of SHA256. This also means we no longer need the rekey salt in the session derivation process. BIP changes are WIP and coming soon.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1353395420",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "unlabeled",
      "id": 8049629874,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAHfy5qy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8049629874",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-15T17:41:17Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 8108320407,
      "node_id": "LE_lADOABII584_Is2OzwAAAAHjSyaX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8108320407",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-25T11:35:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8214602407,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAHpoOKn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8214602407",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-12T19:10:34Z"
    },
    {
      "event": "commented",
      "id": 1380882259,
      "node_id": "IC_kwDOABII585STpdT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1380882259",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-12T19:10:43Z",
      "updated_at": "2023-01-12T19:10:43Z",
      "author_association": "MEMBER",
      "body": "Rebased",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1380882259",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "unlabeled",
      "id": 8214915832,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAHppar4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8214915832",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-12T19:53:03Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 8219599095,
      "node_id": "LE_lADOABII584_Is2OzwAAAAHp7SD3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8219599095",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-13T10:46:08Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8226122357,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAHqUKp1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8226122357",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-14T05:54:28Z"
    },
    {
      "event": "commented",
      "id": 1382669628,
      "node_id": "IC_kwDOABII585Sad08",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1382669628",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-14T05:54:51Z",
      "updated_at": "2023-01-14T05:54:51Z",
      "author_association": "MEMBER",
      "body": "Rebased",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1382669628",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "unlabeled",
      "id": 8226236533,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAHqUmh1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8226236533",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-14T07:57:55Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8338722975,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAHxBtCf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8338722975",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T22:14:25Z"
    },
    {
      "event": "commented",
      "id": 1401072257,
      "node_id": "IC_kwDOABII585TgqqB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1401072257",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T22:14:36Z",
      "updated_at": "2023-01-23T22:14:36Z",
      "author_association": "MEMBER",
      "body": "Rebased changes from #26153",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1401072257",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "labeled",
      "id": 8380038856,
      "node_id": "LE_lADOABII584_Is2OzwAAAAHzfT7I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8380038856",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-28T16:35:13Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8417526326,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAH1uUI2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8417526326",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-02T06:23:38Z"
    },
    {
      "event": "commented",
      "id": 1413217693,
      "node_id": "IC_kwDOABII585UO_2d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1413217693",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-02T06:27:45Z",
      "updated_at": "2023-02-02T06:27:45Z",
      "author_association": "MEMBER",
      "body": "Rebased. Brought in upstream changes.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1413217693",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "unlabeled",
      "id": 8417678300,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAH1u5Pc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8417678300",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-02T06:49:26Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 8527582471,
      "node_id": "LE_lADOABII584_Is2OzwAAAAH8SJUH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8527582471",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-15T15:53:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhlMDRmMDU4YTQyMzkzNGVhZWViYzhhYTc3NWZkMGY4MWQ1MzQyZWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8e04f058a423934eaeebc8aa775fd0f81d5342ed",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8e04f058a423934eaeebc8aa775fd0f81d5342ed",
      "tree": {
        "sha": "bf6675fe01aa57a094415766a4a01a48f9574168",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bf6675fe01aa57a094415766a4a01a48f9574168"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/94070029fb6b783833973f9fe08a3a871994492f",
          "sha": "94070029fb6b783833973f9fe08a3a871994492f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/94070029fb6b783833973f9fe08a3a871994492f"
        }
      ],
      "message": "RFC8439 nonce and counter for ChaCha20",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-02-20T23:00:56Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2022-05-10T22:34:37Z"
      },
      "sha": "8e04f058a423934eaeebc8aa775fd0f81d5342ed"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdhOWQyZmI4Y2YxMWVlZjhiNmJkODdhZDEwNjZkZjM3NGJmM2I2MjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7a9d2fb8cf11eef8b6bd87ad1066df374bf3b620",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7a9d2fb8cf11eef8b6bd87ad1066df374bf3b620",
      "tree": {
        "sha": "120f0422beae137e2b0c977d3d7ecc328aaee152",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/120f0422beae137e2b0c977d3d7ecc328aaee152"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8e04f058a423934eaeebc8aa775fd0f81d5342ed",
          "sha": "8e04f058a423934eaeebc8aa775fd0f81d5342ed",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8e04f058a423934eaeebc8aa775fd0f81d5342ed"
        }
      ],
      "message": "RFC8439 implementation and tests",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-02-20T23:00:56Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2022-06-09T21:59:28Z"
      },
      "sha": "7a9d2fb8cf11eef8b6bd87ad1066df374bf3b620"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFjZDY2NGU4MDU1OTU0ZWNmOGJlOGJkNTI2NDU1ZTg4YmY4OGJmMmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/acd664e8055954ecf8be8bd526455e88bf88bf2c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/acd664e8055954ecf8be8bd526455e88bf88bf2c",
      "tree": {
        "sha": "dfa49645208cc6facbbf4b2e8288871135a078e7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dfa49645208cc6facbbf4b2e8288871135a078e7"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7a9d2fb8cf11eef8b6bd87ad1066df374bf3b620",
          "sha": "7a9d2fb8cf11eef8b6bd87ad1066df374bf3b620",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7a9d2fb8cf11eef8b6bd87ad1066df374bf3b620"
        }
      ],
      "message": "Adding forward secure FSChaCha20",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-02-20T23:00:56Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2022-06-09T22:00:55Z"
      },
      "sha": "acd664e8055954ecf8be8bd526455e88bf88bf2c"
    },
    {
      "event": "commented",
      "id": 1437814028,
      "node_id": "IC_kwDOABII585Vs00M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1437814028",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-21T03:35:39Z",
      "updated_at": "2023-02-21T03:35:39Z",
      "author_association": "MEMBER",
      "body": "Rebased.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1437814028",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8566500344,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAH-mmv4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8566500344",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-21T03:35:39Z"
    },
    {
      "event": "unlabeled",
      "id": 8566763585,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAH-nnBB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8566763585",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-21T04:45:41Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8697636664,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAIGa2c4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8697636664",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-08T15:23:35Z"
    },
    {
      "event": "commented",
      "id": 1460334287,
      "node_id": "IC_kwDOABII585XCu7P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1460334287",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-08T15:28:29Z",
      "updated_at": "2023-03-08T15:28:29Z",
      "author_association": "MEMBER",
      "body": "Rebased. Brought in changes from https://github.com/bitcoin-core/secp256k1/pull/1129.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1460334287",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "labeled",
      "id": 8725889391,
      "node_id": "LE_lADOABII584_Is2OzwAAAAIIGoFv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8725889391",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-12T16:05:51Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE4Nzc2MWZjOGFhMzZiMWE0YzNhNDNlODY2MDU2ZWQ5NjQyOWM0MjM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/187761fc8aa36b1a4c3a43e866056ed96429c423",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/187761fc8aa36b1a4c3a43e866056ed96429c423",
      "tree": {
        "sha": "5b4ee44cc16bca57e6fdb6ec7ca8031b3f734097",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5b4ee44cc16bca57e6fdb6ec7ca8031b3f734097"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/acd664e8055954ecf8be8bd526455e88bf88bf2c",
          "sha": "acd664e8055954ecf8be8bd526455e88bf88bf2c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/acd664e8055954ecf8be8bd526455e88bf88bf2c"
        }
      ],
      "message": "BIP324 Cipher Suite",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T20:34:11Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2021-01-06T08:48:08Z"
      },
      "sha": "187761fc8aa36b1a4c3a43e866056ed96429c423"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg0MDU4NTZlZDkyNTI1ODA1YTk5YmVhMjczODA3OTljYjMzZWE0N2E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8405856ed92525805a99bea27380799cb33ea47a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8405856ed92525805a99bea27380799cb33ea47a",
      "tree": {
        "sha": "9d08a5833d5d8bee3cb8e11b80c3ab9b22ec8c16",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9d08a5833d5d8bee3cb8e11b80c3ab9b22ec8c16"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/187761fc8aa36b1a4c3a43e866056ed96429c423",
          "sha": "187761fc8aa36b1a4c3a43e866056ed96429c423",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/187761fc8aa36b1a4c3a43e866056ed96429c423"
        }
      ],
      "message": "Allow for RFC8439 AD in cipher suite interface",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T20:34:13Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2022-08-11T23:38:04Z"
      },
      "sha": "8405856ed92525805a99bea27380799cb33ea47a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVhM2U5MTE1NTg0NjczMjNmODhjMTA1MDg4NzA2MzdjZDVkZjRjMjM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea3e911558467323f88c10508870637cd5df4c23",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ea3e911558467323f88c10508870637cd5df4c23",
      "tree": {
        "sha": "4300bd582c5f79dcb6674c49d01448600b65058e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4300bd582c5f79dcb6674c49d01448600b65058e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f4e42a78c75719ad6a99962360ec67d92a563a9d",
          "sha": "f4e42a78c75719ad6a99962360ec67d92a563a9d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f4e42a78c75719ad6a99962360ec67d92a563a9d"
        },
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8405856ed92525805a99bea27380799cb33ea47a",
          "sha": "8405856ed92525805a99bea27380799cb33ea47a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8405856ed92525805a99bea27380799cb33ea47a"
        }
      ],
      "message": "Merge branch 'bip324-cipher-suite' into bip324-handshake",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:41:16Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:41:16Z"
      },
      "sha": "ea3e911558467323f88c10508870637cd5df4c23"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk4NGIzZDBhMWZhYWJjMTY1N2UwZGQzMzQzMmZkYWRmZDc4MzM1YTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/984b3d0a1faabc1657e0dd33432fdadfd78335a9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/984b3d0a1faabc1657e0dd33432fdadfd78335a9",
      "tree": {
        "sha": "a5120fb3699b8209002f9d53b45cfcfe23b1f397",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a5120fb3699b8209002f9d53b45cfcfe23b1f397"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/763079a3f1b937f54e3c2d4166d296f596f7be1b",
          "sha": "763079a3f1b937f54e3c2d4166d296f596f7be1b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/763079a3f1b937f54e3c2d4166d296f596f7be1b"
        }
      ],
      "message": "Squashed 'src/secp256k1/' changes from bdf39000b9..8034c67a48\n\n8034c67a48 Add doc/ellswift.md with ElligatorSwift explanation\ne90aa4e62e Add ellswift testing to CI\n131faedd8a Add ElligatorSwift ctime tests\n198a04c058 Add tests for ElligatorSwift\n9984bfe476 Add ElligatorSwift benchmarks\nf053da3ab7 Add ellswift module implementing ElligatorSwift\n76c64be237 Add functions to test if X coordinate is valid\naff948fca2 Add benchmark for key generation\n5ed9314d6d Add exhaustive tests for ecmult_const_xonly\nb69fe88d5e Add x-only ecmult_const version for x=n/d\n427bc3cdcf Merge bitcoin-core/secp256k1#1236: Update comment for secp256k1_modinv32_inv256\n647f0a5cb1 Update comment for secp256k1_modinv32_inv256\n5658209459 Merge bitcoin-core/secp256k1#1228: release cleanup: bump version after 0.3.0\n28e63f7ea7 release cleanup: bump version after 0.3.0\n\ngit-subtree-dir: src/secp256k1\ngit-subtree-split: 8034c67a48dc1334bc74ee4ba239111a23d9789e",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:41:28Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:41:28Z"
      },
      "sha": "984b3d0a1faabc1657e0dd33432fdadfd78335a9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDAwN2E5MmVkODAyMzE5ZTljNzAxMzNlNDFkNmViNWEzZjJmMWZmNjk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/007a92ed802319e9c70133e41d6eb5a3f2f1ff69",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/007a92ed802319e9c70133e41d6eb5a3f2f1ff69",
      "tree": {
        "sha": "28b7f84780fe5b8c01710422470b3b572a1c34ee",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/28b7f84780fe5b8c01710422470b3b572a1c34ee"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea3e911558467323f88c10508870637cd5df4c23",
          "sha": "ea3e911558467323f88c10508870637cd5df4c23",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ea3e911558467323f88c10508870637cd5df4c23"
        },
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/984b3d0a1faabc1657e0dd33432fdadfd78335a9",
          "sha": "984b3d0a1faabc1657e0dd33432fdadfd78335a9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/984b3d0a1faabc1657e0dd33432fdadfd78335a9"
        }
      ],
      "message": "Merge commit '984b3d0a1faabc1657e0dd33432fdadfd78335a9' into bip324-handshake",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:41:28Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:41:28Z"
      },
      "sha": "007a92ed802319e9c70133e41d6eb5a3f2f1ff69"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDNkMWIyNzY5NDllYWQ1NzBlZDZlMmYxMDQ5NmNhODIwZmVmMGJkZTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3d1b276949ead570ed6e2f10496ca820fef0bde1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3d1b276949ead570ed6e2f10496ca820fef0bde1",
      "tree": {
        "sha": "51156e17f44bbb6301ed263357d024d95b7ad153",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/51156e17f44bbb6301ed263357d024d95b7ad153"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/007a92ed802319e9c70133e41d6eb5a3f2f1ff69",
          "sha": "007a92ed802319e9c70133e41d6eb5a3f2f1ff69",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/007a92ed802319e9c70133e41d6eb5a3f2f1ff69"
        }
      ],
      "message": "Enable ECDH computation on secp256k1 keys",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:43:10Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2022-07-22T16:19:12Z"
      },
      "sha": "3d1b276949ead570ed6e2f10496ca820fef0bde1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRiN2JlODU1ZGQ5MzUyMGEzMGIzZmMxNDlhNWRiMGM5MzlkOTJmMTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b7be855dd93520a30b3fc149a5db0c939d92f18",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4b7be855dd93520a30b3fc149a5db0c939d92f18",
      "tree": {
        "sha": "7aaf45d1bad675db9f87d704a6358f20f8a066a7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7aaf45d1bad675db9f87d704a6358f20f8a066a7"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3d1b276949ead570ed6e2f10496ca820fef0bde1",
          "sha": "3d1b276949ead570ed6e2f10496ca820fef0bde1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3d1b276949ead570ed6e2f10496ca820fef0bde1"
        }
      ],
      "message": "Bench test for ECDH",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:43:10Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2022-07-22T16:46:39Z"
      },
      "sha": "4b7be855dd93520a30b3fc149a5db0c939d92f18"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZmZmE2OGY0ZGJlMDgyMTUwYTVlZjgxODc0MmM1ZjkwNzE1OThmZTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ffa68f4dbe082150a5ef818742c5f9071598fe1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6ffa68f4dbe082150a5ef818742c5f9071598fe1",
      "tree": {
        "sha": "dab3281a80f7bf1699d165633d8cb9f4f4be51fa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dab3281a80f7bf1699d165633d8cb9f4f4be51fa"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b7be855dd93520a30b3fc149a5db0c939d92f18",
          "sha": "4b7be855dd93520a30b3fc149a5db0c939d92f18",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4b7be855dd93520a30b3fc149a5db0c939d92f18"
        }
      ],
      "message": "Fuzz test for ECDH",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:43:10Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2022-07-22T17:08:01Z"
      },
      "sha": "6ffa68f4dbe082150a5ef818742c5f9071598fe1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRjMjUyN2ZiMmY2ZTlkZTk0Y2Y5ZTUwZjQwZWE3YTNiMDFjMTdmM2I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dc2527fb2f6e9de94cf9e50f40ea7a3b01c17f3b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/dc2527fb2f6e9de94cf9e50f40ea7a3b01c17f3b",
      "tree": {
        "sha": "162d745cdc04affeaa54054ef7e7ba9d5d1a5e07",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/162d745cdc04affeaa54054ef7e7ba9d5d1a5e07"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ffa68f4dbe082150a5ef818742c5f9071598fe1",
          "sha": "6ffa68f4dbe082150a5ef818742c5f9071598fe1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6ffa68f4dbe082150a5ef818742c5f9071598fe1"
        }
      ],
      "message": "HKDF key derivation from ECDH secret for BIP324",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:43:10Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2021-11-16T19:54:47Z"
      },
      "sha": "dc2527fb2f6e9de94cf9e50f40ea7a3b01c17f3b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE3OGVmNzU3YmFiNmRiNDM3YzhlYmVjZDZmYTcwMDliMTZkYTQwZDY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "tree": {
        "sha": "41a7c22b2877df0b3b1ec4d15c35978bab962e55",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/41a7c22b2877df0b3b1ec4d15c35978bab962e55"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dc2527fb2f6e9de94cf9e50f40ea7a3b01c17f3b",
          "sha": "dc2527fb2f6e9de94cf9e50f40ea7a3b01c17f3b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/dc2527fb2f6e9de94cf9e50f40ea7a3b01c17f3b"
        }
      ],
      "message": "Fuzz test for BIP324 key derivation",
      "committer": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2023-03-20T22:43:10Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2021-11-18T23:28:52Z"
      },
      "sha": "178ef757bab6db437c8ebecd6fa7009b16da40d6"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8801130746,
      "node_id": "HRFPE_lADOABII584_Is2OzwAAAAIMlpj6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8801130746",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T04:03:22Z"
    },
    {
      "event": "commented",
      "id": 1477251465,
      "node_id": "IC_kwDOABII585YDRGJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1477251465",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T04:03:30Z",
      "updated_at": "2023-03-21T04:03:30Z",
      "author_association": "MEMBER",
      "body": "Rebased.",
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1477251465",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "unlabeled",
      "id": 8801446075,
      "node_id": "UNLE_lADOABII584_Is2OzwAAAAIMm2i7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8801446075",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T05:07:26Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 8913479026,
      "node_id": "LE_lADOABII584_Is2OzwAAAAITSOVy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8913479026",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-03T14:08:59Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1494395236,
      "node_id": "IC_kwDOABII585ZEqlk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1494395236",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-03T14:09:00Z",
      "updated_at": "2023-04-03T14:09:00Z",
      "author_association": "MEMBER",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1494395236",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "commented",
      "id": 1512705307,
      "node_id": "IC_kwDOABII585aKg0b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1512705307",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-18T08:50:23Z",
      "updated_at": "2023-04-18T08:50:23Z",
      "author_association": "MEMBER",
      "body": "Closing this for now, as it's partly included in #27479.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1512705307",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561"
    },
    {
      "event": "closed",
      "id": 9033155348,
      "node_id": "CE_lADOABII584_Is2OzwAAAAIaawMU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9033155348",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-18T08:50:23Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755498657",
      "pull_request_review_id": 814167558,
      "id": 755498657,
      "node_id": "PRRC_kwDOABII584tB_6h",
      "diff_hunk": "@@ -332,6 +333,23 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+std::optional<ECDHSecret> CKey::ComputeECDHSecret(const CPubKey& pubkey) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return {};\n+    }\n+\n+    ECDHSecret secret;\n+    secret.resize(ECDH_SECRET_SIZE);\n+\n+    if (secp256k1_ecdh(secp256k1_context_sign, secret.data(), &pubkey_internal,",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "2d58b293461c0b8890ce82eb5683c06ff805b85e",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The case of secp256k1_ecdh returning 0 corresponds to invalid input. That won't happen here; I think you can assert instead and avoid the `std::optional` in the return type.",
      "created_at": "2021-11-23T20:58:40Z",
      "updated_at": "2021-11-23T21:19:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755498657",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755498657"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 346,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755500261",
      "pull_request_review_id": 814167558,
      "id": 755500261,
      "node_id": "PRRC_kwDOABII584tCATl",
      "diff_hunk": "@@ -305,4 +305,20 @@ FUZZ_TARGET_INIT(key, initialize_key)\n             assert(key == loaded_key);\n         }\n     }\n+\n+    {\n+        // Test ECDH computation with another key",
      "path": "src/test/fuzz/key.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "042f771e16f887b1364291bb05b9da9d74c9f45c",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You could do a much stronger test: take two private keys as input fuzz data, compute the corresponding public keys, and compute the ecdh secrets from (sec1,pub2) and (sec2,pub1), and check that they match.\r\n\r\nIt's cryptographic data (hashes and EC operations), so this is very unlikely to actually uncover any bugs unless they're very apparent, but this way the fuzz test actually verifies the full behavior we desire from these functions.",
      "created_at": "2021-11-23T21:01:18Z",
      "updated_at": "2021-11-23T21:19:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755500261",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755500261"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 310,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755501124",
      "pull_request_review_id": 814167558,
      "id": 755501124,
      "node_id": "PRRC_kwDOABII584tCAhE",
      "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys\n+{\n+public:\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_F; // k1a\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_V; // k2a\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_F; // k1b\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_V; // k2b\n+    std::array<uint8_t, BIP324_KEY_LEN> session_id;\n+\n+    // Takes ownership of the ECDH secret and wipes the ephemeral secret once\n+    // the derivation is complete.\n+    explicit BIP324Keys(ECDHSecret&& ecdh_secret, const Span<uint8_t>& initiator_hdata, const Span<uint8_t>& responder_hdata);",
      "path": "src/util/bip324.h",
      "position": null,
      "original_position": 26,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: pass Spans by value.",
      "created_at": "2021-11-23T21:02:47Z",
      "updated_at": "2021-11-23T21:19:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755501124",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755501124"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755505318",
      "pull_request_review_id": 814167558,
      "id": 755505318,
      "node_id": "PRRC_kwDOABII584tCBim",
      "diff_hunk": "@@ -0,0 +1,36 @@\n+// Copyright (c) 2021 The Bitcoin Core developers",
      "path": "src/util/bip324.cpp",
      "position": null,
      "original_position": 1,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm not sure this belongs in util, it seems pretty specific to Bitcoin.",
      "created_at": "2021-11-23T21:10:08Z",
      "updated_at": "2021-11-23T21:19:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755505318",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755505318"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755510650",
      "pull_request_review_id": 814167558,
      "id": 755510650,
      "node_id": "PRRC_kwDOABII584tCC16",
      "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys",
      "path": "src/util/bip324.h",
      "position": null,
      "original_position": 15,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Not sure if a class for this is desirable in the first place. These keys shouldn't be long-lived in any case (they're only used to initialize the stream ciphers, and then destroyed). That can just as well be done with a simple function call?",
      "created_at": "2021-11-23T21:19:41Z",
      "updated_at": "2021-11-23T21:19:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755510650",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755510650"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114972",
      "pull_request_review_id": 816282146,
      "id": 757114972,
      "node_id": "PRRC_kwDOABII584tIKhc",
      "diff_hunk": "@@ -332,6 +333,23 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+std::optional<ECDHSecret> CKey::ComputeECDHSecret(const CPubKey& pubkey) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return {};\n+    }\n+\n+    ECDHSecret secret;\n+    secret.resize(ECDH_SECRET_SIZE);\n+\n+    if (secp256k1_ecdh(secp256k1_context_sign, secret.data(), &pubkey_internal,",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "2d58b293461c0b8890ce82eb5683c06ff805b85e",
      "in_reply_to_id": 755498657,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done - still needed a boolean return value due to the other failure case above.",
      "created_at": "2021-11-25T20:24:19Z",
      "updated_at": "2021-11-25T20:24:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114972",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114972"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 346,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114984",
      "pull_request_review_id": 816282165,
      "id": 757114984,
      "node_id": "PRRC_kwDOABII584tIKho",
      "diff_hunk": "@@ -305,4 +305,20 @@ FUZZ_TARGET_INIT(key, initialize_key)\n             assert(key == loaded_key);\n         }\n     }\n+\n+    {\n+        // Test ECDH computation with another key",
      "path": "src/test/fuzz/key.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "042f771e16f887b1364291bb05b9da9d74c9f45c",
      "in_reply_to_id": 755500261,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done!",
      "created_at": "2021-11-25T20:24:23Z",
      "updated_at": "2021-11-25T20:24:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114984",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114984"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 310,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115000",
      "pull_request_review_id": 816282189,
      "id": 757115000,
      "node_id": "PRRC_kwDOABII584tIKh4",
      "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys\n+{\n+public:\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_F; // k1a\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_V; // k2a\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_F; // k1b\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_V; // k2b\n+    std::array<uint8_t, BIP324_KEY_LEN> session_id;\n+\n+    // Takes ownership of the ECDH secret and wipes the ephemeral secret once\n+    // the derivation is complete.\n+    explicit BIP324Keys(ECDHSecret&& ecdh_secret, const Span<uint8_t>& initiator_hdata, const Span<uint8_t>& responder_hdata);",
      "path": "src/util/bip324.h",
      "position": null,
      "original_position": 26,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "in_reply_to_id": 755501124,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2021-11-25T20:24:26Z",
      "updated_at": "2021-11-25T20:24:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115000",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115000"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115010",
      "pull_request_review_id": 816282205,
      "id": 757115010,
      "node_id": "PRRC_kwDOABII584tIKiC",
      "diff_hunk": "@@ -0,0 +1,36 @@\n+// Copyright (c) 2021 The Bitcoin Core developers",
      "path": "src/util/bip324.cpp",
      "position": null,
      "original_position": 1,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "in_reply_to_id": 755505318,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I moved this into `net.{h|cpp}` as that's where it will be used. I didn't particularly want to increase the length of those files, so please let me know if the right thing to do is to have it in `src/bip324.{h|cpp}`",
      "created_at": "2021-11-25T20:24:30Z",
      "updated_at": "2021-11-25T20:24:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115010",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115010"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115092",
      "pull_request_review_id": 816282312,
      "id": 757115092,
      "node_id": "PRRC_kwDOABII584tIKjU",
      "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys",
      "path": "src/util/bip324.h",
      "position": null,
      "original_position": 15,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "in_reply_to_id": 755510650,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2021-11-25T20:24:44Z",
      "updated_at": "2021-11-25T20:24:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115092",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115092"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762791112",
      "pull_request_review_id": 823656777,
      "id": 762791112,
      "node_id": "PRRC_kwDOABII584td0TI",
      "diff_hunk": "@@ -399,6 +401,38 @@ static CAddress GetBindAddress(SOCKET sock)\n     return addr_bind;\n }\n \n+bool derive_bip324_keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why snake case for function name `derive_bip324_keys` here?",
      "created_at": "2021-12-06T08:31:47Z",
      "updated_at": "2021-12-06T08:31:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r762791112",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762791112"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 404,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762793756",
      "pull_request_review_id": 823660440,
      "id": 762793756,
      "node_id": "PRRC_kwDOABII584td08c",
      "diff_hunk": "@@ -399,6 +401,38 @@ static CAddress GetBindAddress(SOCKET sock)\n     return addr_bind;\n }\n \n+bool derive_bip324_keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)\n+{\n+    if (ecdh_secret.size() != ECDH_SECRET_SIZE) {\n+        return false;\n+    }\n+\n+    std::string salt{\"bitcoin_v2_shared_secret\"};",
      "path": "src/net.cpp",
      "position": 22,
      "original_position": 26,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The BIP currently refers to `BitcoinSharedSecret`. I guess to ack this, i'd have to see a new bip :)",
      "created_at": "2021-12-06T08:35:55Z",
      "updated_at": "2021-12-06T08:35:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r762793756",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762793756"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 442,
      "original_line": 442,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765397863",
      "pull_request_review_id": 827156754,
      "id": 765397863,
      "node_id": "PRRC_kwDOABII584tnwtn",
      "diff_hunk": "@@ -399,6 +401,38 @@ static CAddress GetBindAddress(SOCKET sock)\n     return addr_bind;\n }\n \n+bool derive_bip324_keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)\n+{\n+    if (ecdh_secret.size() != ECDH_SECRET_SIZE) {\n+        return false;\n+    }\n+\n+    std::string salt{\"bitcoin_v2_shared_secret\"};",
      "path": "src/net.cpp",
      "position": 22,
      "original_position": 26,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "in_reply_to_id": 762793756,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": ":) I am working on re-structuring it. It's close. Will keep you updated here.",
      "created_at": "2021-12-09T02:58:59Z",
      "updated_at": "2021-12-09T02:58:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r765397863",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765397863"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 442,
      "original_line": 442,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765399130",
      "pull_request_review_id": 827158496,
      "id": 765399130,
      "node_id": "PRRC_kwDOABII584tnxBa",
      "diff_hunk": "@@ -399,6 +401,38 @@ static CAddress GetBindAddress(SOCKET sock)\n     return addr_bind;\n }\n \n+bool derive_bip324_keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "in_reply_to_id": 762791112,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Oh oops. I don't know why I did that. Updated.",
      "created_at": "2021-12-09T03:02:56Z",
      "updated_at": "2021-12-09T03:02:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r765399130",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765399130"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 404,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/800467052",
      "pull_request_review_id": 874403910,
      "id": 800467052,
      "node_id": "PRRC_kwDOABII584vtihs",
      "diff_hunk": "@@ -0,0 +1,30 @@\n+// Copyright (c) 2021 The Bitcoin Core developers",
      "path": "src/bench/ecdh.cpp",
      "position": null,
      "original_position": 1,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "773cbc93b102a87a3ec8f852e7aca595489222a7",
      "in_reply_to_id": null,
      "user": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: if you rebase this at some point, might as well update this",
      "created_at": "2022-02-07T09:34:54Z",
      "updated_at": "2022-02-07T09:38:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r800467052",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/800467052"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850603486",
      "pull_request_review_id": 942511239,
      "id": 850603486,
      "node_id": "PRRC_kwDOABII584ysy3e",
      "diff_hunk": "@@ -1957,7 +1957,7 @@ LIBS_TEMP=\"$LIBS\"\n unset LIBS\n LIBS=\"$LIBS_TEMP\"\n \n-ac_configure_args=\"${ac_configure_args} --disable-shared --with-pic --enable-benchmark=no --enable-module-recovery --enable-module-schnorrsig\"\n+ac_configure_args=\"${ac_configure_args} --disable-shared --with-pic --enable-benchmark=no --enable-module-recovery --enable-module-schnorrsig --enable-module-ecdh -enable-experimental\"",
      "path": "configure.ac",
      "position": null,
      "original_position": 5,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You can drop `-enable-experimental`. It should no-longer be required for `--enable-module-ecdh`, and note the missing `-` in any case.",
      "created_at": "2022-04-14T16:17:41Z",
      "updated_at": "2022-04-14T16:17:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850603486",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850603486"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1960,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850641745",
      "pull_request_review_id": 942563365,
      "id": 850641745,
      "node_id": "PRRC_kwDOABII584ys8NR",
      "diff_hunk": "@@ -332,6 +334,40 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+// Returns just the x-coordinate in big endian\n+static int bip324_ecdh_hash(unsigned char* output, const unsigned char* x32, const unsigned char* y32, void* data)\n+{\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+bool CKey::ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata,\n+                                   ECDHSecret& secret) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return false;\n+    }\n+\n+    std::vector<uint8_t, secure_allocator<uint8_t>> xonly_ecdh;\n+    xonly_ecdh.resize(ECDH_SECRET_SIZE);\n+    assert(secp256k1_ecdh(secp256k1_context_sign, xonly_ecdh.data(), &pubkey_internal,\n+                          keydata.data(), bip324_ecdh_hash, NULL));\n+\n+    CSHA256 hasher;\n+    hasher.Write(BIP324_ECDH_TAG.data(), BIP324_ECDH_TAG.size());\n+    hasher.Write(BIP324_ECDH_TAG.data(), BIP324_ECDH_TAG.size());\n+    hasher.Write(initiator_hdata.data(), initiator_hdata.size());\n+    hasher.Write(responder_hdata.data(), responder_hdata.size());\n+\n+    hasher.Write(xonly_ecdh.data(), xonly_ecdh.size());\n+\n+    secret.resize(ECDH_SECRET_SIZE);\n+    hasher.Finalize(secret.data());\n+    memory_cleanse(xonly_ecdh.data(), ECDH_SECRET_SIZE);",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 45,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is unnecessary, as it's already using secure_allocator, which wipes memory on deallocation.\r\n\r\nThat said, using a vector with secure_allocator is overkill here; you can just use an array (which doesn't need allocation) - and then you do need the cleanse call.",
      "created_at": "2022-04-14T17:07:13Z",
      "updated_at": "2022-04-14T17:07:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850641745",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850641745"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 367,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850728806",
      "pull_request_review_id": 942692576,
      "id": 850728806,
      "node_id": "PRRC_kwDOABII584ytRdm",
      "diff_hunk": "@@ -914,4 +916,70 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_hdata = \"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\";\n+    static const std::string responder_hdata = \"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\";\n+\n+    auto initiator_hdata_vec = ParseHex(initiator_hdata);\n+    Span<uint8_t> initiator_hdata_span{initiator_hdata_vec.data(), initiator_hdata_vec.size()};",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "These spans are unnecessary. You can just pass `initiator_hdata_vec` etc. whereever `initiator_hdata_span` is used (they get converted automatically).",
      "created_at": "2022-04-14T19:06:25Z",
      "updated_at": "2022-04-14T19:06:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850728806",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850728806"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 930,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850729539",
      "pull_request_review_id": 942693537,
      "id": 850729539,
      "node_id": "PRRC_kwDOABII584ytRpD",
      "diff_hunk": "@@ -914,4 +916,70 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_hdata = \"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\";\n+    static const std::string responder_hdata = \"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\";\n+\n+    auto initiator_hdata_vec = ParseHex(initiator_hdata);\n+    Span<uint8_t> initiator_hdata_span{initiator_hdata_vec.data(), initiator_hdata_vec.size()};\n+\n+    auto responder_hdata_vec = ParseHex(responder_hdata);\n+    Span<uint8_t> responder_hdata_span{responder_hdata_vec.data(), responder_hdata_vec.size()};\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_pubkey = initiator_key.GetPubKey();\n+    auto responder_pubkey = responder_key.GetPubKey();\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    BOOST_CHECK(initiator_key.ComputeBIP324ECDHSecret(responder_pubkey, initiator_hdata_span, responder_hdata_span, initiator_secret));\n+    BOOST_CHECK(responder_key.ComputeBIP324ECDHSecret(initiator_pubkey, initiator_hdata_span, responder_hdata_span, responder_secret));\n+\n+    BOOST_CHECK_EQUAL(ECDH_SECRET_SIZE, initiator_secret.size());\n+    BOOST_CHECK_EQUAL(ECDH_SECRET_SIZE, responder_secret.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_secret.data(), responder_secret.data(), ECDH_SECRET_SIZE));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    BOOST_CHECK(DeriveBIP324Keys(std::move(initiator_secret), initiator_hdata_span, responder_hdata_span, initiator_keys));\n+    BOOST_CHECK(DeriveBIP324Keys(std::move(responder_secret), initiator_hdata_span, responder_hdata_span, responder_keys));\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_F.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.initiator_F.size(), responder_keys.initiator_F.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.initiator_F.data(), responder_keys.initiator_F.data(), initiator_keys.initiator_F.size()));\n+    BOOST_CHECK_EQUAL(\"fb9b2551d1ac88a7def2c2e4cfa25592ffbea4c42adf26d83fae50d5f5036415\", HexStr(Span{initiator_keys.initiator_F}));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_V.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.initiator_V.size(), responder_keys.initiator_V.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.initiator_V.data(), responder_keys.initiator_V.data(), initiator_keys.initiator_V.size()));\n+    BOOST_CHECK_EQUAL(\"c141b106c8a5ae14e355ab89ca6d8e418945b7313e0d65a8d5742f1f11de5050\", HexStr(Span{initiator_keys.initiator_V}));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_F.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.responder_F.size(), responder_keys.responder_F.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.responder_F.data(), responder_keys.responder_F.data(), initiator_keys.responder_F.size()));\n+    BOOST_CHECK_EQUAL(\"4a5c97a4317a0e1d65fa69d3d35a74b32ef3bdd2de9910a06709357d5584fee2\", HexStr(Span{initiator_keys.responder_F}));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_V.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.responder_V.size(), responder_keys.responder_V.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.responder_V.data(), responder_keys.responder_V.data(), initiator_keys.responder_V.size()));\n+    BOOST_CHECK_EQUAL(\"94e374b822bc293b4eb3475aed2457e1b2fc9691df9ffb02afc462c36d513783\", HexStr(Span{initiator_keys.responder_V}));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.session_id.size(), responder_keys.session_id.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.session_id.data(), responder_keys.session_id.data(), initiator_keys.session_id.size()));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 74,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You can use `BOOST_CHECK(initiator_keys.session_id == responder_keys.session_id)` instead here.",
      "created_at": "2022-04-14T19:07:36Z",
      "updated_at": "2022-04-14T19:07:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850729539",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850729539"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 980,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850737479",
      "pull_request_review_id": 942704299,
      "id": 850737479,
      "node_id": "PRRC_kwDOABII584ytTlH",
      "diff_hunk": "@@ -22,6 +25,14 @@\n  */\n typedef std::vector<unsigned char, secure_allocator<unsigned char> > CPrivKey;\n \n+constexpr static size_t ECDH_SECRET_SIZE = CSHA256::OUTPUT_SIZE;\n+\n+// SHA256(\"secp256k1_ellsq_xonly_ecdh\") proven with a unit test (xonly_ecdh_tag)\n+const static auto BIP324_ECDH_TAG = ParseHex(\"4dbebba5394890bf7370e9ca2ca6112941b974c56950e5c4fef7f00a2bbf3e55\");",
      "path": "src/key.h",
      "position": null,
      "original_position": 21,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You can also use `const CHashWriter HASHER_BIP324_ECDH = TaggedHash(\"secp256k1_ellsq_xonly_ecdh\");`, and then do the rest of the hashing using `(HashWriter(HASHER_BIP324_ECDH) << [rest of stuff] << [to hash]).GetSHA256()`. That precomputes the entire midstate after the tag.",
      "created_at": "2022-04-14T19:19:13Z",
      "updated_at": "2022-04-14T19:19:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850737479",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850737479"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850740291",
      "pull_request_review_id": 942708102,
      "id": 850740291,
      "node_id": "PRRC_kwDOABII584ytURD",
      "diff_hunk": "@@ -332,6 +334,40 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+// Returns just the x-coordinate in big endian\n+static int bip324_ecdh_hash(unsigned char* output, const unsigned char* x32, const unsigned char* y32, void* data)\n+{\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+bool CKey::ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata,",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You can make the arguments here take `Span<const uint8_t>` - or even `Span<const std::byte>`. I don't think this function needs to be able to mutate the passed in hdata.",
      "created_at": "2022-04-14T19:23:35Z",
      "updated_at": "2022-04-14T19:23:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850740291",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850740291"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 344,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850955289",
      "pull_request_review_id": 943076848,
      "id": 850955289,
      "node_id": "PRRC_kwDOABII584yuIwZ",
      "diff_hunk": "@@ -0,0 +1,30 @@\n+// Copyright (c) 2021 The Bitcoin Core developers",
      "path": "src/bench/ecdh.cpp",
      "position": null,
      "original_position": 1,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "773cbc93b102a87a3ec8f852e7aca595489222a7",
      "in_reply_to_id": 800467052,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2022-04-15T01:09:49Z",
      "updated_at": "2022-04-15T01:09:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850955289",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850955289"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850955445",
      "pull_request_review_id": 943076911,
      "id": 850955445,
      "node_id": "PRRC_kwDOABII584yuIy1",
      "diff_hunk": "@@ -1957,7 +1957,7 @@ LIBS_TEMP=\"$LIBS\"\n unset LIBS\n LIBS=\"$LIBS_TEMP\"\n \n-ac_configure_args=\"${ac_configure_args} --disable-shared --with-pic --enable-benchmark=no --enable-module-recovery --enable-module-schnorrsig\"\n+ac_configure_args=\"${ac_configure_args} --disable-shared --with-pic --enable-benchmark=no --enable-module-recovery --enable-module-schnorrsig --enable-module-ecdh -enable-experimental\"",
      "path": "configure.ac",
      "position": null,
      "original_position": 5,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": 850603486,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks. Done.",
      "created_at": "2022-04-15T01:10:00Z",
      "updated_at": "2022-04-15T01:10:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850955445",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850955445"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1960,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850955813",
      "pull_request_review_id": 943077043,
      "id": 850955813,
      "node_id": "PRRC_kwDOABII584yuI4l",
      "diff_hunk": "@@ -332,6 +334,40 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+// Returns just the x-coordinate in big endian\n+static int bip324_ecdh_hash(unsigned char* output, const unsigned char* x32, const unsigned char* y32, void* data)\n+{\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+bool CKey::ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata,\n+                                   ECDHSecret& secret) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return false;\n+    }\n+\n+    std::vector<uint8_t, secure_allocator<uint8_t>> xonly_ecdh;\n+    xonly_ecdh.resize(ECDH_SECRET_SIZE);\n+    assert(secp256k1_ecdh(secp256k1_context_sign, xonly_ecdh.data(), &pubkey_internal,\n+                          keydata.data(), bip324_ecdh_hash, NULL));\n+\n+    CSHA256 hasher;\n+    hasher.Write(BIP324_ECDH_TAG.data(), BIP324_ECDH_TAG.size());\n+    hasher.Write(BIP324_ECDH_TAG.data(), BIP324_ECDH_TAG.size());\n+    hasher.Write(initiator_hdata.data(), initiator_hdata.size());\n+    hasher.Write(responder_hdata.data(), responder_hdata.size());\n+\n+    hasher.Write(xonly_ecdh.data(), xonly_ecdh.size());\n+\n+    secret.resize(ECDH_SECRET_SIZE);\n+    hasher.Finalize(secret.data());\n+    memory_cleanse(xonly_ecdh.data(), ECDH_SECRET_SIZE);",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 45,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": 850641745,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done - simpler with array + cleanse.",
      "created_at": "2022-04-15T01:10:28Z",
      "updated_at": "2022-04-15T01:10:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850955813",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850955813"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 367,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850955968",
      "pull_request_review_id": 943077104,
      "id": 850955968,
      "node_id": "PRRC_kwDOABII584yuI7A",
      "diff_hunk": "@@ -914,4 +916,70 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_hdata = \"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\";\n+    static const std::string responder_hdata = \"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\";\n+\n+    auto initiator_hdata_vec = ParseHex(initiator_hdata);\n+    Span<uint8_t> initiator_hdata_span{initiator_hdata_vec.data(), initiator_hdata_vec.size()};",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": 850728806,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2022-04-15T01:10:40Z",
      "updated_at": "2022-04-15T01:10:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850955968",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850955968"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 930,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850956064",
      "pull_request_review_id": 943077141,
      "id": 850956064,
      "node_id": "PRRC_kwDOABII584yuI8g",
      "diff_hunk": "@@ -914,4 +916,70 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_hdata = \"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\";\n+    static const std::string responder_hdata = \"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\";\n+\n+    auto initiator_hdata_vec = ParseHex(initiator_hdata);\n+    Span<uint8_t> initiator_hdata_span{initiator_hdata_vec.data(), initiator_hdata_vec.size()};\n+\n+    auto responder_hdata_vec = ParseHex(responder_hdata);\n+    Span<uint8_t> responder_hdata_span{responder_hdata_vec.data(), responder_hdata_vec.size()};\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_pubkey = initiator_key.GetPubKey();\n+    auto responder_pubkey = responder_key.GetPubKey();\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    BOOST_CHECK(initiator_key.ComputeBIP324ECDHSecret(responder_pubkey, initiator_hdata_span, responder_hdata_span, initiator_secret));\n+    BOOST_CHECK(responder_key.ComputeBIP324ECDHSecret(initiator_pubkey, initiator_hdata_span, responder_hdata_span, responder_secret));\n+\n+    BOOST_CHECK_EQUAL(ECDH_SECRET_SIZE, initiator_secret.size());\n+    BOOST_CHECK_EQUAL(ECDH_SECRET_SIZE, responder_secret.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_secret.data(), responder_secret.data(), ECDH_SECRET_SIZE));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    BOOST_CHECK(DeriveBIP324Keys(std::move(initiator_secret), initiator_hdata_span, responder_hdata_span, initiator_keys));\n+    BOOST_CHECK(DeriveBIP324Keys(std::move(responder_secret), initiator_hdata_span, responder_hdata_span, responder_keys));\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_F.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.initiator_F.size(), responder_keys.initiator_F.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.initiator_F.data(), responder_keys.initiator_F.data(), initiator_keys.initiator_F.size()));\n+    BOOST_CHECK_EQUAL(\"fb9b2551d1ac88a7def2c2e4cfa25592ffbea4c42adf26d83fae50d5f5036415\", HexStr(Span{initiator_keys.initiator_F}));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_V.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.initiator_V.size(), responder_keys.initiator_V.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.initiator_V.data(), responder_keys.initiator_V.data(), initiator_keys.initiator_V.size()));\n+    BOOST_CHECK_EQUAL(\"c141b106c8a5ae14e355ab89ca6d8e418945b7313e0d65a8d5742f1f11de5050\", HexStr(Span{initiator_keys.initiator_V}));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_F.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.responder_F.size(), responder_keys.responder_F.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.responder_F.data(), responder_keys.responder_F.data(), initiator_keys.responder_F.size()));\n+    BOOST_CHECK_EQUAL(\"4a5c97a4317a0e1d65fa69d3d35a74b32ef3bdd2de9910a06709357d5584fee2\", HexStr(Span{initiator_keys.responder_F}));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_V.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.responder_V.size(), responder_keys.responder_V.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.responder_V.data(), responder_keys.responder_V.data(), initiator_keys.responder_V.size()));\n+    BOOST_CHECK_EQUAL(\"94e374b822bc293b4eb3475aed2457e1b2fc9691df9ffb02afc462c36d513783\", HexStr(Span{initiator_keys.responder_V}));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK_EQUAL(initiator_keys.session_id.size(), responder_keys.session_id.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_keys.session_id.data(), responder_keys.session_id.data(), initiator_keys.session_id.size()));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 74,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": 850729539,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2022-04-15T01:10:47Z",
      "updated_at": "2022-04-15T01:10:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850956064",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850956064"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 980,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850956520",
      "pull_request_review_id": 943077292,
      "id": 850956520,
      "node_id": "PRRC_kwDOABII584yuJDo",
      "diff_hunk": "@@ -22,6 +25,14 @@\n  */\n typedef std::vector<unsigned char, secure_allocator<unsigned char> > CPrivKey;\n \n+constexpr static size_t ECDH_SECRET_SIZE = CSHA256::OUTPUT_SIZE;\n+\n+// SHA256(\"secp256k1_ellsq_xonly_ecdh\") proven with a unit test (xonly_ecdh_tag)\n+const static auto BIP324_ECDH_TAG = ParseHex(\"4dbebba5394890bf7370e9ca2ca6112941b974c56950e5c4fef7f00a2bbf3e55\");",
      "path": "src/key.h",
      "position": null,
      "original_position": 21,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": 850737479,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Super nice change - much cleaner. Thanks for showing me that. Done.",
      "created_at": "2022-04-15T01:11:17Z",
      "updated_at": "2022-04-15T01:11:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850956520",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850956520"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850956627",
      "pull_request_review_id": 943077332,
      "id": 850956627,
      "node_id": "PRRC_kwDOABII584yuJFT",
      "diff_hunk": "@@ -332,6 +334,40 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+// Returns just the x-coordinate in big endian\n+static int bip324_ecdh_hash(unsigned char* output, const unsigned char* x32, const unsigned char* y32, void* data)\n+{\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+bool CKey::ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata,",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f0b520b17c3ecf4176c53b3752d1cb761d67ffe3",
      "in_reply_to_id": 850740291,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2022-04-15T01:11:24Z",
      "updated_at": "2022-04-15T01:11:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r850956627",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850956627"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 344,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867312810",
      "pull_request_review_id": 965298394,
      "id": 867312810,
      "node_id": "PRRC_kwDOABII584zsiSq",
      "diff_hunk": "@@ -344,4 +345,33 @@ BOOST_AUTO_TEST_CASE(bip340_test_vectors)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_ecdh)\n+{\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    auto initiator_hdata_vec = ParseHex(\"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e96c66365b4d38eefd0a883be64112f4495\");",
      "path": "src/test/key_tests.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "2ec727ee616a9ed699c4d2fb00005bec81dc9954",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "to match the [64 bytes encoding](https://github.com/bitcoin/bitcoin/blob/c9db50bc2f8674913e785384c0e323c2df71754d/src/test/net_tests.cpp#L926) in commit c9db50b.\r\n```suggestion\r\n    auto initiator_hdata_vec = ParseHex(\"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\");\r\n```",
      "created_at": "2022-05-07T06:36:52Z",
      "updated_at": "2022-05-07T06:39:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r867312810",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867312810"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 354,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/919522522",
      "pull_request_review_id": 1036602360,
      "id": 919522522,
      "node_id": "PRRC_kwDOABII5842zsza",
      "diff_hunk": "@@ -344,4 +345,33 @@ BOOST_AUTO_TEST_CASE(bip340_test_vectors)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_ecdh)\n+{\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    auto initiator_hdata_vec = ParseHex(\"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e96c66365b4d38eefd0a883be64112f4495\");",
      "path": "src/test/key_tests.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "2ec727ee616a9ed699c4d2fb00005bec81dc9954",
      "in_reply_to_id": 867312810,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks! Done.",
      "created_at": "2022-07-12T23:58:49Z",
      "updated_at": "2022-07-12T23:58:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r919522522",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/919522522"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 354,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921012980",
      "pull_request_review_id": 1038661558,
      "id": 921012980,
      "node_id": "PRRC_kwDOABII58425Yr0",
      "diff_hunk": "@@ -332,6 +334,34 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+// Returns just the x-coordinate in big endian\n+static int bip324_ecdh_hash(unsigned char* output, const unsigned char* x32, const unsigned char* y32, void* data)\n+{\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+bool CKey::ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<const uint8_t> initiator_hdata, const Span<const uint8_t> responder_hdata,\n+                                   ECDHSecret& secret) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return false;\n+    }\n+\n+    uint8_t xonly_ecdh[ECDH_SECRET_SIZE];\n+    assert(secp256k1_ecdh(secp256k1_context_sign, xonly_ecdh, &pubkey_internal,\n+                          keydata.data(), bip324_ecdh_hash, nullptr));",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "71e53c0682d14c011e1aea9aec81586742d80d39",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "According to our guidelines, assertions shouldn't have side-effects (see https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#general-c).\r\n```suggestion\r\n    if (!secp256k1_ecdh(secp256k1_context_sign, xonly_ecdh, &pubkey_internal,\r\n                        keydata.data(), bip324_ecdh_hash, nullptr)) {\r\n        assert(false);\r\n    }\r\n```",
      "created_at": "2022-07-14T10:40:21Z",
      "updated_at": "2022-07-14T11:02:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r921012980",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921012980"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 353,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 354,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921018820",
      "pull_request_review_id": 1038661558,
      "id": 921018820,
      "node_id": "PRRC_kwDOABII58425aHE",
      "diff_hunk": "@@ -156,6 +166,10 @@ class CKey\n \n     //! Load private key and check that public key matches.\n     bool Load(const CPrivKey& privkey, const CPubKey& vchPubKey, bool fSkipCheck);\n+\n+    // Returns false if an invalid public key is provided\n+    bool ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<const uint8_t> initiator_hdata, const Span<const uint8_t> responder_hdata,\n+                                 ECDHSecret& secret) const;",
      "path": "src/key.h",
      "position": null,
      "original_position": 36,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "71e53c0682d14c011e1aea9aec81586742d80d39",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: An alternative, probably more modern interface would be to return `std::optional<ECDHSecret>` instead of storing the result in an out-parameter.\r\n```suggestion\r\n    // Returns std::nullopt if an invalid public key is provided\r\n    std::optional<ECDHSecret> ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<const uint8_t> initiator_hdata, const Span<const uint8_t> responder_hdata) const;\r\n```",
      "created_at": "2022-07-14T10:47:11Z",
      "updated_at": "2022-07-14T11:02:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r921018820",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921018820"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 170,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 172,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921019942",
      "pull_request_review_id": 1038661558,
      "id": 921019942,
      "node_id": "PRRC_kwDOABII58425aYm",
      "diff_hunk": "@@ -344,4 +345,33 @@ BOOST_AUTO_TEST_CASE(bip340_test_vectors)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_ecdh)\n+{\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    auto initiator_hdata_vec = ParseHex(\"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\");\n+    auto responder_hdata_vec = ParseHex(\"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\");\n+\n+    Span<uint8_t> initiator_hdata{initiator_hdata_vec.data(), initiator_hdata_vec.size()};\n+    Span<uint8_t> responder_hdata{responder_hdata_vec.data(), responder_hdata_vec.size()};\n+\n+    BOOST_CHECK(initiator_key.ComputeBIP324ECDHSecret(responder_key.GetPubKey(), initiator_hdata, responder_hdata, initiator_secret));\n+    BOOST_CHECK(responder_key.ComputeBIP324ECDHSecret(initiator_key.GetPubKey(), initiator_hdata, responder_hdata, responder_secret));\n+    BOOST_CHECK_EQUAL(initiator_secret.size(), ECDH_SECRET_SIZE);\n+    BOOST_CHECK_EQUAL(responder_secret.size(), ECDH_SECRET_SIZE);",
      "path": "src/test/key_tests.cpp",
      "position": null,
      "original_position": 27,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "71e53c0682d14c011e1aea9aec81586742d80d39",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: These checks obviously don't hurt, but now that ECDHSecret uses `std::array` and has it's size fixed at compile-time, they are not that useful anymore.\r\n```suggestion\r\n```",
      "created_at": "2022-07-14T10:48:41Z",
      "updated_at": "2022-07-14T11:02:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r921019942",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921019942"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 362,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 363,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921022051",
      "pull_request_review_id": 1038661558,
      "id": 921022051,
      "node_id": "PRRC_kwDOABII58425a5j",
      "diff_hunk": "@@ -344,4 +345,33 @@ BOOST_AUTO_TEST_CASE(bip340_test_vectors)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_ecdh)\n+{\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    auto initiator_hdata_vec = ParseHex(\"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\");\n+    auto responder_hdata_vec = ParseHex(\"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\");\n+\n+    Span<uint8_t> initiator_hdata{initiator_hdata_vec.data(), initiator_hdata_vec.size()};\n+    Span<uint8_t> responder_hdata{responder_hdata_vec.data(), responder_hdata_vec.size()};\n+\n+    BOOST_CHECK(initiator_key.ComputeBIP324ECDHSecret(responder_key.GetPubKey(), initiator_hdata, responder_hdata, initiator_secret));\n+    BOOST_CHECK(responder_key.ComputeBIP324ECDHSecret(initiator_key.GetPubKey(), initiator_hdata, responder_hdata, responder_secret));\n+    BOOST_CHECK_EQUAL(initiator_secret.size(), ECDH_SECRET_SIZE);\n+    BOOST_CHECK_EQUAL(responder_secret.size(), ECDH_SECRET_SIZE);\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_secret.data(), responder_secret.data(), ECDH_SECRET_SIZE));",
      "path": "src/test/key_tests.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "71e53c0682d14c011e1aea9aec81586742d80d39",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: could simply use `operator==` of `std::array` here:\r\n```suggestion\r\n    BOOST_CHECK(initiator_secret == responder_secret);\r\n```",
      "created_at": "2022-07-14T10:51:29Z",
      "updated_at": "2022-07-14T11:03:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r921022051",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921022051"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 364,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921024909",
      "pull_request_review_id": 1038661558,
      "id": 921024909,
      "node_id": "PRRC_kwDOABII58425bmN",
      "diff_hunk": "@@ -306,3 +307,40 @@ FUZZ_TARGET_INIT(key, initialize_key)\n         }\n     }\n }\n+\n+FUZZ_TARGET_INIT(ecdh, initialize_key)\n+{\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    auto rnd32 = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+    rnd32.resize(32);\n+    CKey k1;\n+    k1.Set(rnd32.begin(), rnd32.end(), true);\n+\n+    if (!k1.IsValid()) {\n+        return;\n+    }\n+\n+    rnd32 = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+    rnd32.resize(32);\n+    CKey k2;\n+    k2.Set(rnd32.begin(), rnd32.end(), true);\n+\n+    if (!k2.IsValid()) {\n+        return;\n+    }\n+\n+    auto k1_ellsq = fuzzed_data_provider.ConsumeBytes<uint8_t>(64);\n+    k1_ellsq.resize(64);\n+\n+    auto k2_ellsq = fuzzed_data_provider.ConsumeBytes<uint8_t>(64);\n+    k2_ellsq.resize(64);\n+\n+    CPubKey k1_pubkey = k1.GetPubKey();\n+    CPubKey k2_pubkey = k2.GetPubKey();\n+    ECDHSecret ecdh_secret_1, ecdh_secret_2;\n+    assert(k1.ComputeBIP324ECDHSecret(k2_pubkey, k1_ellsq, k2_ellsq, ecdh_secret_1));\n+    assert(k2.ComputeBIP324ECDHSecret(k1_pubkey, k1_ellsq, k2_ellsq, ecdh_secret_2));\n+    assert(ecdh_secret_1.size() == ECDH_SECRET_SIZE);\n+    assert(ecdh_secret_2.size() == ECDH_SECRET_SIZE);\n+    assert(memcmp(ecdh_secret_1.data(), ecdh_secret_2.data(), ECDH_SECRET_SIZE) == 0);",
      "path": "src/test/fuzz/key.cpp",
      "position": null,
      "original_position": 47,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "b02d45c004613dd6f5591bc274210495584d9447",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit:\r\n```suggestion\r\n    assert(ecdh_secret_1 == ecdh_secret_2);\r\n```",
      "created_at": "2022-07-14T10:55:10Z",
      "updated_at": "2022-07-14T11:02:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r921024909",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921024909"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 343,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 345,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921027001",
      "pull_request_review_id": 1038661558,
      "id": 921027001,
      "node_id": "PRRC_kwDOABII58425cG5",
      "diff_hunk": "@@ -438,6 +440,42 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+bool DeriveBIP324Keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)\n+{\n+    if (ecdh_secret.size() != ECDH_SECRET_SIZE) {\n+        return false;\n+    }\n+",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 25,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "200c3b4787f1b455d59a88ecefbdd94c13ce1e62",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Since `ECDHSecret` has a fixed size (`std::array<uint8_t, ECDH_SECRET_SIZE>`), this is dead code now and can be removed.\r\n```suggestion\r\n```",
      "created_at": "2022-07-14T10:57:45Z",
      "updated_at": "2022-07-14T11:02:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r921027001",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921027001"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 445,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 448,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921029203",
      "pull_request_review_id": 1038661558,
      "id": 921029203,
      "node_id": "PRRC_kwDOABII58425cpT",
      "diff_hunk": "@@ -917,4 +919,73 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_hdata = \"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\";\n+    static const std::string responder_hdata = \"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\";\n+\n+    auto initiator_hdata_vec = ParseHex(initiator_hdata);\n+    auto responder_hdata_vec = ParseHex(responder_hdata);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_pubkey = initiator_key.GetPubKey();\n+    auto responder_pubkey = responder_key.GetPubKey();\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    BOOST_CHECK(initiator_key.ComputeBIP324ECDHSecret(responder_pubkey, initiator_hdata_vec, responder_hdata_vec, initiator_secret));\n+    BOOST_CHECK(responder_key.ComputeBIP324ECDHSecret(initiator_pubkey, initiator_hdata_vec, responder_hdata_vec, responder_secret));\n+\n+    BOOST_CHECK_EQUAL(ECDH_SECRET_SIZE, initiator_secret.size());\n+    BOOST_CHECK_EQUAL(ECDH_SECRET_SIZE, responder_secret.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_secret.data(), responder_secret.data(), ECDH_SECRET_SIZE));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "200c3b4787f1b455d59a88ecefbdd94c13ce1e62",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit:\r\n```suggestion\r\n    BOOST_CHECK(initiator_secret == responder_secret);\r\n```",
      "created_at": "2022-07-14T11:00:39Z",
      "updated_at": "2022-07-14T11:02:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r921029203",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921029203"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 944,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 947,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549421",
      "pull_request_review_id": 1042105709,
      "id": 923549421,
      "node_id": "PRRC_kwDOABII5843DD7t",
      "diff_hunk": "@@ -332,6 +334,34 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+// Returns just the x-coordinate in big endian\n+static int bip324_ecdh_hash(unsigned char* output, const unsigned char* x32, const unsigned char* y32, void* data)\n+{\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+bool CKey::ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<const uint8_t> initiator_hdata, const Span<const uint8_t> responder_hdata,\n+                                   ECDHSecret& secret) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return false;\n+    }\n+\n+    uint8_t xonly_ecdh[ECDH_SECRET_SIZE];\n+    assert(secp256k1_ecdh(secp256k1_context_sign, xonly_ecdh, &pubkey_internal,\n+                          keydata.data(), bip324_ecdh_hash, nullptr));",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "71e53c0682d14c011e1aea9aec81586742d80d39",
      "in_reply_to_id": 921012980,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks for teaching me this. Done.",
      "created_at": "2022-07-18T16:05:41Z",
      "updated_at": "2022-07-18T16:05:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r923549421",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549421"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 353,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 354,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549534",
      "pull_request_review_id": 1042105883,
      "id": 923549534,
      "node_id": "PRRC_kwDOABII5843DD9e",
      "diff_hunk": "@@ -156,6 +166,10 @@ class CKey\n \n     //! Load private key and check that public key matches.\n     bool Load(const CPrivKey& privkey, const CPubKey& vchPubKey, bool fSkipCheck);\n+\n+    // Returns false if an invalid public key is provided\n+    bool ComputeBIP324ECDHSecret(const CPubKey& pubkey, const Span<const uint8_t> initiator_hdata, const Span<const uint8_t> responder_hdata,\n+                                 ECDHSecret& secret) const;",
      "path": "src/key.h",
      "position": null,
      "original_position": 36,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "71e53c0682d14c011e1aea9aec81586742d80d39",
      "in_reply_to_id": 921018820,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done. ",
      "created_at": "2022-07-18T16:05:49Z",
      "updated_at": "2022-07-18T16:05:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r923549534",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549534"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 170,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 172,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549638",
      "pull_request_review_id": 1042106012,
      "id": 923549638,
      "node_id": "PRRC_kwDOABII5843DD_G",
      "diff_hunk": "@@ -344,4 +345,33 @@ BOOST_AUTO_TEST_CASE(bip340_test_vectors)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_ecdh)\n+{\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    auto initiator_hdata_vec = ParseHex(\"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\");\n+    auto responder_hdata_vec = ParseHex(\"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\");\n+\n+    Span<uint8_t> initiator_hdata{initiator_hdata_vec.data(), initiator_hdata_vec.size()};\n+    Span<uint8_t> responder_hdata{responder_hdata_vec.data(), responder_hdata_vec.size()};\n+\n+    BOOST_CHECK(initiator_key.ComputeBIP324ECDHSecret(responder_key.GetPubKey(), initiator_hdata, responder_hdata, initiator_secret));\n+    BOOST_CHECK(responder_key.ComputeBIP324ECDHSecret(initiator_key.GetPubKey(), initiator_hdata, responder_hdata, responder_secret));\n+    BOOST_CHECK_EQUAL(initiator_secret.size(), ECDH_SECRET_SIZE);\n+    BOOST_CHECK_EQUAL(responder_secret.size(), ECDH_SECRET_SIZE);",
      "path": "src/test/key_tests.cpp",
      "position": null,
      "original_position": 27,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "71e53c0682d14c011e1aea9aec81586742d80d39",
      "in_reply_to_id": 921019942,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2022-07-18T16:05:55Z",
      "updated_at": "2022-07-18T16:05:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r923549638",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549638"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 362,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 363,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549735",
      "pull_request_review_id": 1042106134,
      "id": 923549735,
      "node_id": "PRRC_kwDOABII5843DEAn",
      "diff_hunk": "@@ -344,4 +345,33 @@ BOOST_AUTO_TEST_CASE(bip340_test_vectors)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_ecdh)\n+{\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    auto initiator_hdata_vec = ParseHex(\"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\");\n+    auto responder_hdata_vec = ParseHex(\"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\");\n+\n+    Span<uint8_t> initiator_hdata{initiator_hdata_vec.data(), initiator_hdata_vec.size()};\n+    Span<uint8_t> responder_hdata{responder_hdata_vec.data(), responder_hdata_vec.size()};\n+\n+    BOOST_CHECK(initiator_key.ComputeBIP324ECDHSecret(responder_key.GetPubKey(), initiator_hdata, responder_hdata, initiator_secret));\n+    BOOST_CHECK(responder_key.ComputeBIP324ECDHSecret(initiator_key.GetPubKey(), initiator_hdata, responder_hdata, responder_secret));\n+    BOOST_CHECK_EQUAL(initiator_secret.size(), ECDH_SECRET_SIZE);\n+    BOOST_CHECK_EQUAL(responder_secret.size(), ECDH_SECRET_SIZE);\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_secret.data(), responder_secret.data(), ECDH_SECRET_SIZE));",
      "path": "src/test/key_tests.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "71e53c0682d14c011e1aea9aec81586742d80d39",
      "in_reply_to_id": 921022051,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2022-07-18T16:06:00Z",
      "updated_at": "2022-07-18T16:06:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r923549735",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549735"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 364,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549834",
      "pull_request_review_id": 1042106262,
      "id": 923549834,
      "node_id": "PRRC_kwDOABII5843DECK",
      "diff_hunk": "@@ -306,3 +307,40 @@ FUZZ_TARGET_INIT(key, initialize_key)\n         }\n     }\n }\n+\n+FUZZ_TARGET_INIT(ecdh, initialize_key)\n+{\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    auto rnd32 = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+    rnd32.resize(32);\n+    CKey k1;\n+    k1.Set(rnd32.begin(), rnd32.end(), true);\n+\n+    if (!k1.IsValid()) {\n+        return;\n+    }\n+\n+    rnd32 = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+    rnd32.resize(32);\n+    CKey k2;\n+    k2.Set(rnd32.begin(), rnd32.end(), true);\n+\n+    if (!k2.IsValid()) {\n+        return;\n+    }\n+\n+    auto k1_ellsq = fuzzed_data_provider.ConsumeBytes<uint8_t>(64);\n+    k1_ellsq.resize(64);\n+\n+    auto k2_ellsq = fuzzed_data_provider.ConsumeBytes<uint8_t>(64);\n+    k2_ellsq.resize(64);\n+\n+    CPubKey k1_pubkey = k1.GetPubKey();\n+    CPubKey k2_pubkey = k2.GetPubKey();\n+    ECDHSecret ecdh_secret_1, ecdh_secret_2;\n+    assert(k1.ComputeBIP324ECDHSecret(k2_pubkey, k1_ellsq, k2_ellsq, ecdh_secret_1));\n+    assert(k2.ComputeBIP324ECDHSecret(k1_pubkey, k1_ellsq, k2_ellsq, ecdh_secret_2));\n+    assert(ecdh_secret_1.size() == ECDH_SECRET_SIZE);\n+    assert(ecdh_secret_2.size() == ECDH_SECRET_SIZE);\n+    assert(memcmp(ecdh_secret_1.data(), ecdh_secret_2.data(), ECDH_SECRET_SIZE) == 0);",
      "path": "src/test/fuzz/key.cpp",
      "position": null,
      "original_position": 47,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "b02d45c004613dd6f5591bc274210495584d9447",
      "in_reply_to_id": 921024909,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2022-07-18T16:06:06Z",
      "updated_at": "2022-07-18T16:06:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r923549834",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923549834"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 343,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 345,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923550203",
      "pull_request_review_id": 1042106764,
      "id": 923550203,
      "node_id": "PRRC_kwDOABII5843DEH7",
      "diff_hunk": "@@ -438,6 +440,42 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+bool DeriveBIP324Keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)\n+{\n+    if (ecdh_secret.size() != ECDH_SECRET_SIZE) {\n+        return false;\n+    }\n+",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 25,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "200c3b4787f1b455d59a88ecefbdd94c13ce1e62",
      "in_reply_to_id": 921027001,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done. This also let me optimize the interface to the function as it always succeeds now.",
      "created_at": "2022-07-18T16:06:28Z",
      "updated_at": "2022-07-18T16:06:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r923550203",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923550203"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 445,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 448,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923550345",
      "pull_request_review_id": 1042106960,
      "id": 923550345,
      "node_id": "PRRC_kwDOABII5843DEKJ",
      "diff_hunk": "@@ -917,4 +919,73 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_hdata = \"2deb41da6887640dda029ae41c9c9958881d0bb8e28f6bb9039ee9b7bb11091d62f4cbe65cc418df7aefd738f4d3e926c66365b4d38eefd0a883be64112f4495\";\n+    static const std::string responder_hdata = \"4c469c70ba242ae0fc98d4eff6258cf19ecab96611c9c736356a4cf11d66edfa4d2970e56744a6d071861a4cbe2730eb7733a38b166e3df73450ef37112dd32f\";\n+\n+    auto initiator_hdata_vec = ParseHex(initiator_hdata);\n+    auto responder_hdata_vec = ParseHex(responder_hdata);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_pubkey = initiator_key.GetPubKey();\n+    auto responder_pubkey = responder_key.GetPubKey();\n+\n+    ECDHSecret initiator_secret, responder_secret;\n+    BOOST_CHECK(initiator_key.ComputeBIP324ECDHSecret(responder_pubkey, initiator_hdata_vec, responder_hdata_vec, initiator_secret));\n+    BOOST_CHECK(responder_key.ComputeBIP324ECDHSecret(initiator_pubkey, initiator_hdata_vec, responder_hdata_vec, responder_secret));\n+\n+    BOOST_CHECK_EQUAL(ECDH_SECRET_SIZE, initiator_secret.size());\n+    BOOST_CHECK_EQUAL(ECDH_SECRET_SIZE, responder_secret.size());\n+    BOOST_CHECK_EQUAL(0, memcmp(initiator_secret.data(), responder_secret.data(), ECDH_SECRET_SIZE));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "200c3b4787f1b455d59a88ecefbdd94c13ce1e62",
      "in_reply_to_id": 921029203,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2022-07-18T16:06:37Z",
      "updated_at": "2022-07-18T16:06:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r923550345",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923550345"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 944,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 947,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/928122428",
      "pull_request_review_id": 1048536180,
      "id": 928122428,
      "node_id": "PRRC_kwDOABII5843UgY8",
      "diff_hunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+\n+#include <key.h>\n+#include <pubkey.h>\n+#include <random.h>\n+#include <secp256k1.h>\n+#include <secp256k1_ellswift.h>\n+\n+#include <cstddef>\n+\n+CKey GetRandomKey()\n+{\n+    CKey key;\n+    key.MakeNewKey(true);\n+    return key;\n+}\n+\n+void GetEll64(const CPubKey& pubkey, unsigned char* ell64) {\n+    auto ctx = GetVerifyContext();\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(ctx, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return;\n+    }\n+\n+    std::array<unsigned char, 32> rnd32;\n+    GetRandBytes(rnd32);\n+    secp256k1_ellswift_encode(ctx, ell64, &pubkey_internal, rnd32.data());",
      "path": "src/bench/bip324_ecdh.cpp",
      "position": null,
      "original_position": 31,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "9f1b84c2830d64bedc3e0c8b1014d581048274cd",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The new ellswift API has a function `secp256k1_ellswift_create` which goes directly from private key + randomness to ellswift encoding, bypassing the need for encoding the public key in the traditional form.",
      "created_at": "2022-07-23T13:14:32Z",
      "updated_at": "2022-07-23T13:14:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r928122428",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/928122428"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930357420",
      "pull_request_review_id": 1051537568,
      "id": 930357420,
      "node_id": "PRRC_kwDOABII5843dCCs",
      "diff_hunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+\n+#include <key.h>\n+#include <pubkey.h>\n+#include <random.h>\n+#include <secp256k1.h>\n+#include <secp256k1_ellswift.h>\n+\n+#include <cstddef>\n+\n+CKey GetRandomKey()\n+{\n+    CKey key;\n+    key.MakeNewKey(true);\n+    return key;\n+}\n+\n+void GetEll64(const CPubKey& pubkey, unsigned char* ell64) {\n+    auto ctx = GetVerifyContext();\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(ctx, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return;\n+    }\n+\n+    std::array<unsigned char, 32> rnd32;\n+    GetRandBytes(rnd32);\n+    secp256k1_ellswift_encode(ctx, ell64, &pubkey_internal, rnd32.data());",
      "path": "src/bench/bip324_ecdh.cpp",
      "position": null,
      "original_position": 31,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "9f1b84c2830d64bedc3e0c8b1014d581048274cd",
      "in_reply_to_id": 928122428,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Much nicer. Thank you for the reminder. Done.",
      "created_at": "2022-07-26T19:54:23Z",
      "updated_at": "2022-07-26T19:54:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r930357420",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930357420"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958524234",
      "pull_request_review_id": 1090383174,
      "id": 958524234,
      "node_id": "PRRC_kwDOABII5845IetK",
      "diff_hunk": "@@ -344,4 +346,29 @@ BOOST_AUTO_TEST_CASE(bip340_test_vectors)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_ecdh)\n+{\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_ellswift = ParseHex(\"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\");\n+    auto responder_ellswift = ParseHex(\"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\");\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));",
      "path": "src/test/key_tests.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "789d8bb80ab71a32ddf64b1242d11fa9e333d762",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 789d8bb: this would be the ECDH secret - `ae1b0c44c3c38aa5206899c0928ca51f637e3ec05771b4a6c0662b46b76049d8`",
      "created_at": "2022-08-30T14:01:48Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958524234",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958524234"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 362,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 363,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958526002",
      "pull_request_review_id": 1090383174,
      "id": 958526002,
      "node_id": "PRRC_kwDOABII5845IfIy",
      "diff_hunk": "@@ -22,6 +28,12 @@\n  */\n typedef std::vector<unsigned char, secure_allocator<unsigned char> > CPrivKey;\n \n+constexpr static size_t ECDH_SECRET_SIZE = CSHA256::OUTPUT_SIZE;\n+const auto HASHER_BIP324_ECDH = TaggedHash(\"secp256k1_ellsq_xonly_ecdh\");",
      "path": "src/key.h",
      "position": null,
      "original_position": 23,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "789d8bb80ab71a32ddf64b1242d11fa9e333d762",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 789d8bb8: s/secp256k1_ellsq_xonly_ecdh/secp256k1_ellswift_xonly_ecdh",
      "created_at": "2022-08-30T14:03:13Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958526002",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958526002"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958538781",
      "pull_request_review_id": 1090383174,
      "id": 958538781,
      "node_id": "PRRC_kwDOABII5845IiQd",
      "diff_hunk": "@@ -22,6 +28,12 @@\n  */\n typedef std::vector<unsigned char, secure_allocator<unsigned char> > CPrivKey;\n \n+constexpr static size_t ECDH_SECRET_SIZE = CSHA256::OUTPUT_SIZE;\n+const auto HASHER_BIP324_ECDH = TaggedHash(\"secp256k1_ellsq_xonly_ecdh\");",
      "path": "src/key.h",
      "position": null,
      "original_position": 23,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "789d8bb80ab71a32ddf64b1242d11fa9e333d762",
      "in_reply_to_id": 958526002,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 789d8bb: would it be useful to keep the `TaggedHash()` function call similar to other calls in [the codebase](https://github.com/bitcoin/bitcoin/blob/cfda740b332c77800f9bb2506d840dad3f4938c0/src/pubkey.cpp#L214)?\r\n```suggestion\r\nconst HashWriter HASHER_BIP324_ECDH{TaggedHash(\"secp256k1_ellswift_xonly_ecdh\")};\r\n```",
      "created_at": "2022-08-30T14:13:41Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958538781",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958538781"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958660692",
      "pull_request_review_id": 1090383174,
      "id": 958660692,
      "node_id": "PRRC_kwDOABII5845JABU",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 4220009b: ECDH secret is `ae1b0c44c3c38aa5206899c0928ca51f637e3ec05771b4a6c0662b46b76049d8`",
      "created_at": "2022-08-30T15:53:41Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958660692",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958660692"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 932,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 933,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958762184",
      "pull_request_review_id": 1090383174,
      "id": 958762184,
      "node_id": "PRRC_kwDOABII5845JYzI",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 48,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 4220009: `98b1a948d70374db8078475fd2b573789989a57d5394ecc229a3f2ec336c4d18`",
      "created_at": "2022-08-30T17:40:24Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958762184",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958762184"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 946,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958764152",
      "pull_request_review_id": 1090383174,
      "id": 958764152,
      "node_id": "PRRC_kwDOABII5845JZR4",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 4220009: `95bdf50958c46ad24c7646cd7bf7579ffafb2f032d2c5356fc8341e198d0bb51`",
      "created_at": "2022-08-30T17:42:42Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958764152",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958764152"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 950,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958766225",
      "pull_request_review_id": 1090383174,
      "id": 958766225,
      "node_id": "PRRC_kwDOABII5845JZyR",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 56,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 4220009: `0dec3e671918898ce5472b161ddfcc6f765bf459e8cdeb86825fa704a58546e5`",
      "created_at": "2022-08-30T17:44:47Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958766225",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958766225"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 954,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958766665",
      "pull_request_review_id": 1090383174,
      "id": 958766665,
      "node_id": "PRRC_kwDOABII5845JZ5J",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"82c8d144f1dc7b86993c248db020aecfaed37a5c215bea5a7f1bf4399a85ecca\", HexStr(initiator_keys.responder_P));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 60,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 4220009: `af8b74244dd43c5921e2449a125d669f6d82a23250fa040eafc3ba2373067de5`",
      "created_at": "2022-08-30T17:45:19Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958766665",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958766665"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 958,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958767066",
      "pull_request_review_id": 1090383174,
      "id": 958767066,
      "node_id": "PRRC_kwDOABII5845JZ_a",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"82c8d144f1dc7b86993c248db020aecfaed37a5c215bea5a7f1bf4399a85ecca\", HexStr(initiator_keys.responder_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK(initiator_keys.session_id == responder_keys.session_id);\n+    BOOST_CHECK_EQUAL(\"e6b4d42bc1fbce790cf7b419d0128c7caf319b491acfd9fd874f29ca3843fe40\", HexStr(initiator_keys.session_id));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 4220009: `ae605e623a8f710f4f0c99454d74cdfb8861cad1f8f6dd2eb86390d615efab01`",
      "created_at": "2022-08-30T17:45:47Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958767066",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958767066"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 962,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958767405",
      "pull_request_review_id": 1090383174,
      "id": 958767405,
      "node_id": "PRRC_kwDOABII5845JaEt",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"82c8d144f1dc7b86993c248db020aecfaed37a5c215bea5a7f1bf4399a85ecca\", HexStr(initiator_keys.responder_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK(initiator_keys.session_id == responder_keys.session_id);\n+    BOOST_CHECK_EQUAL(\"e6b4d42bc1fbce790cf7b419d0128c7caf319b491acfd9fd874f29ca3843fe40\", HexStr(initiator_keys.session_id));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.rekey_salt.size());\n+    BOOST_CHECK(initiator_keys.rekey_salt == responder_keys.rekey_salt);\n+    BOOST_CHECK_EQUAL(\"060d26411cdedabda638b1a807d0b68cbbb326385881409fcd2f5705091c5842\", HexStr(initiator_keys.rekey_salt));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 4220009: `e46620b5e10052931401606ccbb4c810c4f9afa9db948e3acfbeaa65b0cc8199`",
      "created_at": "2022-08-30T17:46:10Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958767405",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958767405"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 966,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958768072",
      "pull_request_review_id": 1090383174,
      "id": 958768072,
      "node_id": "PRRC_kwDOABII5845JaPI",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"82c8d144f1dc7b86993c248db020aecfaed37a5c215bea5a7f1bf4399a85ecca\", HexStr(initiator_keys.responder_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK(initiator_keys.session_id == responder_keys.session_id);\n+    BOOST_CHECK_EQUAL(\"e6b4d42bc1fbce790cf7b419d0128c7caf319b491acfd9fd874f29ca3843fe40\", HexStr(initiator_keys.session_id));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.rekey_salt.size());\n+    BOOST_CHECK(initiator_keys.rekey_salt == responder_keys.rekey_salt);\n+    BOOST_CHECK_EQUAL(\"060d26411cdedabda638b1a807d0b68cbbb326385881409fcd2f5705091c5842\", HexStr(initiator_keys.rekey_salt));\n+\n+    BOOST_CHECK_EQUAL(BIP324_GARBAGE_TERMINATOR_LEN, initiator_keys.garbage_terminator.size());\n+    BOOST_CHECK(initiator_keys.garbage_terminator == responder_keys.garbage_terminator);\n+    BOOST_CHECK_EQUAL(\"118878010356d064\", HexStr(Span{initiator_keys.garbage_terminator}));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 72,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 4220009: `73d7412ff3b42a01`",
      "created_at": "2022-08-30T17:46:58Z",
      "updated_at": "2022-08-30T18:16:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r958768072",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958768072"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 970,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884548",
      "pull_request_review_id": 1103351076,
      "id": 967884548,
      "node_id": "PRRC_kwDOABII5845sL8E",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"82c8d144f1dc7b86993c248db020aecfaed37a5c215bea5a7f1bf4399a85ecca\", HexStr(initiator_keys.responder_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK(initiator_keys.session_id == responder_keys.session_id);\n+    BOOST_CHECK_EQUAL(\"e6b4d42bc1fbce790cf7b419d0128c7caf319b491acfd9fd874f29ca3843fe40\", HexStr(initiator_keys.session_id));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.rekey_salt.size());\n+    BOOST_CHECK(initiator_keys.rekey_salt == responder_keys.rekey_salt);\n+    BOOST_CHECK_EQUAL(\"060d26411cdedabda638b1a807d0b68cbbb326385881409fcd2f5705091c5842\", HexStr(initiator_keys.rekey_salt));\n+\n+    BOOST_CHECK_EQUAL(BIP324_GARBAGE_TERMINATOR_LEN, initiator_keys.garbage_terminator.size());\n+    BOOST_CHECK(initiator_keys.garbage_terminator == responder_keys.garbage_terminator);\n+    BOOST_CHECK_EQUAL(\"118878010356d064\", HexStr(Span{initiator_keys.garbage_terminator}));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 72,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": 958768072,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2022-09-11T20:30:30Z",
      "updated_at": "2022-09-11T20:30:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884548",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884548"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 970,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884561",
      "pull_request_review_id": 1103351086,
      "id": 967884561,
      "node_id": "PRRC_kwDOABII5845sL8R",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"82c8d144f1dc7b86993c248db020aecfaed37a5c215bea5a7f1bf4399a85ecca\", HexStr(initiator_keys.responder_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK(initiator_keys.session_id == responder_keys.session_id);\n+    BOOST_CHECK_EQUAL(\"e6b4d42bc1fbce790cf7b419d0128c7caf319b491acfd9fd874f29ca3843fe40\", HexStr(initiator_keys.session_id));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.rekey_salt.size());\n+    BOOST_CHECK(initiator_keys.rekey_salt == responder_keys.rekey_salt);\n+    BOOST_CHECK_EQUAL(\"060d26411cdedabda638b1a807d0b68cbbb326385881409fcd2f5705091c5842\", HexStr(initiator_keys.rekey_salt));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": 958767405,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-09-11T20:30:36Z",
      "updated_at": "2022-09-11T20:30:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884561",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884561"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 966,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884567",
      "pull_request_review_id": 1103351093,
      "id": 967884567,
      "node_id": "PRRC_kwDOABII5845sL8X",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"82c8d144f1dc7b86993c248db020aecfaed37a5c215bea5a7f1bf4399a85ecca\", HexStr(initiator_keys.responder_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK(initiator_keys.session_id == responder_keys.session_id);\n+    BOOST_CHECK_EQUAL(\"e6b4d42bc1fbce790cf7b419d0128c7caf319b491acfd9fd874f29ca3843fe40\", HexStr(initiator_keys.session_id));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": 958767066,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-09-11T20:30:40Z",
      "updated_at": "2022-09-11T20:30:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884567",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884567"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 962,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884573",
      "pull_request_review_id": 1103351102,
      "id": 967884573,
      "node_id": "PRRC_kwDOABII5845sL8d",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"82c8d144f1dc7b86993c248db020aecfaed37a5c215bea5a7f1bf4399a85ecca\", HexStr(initiator_keys.responder_P));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 60,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": 958766665,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-09-11T20:30:47Z",
      "updated_at": "2022-09-11T20:30:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884573",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884573"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 958,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884576",
      "pull_request_review_id": 1103351107,
      "id": 967884576,
      "node_id": "PRRC_kwDOABII5845sL8g",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"f31764965c22b792a5ac3f35573b01db27a8d479677c53c43d71bbc2141e8886\", HexStr(initiator_keys.responder_L));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 56,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": 958766225,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-09-11T20:30:52Z",
      "updated_at": "2022-09-11T20:30:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884576",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884576"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 954,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884584",
      "pull_request_review_id": 1103351115,
      "id": 967884584,
      "node_id": "PRRC_kwDOABII5845sL8o",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"bc6617bd1473017b1b40e927c0330b74d1bdd30594a1daa49d89c831f03775cd\", HexStr(initiator_keys.initiator_P));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": 958764152,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-09-11T20:30:55Z",
      "updated_at": "2022-09-11T20:30:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884584",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884584"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 950,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884601",
      "pull_request_review_id": 1103351125,
      "id": 967884601,
      "node_id": "PRRC_kwDOABII5845sL85",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    // Make sure that the ephemeral ECDH secret is cleansed from memory once the keys are derived.\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"0000000000000000000000000000000000000000000000000000000000000000\", HexStr(responder_secret.value()));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"75fa71b052982a72ecb4a0e2a73697857121e4fca2f06e791a5d3c3383d4bb16\", HexStr(initiator_keys.initiator_L));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 48,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": 958762184,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-09-11T20:30:59Z",
      "updated_at": "2022-09-11T20:31:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884601",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884601"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 946,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884605",
      "pull_request_review_id": 1103351131,
      "id": 967884605,
      "node_id": "PRRC_kwDOABII5845sL89",
      "diff_hunk": "@@ -906,4 +908,68 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "4220009bc799722b0160284492b49ad371690d07",
      "in_reply_to_id": 958660692,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-09-11T20:31:04Z",
      "updated_at": "2022-09-11T20:31:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884605",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884605"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 932,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 933,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884612",
      "pull_request_review_id": 1103351137,
      "id": 967884612,
      "node_id": "PRRC_kwDOABII5845sL9E",
      "diff_hunk": "@@ -22,6 +28,12 @@\n  */\n typedef std::vector<unsigned char, secure_allocator<unsigned char> > CPrivKey;\n \n+constexpr static size_t ECDH_SECRET_SIZE = CSHA256::OUTPUT_SIZE;\n+const auto HASHER_BIP324_ECDH = TaggedHash(\"secp256k1_ellsq_xonly_ecdh\");",
      "path": "src/key.h",
      "position": null,
      "original_position": 23,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "789d8bb80ab71a32ddf64b1242d11fa9e333d762",
      "in_reply_to_id": 958526002,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-09-11T20:31:08Z",
      "updated_at": "2022-09-11T20:31:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884612",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884612"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884629",
      "pull_request_review_id": 1103351146,
      "id": 967884629,
      "node_id": "PRRC_kwDOABII5845sL9V",
      "diff_hunk": "@@ -344,4 +346,29 @@ BOOST_AUTO_TEST_CASE(bip340_test_vectors)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_ecdh)\n+{\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_ellswift = ParseHex(\"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\");\n+    auto responder_ellswift = ParseHex(\"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\");\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"6cbb9cd446f28623979b16affc4b57c4af95db832cb1a4ff8bc41e3192a33bd8\", HexStr(responder_secret.value()));",
      "path": "src/test/key_tests.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "789d8bb80ab71a32ddf64b1242d11fa9e333d762",
      "in_reply_to_id": 958524234,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-09-11T20:31:14Z",
      "updated_at": "2022-09-11T20:31:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r967884629",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967884629"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": 362,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 363,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976885899",
      "pull_request_review_id": 1115947374,
      "id": 976885899,
      "node_id": "PRRC_kwDOABII5846OhiL",
      "diff_hunk": "@@ -906,4 +908,64 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"ae1b0c44c3c38aa5206899c0928ca51f637e3ec05771b4a6c0662b46b76049d8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"ae1b0c44c3c38aa5206899c0928ca51f637e3ec05771b4a6c0662b46b76049d8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"98b1a948d70374db8078475fd2b573789989a57d5394ecc229a3f2ec336c4d18\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"95bdf50958c46ad24c7646cd7bf7579ffafb2f032d2c5356fc8341e198d0bb51\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"0dec3e671918898ce5472b161ddfcc6f765bf459e8cdeb86825fa704a58546e5\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"af8b74244dd43c5921e2449a125d669f6d82a23250fa040eafc3ba2373067de5\", HexStr(initiator_keys.responder_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK(initiator_keys.session_id == responder_keys.session_id);\n+    BOOST_CHECK_EQUAL(\"ae605e623a8f710f4f0c99454d74cdfb8861cad1f8f6dd2eb86390d615efab01\", HexStr(initiator_keys.session_id));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.rekey_salt.size());\n+    BOOST_CHECK(initiator_keys.rekey_salt == responder_keys.rekey_salt);\n+    BOOST_CHECK_EQUAL(\"e46620b5e10052931401606ccbb4c810c4f9afa9db948e3acfbeaa65b0cc8199\", HexStr(initiator_keys.rekey_salt));\n+\n+    BOOST_CHECK_EQUAL(BIP324_GARBAGE_TERMINATOR_LEN, initiator_keys.garbage_terminator.size());\n+    BOOST_CHECK(initiator_keys.garbage_terminator == responder_keys.garbage_terminator);\n+    BOOST_CHECK_EQUAL(\"73d7412ff3b42a01\", HexStr(Span{initiator_keys.garbage_terminator}));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f5d4f368f07b449155cd5031697b2eb1fce2f9cc",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "f5d4f36: Span can be removed.",
      "created_at": "2022-09-21T18:56:20Z",
      "updated_at": "2022-09-21T19:06:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r976885899",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976885899"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 966,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976899290",
      "pull_request_review_id": 1115967334,
      "id": 976899290,
      "node_id": "PRRC_kwDOABII5846Okza",
      "diff_hunk": "@@ -332,6 +334,40 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+// Returns just the x-coordinate in big endian\n+static int bip324_ecdh_hash(unsigned char* output, const unsigned char* x32, const unsigned char* ours, const unsigned char* theirs, void* data)\n+{\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+std::optional<ECDHSecret> CKey::ComputeBIP324ECDHSecret(const Span<const std::byte> their_ellswift,\n+                                                        const Span<const std::byte> our_ellswift,\n+                                                        bool initiating) const\n+{\n+    uint8_t xonly_ecdh[ECDH_SECRET_SIZE];",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 26,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "ab46788fc024eea10e1b5d952867bad8576c08db",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ab46788: uint8_t can be made std::byte. ",
      "created_at": "2022-09-21T19:12:14Z",
      "updated_at": "2022-09-21T19:12:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r976899290",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976899290"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 348,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/985049926",
      "pull_request_review_id": 1127484572,
      "id": 985049926,
      "node_id": "PRRC_kwDOABII5846tqtG",
      "diff_hunk": "@@ -332,6 +334,40 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+// Returns just the x-coordinate in big endian\n+static int bip324_ecdh_hash(unsigned char* output, const unsigned char* x32, const unsigned char* ours, const unsigned char* theirs, void* data)\n+{\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+std::optional<ECDHSecret> CKey::ComputeBIP324ECDHSecret(const Span<const std::byte> their_ellswift,\n+                                                        const Span<const std::byte> our_ellswift,\n+                                                        bool initiating) const\n+{\n+    uint8_t xonly_ecdh[ECDH_SECRET_SIZE];",
      "path": "src/key.cpp",
      "position": null,
      "original_position": 26,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "ab46788fc024eea10e1b5d952867bad8576c08db",
      "in_reply_to_id": 976899290,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@stratospher Upon further thought after our conversation, I think unsigned char makes sense here as that's exactly what all the functions it is used with require. So I'm going with that when I update.",
      "created_at": "2022-10-01T04:58:45Z",
      "updated_at": "2022-10-01T04:58:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r985049926",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/985049926"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 348,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/985145859",
      "pull_request_review_id": 1127568188,
      "id": 985145859,
      "node_id": "PRRC_kwDOABII5846uCID",
      "diff_hunk": "@@ -906,4 +908,64 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n     TestOnlyResetTimeData();\n }\n \n+BOOST_AUTO_TEST_CASE(bip324_derivation_test)\n+{\n+    // BIP324 key derivation uses network magic in the HKDF process. We use mainnet\n+    // params here to make it easier for other implementors to use this test as a test vector.\n+    SelectParams(CBaseChainParams::MAIN);\n+    static const std::string strSecret1 = \"5HxWvvfubhXpYYpS3tJkw6fq9jE9j18THftkZjHHfmFiWtmAbrj\";\n+    static const std::string strSecret2C = \"L3Hq7a8FEQwJkW1M2GNKDW28546Vp5miewcCzSqUD9kCAXrJdS3g\";\n+    static const std::string initiator_ellswift_str = \"b654960dff0ba8808a34337f46cc68ba7619c9df76d0550639dea62de07d17f9cb61b85f2897834ce12c50b1aefa281944abf2223a5fcf0a2a7d8c022498db35\";\n+    static const std::string responder_ellswift_str = \"ea57aae33e8dd38380c303fb561b741293ef97c780445184cabdb5ef207053db628f2765e5d770f666738112c94714991362f6643d9837e1c89cbd9710b80929\";\n+\n+    auto initiator_ellswift = ParseHex(initiator_ellswift_str);\n+    auto responder_ellswift = ParseHex(responder_ellswift_str);\n+\n+    CKey initiator_key = DecodeSecret(strSecret1);\n+    CKey responder_key = DecodeSecret(strSecret2C);\n+\n+    auto initiator_secret = initiator_key.ComputeBIP324ECDHSecret(MakeByteSpan(responder_ellswift), MakeByteSpan(initiator_ellswift), true);\n+    BOOST_CHECK(initiator_secret.has_value());\n+    auto responder_secret = responder_key.ComputeBIP324ECDHSecret(MakeByteSpan(initiator_ellswift), MakeByteSpan(responder_ellswift), false);\n+    BOOST_CHECK(responder_secret.has_value());\n+    BOOST_CHECK(initiator_secret.value() == responder_secret.value());\n+    BOOST_CHECK_EQUAL(\"ae1b0c44c3c38aa5206899c0928ca51f637e3ec05771b4a6c0662b46b76049d8\", HexStr(initiator_secret.value()));\n+    BOOST_CHECK_EQUAL(\"ae1b0c44c3c38aa5206899c0928ca51f637e3ec05771b4a6c0662b46b76049d8\", HexStr(responder_secret.value()));\n+\n+    BIP324Keys initiator_keys, responder_keys;\n+\n+    DeriveBIP324Keys(std::move(initiator_secret.value()), initiator_keys);\n+    DeriveBIP324Keys(std::move(responder_secret.value()), responder_keys);\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_L.size());\n+    BOOST_CHECK(initiator_keys.initiator_L == responder_keys.initiator_L);\n+    BOOST_CHECK_EQUAL(\"98b1a948d70374db8078475fd2b573789989a57d5394ecc229a3f2ec336c4d18\", HexStr(initiator_keys.initiator_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.initiator_P.size());\n+    BOOST_CHECK(initiator_keys.initiator_P == responder_keys.initiator_P);\n+    BOOST_CHECK_EQUAL(\"95bdf50958c46ad24c7646cd7bf7579ffafb2f032d2c5356fc8341e198d0bb51\", HexStr(initiator_keys.initiator_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_L.size());\n+    BOOST_CHECK(initiator_keys.responder_L == responder_keys.responder_L);\n+    BOOST_CHECK_EQUAL(\"0dec3e671918898ce5472b161ddfcc6f765bf459e8cdeb86825fa704a58546e5\", HexStr(initiator_keys.responder_L));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.responder_P.size());\n+    BOOST_CHECK(initiator_keys.responder_P == responder_keys.responder_P);\n+    BOOST_CHECK_EQUAL(\"af8b74244dd43c5921e2449a125d669f6d82a23250fa040eafc3ba2373067de5\", HexStr(initiator_keys.responder_P));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.session_id.size());\n+    BOOST_CHECK(initiator_keys.session_id == responder_keys.session_id);\n+    BOOST_CHECK_EQUAL(\"ae605e623a8f710f4f0c99454d74cdfb8861cad1f8f6dd2eb86390d615efab01\", HexStr(initiator_keys.session_id));\n+\n+    BOOST_CHECK_EQUAL(BIP324_KEY_LEN, initiator_keys.rekey_salt.size());\n+    BOOST_CHECK(initiator_keys.rekey_salt == responder_keys.rekey_salt);\n+    BOOST_CHECK_EQUAL(\"e46620b5e10052931401606ccbb4c810c4f9afa9db948e3acfbeaa65b0cc8199\", HexStr(initiator_keys.rekey_salt));\n+\n+    BOOST_CHECK_EQUAL(BIP324_GARBAGE_TERMINATOR_LEN, initiator_keys.garbage_terminator.size());\n+    BOOST_CHECK(initiator_keys.garbage_terminator == responder_keys.garbage_terminator);\n+    BOOST_CHECK_EQUAL(\"73d7412ff3b42a01\", HexStr(Span{initiator_keys.garbage_terminator}));",
      "path": "src/test/net_tests.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "178ef757bab6db437c8ebecd6fa7009b16da40d6",
      "original_commit_id": "f5d4f368f07b449155cd5031697b2eb1fce2f9cc",
      "in_reply_to_id": 976885899,
      "user": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2022-10-01T21:18:11Z",
      "updated_at": "2022-10-01T21:18:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r985145859",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/985145859"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 966,
      "side": "RIGHT"
    }
  ]
}