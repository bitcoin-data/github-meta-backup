{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381",
    "id": 768313522,
    "node_id": "PR_kwDOABII584ty4iy",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23381",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/23381.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/23381.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23381",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23381/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/14cd7bf793547fa5143acece564482271f5c30bc",
    "number": 23381,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "validation/refactor: refactoring for package submission",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This contains the refactors and moves within #22674. There are no behavior changes, so it should be simpler to review.",
    "labels": [
      {
        "id": 135961,
        "node_id": "MDU6TGFiZWwxMzU5NjE=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
        "name": "Refactoring",
        "color": "E6F6D6",
        "default": false
      }
    ],
    "created_at": "2021-10-28T12:48:29Z",
    "updated_at": "2022-11-09T17:37:17Z",
    "closed_at": "2021-11-09T15:46:56Z",
    "mergeable_state": "unknown",
    "merged_at": "2021-11-09T15:46:56Z",
    "merge_commit_sha": "e70fb87a4f8c3b9afab634be64ba7142edd49ddc",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "glozow:2021-10-validation-refactors",
      "ref": "2021-10-validation-refactors",
      "sha": "14cd7bf793547fa5143acece564482271f5c30bc",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 244262754,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNDQyNjI3NTQ=",
        "name": "bitcoin",
        "full_name": "glozow/bitcoin",
        "owner": {
          "login": "glozow",
          "id": 25183001,
          "node_id": "MDQ6VXNlcjI1MTgzMDAx",
          "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/glozow",
          "html_url": "https://github.com/glozow",
          "followers_url": "https://api.github.com/users/glozow/followers",
          "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
          "organizations_url": "https://api.github.com/users/glozow/orgs",
          "repos_url": "https://api.github.com/users/glozow/repos",
          "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/glozow/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/glozow/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/glozow/bitcoin",
        "archive_url": "https://api.github.com/repos/glozow/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/glozow/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/glozow/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/glozow/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/glozow/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/glozow/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/glozow/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/glozow/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/glozow/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/glozow/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/glozow/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/glozow/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/glozow/bitcoin/events",
        "forks_url": "https://api.github.com/repos/glozow/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/glozow/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/glozow/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/glozow/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/glozow/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/glozow/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/glozow/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/glozow/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/glozow/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/glozow/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/glozow/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/glozow/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/glozow/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/glozow/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/glozow/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/glozow/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:glozow/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/glozow/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/glozow/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/glozow/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/glozow/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/glozow/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/glozow/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/glozow/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/glozow/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/glozow/bitcoin/hooks",
        "svn_url": "https://github.com/glozow/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 7,
        "watchers_count": 7,
        "size": 225090,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-02T10:00:34Z",
        "created_at": "2020-03-02T02:31:56Z",
        "updated_at": "2022-01-07T17:55:23Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "24abd8312ec1caa04f9b3bd92cd960e28ca91e17",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69819,
        "watchers_count": 69819,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T05:35:10Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T04:47:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 285,
    "deletions": 195,
    "changed_files": 6,
    "commits": 10,
    "review_comments": 27,
    "comments": 7
  },
  "events": [
    {
      "event": "labeled",
      "id": 5533941157,
      "node_id": "LE_lADOABII58495ePdzwAAAAFJ2T2l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5533941157",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-28T12:57:47Z",
      "label": {
        "name": "Refactoring",
        "color": "E6F6D6"
      }
    },
    {
      "event": "reviewed",
      "id": 791853253,
      "node_id": "PRR_kwDOABII584vMrjF",
      "url": null,
      "actor": null,
      "commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "I'd suggest removing the following sentences from the commit logs:\r\n\r\n- \"It also prevents a bug where we swap a package transaction for a same-txid-different-wtxid mempool transaction and put the wrong virtual size in the RPC result.\"\r\n- \"Not doing this now would cause a bug where every package transaction could increase the descendant limit despite having unrelated conflicts, resulting in an inflated descendant limit.\"\r\n\r\nI don't think writing about what bugs _could_ be introduced in future is very informative. It's enough to say that these values are specific to individual candidate transactions, so should be kept in the `Workspace` struct.\r\n\r\nIn the _scripted-diff: clean up MemPoolAccept aliases_ commit, there are various alias members that are not removed. Was that just because it was too difficult to target them with a scripted diff, or because you think those members are special in some way?",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#pullrequestreview-791853253",
      "submitted_at": "2021-10-28T14:44:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBhNzllYWJhNzI5ZTYwYTgzYjBlNjA0ZTZhMThlOWJhMWNhMWJjODg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0a79eaba729e60a83b0e604e6a18e9ba1ca1bc88",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0a79eaba729e60a83b0e604e6a18e9ba1ca1bc88",
      "tree": {
        "sha": "6ce9e958531edbe9f1f228121b8bcb834465c417",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6ce9e958531edbe9f1f228121b8bcb834465c417"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ab25ef8c7f767258d5fe44f53b35ad8bd51ed5cd",
          "sha": "ab25ef8c7f767258d5fe44f53b35ad8bd51ed5cd",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ab25ef8c7f767258d5fe44f53b35ad8bd51ed5cd"
        }
      ],
      "message": "[validation] case-based constructors for ATMPArgs\n\nNo change in behavior.\nATMPArgs can continue to have granular rules like switching BIP125\non/off while we create an interface for the different sets of rules for\nsingle transactions vs multiple-testmempoolaccept vs package validation.\nThis is a cleaner interface than manually constructing the args, which\nmakes it easy to mix up ordering, use the wrong default, etc. It also\nmeans we don't need to edit ATMP/single transaction validation code\nevery time we update ATMPArgs for package validation.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-28T14:57:26Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-07-20T09:41:00Z"
      },
      "sha": "0a79eaba729e60a83b0e604e6a18e9ba1ca1bc88"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNiYjM1OThiNWNlMmJlYTU4YThjYjFhZDIxNjdkN2QxZDA3OWFjZjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cbb3598b5ce2bea58a8cb1ad2167d7d1d079acf7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cbb3598b5ce2bea58a8cb1ad2167d7d1d079acf7",
      "tree": {
        "sha": "9e68c1545205f59645dc0ed55fa9a344b54fe00f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9e68c1545205f59645dc0ed55fa9a344b54fe00f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0a79eaba729e60a83b0e604e6a18e9ba1ca1bc88",
          "sha": "0a79eaba729e60a83b0e604e6a18e9ba1ca1bc88",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0a79eaba729e60a83b0e604e6a18e9ba1ca1bc88"
        }
      ],
      "message": "[validation/refactor] store precomputed txdata in workspace\n\nWe want to be able to re-use the precomputed transaction data between\nPolicyScriptChecks and ConsensusScriptChecks in\nAcceptMultipleTransactions.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-28T14:58:53Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-07-20T10:38:44Z"
      },
      "sha": "cbb3598b5ce2bea58a8cb1ad2167d7d1d079acf7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhmYTI5MzZiMzRmZGE5YzBiZWE5NjMzMTFmYTgwYTA0YjRiZjU4Njc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8fa2936b34fda9c0bea963311fa80a04b4bf5867",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8fa2936b34fda9c0bea963311fa80a04b4bf5867",
      "tree": {
        "sha": "fb848595955dfb27749b169bdeab1411f2a525c6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fb848595955dfb27749b169bdeab1411f2a525c6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cbb3598b5ce2bea58a8cb1ad2167d7d1d079acf7",
          "sha": "cbb3598b5ce2bea58a8cb1ad2167d7d1d079acf7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cbb3598b5ce2bea58a8cb1ad2167d7d1d079acf7"
        }
      ],
      "message": "[validation] re-introduce bool for whether a transaction is RBF\n\nThis bool was originally part of Workspace and was removed in #22539\nwhen it was no longer needed in Finalize(). Re-introducing it because,\nonce again, multiple functions will need to know whether we're doing an\nRBF. Member of MemPoolAccept so that we can use this to inform package\nRBF in the future.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-28T14:58:54Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-28T12:25:23Z"
      },
      "sha": "8fa2936b34fda9c0bea963311fa80a04b4bf5867"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM2YTg0NDE5MTJiZjg0YjRkYTljNzQ4MjZkY2Q0MjUzM2Q4YWJhYWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/36a8441912bf84b4da9c74826dcd42533d8abaaa",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/36a8441912bf84b4da9c74826dcd42533d8abaaa",
      "tree": {
        "sha": "0d65ed2f257ad67ec05732e839fe7a4c8ba87c15",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0d65ed2f257ad67ec05732e839fe7a4c8ba87c15"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8fa2936b34fda9c0bea963311fa80a04b4bf5867",
          "sha": "8fa2936b34fda9c0bea963311fa80a04b4bf5867",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8fa2936b34fda9c0bea963311fa80a04b4bf5867"
        }
      ],
      "message": "[validation/rpc] cache + use vsize calculated in PreChecks\n\nThis is not only cleaner but also helps make sure we are always using\nthe virtual size measure that includes the sigop weight heuristic (which\nis the vsize the mempool would return).",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-28T14:58:54Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-09-02T12:09:11Z"
      },
      "sha": "36a8441912bf84b4da9c74826dcd42533d8abaaa"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5534921749,
      "node_id": "HRFPE_lADOABII58495ePdzwAAAAFJ6DQV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5534921749",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-28T15:15:36Z"
    },
    {
      "event": "commented",
      "id": 953947619,
      "node_id": "IC_kwDOABII58443BXj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/953947619",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-28T15:17:33Z",
      "updated_at": "2021-10-28T15:17:33Z",
      "author_association": "MEMBER",
      "body": "Thanks for the review @jnewbery, took your suggestions",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#issuecomment-953947619",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23381"
    },
    {
      "event": "mentioned",
      "id": 5534934588,
      "node_id": "MEE_lADOABII58495ePdzwAAAAFJ6GY8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5534934588",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-28T15:17:33Z"
    },
    {
      "event": "subscribed",
      "id": 5534934595,
      "node_id": "SE_lADOABII58495ePdzwAAAAFJ6GZD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5534934595",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-28T15:17:33Z"
    },
    {
      "event": "reviewed",
      "id": 792074604,
      "node_id": "PRR_kwDOABII584vNhls",
      "url": null,
      "actor": null,
      "commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK 4d262e060e714042d747c4f0b2e0398234893d34\r\n\r\nOne suggestion inline.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#pullrequestreview-792074604",
      "submitted_at": "2021-10-28T15:59:30Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
    },
    {
      "event": "added_to_project",
      "id": 5535206645,
      "node_id": "ATPE_lADOABII58495ePdzwAAAAFJ7Iz1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5535206645",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-28T16:00:37Z",
      "project_card": {
        "id": 71789822,
        "url": "https://api.github.com/projects/columns/cards/71789822",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "commented",
      "id": 954101804,
      "node_id": "IC_kwDOABII58443nAs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954101804",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-28T18:37:46Z",
      "updated_at": "2021-11-08T06:19:29Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23465](https://github.com/bitcoin/bitcoin/pull/23465) (Remove CChainParams and CTxMemPool params from ATMP by lsilva01)\n* [#23448](https://github.com/bitcoin/bitcoin/pull/23448) (refactor, consensus: remove calls to global `Params()` in validation layer by lsilva01)\n* [#23437](https://github.com/bitcoin/bitcoin/pull/23437) (refactor, mempool: remove AcceptToMemoryPoolWithTime by lsilva01)\n* [#23121](https://github.com/bitcoin/bitcoin/pull/23121) ([policy] check ancestor feerate in RBF, remove BIP125 Rule2 by glozow)\n* [#22981](https://github.com/bitcoin/bitcoin/pull/22981) (doc: Fix incorrect C++ named args by MarcoFalke)\n* [#22674](https://github.com/bitcoin/bitcoin/pull/22674) (validation: mempool validation and submission for packages of 1 child + parents by glozow)\n* [#22097](https://github.com/bitcoin/bitcoin/pull/22097) (validation: Move package acceptance size limit from KvB to WU by ariard)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#issuecomment-954101804",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23381"
    },
    {
      "event": "reviewed",
      "id": 792904885,
      "node_id": "PRR_kwDOABII584vQsS1",
      "url": null,
      "actor": null,
      "commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#pullrequestreview-792904885",
      "submitted_at": "2021-10-29T11:01:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
    },
    {
      "event": "reviewed",
      "id": 794784809,
      "node_id": "PRR_kwDOABII584vX3Qp",
      "url": null,
      "actor": null,
      "commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Overall good. See the comment around the newer descendant limits members in `Workspace`.",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#pullrequestreview-794784809",
      "submitted_at": "2021-11-02T01:00:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5569529832,
      "node_id": "HRFPE_lADOABII58495ePdzwAAAAFL-Efo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5569529832",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-04T16:32:59Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDNkM2U0NTk4YjZlNTcwYjFmODI0OGIxZWU0M2VjNTkxNjVhM2ZmNWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3d3e4598b6e570b1f8248b1ee43ec59165a3ff5c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3d3e4598b6e570b1f8248b1ee43ec59165a3ff5c",
      "tree": {
        "sha": "05880ed139990176499ae8f11dff3842948e2d15",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/05880ed139990176499ae8f11dff3842948e2d15"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/36a8441912bf84b4da9c74826dcd42533d8abaaa",
          "sha": "36a8441912bf84b4da9c74826dcd42533d8abaaa",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/36a8441912bf84b4da9c74826dcd42533d8abaaa"
        }
      ],
      "message": "[validation] cache iterators to mempool conflicts",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-11-04T16:38:11Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-28T15:09:33Z"
      },
      "sha": "3d3e4598b6e570b1f8248b1ee43ec59165a3ff5c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZkOTJiMGMzOTg2YjllYjQxY2UyOGViNjAyZjU2ZDQwNWJkZDNjZDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fd92b0c3986b9eb41ce28eb602f56d405bdd3cd7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fd92b0c3986b9eb41ce28eb602f56d405bdd3cd7",
      "tree": {
        "sha": "290ed4addb63a54a4e5af2395a18f88985d122d6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/290ed4addb63a54a4e5af2395a18f88985d122d6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3d3e4598b6e570b1f8248b1ee43ec59165a3ff5c",
          "sha": "3d3e4598b6e570b1f8248b1ee43ec59165a3ff5c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3d3e4598b6e570b1f8248b1ee43ec59165a3ff5c"
        }
      ],
      "message": "document workspace members",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-11-04T16:38:13Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-11-04T16:23:32Z"
      },
      "sha": "fd92b0c3986b9eb41ce28eb602f56d405bdd3cd7"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5569585806,
      "node_id": "HRFPE_lADOABII58495ePdzwAAAAFL-SKO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5569585806",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-04T16:41:40Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDllOTEwZDgxNTJlMDhkMjZlY2NlNjU5Mjg3MGFkYmU1ZGFiZDE1OWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9e910d8152e08d26ecce6592870adbe5dabd159e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9e910d8152e08d26ecce6592870adbe5dabd159e",
      "tree": {
        "sha": "422b3596c98fa1041db0522c568e345da84d0608",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/422b3596c98fa1041db0522c568e345da84d0608"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fd92b0c3986b9eb41ce28eb602f56d405bdd3cd7",
          "sha": "fd92b0c3986b9eb41ce28eb602f56d405bdd3cd7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fd92b0c3986b9eb41ce28eb602f56d405bdd3cd7"
        }
      ],
      "message": "scripted-diff: clean up MemPoolAccept aliases\n\nThe aliases are leftover from a previous MOVEONLY refactor - they are\nunnecessary and removing them reduces the diff for splitting out mempool\nChecks from PreChecks, making RBF variables MemPoolAccept-wide, etc.\n\n-BEGIN VERIFY SCRIPT-\n\nunalias() { sed -i \"s:\\<$1\\>:$2:g\" src/validation.cpp; sed -i \"/$2 = $2/d\" src/validation.cpp; }\n\nunalias nModifiedFees \t\t  ws.m_modified_fees\nunalias nConflictingFees      \t  ws.m_conflicting_fees\nunalias nConflictingSize          ws.m_conflicting_size\nunalias setConflicts \t          ws.m_conflicts\nunalias allConflicting\t\t  ws.m_all_conflicting\nunalias setAncestors\t          ws.m_ancestors\n\n-END VERIFY SCRIPT-",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-11-04T18:54:03Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-08-03T10:54:42Z"
      },
      "sha": "9e910d8152e08d26ecce6592870adbe5dabd159e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM5YjE0MzljYTlhYjY5MWY0NjcyZDJjYmYzM2Q5MzgxZjI5ODU0NjY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c9b1439ca9ab691f4672d2cbf33d9381f2985466",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c9b1439ca9ab691f4672d2cbf33d9381f2985466",
      "tree": {
        "sha": "cac73565d4a961fdbd835b0c7742d5762d61890e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cac73565d4a961fdbd835b0c7742d5762d61890e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9e910d8152e08d26ecce6592870adbe5dabd159e",
          "sha": "9e910d8152e08d26ecce6592870adbe5dabd159e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9e910d8152e08d26ecce6592870adbe5dabd159e"
        }
      ],
      "message": "MOVEONLY: mempool checks to their own functions\n\nNo change in behavior, because package transactions would not be going\nthrough the rbf logic in PreChecks anyway (BIP125 is currently disabled\nfor package acceptance, see ATMPArgs).\n\nWe draw the line here because each individual transaction in package\nvalidation still goes through all PreChecks. For example, checking that\none's own conflicts and dependencies are disjoint (a consensus check)\nand individual transaction mempool ancestor/descendant limits.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-11-04T18:55:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-08-09T10:56:57Z"
      },
      "sha": "c9b1439ca9ab691f4672d2cbf33d9381f2985466"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY4NzYzNzgzNjU4ZjAwNGVmZDkxMTdmYTdhNjliMGUyNzFjNGVhYWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/68763783658f004efd9117fa7a69b0e271c4eaaa",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/68763783658f004efd9117fa7a69b0e271c4eaaa",
      "tree": {
        "sha": "2f8c2a168236c2596f343e898944257eca5b82d2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2f8c2a168236c2596f343e898944257eca5b82d2"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c9b1439ca9ab691f4672d2cbf33d9381f2985466",
          "sha": "c9b1439ca9ab691f4672d2cbf33d9381f2985466",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c9b1439ca9ab691f4672d2cbf33d9381f2985466"
        }
      ],
      "message": "MOVEONLY: move package unit tests to their own file",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-11-04T18:55:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-28T11:54:19Z"
      },
      "sha": "68763783658f004efd9117fa7a69b0e271c4eaaa"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE0Y2Q3YmY3OTM1NDdmYTUxNDNhY2VjZTU2NDQ4MjI3MWY1YzMwYmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/14cd7bf793547fa5143acece564482271f5c30bc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/14cd7bf793547fa5143acece564482271f5c30bc",
      "tree": {
        "sha": "49c9646ebfaef919beab6e97a7933a97c07bd0e3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/49c9646ebfaef919beab6e97a7933a97c07bd0e3"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/68763783658f004efd9117fa7a69b0e271c4eaaa",
          "sha": "68763783658f004efd9117fa7a69b0e271c4eaaa",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/68763783658f004efd9117fa7a69b0e271c4eaaa"
        }
      ],
      "message": "[test] call CheckPackage for package sanitization checks\n\nMakes the test more minimal. We're just trying to test that our package\nsanitization logic is correct. Now that this code lives in its own\nfunction (rather than inside of AcceptMultipleTransactions), there's no\nneed to call ProcessNewPackage to test this.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-11-04T18:55:12Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-28T11:58:11Z"
      },
      "sha": "14cd7bf793547fa5143acece564482271f5c30bc"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5570408071,
      "node_id": "HRFPE_lADOABII58495ePdzwAAAAFMBa6H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5570408071",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-04T18:56:34Z"
    },
    {
      "event": "commented",
      "id": 962174813,
      "node_id": "IC_kwDOABII5845WZ9d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/962174813",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-05T19:50:15Z",
      "updated_at": "2021-11-05T19:50:15Z",
      "author_association": "MEMBER",
      "body": "Thanks for the reviews @ariard and @jnewbery, took suggestions",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#issuecomment-962174813",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23381"
    },
    {
      "event": "mentioned",
      "id": 5576457083,
      "node_id": "MEE_lADOABII58495ePdzwAAAAFMYft7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5576457083",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-05T19:50:16Z"
    },
    {
      "event": "subscribed",
      "id": 5576457088,
      "node_id": "SE_lADOABII58495ePdzwAAAAFMYfuA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5576457088",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-05T19:50:16Z"
    },
    {
      "event": "mentioned",
      "id": 5576457091,
      "node_id": "MEE_lADOABII58495ePdzwAAAAFMYfuD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5576457091",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-05T19:50:16Z"
    },
    {
      "event": "subscribed",
      "id": 5576457095,
      "node_id": "SE_lADOABII58495ePdzwAAAAFMYfuH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5576457095",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-05T19:50:16Z"
    },
    {
      "event": "commented",
      "id": 963741194,
      "node_id": "IC_kwDOABII5845cYYK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/963741194",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-09T01:55:19Z",
      "updated_at": "2021-11-09T01:55:19Z",
      "author_association": "MEMBER",
      "body": "Code Review ACK 14cd7bf\r\n\r\nChanges since last review have been removing of `Workspace`-level descendant limits, introducing of fd92b0c39,  stripping off the `setAncestors` alias, improving `PackageMempoolChecks`'s comment, drying up `PackageMempoolChecks` from its `Workspace` parameter.",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#issuecomment-963741194",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23381"
    },
    {
      "event": "commented",
      "id": 964073867,
      "node_id": "IC_kwDOABII5845dpmL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/964073867",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-09T11:44:43Z",
      "updated_at": "2021-11-09T11:44:43Z",
      "author_association": "MEMBER",
      "body": "Code review ACK 14cd7bf793547fa5143acece564482271f5c30bc",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#issuecomment-964073867",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23381"
    },
    {
      "event": "commented",
      "id": 964076982,
      "node_id": "IC_kwDOABII5845dqW2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/964076982",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-09T11:47:45Z",
      "updated_at": "2021-11-09T11:47:45Z",
      "author_association": "MEMBER",
      "body": "I think this might be RFM now since it's a simple refactor.\r\n\r\nPerhaps @t-bast also wants to review this? It's basically the same commits from #22674 that you've already reviewed.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#issuecomment-964076982",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23381"
    },
    {
      "event": "mentioned",
      "id": 5589169254,
      "node_id": "MEE_lADOABII58495ePdzwAAAAFNI_Rm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5589169254",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-09T11:47:45Z"
    },
    {
      "event": "subscribed",
      "id": 5589169259,
      "node_id": "SE_lADOABII58495ePdzwAAAAFNI_Rr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5589169259",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-09T11:47:45Z"
    },
    {
      "event": "reviewed",
      "id": 801355511,
      "node_id": "PRR_kwDOABII584vw7b3",
      "url": null,
      "actor": null,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code Review ACK https://github.com/bitcoin/bitcoin/pull/23381/commits/14cd7bf793547fa5143acece564482271f5c30bc\r\n\r\nMy ack shouldn't weigh that much given my poor knowledge of the codebase, but the code does look cleaner and the added comments are helpful :+1: ",
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#pullrequestreview-801355511",
      "submitted_at": "2021-11-09T14:32:14Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
    },
    {
      "event": "commented",
      "id": 964275979,
      "node_id": "IC_kwDOABII5845ea8L",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/964275979",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-09T15:46:14Z",
      "updated_at": "2021-11-09T15:46:14Z",
      "author_association": "MEMBER",
      "body": "Code review ACK 14cd7bf793547fa5143acece564482271f5c30bc, thanks for adding documentation and clarifying the code\r\n",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#issuecomment-964275979",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23381"
    },
    {
      "event": "merged",
      "id": 5590713398,
      "node_id": "ME_lADOABII58495ePdzwAAAAFNO4Q2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5590713398",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e70fb87a4f8c3b9afab634be64ba7142edd49ddc",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e70fb87a4f8c3b9afab634be64ba7142edd49ddc",
      "created_at": "2021-11-09T15:46:56Z"
    },
    {
      "event": "closed",
      "id": 5590713452,
      "node_id": "CE_lADOABII58495ePdzwAAAAFNO4Rs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5590713452",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-09T15:46:56Z"
    },
    {
      "event": "referenced",
      "id": 5591074618,
      "node_id": "REFE_lADOABII58495ePdzwAAAAFNQQc6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5591074618",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "625cdea35d496ea0dda6fd3847116e6d08c112fe",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/625cdea35d496ea0dda6fd3847116e6d08c112fe",
      "created_at": "2021-11-09T16:36:03Z"
    },
    {
      "event": "reviewed",
      "id": 801621846,
      "node_id": "PRR_kwDOABII584vx8dW",
      "url": null,
      "actor": null,
      "commit_id": "c9b1439ca9ab691f4672d2cbf33d9381f2985466",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#pullrequestreview-801621846",
      "submitted_at": "2021-11-09T17:47:56Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
    },
    {
      "event": "head_ref_deleted",
      "id": 5591768265,
      "node_id": "HRDE_lADOABII58495ePdzwAAAAFNS5zJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5591768265",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-09T18:24:36Z"
    },
    {
      "event": "removed_from_project",
      "id": 5598296633,
      "node_id": "RFPE_lADOABII58495ePdzwAAAAFNrzo5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5598296633",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-10T16:20:00Z",
      "project_card": {
        "id": 71789822,
        "url": "https://api.github.com/projects/columns/cards/71789822",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "referenced",
      "id": 7640125405,
      "node_id": "REFE_lADOABII58495ePdzwAAAAHHYw_d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7640125405",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "979f4e87a480511b10fc3f7e971bcc1d07b50a70",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/979f4e87a480511b10fc3f7e971bcc1d07b50a70",
      "created_at": "2022-10-21T12:14:46Z"
    },
    {
      "event": "referenced",
      "id": 7640125413,
      "node_id": "REFE_lADOABII58495ePdzwAAAAHHYw_l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7640125413",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7afb349331615b10b47f66a700b0faff554967e0",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/7afb349331615b10b47f66a700b0faff554967e0",
      "created_at": "2022-10-21T12:14:46Z"
    },
    {
      "event": "referenced",
      "id": 7653779007,
      "node_id": "REFE_lADOABII58495ePdzwAAAAHIM2Y_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7653779007",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7597e8cfa37d1ec89c4db84f553ad5b2dfab4ce1",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/7597e8cfa37d1ec89c4db84f553ad5b2dfab4ce1",
      "created_at": "2022-10-24T13:03:38Z"
    },
    {
      "event": "referenced",
      "id": 7653779015,
      "node_id": "REFE_lADOABII58495ePdzwAAAAHIM2ZH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7653779015",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "bd6e032568c55137bf98420d9d7877f99ddcdf02",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/bd6e032568c55137bf98420d9d7877f99ddcdf02",
      "created_at": "2022-10-24T13:03:38Z"
    },
    {
      "event": "referenced",
      "id": 7653779027,
      "node_id": "REFE_lADOABII58495ePdzwAAAAHIM2ZT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7653779027",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "9c01a0070ad22a19f12fc0482829036157c7deaf",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/9c01a0070ad22a19f12fc0482829036157c7deaf",
      "created_at": "2022-10-24T13:03:39Z"
    },
    {
      "event": "referenced",
      "id": 7653779041,
      "node_id": "REFE_lADOABII58495ePdzwAAAAHIM2Zh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7653779041",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "f269b4d06a255750efe2492ad952a9c00486520f",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/f269b4d06a255750efe2492ad952a9c00486520f",
      "created_at": "2022-10-24T13:03:39Z"
    },
    {
      "event": "referenced",
      "id": 7654201429,
      "node_id": "REFE_lADOABII58495ePdzwAAAAHIOdhV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7654201429",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "789c3ac2417e4fe9875ec82ec5dff5a958532fd5",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/789c3ac2417e4fe9875ec82ec5dff5a958532fd5",
      "created_at": "2022-10-24T13:49:47Z"
    },
    {
      "event": "referenced",
      "id": 7654201445,
      "node_id": "REFE_lADOABII58495ePdzwAAAAHIOdhl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7654201445",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "9f8c2b711e1d3636d1eb3fc3c1094b4f565d5f2f",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/9f8c2b711e1d3636d1eb3fc3c1094b4f565d5f2f",
      "created_at": "2022-10-24T13:49:48Z"
    },
    {
      "event": "locked",
      "id": 7775834858,
      "node_id": "LOE_lADOABII58495ePdzwAAAAHPedLq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7775834858",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-09T17:37:17Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738380554",
      "pull_request_review_id": 791853253,
      "id": 738380554,
      "node_id": "PRRC_kwDOABII584sAssK",
      "diff_hunk": "@@ -1019,9 +1092,7 @@ static MempoolAcceptResult AcceptToMemoryPoolWithTime(const CChainParams& chainp\n                                                       EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n     std::vector<COutPoint> coins_to_uncache;\n-    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, coins_to_uncache,\n-                                   test_accept, /* m_allow_bip125_replacement */ true };\n-\n+    auto args = MemPoolAccept::ATMPArgs::SingleAccept(chainparams, nAcceptTime, bypass_limits, test_accept, coins_to_uncache);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 498,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No need to reorder `coins_to_uncache, test_accept` to `test_accept, coins_to_uncache` here. It makes your static ctors inconsistent in their argument ordering.",
      "created_at": "2021-10-28T13:17:49Z",
      "updated_at": "2021-10-28T14:44:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738380554",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738380554"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1095,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738385962",
      "pull_request_review_id": 791853253,
      "id": 738385962,
      "node_id": "PRRC_kwDOABII584sAuAq",
      "diff_hunk": "@@ -919,30 +996,30 @@ MempoolAcceptResult MemPoolAccept::AcceptSingleTransaction(const CTransactionRef\n     AssertLockHeld(cs_main);\n     LOCK(m_pool.cs); // mempool \"read lock\" (held through GetMainSignals().TransactionAddedToMempool())\n \n-    Workspace ws(ptx);\n+    Workspace ws(ptx, m_limit_descendants, m_limit_descendant_size);\n \n     if (!PreChecks(args, ws)) return MempoolAcceptResult::Failure(ws.m_state);\n \n+    if (m_rbf && !ReplacementChecks(ws)) return MempoolAcceptResult::Failure(ws.m_state);\n+\n     // Only compute the precomputed transaction data if we need to verify",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 421,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This comment is a little bit stranded now that the `txdata` variable has been removed. Perhaps just remove the first sentence?",
      "created_at": "2021-10-28T13:23:41Z",
      "updated_at": "2021-10-28T14:44:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738385962",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738385962"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1005,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738399598",
      "pull_request_review_id": 791853253,
      "id": 738399598,
      "node_id": "PRRC_kwDOABII584sAxVu",
      "diff_hunk": "@@ -760,60 +811,90 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n         // to be secure by simply only having two immediately-spendable\n         // outputs - one for each counterparty. For more info on the uses for\n         // this, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016518.html\n-        if (nSize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n-                !m_pool.CalculateMemPoolAncestors(*entry, setAncestors, 2, m_limit_ancestor_size, m_limit_descendants + 1, m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n+        if (ws.m_vsize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 216,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        if (ws.m_vsize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\r\n```\r\n```suggestion\r\n        if (ws.m_vsize > EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\r\n```",
      "created_at": "2021-10-28T13:38:04Z",
      "updated_at": "2021-10-28T14:44:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738399598",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738399598"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 814,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738409406",
      "pull_request_review_id": 791853253,
      "id": 738409406,
      "node_id": "PRRC_kwDOABII584sAzu-",
      "diff_hunk": "@@ -484,6 +519,15 @@ class MemPoolAccept\n         const CTransactionRef& m_ptx;\n         const uint256& m_hash;\n         TxValidationState m_state;\n+        /** A temporary cache containing serialized transaction data for signature verification.\n+         * Reused across PolicyScriptChecks and ConsensusScriptChecks. */\n+        PrecomputedTransactionData m_precomputed_txdata;\n+\n+        // Descendant limits passed in to CalculateMemPoolAncestors() for this transaction.\n+        // These may be modified while evaluating a transaction (eg to account for in-mempool\n+        // conflicts; see the comment in PreChecks).\n+        size_t m_tx_limit_descendants;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 70,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: the `tx_` is a bit redundant here. This is a member of the `Workspace` object which is a collection of data relating to a single candidate transaction.",
      "created_at": "2021-10-28T13:48:08Z",
      "updated_at": "2021-10-28T14:44:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738409406",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738409406"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 529,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738458528",
      "pull_request_review_id": 791853253,
      "id": 738458528,
      "node_id": "PRRC_kwDOABII584sA_ug",
      "diff_hunk": "@@ -760,60 +811,90 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n         // to be secure by simply only having two immediately-spendable\n         // outputs - one for each counterparty. For more info on the uses for\n         // this, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016518.html\n-        if (nSize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n-                !m_pool.CalculateMemPoolAncestors(*entry, setAncestors, 2, m_limit_ancestor_size, m_limit_descendants + 1, m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n+        if (ws.m_vsize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n+            !m_pool.CalculateMemPoolAncestors(*entry, ws.m_ancestors, /* limitancestors */ 2,\n+                m_limit_ancestor_size, ws.m_tx_limit_descendants + 1,\n+                ws.m_tx_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n             return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"too-long-mempool-chain\", errString);\n         }\n     }\n \n     // A transaction that spends outputs that would be replaced by it is invalid. Now\n     // that we have the set of all ancestors we can detect this\n-    // pathological case by making sure setConflicts and setAncestors don't\n+    // pathological case by making sure ws.m_conflicts and ws.m_ancestors don't\n     // intersect.\n-    if (const auto err_string{EntriesAndTxidsDisjoint(setAncestors, setConflicts, hash)}) {\n+    if (const auto err_string{EntriesAndTxidsDisjoint(ws.m_ancestors, ws.m_conflicts, hash)}) {\n         // We classify this as a consensus error because a transaction depending on something it\n         // conflicts with would be inconsistent.\n         return state.Invalid(TxValidationResult::TX_CONSENSUS, \"bad-txns-spends-conflicting-tx\", *err_string);\n     }\n \n+    m_rbf = !ws.m_conflicts.empty();\n+    return true;\n+}\n \n-    if (!setConflicts.empty()) {\n-        CFeeRate newFeeRate(nModifiedFees, nSize);\n-        // It's possible that the replacement pays more fees than its direct conflicts but not more\n-        // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n-        // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n-        // more economically rational to mine. Before we go digging through the mempool for all\n-        // transactions that would need to be removed (direct conflicts and all descendants), check\n-        // that the replacement transaction pays more than its direct conflicts.\n-        if (const auto err_string{PaysMoreThanConflicts(setIterConflicting, newFeeRate, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+bool MemPoolAccept::ReplacementChecks(Workspace& ws)\n+{\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(m_pool.cs);\n \n-        // Calculate all conflicting entries and enforce BIP125 Rule #5.\n-        if (const auto err_string{GetEntriesForConflicts(tx, m_pool, setIterConflicting, allConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"too many potential replacements\", *err_string);\n-        }\n-        // Enforce BIP125 Rule #2.\n-        if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, setIterConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"replacement-adds-unconfirmed\", *err_string);\n-        }\n+    const CTransaction& tx = *ws.m_ptx;\n+    const uint256& hash = ws.m_hash;\n+    TxValidationState& state = ws.m_state;\n+    const CTxMemPool::setEntries setIterConflicting = m_pool.GetIterSet(ws.m_conflicts);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 269,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is there any performance penalty in doing this lookup twice? I suspect it's not too bad since each of the lookups are into a boost::multi_index::hashed_unique map, which has an amortized complexity of O(1) (https://www.boost.org/doc/libs/1_56_0/libs/multi_index/doc/reference/hash_indices.html#lookup).\r\n\r\nEven so, it seems a shame to have to query the mempool twice for the same data. Could this set be stored in the `Workspace` object to avoid the second lookup?",
      "created_at": "2021-10-28T14:35:00Z",
      "updated_at": "2021-10-28T14:44:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738458528",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738458528"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 844,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738498714",
      "pull_request_review_id": 792020775,
      "id": 738498714,
      "node_id": "PRRC_kwDOABII584sBJia",
      "diff_hunk": "@@ -1019,9 +1092,7 @@ static MempoolAcceptResult AcceptToMemoryPoolWithTime(const CChainParams& chainp\n                                                       EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n     std::vector<COutPoint> coins_to_uncache;\n-    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, coins_to_uncache,\n-                                   test_accept, /* m_allow_bip125_replacement */ true };\n-\n+    auto args = MemPoolAccept::ATMPArgs::SingleAccept(chainparams, nAcceptTime, bypass_limits, test_accept, coins_to_uncache);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 498,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": 738380554,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2021-10-28T15:15:58Z",
      "updated_at": "2021-10-28T15:15:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738498714",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738498714"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1095,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738498871",
      "pull_request_review_id": 792020982,
      "id": 738498871,
      "node_id": "PRRC_kwDOABII584sBJk3",
      "diff_hunk": "@@ -919,30 +996,30 @@ MempoolAcceptResult MemPoolAccept::AcceptSingleTransaction(const CTransactionRef\n     AssertLockHeld(cs_main);\n     LOCK(m_pool.cs); // mempool \"read lock\" (held through GetMainSignals().TransactionAddedToMempool())\n \n-    Workspace ws(ptx);\n+    Workspace ws(ptx, m_limit_descendants, m_limit_descendant_size);\n \n     if (!PreChecks(args, ws)) return MempoolAcceptResult::Failure(ws.m_state);\n \n+    if (m_rbf && !ReplacementChecks(ws)) return MempoolAcceptResult::Failure(ws.m_state);\n+\n     // Only compute the precomputed transaction data if we need to verify",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 421,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": 738385962,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Removed first sentence",
      "created_at": "2021-10-28T15:16:08Z",
      "updated_at": "2021-10-28T15:16:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738498871",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738498871"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1005,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738499125",
      "pull_request_review_id": 792021313,
      "id": 738499125,
      "node_id": "PRRC_kwDOABII584sBJo1",
      "diff_hunk": "@@ -760,60 +811,90 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n         // to be secure by simply only having two immediately-spendable\n         // outputs - one for each counterparty. For more info on the uses for\n         // this, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016518.html\n-        if (nSize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n-                !m_pool.CalculateMemPoolAncestors(*entry, setAncestors, 2, m_limit_ancestor_size, m_limit_descendants + 1, m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n+        if (ws.m_vsize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 216,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": 738399598,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2021-10-28T15:16:24Z",
      "updated_at": "2021-10-28T15:16:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738499125",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738499125"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 814,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738499521",
      "pull_request_review_id": 792021856,
      "id": 738499521,
      "node_id": "PRRC_kwDOABII584sBJvB",
      "diff_hunk": "@@ -484,6 +519,15 @@ class MemPoolAccept\n         const CTransactionRef& m_ptx;\n         const uint256& m_hash;\n         TxValidationState m_state;\n+        /** A temporary cache containing serialized transaction data for signature verification.\n+         * Reused across PolicyScriptChecks and ConsensusScriptChecks. */\n+        PrecomputedTransactionData m_precomputed_txdata;\n+\n+        // Descendant limits passed in to CalculateMemPoolAncestors() for this transaction.\n+        // These may be modified while evaluating a transaction (eg to account for in-mempool\n+        // conflicts; see the comment in PreChecks).\n+        size_t m_tx_limit_descendants;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 70,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": 738409406,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Hok, took out the `tx_`",
      "created_at": "2021-10-28T15:16:49Z",
      "updated_at": "2021-10-28T15:16:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738499521",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738499521"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 529,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738499868",
      "pull_request_review_id": 792022334,
      "id": 738499868,
      "node_id": "PRRC_kwDOABII584sBJ0c",
      "diff_hunk": "@@ -760,60 +811,90 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n         // to be secure by simply only having two immediately-spendable\n         // outputs - one for each counterparty. For more info on the uses for\n         // this, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016518.html\n-        if (nSize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n-                !m_pool.CalculateMemPoolAncestors(*entry, setAncestors, 2, m_limit_ancestor_size, m_limit_descendants + 1, m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n+        if (ws.m_vsize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n+            !m_pool.CalculateMemPoolAncestors(*entry, ws.m_ancestors, /* limitancestors */ 2,\n+                m_limit_ancestor_size, ws.m_tx_limit_descendants + 1,\n+                ws.m_tx_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n             return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"too-long-mempool-chain\", errString);\n         }\n     }\n \n     // A transaction that spends outputs that would be replaced by it is invalid. Now\n     // that we have the set of all ancestors we can detect this\n-    // pathological case by making sure setConflicts and setAncestors don't\n+    // pathological case by making sure ws.m_conflicts and ws.m_ancestors don't\n     // intersect.\n-    if (const auto err_string{EntriesAndTxidsDisjoint(setAncestors, setConflicts, hash)}) {\n+    if (const auto err_string{EntriesAndTxidsDisjoint(ws.m_ancestors, ws.m_conflicts, hash)}) {\n         // We classify this as a consensus error because a transaction depending on something it\n         // conflicts with would be inconsistent.\n         return state.Invalid(TxValidationResult::TX_CONSENSUS, \"bad-txns-spends-conflicting-tx\", *err_string);\n     }\n \n+    m_rbf = !ws.m_conflicts.empty();\n+    return true;\n+}\n \n-    if (!setConflicts.empty()) {\n-        CFeeRate newFeeRate(nModifiedFees, nSize);\n-        // It's possible that the replacement pays more fees than its direct conflicts but not more\n-        // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n-        // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n-        // more economically rational to mine. Before we go digging through the mempool for all\n-        // transactions that would need to be removed (direct conflicts and all descendants), check\n-        // that the replacement transaction pays more than its direct conflicts.\n-        if (const auto err_string{PaysMoreThanConflicts(setIterConflicting, newFeeRate, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+bool MemPoolAccept::ReplacementChecks(Workspace& ws)\n+{\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(m_pool.cs);\n \n-        // Calculate all conflicting entries and enforce BIP125 Rule #5.\n-        if (const auto err_string{GetEntriesForConflicts(tx, m_pool, setIterConflicting, allConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"too many potential replacements\", *err_string);\n-        }\n-        // Enforce BIP125 Rule #2.\n-        if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, setIterConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"replacement-adds-unconfirmed\", *err_string);\n-        }\n+    const CTransaction& tx = *ws.m_ptx;\n+    const uint256& hash = ws.m_hash;\n+    TxValidationState& state = ws.m_state;\n+    const CTxMemPool::setEntries setIterConflicting = m_pool.GetIterSet(ws.m_conflicts);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 269,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "f7d8be9b4bd8215a1a6261e0925c4bb7554b99ac",
      "in_reply_to_id": 738458528,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "added a `m_iters_conflicting` to the `workspace` struct",
      "created_at": "2021-10-28T15:17:11Z",
      "updated_at": "2021-10-28T15:17:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738499868",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738499868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 844,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738537426",
      "pull_request_review_id": 792074604,
      "id": 738537426,
      "node_id": "PRRC_kwDOABII584sBS_S",
      "diff_hunk": "@@ -467,13 +496,21 @@ class MemPoolAccept\n     // All the intermediate state that gets passed between the various levels\n     // of checking a given transaction.\n     struct Workspace {\n-        explicit Workspace(const CTransactionRef& ptx) : m_ptx(ptx), m_hash(ptx->GetHash()) {}\n+        explicit Workspace(const CTransactionRef& ptx, size_t limit_descendants, size_t limit_descendant_size) :\n+            m_ptx(ptx), m_hash(ptx->GetHash()),\n+            m_limit_descendants{limit_descendants},\n+            m_limit_descendant_size{limit_descendant_size} {}\n         std::set<uint256> m_conflicts;\n+        /** Iterators to mempool entries that this transaction directly conflicts with. */",
      "path": "src/validation.cpp",
      "position": 44,
      "original_position": 48,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: you could also comment the `m_all_conflicting` member below to emphasize that it contains the conflicts with all descendants. And perhaps rename the members to `m_direct_conflicts` and `m_all_conflicts` to highlight that difference.\r\n\r\nAlso, the `m_conflicts` member above is only used in `PreChecks()`, so could be a local variable in that function rather than a member of `Workspace`.\r\n\r\nPerhaps it makes sense to clean all of that up in the _[validation] cache iterators to mempool conflicts_ commit?",
      "created_at": "2021-10-28T15:59:11Z",
      "updated_at": "2021-10-28T15:59:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r738537426",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738537426"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 502,
      "original_line": 502,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739138737",
      "pull_request_review_id": 792904885,
      "id": 739138737,
      "node_id": "PRRC_kwDOABII584sDlyx",
      "diff_hunk": "@@ -760,60 +813,88 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n         // to be secure by simply only having two immediately-spendable\n         // outputs - one for each counterparty. For more info on the uses for\n         // this, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016518.html\n-        if (nSize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n-                !m_pool.CalculateMemPoolAncestors(*entry, setAncestors, 2, m_limit_ancestor_size, m_limit_descendants + 1, m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n+        if (ws.m_vsize > EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n+            !m_pool.CalculateMemPoolAncestors(*entry, ws.m_ancestors, /* limitancestors */ 2,\n+                m_limit_ancestor_size, ws.m_limit_descendants + 1,\n+                ws.m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n             return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"too-long-mempool-chain\", errString);\n         }\n     }\n \n     // A transaction that spends outputs that would be replaced by it is invalid. Now\n     // that we have the set of all ancestors we can detect this\n-    // pathological case by making sure setConflicts and setAncestors don't\n+    // pathological case by making sure ws.m_conflicts and ws.m_ancestors don't\n     // intersect.\n-    if (const auto err_string{EntriesAndTxidsDisjoint(setAncestors, setConflicts, hash)}) {\n+    if (const auto err_string{EntriesAndTxidsDisjoint(ws.m_ancestors, ws.m_conflicts, hash)}) {\n         // We classify this as a consensus error because a transaction depending on something it\n         // conflicts with would be inconsistent.\n         return state.Invalid(TxValidationResult::TX_CONSENSUS, \"bad-txns-spends-conflicting-tx\", *err_string);\n     }\n \n+    m_rbf = !ws.m_conflicts.empty();\n+    return true;\n+}\n \n-    if (!setConflicts.empty()) {\n-        CFeeRate newFeeRate(nModifiedFees, nSize);\n-        // It's possible that the replacement pays more fees than its direct conflicts but not more\n-        // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n-        // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n-        // more economically rational to mine. Before we go digging through the mempool for all\n-        // transactions that would need to be removed (direct conflicts and all descendants), check\n-        // that the replacement transaction pays more than its direct conflicts.\n-        if (const auto err_string{PaysMoreThanConflicts(setIterConflicting, newFeeRate, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+bool MemPoolAccept::ReplacementChecks(Workspace& ws)\n+{\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(m_pool.cs);\n \n-        // Calculate all conflicting entries and enforce BIP125 Rule #5.\n-        if (const auto err_string{GetEntriesForConflicts(tx, m_pool, setIterConflicting, allConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"too many potential replacements\", *err_string);\n-        }\n-        // Enforce BIP125 Rule #2.\n-        if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, setIterConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"replacement-adds-unconfirmed\", *err_string);\n-        }\n+    const CTransaction& tx = *ws.m_ptx;\n+    const uint256& hash = ws.m_hash;\n+    TxValidationState& state = ws.m_state;\n \n-        // Check if it's economically rational to mine this transaction rather than the ones it\n-        // replaces and pays for its own relay fees. Enforce BIP125 Rules #3 and #4.\n-        for (CTxMemPool::txiter it : allConflicting) {\n-            nConflictingFees += it->GetModifiedFee();\n-            nConflictingSize += it->GetTxSize();\n-        }\n-        if (const auto err_string{PaysForRBF(nConflictingFees, nModifiedFees, nSize, ::incrementalRelayFee, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+    CFeeRate newFeeRate(ws.m_modified_fees, ws.m_vsize);\n+    // It's possible that the replacement pays more fees than its direct conflicts but not more\n+    // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n+    // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n+    // more economically rational to mine. Before we go digging through the mempool for all\n+    // transactions that would need to be removed (direct conflicts and all descendants), check\n+    // that the replacement transaction pays more than its direct conflicts.\n+    if (const auto err_string{PaysMoreThanConflicts(ws.m_iters_conflicting, newFeeRate, hash)}) {\n+        return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n+    }\n+\n+    // Calculate all conflicting entries and enforce BIP125 Rule #5.\n+    if (const auto err_string{GetEntriesForConflicts(tx, m_pool, ws.m_iters_conflicting, ws.m_all_conflicting)}) {\n+        return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n+                             \"too many potential replacements\", *err_string);\n+    }\n+    // Enforce BIP125 Rule #2.\n+    if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, ws.m_iters_conflicting)}) {\n+        return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n+                             \"replacement-adds-unconfirmed\", *err_string);\n+    }\n+    // Check if it's economically rational to mine this transaction rather than the ones it\n+    // replaces and pays for its own relay fees. Enforce BIP125 Rules #3 and #4.\n+    for (CTxMemPool::txiter it : ws.m_all_conflicting) {\n+        ws.m_conflicting_fees += it->GetModifiedFee();\n+        ws.m_conflicting_size += it->GetTxSize();\n+    }\n+    if (const auto err_string{PaysForRBF(ws.m_conflicting_fees, ws.m_modified_fees, ws.m_vsize,\n+                                         ::incrementalRelayFee, hash)}) {\n+        return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n     }\n     return true;\n }\n \n-bool MemPoolAccept::PolicyScriptChecks(const ATMPArgs& args, Workspace& ws, PrecomputedTransactionData& txdata)\n+bool MemPoolAccept::PackageMempoolChecks(const std::vector<CTransactionRef>& txns,\n+                                         std::vector<Workspace>& workspaces,",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 322,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This parameter isn't used in this PR or #22674. I suggest leaving it out until it's used in #22290 (and I think there, you can just pass the vector of `Workspace`s and not the vector of `CTransactionRef`s, since the `Workspace`s contain the `CTransactionRef`s)",
      "created_at": "2021-10-29T11:01:52Z",
      "updated_at": "2021-10-29T11:01:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r739138737",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739138737"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740643940",
      "pull_request_review_id": 794784809,
      "id": 740643940,
      "node_id": "PRRC_kwDOABII584sJVRk",
      "diff_hunk": "@@ -484,6 +521,15 @@ class MemPoolAccept\n         const CTransactionRef& m_ptx;\n         const uint256& m_hash;\n         TxValidationState m_state;\n+        /** A temporary cache containing serialized transaction data for signature verification.\n+         * Reused across PolicyScriptChecks and ConsensusScriptChecks. */\n+        PrecomputedTransactionData m_precomputed_txdata;\n+\n+        // Descendant limits passed in to CalculateMemPoolAncestors() for this transaction.\n+        // These may be modified while evaluating a transaction (eg to account for in-mempool\n+        // conflicts; see the comment in PreChecks).\n+        size_t m_limit_descendants;\n+        size_t m_limit_descendant_size;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 73,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If you can backport the renaming to `m_tx_limit_descendants` from #22674, I think that's good for review clarity. \r\n\r\nThat said, I still don't get why introducing a new pair of descendant limits at the `Workspace`-level, _in addition_ of the one already present in `MemPoolAccept`. AFAICT, the intermediate state, as modified in consequence to account for carve-out relaxation in `PreChecks` isn't re-used inside the other mempool checks helpers (`PolicyScriptChecks`, `Finalize`, ...). Or is the rational about a future use, even ulterior to #22674 ?",
      "created_at": "2021-11-02T00:35:21Z",
      "updated_at": "2021-11-02T01:00:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r740643940",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740643940"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740646512",
      "pull_request_review_id": 794784809,
      "id": 740646512,
      "node_id": "PRRC_kwDOABII584sJV5w",
      "diff_hunk": "@@ -760,60 +813,88 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n         // to be secure by simply only having two immediately-spendable\n         // outputs - one for each counterparty. For more info on the uses for\n         // this, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016518.html\n-        if (nSize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n-                !m_pool.CalculateMemPoolAncestors(*entry, setAncestors, 2, m_limit_ancestor_size, m_limit_descendants + 1, m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n+        if (ws.m_vsize > EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n+            !m_pool.CalculateMemPoolAncestors(*entry, ws.m_ancestors, /* limitancestors */ 2,\n+                m_limit_ancestor_size, ws.m_limit_descendants + 1,\n+                ws.m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n             return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"too-long-mempool-chain\", errString);\n         }\n     }\n \n     // A transaction that spends outputs that would be replaced by it is invalid. Now\n     // that we have the set of all ancestors we can detect this\n-    // pathological case by making sure setConflicts and setAncestors don't\n+    // pathological case by making sure ws.m_conflicts and ws.m_ancestors don't\n     // intersect.\n-    if (const auto err_string{EntriesAndTxidsDisjoint(setAncestors, setConflicts, hash)}) {\n+    if (const auto err_string{EntriesAndTxidsDisjoint(ws.m_ancestors, ws.m_conflicts, hash)}) {\n         // We classify this as a consensus error because a transaction depending on something it\n         // conflicts with would be inconsistent.\n         return state.Invalid(TxValidationResult::TX_CONSENSUS, \"bad-txns-spends-conflicting-tx\", *err_string);\n     }\n \n+    m_rbf = !ws.m_conflicts.empty();\n+    return true;\n+}\n \n-    if (!setConflicts.empty()) {\n-        CFeeRate newFeeRate(nModifiedFees, nSize);\n-        // It's possible that the replacement pays more fees than its direct conflicts but not more\n-        // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n-        // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n-        // more economically rational to mine. Before we go digging through the mempool for all\n-        // transactions that would need to be removed (direct conflicts and all descendants), check\n-        // that the replacement transaction pays more than its direct conflicts.\n-        if (const auto err_string{PaysMoreThanConflicts(setIterConflicting, newFeeRate, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+bool MemPoolAccept::ReplacementChecks(Workspace& ws)\n+{\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(m_pool.cs);\n \n-        // Calculate all conflicting entries and enforce BIP125 Rule #5.\n-        if (const auto err_string{GetEntriesForConflicts(tx, m_pool, setIterConflicting, allConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"too many potential replacements\", *err_string);\n-        }\n-        // Enforce BIP125 Rule #2.\n-        if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, setIterConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"replacement-adds-unconfirmed\", *err_string);\n-        }\n+    const CTransaction& tx = *ws.m_ptx;\n+    const uint256& hash = ws.m_hash;",
      "path": "src/validation.cpp",
      "position": 262,
      "original_position": 274,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe good timing to rename `m_hash` to `m_txid_hash` or anything else to break ambiguity in prevision of wtxid acceptance.",
      "created_at": "2021-11-02T00:43:42Z",
      "updated_at": "2021-11-02T01:00:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r740646512",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740646512"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 843,
      "original_line": 843,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740648931",
      "pull_request_review_id": 794784809,
      "id": 740648931,
      "node_id": "PRRC_kwDOABII584sJWfj",
      "diff_hunk": "@@ -680,9 +732,9 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n \n     int64_t nSigOpsCost = GetTransactionSigOpCost(tx, m_view, STANDARD_SCRIPT_VERIFY_FLAGS);\n \n-    // nModifiedFees includes any fee deltas from PrioritiseTransaction\n-    nModifiedFees = ws.m_base_fees;\n-    m_pool.ApplyDelta(hash, nModifiedFees);\n+    // ws.m_modified_fees includes any fee deltas from PrioritiseTransaction",
      "path": "src/validation.cpp",
      "position": 156,
      "original_position": 163,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: This comment could be replicated, at least in substance in `m_modified_fees` member declaration in `Workspace`. Naming could be also clearer to indicate the source of the modification itself, like `m_priority_fees`",
      "created_at": "2021-11-02T00:51:49Z",
      "updated_at": "2021-11-02T01:00:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r740648931",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740648931"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 737,
      "original_line": 737,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740651256",
      "pull_request_review_id": 794784809,
      "id": 740651256,
      "node_id": "PRRC_kwDOABII584sJXD4",
      "diff_hunk": "@@ -492,15 +538,23 @@ class MemPoolAccept\n     // only tests that are fast should be done here (to avoid CPU DoS).\n     bool PreChecks(ATMPArgs& args, Workspace& ws) EXCLUSIVE_LOCKS_REQUIRED(cs_main, m_pool.cs);\n \n+    // Run checks for mempool replace-by-fee.\n+    bool ReplacementChecks(Workspace& ws) EXCLUSIVE_LOCKS_REQUIRED(cs_main, m_pool.cs);\n+\n+    // Enforce package mempool ancestor/descendant limits.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 84,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Note the comment above `PreChecks` also mention evaluation package limits. I think both of statements are true, though they don't refer to the same set of package limits. IIRC the first ones in `PreChecks` are the in-mempool package limits while the second ones concern atomically accepted package, which is stricter under the union rule. \r\n\r\nI think we can improve documentation to establish clearly that we have two set of package limits to consider.",
      "created_at": "2021-11-02T01:00:03Z",
      "updated_at": "2021-11-02T01:00:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r740651256",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740651256"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 547,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741099846",
      "pull_request_review_id": 795410828,
      "id": 741099846,
      "node_id": "PRRC_kwDOABII584sLElG",
      "diff_hunk": "@@ -484,6 +521,15 @@ class MemPoolAccept\n         const CTransactionRef& m_ptx;\n         const uint256& m_hash;\n         TxValidationState m_state;\n+        /** A temporary cache containing serialized transaction data for signature verification.\n+         * Reused across PolicyScriptChecks and ConsensusScriptChecks. */\n+        PrecomputedTransactionData m_precomputed_txdata;\n+\n+        // Descendant limits passed in to CalculateMemPoolAncestors() for this transaction.\n+        // These may be modified while evaluating a transaction (eg to account for in-mempool\n+        // conflicts; see the comment in PreChecks).\n+        size_t m_limit_descendants;\n+        size_t m_limit_descendant_size;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 73,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": 740643940,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You're right that it's not necessary yet in #22674 - I apologize, as the cut off for splitting it out of #22290 was a little bit arbitrary, so there are a few not-yet-relevant-until-later refactors in this PR.\r\n\r\nTo explain the problem: when we add package RBF, we don't want to increase the `MemPoolAccept::m_limit_descendants` here: https://github.com/bitcoin/bitcoin/blob/04670ef81ea2300fcba4e1a492c4c6b0e0752848/src/validation.cpp#L765\r\nFor example, if we had a package of 5 parents and 1 child, and each of the parents had exactly 1 conflict, this would cause us to increase the descendant limit 5 times. That would be incorrectly inflating the limit.",
      "created_at": "2021-11-02T14:16:09Z",
      "updated_at": "2021-11-02T14:16:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r741099846",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741099846"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741101014",
      "pull_request_review_id": 795415620,
      "id": 741101014,
      "node_id": "PRRC_kwDOABII584sLE3W",
      "diff_hunk": "@@ -760,60 +813,88 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n         // to be secure by simply only having two immediately-spendable\n         // outputs - one for each counterparty. For more info on the uses for\n         // this, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016518.html\n-        if (nSize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n-                !m_pool.CalculateMemPoolAncestors(*entry, setAncestors, 2, m_limit_ancestor_size, m_limit_descendants + 1, m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n+        if (ws.m_vsize > EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n+            !m_pool.CalculateMemPoolAncestors(*entry, ws.m_ancestors, /* limitancestors */ 2,\n+                m_limit_ancestor_size, ws.m_limit_descendants + 1,\n+                ws.m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n             return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"too-long-mempool-chain\", errString);\n         }\n     }\n \n     // A transaction that spends outputs that would be replaced by it is invalid. Now\n     // that we have the set of all ancestors we can detect this\n-    // pathological case by making sure setConflicts and setAncestors don't\n+    // pathological case by making sure ws.m_conflicts and ws.m_ancestors don't\n     // intersect.\n-    if (const auto err_string{EntriesAndTxidsDisjoint(setAncestors, setConflicts, hash)}) {\n+    if (const auto err_string{EntriesAndTxidsDisjoint(ws.m_ancestors, ws.m_conflicts, hash)}) {\n         // We classify this as a consensus error because a transaction depending on something it\n         // conflicts with would be inconsistent.\n         return state.Invalid(TxValidationResult::TX_CONSENSUS, \"bad-txns-spends-conflicting-tx\", *err_string);\n     }\n \n+    m_rbf = !ws.m_conflicts.empty();\n+    return true;\n+}\n \n-    if (!setConflicts.empty()) {\n-        CFeeRate newFeeRate(nModifiedFees, nSize);\n-        // It's possible that the replacement pays more fees than its direct conflicts but not more\n-        // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n-        // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n-        // more economically rational to mine. Before we go digging through the mempool for all\n-        // transactions that would need to be removed (direct conflicts and all descendants), check\n-        // that the replacement transaction pays more than its direct conflicts.\n-        if (const auto err_string{PaysMoreThanConflicts(setIterConflicting, newFeeRate, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+bool MemPoolAccept::ReplacementChecks(Workspace& ws)\n+{\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(m_pool.cs);\n \n-        // Calculate all conflicting entries and enforce BIP125 Rule #5.\n-        if (const auto err_string{GetEntriesForConflicts(tx, m_pool, setIterConflicting, allConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"too many potential replacements\", *err_string);\n-        }\n-        // Enforce BIP125 Rule #2.\n-        if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, setIterConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"replacement-adds-unconfirmed\", *err_string);\n-        }\n+    const CTransaction& tx = *ws.m_ptx;\n+    const uint256& hash = ws.m_hash;",
      "path": "src/validation.cpp",
      "position": 262,
      "original_position": 274,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": 740646512,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point, though I would prefer to just remove `m_hash` from `Workspace` entirely. The hashes are already cached in the `CTransaction` object, so we can just call `ptx->GetHash()` and `ptx->GetWitnessHash()` directly.",
      "created_at": "2021-11-02T14:17:20Z",
      "updated_at": "2021-11-02T14:17:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r741101014",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741101014"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 843,
      "original_line": 843,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743012051",
      "pull_request_review_id": 797985815,
      "id": 743012051,
      "node_id": "PRRC_kwDOABII584sSXbT",
      "diff_hunk": "@@ -484,6 +521,15 @@ class MemPoolAccept\n         const CTransactionRef& m_ptx;\n         const uint256& m_hash;\n         TxValidationState m_state;\n+        /** A temporary cache containing serialized transaction data for signature verification.\n+         * Reused across PolicyScriptChecks and ConsensusScriptChecks. */\n+        PrecomputedTransactionData m_precomputed_txdata;\n+\n+        // Descendant limits passed in to CalculateMemPoolAncestors() for this transaction.\n+        // These may be modified while evaluating a transaction (eg to account for in-mempool\n+        // conflicts; see the comment in PreChecks).\n+        size_t m_limit_descendants;\n+        size_t m_limit_descendant_size;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 73,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": 740643940,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Removed the commit from this PR - will add later when needed in package RBF",
      "created_at": "2021-11-04T16:33:44Z",
      "updated_at": "2021-11-04T16:33:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r743012051",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743012051"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743012329",
      "pull_request_review_id": 797986136,
      "id": 743012329,
      "node_id": "PRRC_kwDOABII584sSXfp",
      "diff_hunk": "@@ -467,13 +496,21 @@ class MemPoolAccept\n     // All the intermediate state that gets passed between the various levels\n     // of checking a given transaction.\n     struct Workspace {\n-        explicit Workspace(const CTransactionRef& ptx) : m_ptx(ptx), m_hash(ptx->GetHash()) {}\n+        explicit Workspace(const CTransactionRef& ptx, size_t limit_descendants, size_t limit_descendant_size) :\n+            m_ptx(ptx), m_hash(ptx->GetHash()),\n+            m_limit_descendants{limit_descendants},\n+            m_limit_descendant_size{limit_descendant_size} {}\n         std::set<uint256> m_conflicts;\n+        /** Iterators to mempool entries that this transaction directly conflicts with. */",
      "path": "src/validation.cpp",
      "position": 44,
      "original_position": 48,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": 738537426,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Added a commit to document the `Workspace` members",
      "created_at": "2021-11-04T16:33:59Z",
      "updated_at": "2021-11-04T16:33:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r743012329",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743012329"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 502,
      "original_line": 502,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743012683",
      "pull_request_review_id": 797986656,
      "id": 743012683,
      "node_id": "PRRC_kwDOABII584sSXlL",
      "diff_hunk": "@@ -760,60 +813,88 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n         // to be secure by simply only having two immediately-spendable\n         // outputs - one for each counterparty. For more info on the uses for\n         // this, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016518.html\n-        if (nSize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n-                !m_pool.CalculateMemPoolAncestors(*entry, setAncestors, 2, m_limit_ancestor_size, m_limit_descendants + 1, m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n+        if (ws.m_vsize > EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n+            !m_pool.CalculateMemPoolAncestors(*entry, ws.m_ancestors, /* limitancestors */ 2,\n+                m_limit_ancestor_size, ws.m_limit_descendants + 1,\n+                ws.m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n             return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"too-long-mempool-chain\", errString);\n         }\n     }\n \n     // A transaction that spends outputs that would be replaced by it is invalid. Now\n     // that we have the set of all ancestors we can detect this\n-    // pathological case by making sure setConflicts and setAncestors don't\n+    // pathological case by making sure ws.m_conflicts and ws.m_ancestors don't\n     // intersect.\n-    if (const auto err_string{EntriesAndTxidsDisjoint(setAncestors, setConflicts, hash)}) {\n+    if (const auto err_string{EntriesAndTxidsDisjoint(ws.m_ancestors, ws.m_conflicts, hash)}) {\n         // We classify this as a consensus error because a transaction depending on something it\n         // conflicts with would be inconsistent.\n         return state.Invalid(TxValidationResult::TX_CONSENSUS, \"bad-txns-spends-conflicting-tx\", *err_string);\n     }\n \n+    m_rbf = !ws.m_conflicts.empty();\n+    return true;\n+}\n \n-    if (!setConflicts.empty()) {\n-        CFeeRate newFeeRate(nModifiedFees, nSize);\n-        // It's possible that the replacement pays more fees than its direct conflicts but not more\n-        // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n-        // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n-        // more economically rational to mine. Before we go digging through the mempool for all\n-        // transactions that would need to be removed (direct conflicts and all descendants), check\n-        // that the replacement transaction pays more than its direct conflicts.\n-        if (const auto err_string{PaysMoreThanConflicts(setIterConflicting, newFeeRate, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+bool MemPoolAccept::ReplacementChecks(Workspace& ws)\n+{\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(m_pool.cs);\n \n-        // Calculate all conflicting entries and enforce BIP125 Rule #5.\n-        if (const auto err_string{GetEntriesForConflicts(tx, m_pool, setIterConflicting, allConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"too many potential replacements\", *err_string);\n-        }\n-        // Enforce BIP125 Rule #2.\n-        if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, setIterConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"replacement-adds-unconfirmed\", *err_string);\n-        }\n+    const CTransaction& tx = *ws.m_ptx;\n+    const uint256& hash = ws.m_hash;\n+    TxValidationState& state = ws.m_state;\n \n-        // Check if it's economically rational to mine this transaction rather than the ones it\n-        // replaces and pays for its own relay fees. Enforce BIP125 Rules #3 and #4.\n-        for (CTxMemPool::txiter it : allConflicting) {\n-            nConflictingFees += it->GetModifiedFee();\n-            nConflictingSize += it->GetTxSize();\n-        }\n-        if (const auto err_string{PaysForRBF(nConflictingFees, nModifiedFees, nSize, ::incrementalRelayFee, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+    CFeeRate newFeeRate(ws.m_modified_fees, ws.m_vsize);\n+    // It's possible that the replacement pays more fees than its direct conflicts but not more\n+    // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n+    // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n+    // more economically rational to mine. Before we go digging through the mempool for all\n+    // transactions that would need to be removed (direct conflicts and all descendants), check\n+    // that the replacement transaction pays more than its direct conflicts.\n+    if (const auto err_string{PaysMoreThanConflicts(ws.m_iters_conflicting, newFeeRate, hash)}) {\n+        return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n+    }\n+\n+    // Calculate all conflicting entries and enforce BIP125 Rule #5.\n+    if (const auto err_string{GetEntriesForConflicts(tx, m_pool, ws.m_iters_conflicting, ws.m_all_conflicting)}) {\n+        return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n+                             \"too many potential replacements\", *err_string);\n+    }\n+    // Enforce BIP125 Rule #2.\n+    if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, ws.m_iters_conflicting)}) {\n+        return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n+                             \"replacement-adds-unconfirmed\", *err_string);\n+    }\n+    // Check if it's economically rational to mine this transaction rather than the ones it\n+    // replaces and pays for its own relay fees. Enforce BIP125 Rules #3 and #4.\n+    for (CTxMemPool::txiter it : ws.m_all_conflicting) {\n+        ws.m_conflicting_fees += it->GetModifiedFee();\n+        ws.m_conflicting_size += it->GetTxSize();\n+    }\n+    if (const auto err_string{PaysForRBF(ws.m_conflicting_fees, ws.m_modified_fees, ws.m_vsize,\n+                                         ::incrementalRelayFee, hash)}) {\n+        return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n     }\n     return true;\n }\n \n-bool MemPoolAccept::PolicyScriptChecks(const ATMPArgs& args, Workspace& ws, PrecomputedTransactionData& txdata)\n+bool MemPoolAccept::PackageMempoolChecks(const std::vector<CTransactionRef>& txns,\n+                                         std::vector<Workspace>& workspaces,",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 322,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": 739138737,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Removed from this PR",
      "created_at": "2021-11-04T16:34:24Z",
      "updated_at": "2021-11-04T16:34:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r743012683",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743012683"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743013476",
      "pull_request_review_id": 797987658,
      "id": 743013476,
      "node_id": "PRRC_kwDOABII584sSXxk",
      "diff_hunk": "@@ -680,9 +732,9 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n \n     int64_t nSigOpsCost = GetTransactionSigOpCost(tx, m_view, STANDARD_SCRIPT_VERIFY_FLAGS);\n \n-    // nModifiedFees includes any fee deltas from PrioritiseTransaction\n-    nModifiedFees = ws.m_base_fees;\n-    m_pool.ApplyDelta(hash, nModifiedFees);\n+    // ws.m_modified_fees includes any fee deltas from PrioritiseTransaction",
      "path": "src/validation.cpp",
      "position": 156,
      "original_position": 163,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": 740648931,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Added comment to `m_modified_fees` 👍 ",
      "created_at": "2021-11-04T16:35:13Z",
      "updated_at": "2021-11-04T16:35:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r743013476",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743013476"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 737,
      "original_line": 737,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743121401",
      "pull_request_review_id": 798148018,
      "id": 743121401,
      "node_id": "PRRC_kwDOABII584sSyH5",
      "diff_hunk": "@@ -492,15 +538,23 @@ class MemPoolAccept\n     // only tests that are fast should be done here (to avoid CPU DoS).\n     bool PreChecks(ATMPArgs& args, Workspace& ws) EXCLUSIVE_LOCKS_REQUIRED(cs_main, m_pool.cs);\n \n+    // Run checks for mempool replace-by-fee.\n+    bool ReplacementChecks(Workspace& ws) EXCLUSIVE_LOCKS_REQUIRED(cs_main, m_pool.cs);\n+\n+    // Enforce package mempool ancestor/descendant limits.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 84,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": 740651256,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Edited the comment to clarify that there's individual and package ancestor/desc limits",
      "created_at": "2021-11-04T18:56:58Z",
      "updated_at": "2021-11-04T18:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r743121401",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/743121401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 547,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/745202366",
      "pull_request_review_id": 800743417,
      "id": 745202366,
      "node_id": "PRRC_kwDOABII584sauK-",
      "diff_hunk": "@@ -760,60 +813,88 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n         // to be secure by simply only having two immediately-spendable\n         // outputs - one for each counterparty. For more info on the uses for\n         // this, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016518.html\n-        if (nSize >  EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n-                !m_pool.CalculateMemPoolAncestors(*entry, setAncestors, 2, m_limit_ancestor_size, m_limit_descendants + 1, m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n+        if (ws.m_vsize > EXTRA_DESCENDANT_TX_SIZE_LIMIT ||\n+            !m_pool.CalculateMemPoolAncestors(*entry, ws.m_ancestors, /* limitancestors */ 2,\n+                m_limit_ancestor_size, ws.m_limit_descendants + 1,\n+                ws.m_limit_descendant_size + EXTRA_DESCENDANT_TX_SIZE_LIMIT, dummy_err_string)) {\n             return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"too-long-mempool-chain\", errString);\n         }\n     }\n \n     // A transaction that spends outputs that would be replaced by it is invalid. Now\n     // that we have the set of all ancestors we can detect this\n-    // pathological case by making sure setConflicts and setAncestors don't\n+    // pathological case by making sure ws.m_conflicts and ws.m_ancestors don't\n     // intersect.\n-    if (const auto err_string{EntriesAndTxidsDisjoint(setAncestors, setConflicts, hash)}) {\n+    if (const auto err_string{EntriesAndTxidsDisjoint(ws.m_ancestors, ws.m_conflicts, hash)}) {\n         // We classify this as a consensus error because a transaction depending on something it\n         // conflicts with would be inconsistent.\n         return state.Invalid(TxValidationResult::TX_CONSENSUS, \"bad-txns-spends-conflicting-tx\", *err_string);\n     }\n \n+    m_rbf = !ws.m_conflicts.empty();\n+    return true;\n+}\n \n-    if (!setConflicts.empty()) {\n-        CFeeRate newFeeRate(nModifiedFees, nSize);\n-        // It's possible that the replacement pays more fees than its direct conflicts but not more\n-        // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n-        // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n-        // more economically rational to mine. Before we go digging through the mempool for all\n-        // transactions that would need to be removed (direct conflicts and all descendants), check\n-        // that the replacement transaction pays more than its direct conflicts.\n-        if (const auto err_string{PaysMoreThanConflicts(setIterConflicting, newFeeRate, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+bool MemPoolAccept::ReplacementChecks(Workspace& ws)\n+{\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(m_pool.cs);\n \n-        // Calculate all conflicting entries and enforce BIP125 Rule #5.\n-        if (const auto err_string{GetEntriesForConflicts(tx, m_pool, setIterConflicting, allConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"too many potential replacements\", *err_string);\n-        }\n-        // Enforce BIP125 Rule #2.\n-        if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, setIterConflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"replacement-adds-unconfirmed\", *err_string);\n-        }\n+    const CTransaction& tx = *ws.m_ptx;\n+    const uint256& hash = ws.m_hash;",
      "path": "src/validation.cpp",
      "position": 262,
      "original_position": 274,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": 740646512,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes that direction is even better!",
      "created_at": "2021-11-09T00:44:28Z",
      "updated_at": "2021-11-09T00:54:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r745202366",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/745202366"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 843,
      "original_line": 843,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/745210795",
      "pull_request_review_id": 800753505,
      "id": 745210795,
      "node_id": "PRRC_kwDOABII584sawOr",
      "diff_hunk": "@@ -484,6 +521,15 @@ class MemPoolAccept\n         const CTransactionRef& m_ptx;\n         const uint256& m_hash;\n         TxValidationState m_state;\n+        /** A temporary cache containing serialized transaction data for signature verification.\n+         * Reused across PolicyScriptChecks and ConsensusScriptChecks. */\n+        PrecomputedTransactionData m_precomputed_txdata;\n+\n+        // Descendant limits passed in to CalculateMemPoolAncestors() for this transaction.\n+        // These may be modified while evaluating a transaction (eg to account for in-mempool\n+        // conflicts; see the comment in PreChecks).\n+        size_t m_limit_descendants;\n+        size_t m_limit_descendant_size;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 73,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "4d262e060e714042d747c4f0b2e0398234893d34",
      "in_reply_to_id": 740643940,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> To explain the problem: when we add package RBF, we don't want to increase the > MemPoolAccept::m_limit_descendants here:\r\n>\r\n> bitcoin/src/validation.cpp\r\n> \r\n> Line 765 in 04670ef\r\n> m_limit_descendants += 1; \r\n>\r\n> For example, if we had a package of 5 parents and 1 child, and each of the parents had exactly 1 > conflict, this would cause us to increase the descendant limit 5 times. That would be incorrectly inflating the limit.\r\n\r\nThanks for the explanation, now I wonder if the carve-out relaxation makes really sense with package RBF. If your counterparty has broadcast a junk branch on the parent transaction and you're RBF'ing one of your output with a package n>2, the one-more-carve-out-child relaxation won't work, I think ?\r\n\r\nThough I would say let's defer the conversation for a future PR when package RBF is effectively introduced. ",
      "created_at": "2021-11-09T01:06:43Z",
      "updated_at": "2021-11-09T01:07:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r745210795",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/745210795"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/745864415",
      "pull_request_review_id": 801621846,
      "id": 745864415,
      "node_id": "PRRC_kwDOABII584sdPzf",
      "diff_hunk": "@@ -823,43 +831,67 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n     }\n \n     m_rbf = !ws.m_conflicts.empty();\n-    if (m_rbf) {\n-        CFeeRate newFeeRate(ws.m_modified_fees, ws.m_vsize);\n-        // It's possible that the replacement pays more fees than its direct conflicts but not more\n-        // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n-        // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n-        // more economically rational to mine. Before we go digging through the mempool for all\n-        // transactions that would need to be removed (direct conflicts and all descendants), check\n-        // that the replacement transaction pays more than its direct conflicts.\n-        if (const auto err_string{PaysMoreThanConflicts(ws.m_iters_conflicting, newFeeRate, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+    return true;\n+}\n \n-        // Calculate all conflicting entries and enforce BIP125 Rule #5.\n-        if (const auto err_string{GetEntriesForConflicts(tx, m_pool, ws.m_iters_conflicting, ws.m_all_conflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"too many potential replacements\", *err_string);\n-        }\n-        // Enforce BIP125 Rule #2.\n-        if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, ws.m_iters_conflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"replacement-adds-unconfirmed\", *err_string);\n-        }\n+bool MemPoolAccept::ReplacementChecks(Workspace& ws)\n+{\n+    AssertLockHeld(cs_main);",
      "path": "src/validation.cpp",
      "position": 248,
      "original_position": 45,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "c9b1439ca9ab691f4672d2cbf33d9381f2985466",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Would it make sense to add `Assume/Assert(ws.m_rbf);`?",
      "created_at": "2021-11-09T17:47:56Z",
      "updated_at": "2021-11-09T17:47:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r745864415",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/745864415"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 839,
      "original_line": 839,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/745903647",
      "pull_request_review_id": 801689777,
      "id": 745903647,
      "node_id": "PRRC_kwDOABII584sdZYf",
      "diff_hunk": "@@ -823,43 +831,67 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n     }\n \n     m_rbf = !ws.m_conflicts.empty();\n-    if (m_rbf) {\n-        CFeeRate newFeeRate(ws.m_modified_fees, ws.m_vsize);\n-        // It's possible that the replacement pays more fees than its direct conflicts but not more\n-        // than all conflicts (i.e. the direct conflicts have high-fee descendants). However, if the\n-        // replacement doesn't pay more fees than its direct conflicts, then we can be sure it's not\n-        // more economically rational to mine. Before we go digging through the mempool for all\n-        // transactions that would need to be removed (direct conflicts and all descendants), check\n-        // that the replacement transaction pays more than its direct conflicts.\n-        if (const auto err_string{PaysMoreThanConflicts(ws.m_iters_conflicting, newFeeRate, hash)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"insufficient fee\", *err_string);\n-        }\n+    return true;\n+}\n \n-        // Calculate all conflicting entries and enforce BIP125 Rule #5.\n-        if (const auto err_string{GetEntriesForConflicts(tx, m_pool, ws.m_iters_conflicting, ws.m_all_conflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"too many potential replacements\", *err_string);\n-        }\n-        // Enforce BIP125 Rule #2.\n-        if (const auto err_string{HasNoNewUnconfirmed(tx, m_pool, ws.m_iters_conflicting)}) {\n-            return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY,\n-                                 \"replacement-adds-unconfirmed\", *err_string);\n-        }\n+bool MemPoolAccept::ReplacementChecks(Workspace& ws)\n+{\n+    AssertLockHeld(cs_main);",
      "path": "src/validation.cpp",
      "position": 248,
      "original_position": 45,
      "commit_id": "14cd7bf793547fa5143acece564482271f5c30bc",
      "original_commit_id": "c9b1439ca9ab691f4672d2cbf33d9381f2985466",
      "in_reply_to_id": 745864415,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sure, there's no harm in adding one. If safety is a concern, note that this is a no-op if `m_iters_conflicting` is empty:`PaysMoreThanConflicts`, `GetEntriesForConflicts`, `HasNoNewUnconfirmed`, and `PaysForRBF` should all simply return `std::nullopt` if they're called with empty or 0 inputs. So if we accidentally called this function with `m_rbf` false or no conflicts, it would be some small wasted effort, but we should be okay.",
      "created_at": "2021-11-09T18:40:10Z",
      "updated_at": "2021-11-09T18:40:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23381#discussion_r745903647",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/745903647"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23381"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 839,
      "original_line": 839,
      "side": "RIGHT"
    }
  ]
}