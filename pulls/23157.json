{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157",
    "id": 747752517,
    "node_id": "PR_kwDOABII584skcxF",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23157",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/23157.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/23157.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/082c5bf099c64e3d27abe9b68a71ce500b693e7e",
    "number": 23157,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "txmempool -/-> validation 1/2: improve performance of check() and remove dependency on validation",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Remove the txmempool <-> validation circular dependency by removing txmempool's dependency on validation. There are two functions in txmempool that need validation right now: `check()` and `removeForReorg()`. This PR removes the dependencies in `check()`.\r\n\r\nThis PR also improves the performance of `CTxMemPool::check()` by walking through the entries exactly once, in ascending ancestorcount order, which guarantees that we see parents before children.",
    "labels": [
      {
        "id": 135961,
        "node_id": "MDU6TGFiZWwxMzU5NjE=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
        "name": "Refactoring",
        "color": "E6F6D6",
        "default": false
      },
      {
        "id": 164208572,
        "node_id": "MDU6TGFiZWwxNjQyMDg1NzI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Mempool",
        "name": "Mempool",
        "color": "fef2c0",
        "default": false
      }
    ],
    "created_at": "2021-10-01T16:06:21Z",
    "updated_at": "2022-10-30T19:07:53Z",
    "closed_at": "2021-10-25T13:22:37Z",
    "mergeable_state": "unknown",
    "merged_at": "2021-10-25T13:22:37Z",
    "merge_commit_sha": "1847ce2d49e13f76824bb6b52985e8ef5fbcd1db",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "glozow:2021-09-speed-mempool-check",
      "ref": "2021-09-speed-mempool-check",
      "sha": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 244262754,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNDQyNjI3NTQ=",
        "name": "bitcoin",
        "full_name": "glozow/bitcoin",
        "owner": {
          "login": "glozow",
          "id": 25183001,
          "node_id": "MDQ6VXNlcjI1MTgzMDAx",
          "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/glozow",
          "html_url": "https://github.com/glozow",
          "followers_url": "https://api.github.com/users/glozow/followers",
          "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
          "organizations_url": "https://api.github.com/users/glozow/orgs",
          "repos_url": "https://api.github.com/users/glozow/repos",
          "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/glozow/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/glozow/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/glozow/bitcoin",
        "archive_url": "https://api.github.com/repos/glozow/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/glozow/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/glozow/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/glozow/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/glozow/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/glozow/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/glozow/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/glozow/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/glozow/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/glozow/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/glozow/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/glozow/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/glozow/bitcoin/events",
        "forks_url": "https://api.github.com/repos/glozow/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/glozow/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/glozow/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/glozow/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/glozow/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/glozow/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/glozow/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/glozow/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/glozow/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/glozow/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/glozow/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/glozow/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/glozow/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/glozow/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/glozow/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/glozow/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:glozow/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/glozow/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/glozow/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/glozow/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/glozow/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/glozow/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/glozow/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/glozow/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/glozow/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/glozow/bitcoin/hooks",
        "svn_url": "https://github.com/glozow/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 7,
        "watchers_count": 7,
        "size": 225090,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-02T10:00:34Z",
        "created_at": "2020-03-02T02:31:56Z",
        "updated_at": "2022-01-07T17:55:23Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "42fedb4acd3cfa813059fcc3f96b2a41f78d9074",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69819,
        "watchers_count": 69819,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T05:35:10Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T04:47:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 59,
    "deletions": 62,
    "changed_files": 7,
    "commits": 8,
    "review_comments": 28,
    "comments": 10
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNiMTQwNzE5NmZiYTY0OGFhNzU1MDRlM2FiM2Q0NmFhMDE4MTU2M2E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cb1407196fba648aa75504e3ab3d46aa0181563a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cb1407196fba648aa75504e3ab3d46aa0181563a",
      "tree": {
        "sha": "e03ee93f9057789f468a5d7d762994f045925ac5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e03ee93f9057789f468a5d7d762994f045925ac5"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/35a31d5f7e9cd71a210c1ed10abc9d772ff36049",
          "sha": "35a31d5f7e9cd71a210c1ed10abc9d772ff36049",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/35a31d5f7e9cd71a210c1ed10abc9d772ff36049"
        }
      ],
      "message": "[refactor/bench] make mempool_stress bench reusable and parameterizable",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-01T15:26:19Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-09-30T08:25:11Z"
      },
      "sha": "cb1407196fba648aa75504e3ab3d46aa0181563a"
    },
    {
      "event": "commented",
      "id": 932360429,
      "node_id": "IC_kwDOABII5843krDt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/932360429",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-01T16:07:01Z",
      "updated_at": "2021-10-04T12:13:10Z",
      "author_association": "MEMBER",
      "body": "bench results on master:\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                8.34 |      119,851,301.59 |    0.0% |      0.01 | `MempoolCheck`\r\n\r\nresults on top of this PR:\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                2.13 |      468,844,203.61 |    0.0% |      0.01 | `MempoolCheck`\r\n\r\n(~4x faster)",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-932360429",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "commented",
      "id": 932416452,
      "node_id": "IC_kwDOABII5843k4vE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/932416452",
      "actor": {
        "login": "flack",
        "id": 425166,
        "node_id": "MDQ6VXNlcjQyNTE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/425166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/flack",
        "html_url": "https://github.com/flack",
        "followers_url": "https://api.github.com/users/flack/followers",
        "following_url": "https://api.github.com/users/flack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/flack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/flack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/flack/subscriptions",
        "organizations_url": "https://api.github.com/users/flack/orgs",
        "repos_url": "https://api.github.com/users/flack/repos",
        "events_url": "https://api.github.com/users/flack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/flack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-01T17:19:19Z",
      "updated_at": "2021-10-01T17:19:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "Sorry for being off-topic, but just because I always twitch slightly when I see it: The bench output is already formatted in [Markdown extended syntax](https://www.markdownguide.org/extended-syntax/), so if you just paste it into the comment box, without backticks around it (and without leading whitespace), it renders a bit nicer. And it's easier to do, because less steps :-)\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                8.34 |      119,851,301.59 |    0.0% |      0.01 | `MempoolCheck`\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                2.13 |      468,844,203.61 |    0.0% |      0.01 | `MempoolCheck`\r\n\r\n\r\n",
      "user": {
        "login": "flack",
        "id": 425166,
        "node_id": "MDQ6VXNlcjQyNTE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/425166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/flack",
        "html_url": "https://github.com/flack",
        "followers_url": "https://api.github.com/users/flack/followers",
        "following_url": "https://api.github.com/users/flack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/flack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/flack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/flack/subscriptions",
        "organizations_url": "https://api.github.com/users/flack/orgs",
        "repos_url": "https://api.github.com/users/flack/repos",
        "events_url": "https://api.github.com/users/flack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/flack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-932416452",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "labeled",
      "id": 5395815019,
      "node_id": "LE_lADOABII5848aRUpzwAAAAFBnZpr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5395815019",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-01T17:21:53Z",
      "label": {
        "name": "Mempool",
        "color": "fef2c0"
      }
    },
    {
      "event": "commented",
      "id": 932423499,
      "node_id": "IC_kwDOABII5843k6dL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/932423499",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-01T17:29:49Z",
      "updated_at": "2021-10-04T14:54:45Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23173](https://github.com/bitcoin/bitcoin/pull/23173) (Add `ChainstateManager::ProcessTransaction` by jnewbery)\n* [#22677](https://github.com/bitcoin/bitcoin/pull/22677) (cut the validation <-> txmempool circular dependency 2/2 by glozow)\n* [#21527](https://github.com/bitcoin/bitcoin/pull/21527) (net_processing: lock clean up by ajtowns)\n* [#17786](https://github.com/bitcoin/bitcoin/pull/17786) (refactor: Nuke policy/fees->mempool circular dependencies by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-932423499",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "reviewed",
      "id": 769688325,
      "node_id": "PRR_kwDOABII584t4IMF",
      "url": null,
      "actor": null,
      "commit_id": "af8a6d31f461441b9d3ea4674d7338ae6249ed63",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#pullrequestreview-769688325",
      "submitted_at": "2021-10-03T22:29:29Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
    },
    {
      "event": "reviewed",
      "id": 770073130,
      "node_id": "PRR_kwDOABII584t5mIq",
      "url": null,
      "actor": null,
      "commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK 4bc0c8066e79f0d95053bcc2449a7d354eaa9c25\r\n\r\nI've left a few nitty style comments inline.\r\n\r\nI found the ordering of the commits:\r\n\r\n- _[mempool] speed up check by using coins cache and iterating in topo order_\r\n- _[mempool] assert that check() always goes in topological order_\r\n- _[mempool] remove code needed for unsorted mempool checking_\r\n\r\nto be a little bit confusing. In the intermediate commits, you have things like:\r\n\r\n```\r\n                assert(mempoolDuplicate.HaveCoin(txin.prevout));\r\n                if (!mempoolDuplicate.HaveCoin(txin.prevout)) fDependsWait = true;\r\n\r\n```\r\n\r\nwhich you then remove in the subsequent commit. It's fine, but it's a bit more mental overhead for reviewers.\r\n\r\nI think a more intuitive progression of commits would be to squash those three commits into two:\r\n\r\n- the first commit just changes the for loop to use `GetSortedDepthAndScore()` and adds the `prev_ancestor_count` sanity check.\r\n- the second commit removes the `waitingOnDependants` code since the iteration is now in depth order.\r\n\r\nIs the next step here to change `check()` to take a `const CCoinsViewCache&` and `int64_t height` and remove the dependency on validation entirely?",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#pullrequestreview-770073130",
      "submitted_at": "2021-10-04T10:42:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5403614875,
      "node_id": "HRFPE_lADOABII5848aRUpzwAAAAFCFJ6b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5403614875",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T12:31:23Z"
    },
    {
      "event": "commented",
      "id": 933445201,
      "node_id": "IC_kwDOABII5843oz5R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933445201",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T12:41:55Z",
      "updated_at": "2021-10-04T12:41:55Z",
      "author_association": "MEMBER",
      "body": "@flack good tip, fixed\r\n\r\n@theStack @jnewbery thanks for your reviews, I think I've incorporated all suggestions :)\r\n\r\n> Is the next step here to change check() to take a const CCoinsViewCache& and int64_t height and remove the dependency on validation entirely?\r\n\r\nYes I thought I had included that commit here but apparently I hadn't - last push added it.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-933445201",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "mentioned",
      "id": 5403676752,
      "node_id": "MEE_lADOABII5848aRUpzwAAAAFCFZBQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5403676752",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T12:41:55Z"
    },
    {
      "event": "subscribed",
      "id": 5403676758,
      "node_id": "SE_lADOABII5848aRUpzwAAAAFCFZBW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5403676758",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T12:41:56Z"
    },
    {
      "event": "mentioned",
      "id": 5403676765,
      "node_id": "MEE_lADOABII5848aRUpzwAAAAFCFZBd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5403676765",
      "actor": {
        "login": "flack",
        "id": 425166,
        "node_id": "MDQ6VXNlcjQyNTE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/425166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/flack",
        "html_url": "https://github.com/flack",
        "followers_url": "https://api.github.com/users/flack/followers",
        "following_url": "https://api.github.com/users/flack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/flack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/flack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/flack/subscriptions",
        "organizations_url": "https://api.github.com/users/flack/orgs",
        "repos_url": "https://api.github.com/users/flack/repos",
        "events_url": "https://api.github.com/users/flack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/flack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T12:41:56Z"
    },
    {
      "event": "subscribed",
      "id": 5403676775,
      "node_id": "SE_lADOABII5848aRUpzwAAAAFCFZBn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5403676775",
      "actor": {
        "login": "flack",
        "id": 425166,
        "node_id": "MDQ6VXNlcjQyNTE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/425166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/flack",
        "html_url": "https://github.com/flack",
        "followers_url": "https://api.github.com/users/flack/followers",
        "following_url": "https://api.github.com/users/flack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/flack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/flack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/flack/subscriptions",
        "organizations_url": "https://api.github.com/users/flack/orgs",
        "repos_url": "https://api.github.com/users/flack/repos",
        "events_url": "https://api.github.com/users/flack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/flack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T12:41:56Z"
    },
    {
      "event": "mentioned",
      "id": 5403676788,
      "node_id": "MEE_lADOABII5848aRUpzwAAAAFCFZB0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5403676788",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T12:41:56Z"
    },
    {
      "event": "subscribed",
      "id": 5403676798,
      "node_id": "SE_lADOABII5848aRUpzwAAAAFCFZB-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5403676798",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T12:41:56Z"
    },
    {
      "event": "reviewed",
      "id": 770246424,
      "node_id": "PRR_kwDOABII584t6QcY",
      "url": null,
      "actor": null,
      "commit_id": "a420bcb8ad6f61fad05941cecdcb5df693ee6cc0",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#pullrequestreview-770246424",
      "submitted_at": "2021-10-04T12:46:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5403729850,
      "node_id": "HRFPE_lADOABII5848aRUpzwAAAAFCFl-6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5403729850",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T12:50:43Z"
    },
    {
      "event": "commented",
      "id": 933486307,
      "node_id": "IC_kwDOABII5843o97j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933486307",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T13:27:35Z",
      "updated_at": "2021-10-04T13:27:35Z",
      "author_association": "MEMBER",
      "body": "> > Is the next step here to change check() to take a const CCoinsViewCache& and int64_t height and remove the dependency on validation entirely?\r\n\r\n> Yes I thought I had included that commit here but apparently I hadn't - last push added it.\r\n\r\nIt might actually be better to defer that commit until after #23173 so fewer changes are needed to net_processing. Entirely up to you.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-933486307",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDMwZTI0MGY2NWU2OWM2ZGZmY2QwMzNhZmM2Mzg5NTM0NWJkNTFmNTM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/30e240f65e69c6dffcd033afc63895345bd51f53",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/30e240f65e69c6dffcd033afc63895345bd51f53",
      "tree": {
        "sha": "abbf90c2cf8baeefb7d85b7cad08e346df127ff9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/abbf90c2cf8baeefb7d85b7cad08e346df127ff9"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cb1407196fba648aa75504e3ab3d46aa0181563a",
          "sha": "cb1407196fba648aa75504e3ab3d46aa0181563a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cb1407196fba648aa75504e3ab3d46aa0181563a"
        }
      ],
      "message": "[bench] Benchmark CTxMemPool::check()",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-04T14:00:28Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-09-30T08:31:18Z"
      },
      "sha": "30e240f65e69c6dffcd033afc63895345bd51f53"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDU0YzZmM2MxZGEwMTA5MGFlZTk2OTFhMmMyYmVlMDk4NGEwNTRjZTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/54c6f3c1da01090aee9691a2c2bee0984a054ce8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/54c6f3c1da01090aee9691a2c2bee0984a054ce8",
      "tree": {
        "sha": "2f0759ff420949138f3ddf882ef4fa4168ad4293",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2f0759ff420949138f3ddf882ef4fa4168ad4293"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/30e240f65e69c6dffcd033afc63895345bd51f53",
          "sha": "30e240f65e69c6dffcd033afc63895345bd51f53",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/30e240f65e69c6dffcd033afc63895345bd51f53"
        }
      ],
      "message": "[mempool] speed up check() by using coins cache and iterating in topo order\n\nNo behavior changes.\n\nBefore, we're always adding transactions to the \"check later\" queue if\nthey have any parents in the mempool. But there's no reason to do this\nif all of its inputs are already available from mempoolDuplicate.\nInstead, check for inputs, and only mark fDependsWait=true if the\nparents haven't been processed yet.\n\nReduce the amount of \"check later\" transactions by looking at\nancestors before descendants. Do this by iterating through them in\nascending order by ancestor count. This works because a child will\nalways have more in-mempool ancestors than its parent.\n\nWe should never have any entries in the \"check later\" queue\nafter this commit.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-04T14:00:28Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-09-30T08:08:40Z"
      },
      "sha": "54c6f3c1da01090aee9691a2c2bee0984a054ce8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU4NjM5ZWMyNmFhZjRkZTNmYWUyODA5NjM0MzRiZjFjZjIwMTdiNmY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e8639ec26aaf4de3fae280963434bf1cf2017b6f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e8639ec26aaf4de3fae280963434bf1cf2017b6f",
      "tree": {
        "sha": "8f61e84b99cf56e4bb386a6fba050c71542eb25c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8f61e84b99cf56e4bb386a6fba050c71542eb25c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/54c6f3c1da01090aee9691a2c2bee0984a054ce8",
          "sha": "54c6f3c1da01090aee9691a2c2bee0984a054ce8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/54c6f3c1da01090aee9691a2c2bee0984a054ce8"
        }
      ],
      "message": "[mempool] remove now-unnecessary code\n\nRemove variables used for keeping track of mempool transactions for\nwhich we haven't processed the parents yet. Since we're iterating in\ntopological order now, they're always unused.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-04T14:00:28Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-09-29T17:38:24Z"
      },
      "sha": "e8639ec26aaf4de3fae280963434bf1cf2017b6f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA5ZDE4OTE2YWZiMGVjYWU5MDcwMGQ0YmVmZDlkNWRjNTI3Njc5NzA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/09d18916afb0ecae90700d4befd9d5dc52767970",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/09d18916afb0ecae90700d4befd9d5dc52767970",
      "tree": {
        "sha": "7bd33a74e30d89d61cbda9949aa23acde70e2ac7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7bd33a74e30d89d61cbda9949aa23acde70e2ac7"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e8639ec26aaf4de3fae280963434bf1cf2017b6f",
          "sha": "e8639ec26aaf4de3fae280963434bf1cf2017b6f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e8639ec26aaf4de3fae280963434bf1cf2017b6f"
        }
      ],
      "message": "MOVEONLY: remove single-use helper func CheckInputsAndUpdateCoins",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-04T14:00:28Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-09-29T18:10:44Z"
      },
      "sha": "09d18916afb0ecae90700d4befd9d5dc52767970"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDllOGQ3YWQ1ZDljYzRiMDEzODI2ZGFlYWQ5Y2VlMDlhYWQ1Mzk0MDE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9e8d7ad5d9cc4b013826daead9cee09aad539401",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9e8d7ad5d9cc4b013826daead9cee09aad539401",
      "tree": {
        "sha": "c10b2f86152cd8639f4c1af45b7e741c16cb0459",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c10b2f86152cd8639f4c1af45b7e741c16cb0459"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/09d18916afb0ecae90700d4befd9d5dc52767970",
          "sha": "09d18916afb0ecae90700d4befd9d5dc52767970",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/09d18916afb0ecae90700d4befd9d5dc52767970"
        }
      ],
      "message": "[validation/mempool] use Spend/AddCoin instead of UpdateCoins\n\nUpdateCoins is an unnecessary dependency on validation. All we need to\ndo is add and remove coins to check inputs. We don't need the extra\nlogic for checking coinbases and handling TxUndos.\n\nAlso remove the wrapper function in validation.h which constructs a\nthrowaway TxUndo object before calling UpdateCoins because it is now\nunused.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-04T14:00:28Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-04T12:01:38Z"
      },
      "sha": "9e8d7ad5d9cc4b013826daead9cee09aad539401"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVkNjExNWYxZWFlMGViNDY2OTYwMTEwNmE5YWFmZjA3OGEyZjNhNzQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ed6115f1eae0eb4669601106a9aaff078a2f3a74",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ed6115f1eae0eb4669601106a9aaff078a2f3a74",
      "tree": {
        "sha": "9e59db60bd18cc5f8c6eb56ba44eab880a1b77f2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9e59db60bd18cc5f8c6eb56ba44eab880a1b77f2"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9e8d7ad5d9cc4b013826daead9cee09aad539401",
          "sha": "9e8d7ad5d9cc4b013826daead9cee09aad539401",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9e8d7ad5d9cc4b013826daead9cee09aad539401"
        }
      ],
      "message": "[mempool] simplify some check() logic\n\nNo transaction in the mempool should ever be a coinbase.\n\nSince mempoolDuplicate's backend is the chainstate coins view, it should\nalways contain the coins available.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-04T14:00:28Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-04T11:58:50Z"
      },
      "sha": "ed6115f1eae0eb4669601106a9aaff078a2f3a74"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA4MmM1YmYwOTljNjRlM2QyN2FiZTliNjhhNzFjZTUwMGI2OTNlN2U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "tree": {
        "sha": "de3cef3823de0046834bbf621ba3a32e2b09042d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/de3cef3823de0046834bbf621ba3a32e2b09042d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ed6115f1eae0eb4669601106a9aaff078a2f3a74",
          "sha": "ed6115f1eae0eb4669601106a9aaff078a2f3a74",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ed6115f1eae0eb4669601106a9aaff078a2f3a74"
        }
      ],
      "message": "[refactor] pass coinsview and height to check()\n\nRemoves check's dependency on validation.h",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-10-04T14:00:28Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-09-29T18:36:01Z"
      },
      "sha": "082c5bf099c64e3d27abe9b68a71ce500b693e7e"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5404234716,
      "node_id": "HRFPE_lADOABII5848aRUpzwAAAAFCHhPc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5404234716",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T14:02:21Z"
    },
    {
      "event": "commented",
      "id": 933614426,
      "node_id": "IC_kwDOABII5843pdNa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933614426",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-04T15:45:40Z",
      "updated_at": "2021-10-04T15:45:40Z",
      "author_association": "MEMBER",
      "body": "reACK 082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-933614426",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "reviewed",
      "id": 772102112,
      "node_id": "PRR_kwDOABII584uBVfg",
      "url": null,
      "actor": null,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "user": {
        "login": "SachinMeier",
        "id": 46731461,
        "node_id": "MDQ6VXNlcjQ2NzMxNDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/46731461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SachinMeier",
        "html_url": "https://github.com/SachinMeier",
        "followers_url": "https://api.github.com/users/SachinMeier/followers",
        "following_url": "https://api.github.com/users/SachinMeier/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/SachinMeier/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/SachinMeier/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/SachinMeier/subscriptions",
        "organizations_url": "https://api.github.com/users/SachinMeier/orgs",
        "repos_url": "https://api.github.com/users/SachinMeier/repos",
        "events_url": "https://api.github.com/users/SachinMeier/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/SachinMeier/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#pullrequestreview-772102112",
      "submitted_at": "2021-10-06T00:45:29Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
    },
    {
      "event": "commented",
      "id": 935322192,
      "node_id": "IC_kwDOABII5843v-JQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935322192",
      "actor": {
        "login": "GeneFerneau",
        "id": 80422284,
        "node_id": "MDQ6VXNlcjgwNDIyMjg0",
        "avatar_url": "https://avatars.githubusercontent.com/u/80422284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/GeneFerneau",
        "html_url": "https://github.com/GeneFerneau",
        "followers_url": "https://api.github.com/users/GeneFerneau/followers",
        "following_url": "https://api.github.com/users/GeneFerneau/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/GeneFerneau/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/GeneFerneau/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/GeneFerneau/subscriptions",
        "organizations_url": "https://api.github.com/users/GeneFerneau/orgs",
        "repos_url": "https://api.github.com/users/GeneFerneau/repos",
        "events_url": "https://api.github.com/users/GeneFerneau/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/GeneFerneau/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-06T03:00:44Z",
      "updated_at": "2021-10-06T03:00:44Z",
      "author_association": "NONE",
      "body": "tACK [082c5bf](https://github.com/bitcoin/bitcoin/pull/23157/commits/082c5bf099c64e3d27abe9b68a71ce500b693e7e)\r\n\r\nRan the bench a few times before and after the optimization:\r\n\r\n## Before optimization refactor\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|               81.26 |       12,306,038.69 |    0.0% |      0.01 | `MempoolCheck`\r\n|               81.26 |       12,305,850.81 |    0.0% |      0.01 | `MempoolCheck`\r\n|               81.26 |       12,306,043.84 |    0.0% |      0.01 | `MempoolCheck`\r\n|                     |                     |         |           |\r\n|                     |       12,305,977.78 |         |           |  Average\r\n\r\n## After optimization refactor\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|               10.72 |       93,324,244.07 |    0.0% |      0.01 | `MempoolCheck`\r\n|               10.72 |       93,323,975.05 |    0.0% |      0.01 | `MempoolCheck`\r\n|               10.72 |       93,323,120.41 |    0.0% |      0.01 | `MempoolCheck`\r\n|                     |                     |         |           |\r\n|                     |       93,323,779.84 |         |           |  Average\r\n\r\n## Optimization increase in op/s\r\n\r\n93,323,779.84 / 12,305,977.78 = 7.5836 (758.36%)",
      "user": {
        "login": "GeneFerneau",
        "id": 80422284,
        "node_id": "MDQ6VXNlcjgwNDIyMjg0",
        "avatar_url": "https://avatars.githubusercontent.com/u/80422284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/GeneFerneau",
        "html_url": "https://github.com/GeneFerneau",
        "followers_url": "https://api.github.com/users/GeneFerneau/followers",
        "following_url": "https://api.github.com/users/GeneFerneau/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/GeneFerneau/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/GeneFerneau/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/GeneFerneau/subscriptions",
        "organizations_url": "https://api.github.com/users/GeneFerneau/orgs",
        "repos_url": "https://api.github.com/users/GeneFerneau/repos",
        "events_url": "https://api.github.com/users/GeneFerneau/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/GeneFerneau/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-935322192",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "commented",
      "id": 936659052,
      "node_id": "IC_kwDOABII58431Ehs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/936659052",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-06T16:43:21Z",
      "updated_at": "2021-10-06T16:43:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "concept ACK\r\nI'll try to do a code review, but FWIW, my working clone is usually built with optimization disabled (`-O0`) to make debugging easier, and there's an even bigger improvement that way (approximately 18x):\r\n\r\nbefore:\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|              215.53 |        4,639,632.68 |    2.1% |      0.01 | `MempoolCheck`\r\n\r\nafter:\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|               12.12 |       82,495,736.15 |    3.8% |      0.01 | `MempoolCheck`",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-936659052",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "reviewed",
      "id": 773082160,
      "node_id": "PRR_kwDOABII584uFEww",
      "url": null,
      "actor": null,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "tACK https://github.com/bitcoin/bitcoin/pull/23157/commits/082c5bf099c64e3d27abe9b68a71ce500b693e7e\r\n\r\nBench comparison\r\n\r\n#### Optimized\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                2.39 |      417,806,513.20 |    0.6% |      0.01 | `MempoolCheck`\r\n|                2.39 |      419,189,093.49 |    0.6% |      0.01 | `MempoolCheck`\r\n|                2.39 |      419,188,854.66 |    0.6% |      0.01 | `MempoolCheck`\r\n|                2.39 |      419,049,672.97 |    0.3% |      0.01 | `MempoolCheck`\r\n\r\n#### Non-Optimized\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|               12.61 |       79,317,536.11 |    6.8% |      0.01 | `MempoolCheck`\r\n|               12.20 |       81,995,745.32 |    9.2% |      0.01 | `MempoolCheck`\r\n|               12.22 |       81,862,095.21 |    1.9% |      0.01 | `MempoolCheck`\r\n|               12.17 |       82,167,397.00 |    0.8% |      0.01 | `MempoolCheck`\r\n\r\n\r\nIt seems I am observing only 6x speedup. But that's probably my local benching issue. ",
      "user": {
        "login": "rajarshimaitra",
        "id": 36541669,
        "node_id": "MDQ6VXNlcjM2NTQxNjY5",
        "avatar_url": "https://avatars.githubusercontent.com/u/36541669?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rajarshimaitra",
        "html_url": "https://github.com/rajarshimaitra",
        "followers_url": "https://api.github.com/users/rajarshimaitra/followers",
        "following_url": "https://api.github.com/users/rajarshimaitra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rajarshimaitra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rajarshimaitra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rajarshimaitra/subscriptions",
        "organizations_url": "https://api.github.com/users/rajarshimaitra/orgs",
        "repos_url": "https://api.github.com/users/rajarshimaitra/repos",
        "events_url": "https://api.github.com/users/rajarshimaitra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rajarshimaitra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#pullrequestreview-773082160",
      "submitted_at": "2021-10-06T18:22:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
    },
    {
      "event": "reviewed",
      "id": 775676379,
      "node_id": "PRR_kwDOABII584uO-Hb",
      "url": null,
      "actor": null,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Not sure what's different or wrong on my system (running OpenBSD 6.9/amd64), but the benchmark doesn't show any noticable difference after the optimization in `CTxMemPool::check`, it even seems to be worse.\r\n\r\nat commit https://github.com/bitcoin/bitcoin/pull/23157/commits/30e240f65e69c6dffcd033afc63895345bd51f53 (with original `check` as on master branch):\r\n```\r\n$ ./src/bench/bench_bitcoin -filter=MempoolCheck\r\n```\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|              100.66 |        9,934,356.36 |    1.6% |      0.01 | `MempoolCheck`\r\n\r\nat commit https://github.com/bitcoin/bitcoin/pull/23157/commits/54c6f3c1da01090aee9691a2c2bee0984a054ce8 (with optimized `check`):\r\n```\r\n$ ./src/bench/bench_bitcoin -filter=MempoolCheck\r\n```\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|              107.36 |        9,314,108.15 |    4.4% |      0.01 | `MempoolCheck`\r\n\r\nWill try on a Debian Linux machine later to compare.\r\n\r\n// EDIT: It seems like the difference in benchmark results is almost only caused by the very last commit.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#pullrequestreview-775676379",
      "submitted_at": "2021-10-10T14:17:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
    },
    {
      "event": "commented",
      "id": 947480706,
      "node_id": "IC_kwDOABII5844eWiC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947480706",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-20T09:16:11Z",
      "updated_at": "2021-10-20T09:16:11Z",
      "author_association": "MEMBER",
      "body": ">  It seems like the difference in benchmark results is almost only caused by the very last commit.\r\n\r\nThat sounds strange to me, but I guess it's plausible that the bench only sees a speedup because of the parameter change rather than ordered traversal. Even so, I'd want to remove all that unnecessary code...\r\n\r\n",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-947480706",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "commented",
      "id": 947713643,
      "node_id": "IC_kwDOABII5844fPZr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947713643",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-20T14:18:30Z",
      "updated_at": "2021-10-20T14:18:30Z",
      "author_association": "MEMBER",
      "body": "> That sounds strange to me, but I guess it's plausible that the bench only sees a speedup because of the parameter change rather than ordered traversal. Even so, I'd want to remove all that unnecessary code...\r\n\r\nAgree, removing unnecessary code is always a good thing! I didn't intend to sound concept NACKy, this was just a hint that the posted benchmark results have to be taken with a grain of salt :) will likely code-review this PR within the next days.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#issuecomment-947713643",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23157"
    },
    {
      "event": "reviewed",
      "id": 787378912,
      "node_id": "PRR_kwDOABII584u7nLg",
      "url": null,
      "actor": null,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code-review ACK 082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#pullrequestreview-787378912",
      "submitted_at": "2021-10-23T10:18:13Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
    },
    {
      "event": "merged",
      "id": 5513588969,
      "node_id": "ME_lADOABII5848aRUpzwAAAAFIorDp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5513588969",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1847ce2d49e13f76824bb6b52985e8ef5fbcd1db",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1847ce2d49e13f76824bb6b52985e8ef5fbcd1db",
      "created_at": "2021-10-25T13:22:37Z"
    },
    {
      "event": "closed",
      "id": 5513588985,
      "node_id": "CE_lADOABII5848aRUpzwAAAAFIorD5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5513588985",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-25T13:22:37Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 5513619950,
      "node_id": "HRDE_lADOABII5848aRUpzwAAAAFIoynu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5513619950",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-25T13:26:54Z"
    },
    {
      "event": "labeled",
      "id": 5513728437,
      "node_id": "LE_lADOABII5848aRUpzwAAAAFIpNG1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5513728437",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-25T13:42:45Z",
      "label": {
        "name": "Refactoring",
        "color": "E6F6D6"
      }
    },
    {
      "event": "referenced",
      "id": 5514116490,
      "node_id": "REFE_lADOABII5848aRUpzwAAAAFIqr2K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5514116490",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ff642d72379ae02b6dab46fa30345d1094e8e6a6",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/ff642d72379ae02b6dab46fa30345d1094e8e6a6",
      "created_at": "2021-10-25T14:35:58Z"
    },
    {
      "event": "reviewed",
      "id": 792468601,
      "node_id": "PRR_kwDOABII584vPBx5",
      "url": null,
      "actor": null,
      "commit_id": "54c6f3c1da01090aee9691a2c2bee0984a054ce8",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Post merge ACK 082c5bf099c64e3d27abe9b68a71ce500b693e7e\r\n\r\nWarming up to review some of your open PRs. Just one question / possible nit. You are KILLING it with these PRs, well done 💪",
      "user": {
        "login": "mjdietzx",
        "id": 7217256,
        "node_id": "MDQ6VXNlcjcyMTcyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7217256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mjdietzx",
        "html_url": "https://github.com/mjdietzx",
        "followers_url": "https://api.github.com/users/mjdietzx/followers",
        "following_url": "https://api.github.com/users/mjdietzx/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mjdietzx/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mjdietzx/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mjdietzx/subscriptions",
        "organizations_url": "https://api.github.com/users/mjdietzx/orgs",
        "repos_url": "https://api.github.com/users/mjdietzx/repos",
        "events_url": "https://api.github.com/users/mjdietzx/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mjdietzx/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#pullrequestreview-792468601",
      "submitted_at": "2021-10-28T22:23:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
    },
    {
      "event": "referenced",
      "id": 7543764936,
      "node_id": "REFE_lADOABII5848aRUpzwAAAAHBpLfI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7543764936",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "8a5d04de8890b3fc895d74bf34cc8a25959547c7",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/8a5d04de8890b3fc895d74bf34cc8a25959547c7",
      "created_at": "2022-10-07T13:42:09Z"
    },
    {
      "event": "referenced",
      "id": 7543764946,
      "node_id": "REFE_lADOABII5848aRUpzwAAAAHBpLfS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7543764946",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "6cb979d8b958556641b639f32ddaaade974c5df1",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/6cb979d8b958556641b639f32ddaaade974c5df1",
      "created_at": "2022-10-07T13:42:09Z"
    },
    {
      "event": "referenced",
      "id": 7543764954,
      "node_id": "REFE_lADOABII5848aRUpzwAAAAHBpLfa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7543764954",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "12aa734d7c3e901d937dd4cb2436579556baded5",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/12aa734d7c3e901d937dd4cb2436579556baded5",
      "created_at": "2022-10-07T13:42:09Z"
    },
    {
      "event": "referenced",
      "id": 7543764964,
      "node_id": "REFE_lADOABII5848aRUpzwAAAAHBpLfk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7543764964",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "654ce965298f536d8601a05cad9e8d3d6a3a4f07",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/654ce965298f536d8601a05cad9e8d3d6a3a4f07",
      "created_at": "2022-10-07T13:42:09Z"
    },
    {
      "event": "referenced",
      "id": 7543764973,
      "node_id": "REFE_lADOABII5848aRUpzwAAAAHBpLft",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7543764973",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "c8b5a158b4414a5f78f437d9299d26ddf203b665",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/c8b5a158b4414a5f78f437d9299d26ddf203b665",
      "created_at": "2022-10-07T13:42:09Z"
    },
    {
      "event": "locked",
      "id": 7699628996,
      "node_id": "LOE_lADOABII5848aRUpzwAAAAHK7wPE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7699628996",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-30T19:07:53Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/720916478",
      "pull_request_review_id": 769688325,
      "id": 720916478,
      "node_id": "PRRC_kwDOABII584q-E_-",
      "diff_hunk": "@@ -98,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }\n+    std::vector<CTransactionRef> ordered_coins = CreateOrderedCoins(det_rand, childTxs, /* min_ancestors */ 5);\n+    std::vector<size_t> random_index;",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "af8a6d31f461441b9d3ea4674d7338ae6249ed63",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This vector doesn't seem to be used anywhere after being filled (aka [WOM](https://en.m.wikipedia.org/wiki/Write-only_memory_(joke)))?",
      "created_at": "2021-10-03T22:27:02Z",
      "updated_at": "2021-10-03T22:29:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r720916478",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/720916478"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 111,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721193126",
      "pull_request_review_id": 770063396,
      "id": 721193126,
      "node_id": "PRRC_kwDOABII584q_Iim",
      "diff_hunk": "@@ -98,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }\n+    std::vector<CTransactionRef> ordered_coins = CreateOrderedCoins(det_rand, childTxs, /* min_ancestors */ 5);\n+    std::vector<size_t> random_index;",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "af8a6d31f461441b9d3ea4674d7338ae6249ed63",
      "in_reply_to_id": 720916478,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "oops :sweat_smile: was originally going to use this to evict transactions in random order, will remove",
      "created_at": "2021-10-04T09:29:11Z",
      "updated_at": "2021-10-04T09:29:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721193126",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721193126"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 111,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721200535",
      "pull_request_review_id": 770073130,
      "id": 721200535,
      "node_id": "PRRC_kwDOABII584q_KWX",
      "diff_hunk": "@@ -91,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 67,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Consider making const and using current variable naming style:\r\n\r\n```c++\r\n    const int child_txs{bench.complexityN() > 1 ?\r\n                        static_cast<int>(bench.complexityN()) :\r\n                        2000};\r\n```",
      "created_at": "2021-10-04T09:38:53Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721200535",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721200535"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": 106,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 109,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721201942",
      "pull_request_review_id": 770073130,
      "id": 721201942,
      "node_id": "PRRC_kwDOABII584q_KsW",
      "diff_hunk": "@@ -91,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }\n+    std::vector<CTransactionRef> ordered_coins = CreateOrderedCoins(det_rand, childTxs, /* min_ancestors */ 5);",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    const std::vector<CTransactionRef> ordered_coins = CreateOrderedCoins(det_rand, childTxs, /* min_ancestors */ 5);\r\n```",
      "created_at": "2021-10-04T09:40:41Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721201942",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721201942"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721202043",
      "pull_request_review_id": 770073130,
      "id": 721202043,
      "node_id": "PRRC_kwDOABII584q_Kt7",
      "diff_hunk": "@@ -91,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }\n+    std::vector<CTransactionRef> ordered_coins = CreateOrderedCoins(det_rand, childTxs, /* min_ancestors */ 5);\n+    std::vector<size_t> random_index;\n+    random_index.resize(ordered_coins.size());\n+    std::iota(random_index.begin(), random_index.end(), 0);\n+    Shuffle(random_index.begin(), random_index.end(), FastRandomContext());\n+    auto extra_args = {\"-checkmempool=1\"}; // Always check",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 73,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    const auto extra_args = {\"-checkmempool=1\"}; // Always check\r\n```",
      "created_at": "2021-10-04T09:40:49Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721202043",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721202043"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721202532",
      "pull_request_review_id": 770073130,
      "id": 721202532,
      "node_id": "PRRC_kwDOABII584q_K1k",
      "diff_hunk": "@@ -91,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }\n+    std::vector<CTransactionRef> ordered_coins = CreateOrderedCoins(det_rand, childTxs, /* min_ancestors */ 5);\n+    std::vector<size_t> random_index;\n+    random_index.resize(ordered_coins.size());\n+    std::iota(random_index.begin(), random_index.end(), 0);\n+    Shuffle(random_index.begin(), random_index.end(), FastRandomContext());\n+    auto extra_args = {\"-checkmempool=1\"}; // Always check\n+    const auto testing_setup = MakeNoLogFileContext<const TestingSetup>(CBaseChainParams::MAIN, extra_args);\n+    CTxMemPool pool;\n+    LOCK2(cs_main, pool.cs);\n+    for (auto& tx : ordered_coins) AddTx(tx, pool);\n+    bench.run([&]() NO_THREAD_SAFETY_ANALYSIS {",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 78,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think it helps readability to have a linebreak between the setup and the bench run:\r\n\r\n```suggestion\r\n    for (auto& tx : ordered_coins) AddTx(tx, pool);\r\n\r\n    bench.run([&]() NO_THREAD_SAFETY_ANALYSIS {\r\n```",
      "created_at": "2021-10-04T09:41:28Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721202532",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721202532"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721206321",
      "pull_request_review_id": 770073130,
      "id": 721206321,
      "node_id": "PRRC_kwDOABII584q_Lwx",
      "diff_hunk": "@@ -6,7 +6,9 @@\n #include <policy/policy.h>\n #include <test/util/setup_common.h>\n #include <txmempool.h>\n+#include <validation.h>\n \n+#include <numeric>",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Remove this along with `std::iota` (https://github.com/bitcoin/bitcoin/pull/23157/files#r721193126)",
      "created_at": "2021-10-04T09:46:35Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721206321",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721206321"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 11,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721222770",
      "pull_request_review_id": 770073130,
      "id": 721222770,
      "node_id": "PRRC_kwDOABII584q_Pxy",
      "diff_hunk": "@@ -751,6 +745,10 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n         assert(it->GetSizeWithAncestors() == nSizeCheck);\n         assert(it->GetSigOpCostWithAncestors() == nSigOpCheck);\n         assert(it->GetModFeesWithAncestors() == nFeesCheck);\n+        // Sanity check: we are walking in ascending ancestor count order. The non-contextual\n+        // check() will have ensured that this count is accurate.",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't understand what \"non-contextual check()\" is referring to here.",
      "created_at": "2021-10-04T10:09:09Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721222770",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721222770"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": 748,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 749,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721223840",
      "pull_request_review_id": 770073130,
      "id": 721223840,
      "node_id": "PRRC_kwDOABII584q_QCg",
      "diff_hunk": "@@ -693,28 +686,29 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n     uint64_t checkTotal = 0;\n     CAmount check_total_fee{0};\n     uint64_t innerUsage = 0;\n+    uint64_t prev_ancestor_count{0};\n \n     CCoinsViewCache& active_coins_tip = active_chainstate.CoinsTip();\n     CCoinsViewCache mempoolDuplicate(const_cast<CCoinsViewCache*>(&active_coins_tip));\n     const int64_t spendheight = active_chainstate.m_chain.Height() + 1;\n \n-    std::list<const CTxMemPoolEntry*> waitingOnDependants;\n-    for (indexed_transaction_set::const_iterator it = mapTx.begin(); it != mapTx.end(); it++) {\n+    for (const auto& it : GetSortedDepthAndScore()) {\n         unsigned int i = 0;\n         checkTotal += it->GetTxSize();\n         check_total_fee += it->GetFee();\n         innerUsage += it->DynamicMemoryUsage();\n         const CTransaction& tx = it->GetTx();\n         innerUsage += memusage::DynamicUsage(it->GetMemPoolParentsConst()) + memusage::DynamicUsage(it->GetMemPoolChildrenConst());\n-        bool fDependsWait = false;\n         CTxMemPoolEntry::Parents setParentCheck;\n         for (const CTxIn &txin : tx.vin) {\n             // Check that every mempool transaction's inputs refer to available coins, or other mempool tx's.\n             indexed_transaction_set::const_iterator it2 = mapTx.find(txin.prevout.hash);\n             if (it2 != mapTx.end()) {\n                 const CTransaction& tx2 = it2->GetTx();\n                 assert(tx2.vout.size() > txin.prevout.n && !tx2.vout[txin.prevout.n].IsNull());\n-                fDependsWait = true;\n+                // Sanity check: all parents should have been checked before their children, which",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This comment could explain why parents have been checked before their children (because we sorted by depth before iterating through entries).",
      "created_at": "2021-10-04T10:10:38Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721223840",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721223840"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 709,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721225993",
      "pull_request_review_id": 770073130,
      "id": 721225993,
      "node_id": "PRRC_kwDOABII584q_QkJ",
      "diff_hunk": "@@ -671,14 +672,6 @@ void CTxMemPool::clear()\n     _clear();\n }\n \n-static void CheckInputsAndUpdateCoins(const CTransaction& tx, CCoinsViewCache& mempoolDuplicate, const int64_t spendheight)\n-{\n-    TxValidationState dummy_state; // Not used. CheckTxInputs() should always pass\n-    CAmount txfee = 0;\n-    bool fCheckResult = tx.IsCoinBase() || Consensus::CheckTxInputs(tx, dummy_state, mempoolDuplicate, spendheight, txfee);\n-    assert(fCheckResult);\n-    UpdateCoins(tx, mempoolDuplicate, std::numeric_limits<int>::max());\n-}\n ",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Remove extra newline :)",
      "created_at": "2021-10-04T10:13:55Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721225993",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721225993"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 675,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721230523",
      "pull_request_review_id": 770073130,
      "id": 721230523,
      "node_id": "PRRC_kwDOABII584q_Rq7",
      "diff_hunk": "@@ -693,28 +686,29 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n     uint64_t checkTotal = 0;\n     CAmount check_total_fee{0};\n     uint64_t innerUsage = 0;\n+    uint64_t prev_ancestor_count{0};\n \n     CCoinsViewCache& active_coins_tip = active_chainstate.CoinsTip();\n     CCoinsViewCache mempoolDuplicate(const_cast<CCoinsViewCache*>(&active_coins_tip));\n     const int64_t spendheight = active_chainstate.m_chain.Height() + 1;\n \n-    std::list<const CTxMemPoolEntry*> waitingOnDependants;\n-    for (indexed_transaction_set::const_iterator it = mapTx.begin(); it != mapTx.end(); it++) {\n+    for (const auto& it : GetSortedDepthAndScore()) {\n         unsigned int i = 0;\n         checkTotal += it->GetTxSize();\n         check_total_fee += it->GetFee();\n         innerUsage += it->DynamicMemoryUsage();\n         const CTransaction& tx = it->GetTx();\n         innerUsage += memusage::DynamicUsage(it->GetMemPoolParentsConst()) + memusage::DynamicUsage(it->GetMemPoolChildrenConst());\n-        bool fDependsWait = false;\n         CTxMemPoolEntry::Parents setParentCheck;\n         for (const CTxIn &txin : tx.vin) {\n             // Check that every mempool transaction's inputs refer to available coins, or other mempool tx's.\n             indexed_transaction_set::const_iterator it2 = mapTx.find(txin.prevout.hash);\n             if (it2 != mapTx.end()) {\n                 const CTransaction& tx2 = it2->GetTx();\n                 assert(tx2.vout.size() > txin.prevout.n && !tx2.vout[txin.prevout.n].IsNull());\n-                fDependsWait = true;\n+                // Sanity check: all parents should have been checked before their children, which\n+                // means its outputs must be available in the coins cache.\n+                assert(mempoolDuplicate.HaveCoin(txin.prevout));",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Can this assert and the `assert(active_coins_tip.HaveCoin(txin.prevout));` in the else branch below now be merged into a single `assert(mempoolDuplicate.HaveCoin(txin.prevout));`?\r\n\r\nIf I understand correctly, the `mempoolDuplicate` coins cache is a copy of the `active_chains_tip` cache, so should have all of the coins in the UTXO set. That means `mempoolDuplicate` should have all of the coins that are being spent by each transaction as we iterate through the entries in depth order.\r\n\r\n```diff\r\n--- a/src/txmempool.cpp\r\n+++ b/src/txmempool.cpp\r\n@@ -706,13 +706,11 @@ void CTxMemPool::check(CChainState& active_chainstate) const\r\n             if (it2 != mapTx.end()) {\r\n                 const CTransaction& tx2 = it2->GetTx();\r\n                 assert(tx2.vout.size() > txin.prevout.n && !tx2.vout[txin.prevout.n].IsNull());\r\n-                // Sanity check: all parents should have been checked before their children, which\r\n-                // means its outputs must be available in the coins cache.\r\n-                assert(mempoolDuplicate.HaveCoin(txin.prevout));\r\n                 setParentCheck.insert(*it2);\r\n-            } else {\r\n-                assert(active_coins_tip.HaveCoin(txin.prevout));\r\n             }\r\n+            // Sanity check: all parents should have been checked before their children, which\r\n+            // means its outputs must be available in the coins cache.\r\n+            assert(mempoolDuplicate.HaveCoin(txin.prevout));\r\n             // Check whether its inputs are marked in mapNextTx.\r\n             auto it3 = mapNextTx.find(txin.prevout);\r\n             assert(it3 != mapNextTx.end());\r\n```",
      "created_at": "2021-10-04T10:20:51Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721230523",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721230523"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 711,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721235682",
      "pull_request_review_id": 770073130,
      "id": 721235682,
      "node_id": "PRRC_kwDOABII584q_S7i",
      "diff_hunk": "@@ -769,24 +767,12 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n         // just a sanity check, not definitive that this calc is correct...\n         assert(it->GetSizeWithDescendants() >= child_sizes + it->GetTxSize());\n \n-        if (fDependsWait)\n-            waitingOnDependants.push_back(&(*it));\n-        else {\n-            CheckInputsAndUpdateCoins(tx, mempoolDuplicate, spendheight);\n-        }\n-    }\n-    unsigned int stepsSinceLastRemove = 0;\n-    while (!waitingOnDependants.empty()) {\n-        const CTxMemPoolEntry* entry = waitingOnDependants.front();\n-        waitingOnDependants.pop_front();\n-        if (!mempoolDuplicate.HaveInputs(entry->GetTx())) {\n-            waitingOnDependants.push_back(entry);\n-            stepsSinceLastRemove++;\n-            assert(stepsSinceLastRemove < waitingOnDependants.size());\n-        } else {\n-            CheckInputsAndUpdateCoins(entry->GetTx(), mempoolDuplicate, spendheight);\n-            stepsSinceLastRemove = 0;\n-        }\n+        TxValidationState dummy_state; // Not used. CheckTxInputs() should always pass\n+        CAmount txfee = 0;\n+        bool fCheckResult = tx.IsCoinBase() || Consensus::CheckTxInputs(tx, dummy_state, mempoolDuplicate, spendheight, txfee);",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 92,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I know you just moved this code, but I think we should remove `tx.IsCoinBase()` from here, and add an `assert(!tx.IsCoinBase());`. The mempool shouldn't contain coinbase transactions.\r\n\r\nNo need to do it as part of this PR. Can be a follow-up.",
      "created_at": "2021-10-04T10:28:33Z",
      "updated_at": "2021-10-04T10:42:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721235682",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721235682"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 772,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721317603",
      "pull_request_review_id": 770231491,
      "id": 721317603,
      "node_id": "PRRC_kwDOABII584q_m7j",
      "diff_hunk": "@@ -91,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 67,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721200535,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "did ternary operator on one line",
      "created_at": "2021-10-04T12:31:43Z",
      "updated_at": "2021-10-04T12:31:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721317603",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721317603"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": 106,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 109,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721317697",
      "pull_request_review_id": 770231615,
      "id": 721317697,
      "node_id": "PRRC_kwDOABII584q_m9B",
      "diff_hunk": "@@ -91,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }\n+    std::vector<CTransactionRef> ordered_coins = CreateOrderedCoins(det_rand, childTxs, /* min_ancestors */ 5);",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721201942,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2021-10-04T12:31:51Z",
      "updated_at": "2021-10-04T12:31:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721317697",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721317697"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721317769",
      "pull_request_review_id": 770231711,
      "id": 721317769,
      "node_id": "PRRC_kwDOABII584q_m-J",
      "diff_hunk": "@@ -91,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }\n+    std::vector<CTransactionRef> ordered_coins = CreateOrderedCoins(det_rand, childTxs, /* min_ancestors */ 5);\n+    std::vector<size_t> random_index;\n+    random_index.resize(ordered_coins.size());\n+    std::iota(random_index.begin(), random_index.end(), 0);\n+    Shuffle(random_index.begin(), random_index.end(), FastRandomContext());\n+    auto extra_args = {\"-checkmempool=1\"}; // Always check",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 73,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721202043,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2021-10-04T12:31:57Z",
      "updated_at": "2021-10-04T12:31:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721317769",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721317769"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721317858",
      "pull_request_review_id": 770231847,
      "id": 721317858,
      "node_id": "PRRC_kwDOABII584q_m_i",
      "diff_hunk": "@@ -91,4 +100,27 @@ static void ComplexMemPool(benchmark::Bench& bench)\n     });\n }\n \n+static void MempoolCheck(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 2000;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }\n+    std::vector<CTransactionRef> ordered_coins = CreateOrderedCoins(det_rand, childTxs, /* min_ancestors */ 5);\n+    std::vector<size_t> random_index;\n+    random_index.resize(ordered_coins.size());\n+    std::iota(random_index.begin(), random_index.end(), 0);\n+    Shuffle(random_index.begin(), random_index.end(), FastRandomContext());\n+    auto extra_args = {\"-checkmempool=1\"}; // Always check\n+    const auto testing_setup = MakeNoLogFileContext<const TestingSetup>(CBaseChainParams::MAIN, extra_args);\n+    CTxMemPool pool;\n+    LOCK2(cs_main, pool.cs);\n+    for (auto& tx : ordered_coins) AddTx(tx, pool);\n+    bench.run([&]() NO_THREAD_SAFETY_ANALYSIS {",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 78,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721202532,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agree, done",
      "created_at": "2021-10-04T12:32:06Z",
      "updated_at": "2021-10-04T12:32:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721317858",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721317858"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721318009",
      "pull_request_review_id": 770232064,
      "id": 721318009,
      "node_id": "PRRC_kwDOABII584q_nB5",
      "diff_hunk": "@@ -6,7 +6,9 @@\n #include <policy/policy.h>\n #include <test/util/setup_common.h>\n #include <txmempool.h>\n+#include <validation.h>\n \n+#include <numeric>",
      "path": "src/bench/mempool_stress.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721206321,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done, sorry for the sloppiness",
      "created_at": "2021-10-04T12:32:18Z",
      "updated_at": "2021-10-04T12:32:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721318009",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721318009"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 11,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721318286",
      "pull_request_review_id": 770232451,
      "id": 721318286,
      "node_id": "PRRC_kwDOABII584q_nGO",
      "diff_hunk": "@@ -751,6 +745,10 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n         assert(it->GetSizeWithAncestors() == nSizeCheck);\n         assert(it->GetSigOpCostWithAncestors() == nSigOpCheck);\n         assert(it->GetModFeesWithAncestors() == nFeesCheck);\n+        // Sanity check: we are walking in ascending ancestor count order. The non-contextual\n+        // check() will have ensured that this count is accurate.",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721222770,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Leftover from previous iteration of the PR - removed now",
      "created_at": "2021-10-04T12:32:44Z",
      "updated_at": "2021-10-04T12:32:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721318286",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721318286"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": 748,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 749,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721318384",
      "pull_request_review_id": 770232594,
      "id": 721318384,
      "node_id": "PRRC_kwDOABII584q_nHw",
      "diff_hunk": "@@ -693,28 +686,29 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n     uint64_t checkTotal = 0;\n     CAmount check_total_fee{0};\n     uint64_t innerUsage = 0;\n+    uint64_t prev_ancestor_count{0};\n \n     CCoinsViewCache& active_coins_tip = active_chainstate.CoinsTip();\n     CCoinsViewCache mempoolDuplicate(const_cast<CCoinsViewCache*>(&active_coins_tip));\n     const int64_t spendheight = active_chainstate.m_chain.Height() + 1;\n \n-    std::list<const CTxMemPoolEntry*> waitingOnDependants;\n-    for (indexed_transaction_set::const_iterator it = mapTx.begin(); it != mapTx.end(); it++) {\n+    for (const auto& it : GetSortedDepthAndScore()) {\n         unsigned int i = 0;\n         checkTotal += it->GetTxSize();\n         check_total_fee += it->GetFee();\n         innerUsage += it->DynamicMemoryUsage();\n         const CTransaction& tx = it->GetTx();\n         innerUsage += memusage::DynamicUsage(it->GetMemPoolParentsConst()) + memusage::DynamicUsage(it->GetMemPoolChildrenConst());\n-        bool fDependsWait = false;\n         CTxMemPoolEntry::Parents setParentCheck;\n         for (const CTxIn &txin : tx.vin) {\n             // Check that every mempool transaction's inputs refer to available coins, or other mempool tx's.\n             indexed_transaction_set::const_iterator it2 = mapTx.find(txin.prevout.hash);\n             if (it2 != mapTx.end()) {\n                 const CTransaction& tx2 = it2->GetTx();\n                 assert(tx2.vout.size() > txin.prevout.n && !tx2.vout[txin.prevout.n].IsNull());\n-                fDependsWait = true;\n+                // Sanity check: all parents should have been checked before their children, which",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721223840,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2021-10-04T12:32:53Z",
      "updated_at": "2021-10-04T12:32:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721318384",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721318384"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 709,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721318517",
      "pull_request_review_id": 770232767,
      "id": 721318517,
      "node_id": "PRRC_kwDOABII584q_nJ1",
      "diff_hunk": "@@ -671,14 +672,6 @@ void CTxMemPool::clear()\n     _clear();\n }\n \n-static void CheckInputsAndUpdateCoins(const CTransaction& tx, CCoinsViewCache& mempoolDuplicate, const int64_t spendheight)\n-{\n-    TxValidationState dummy_state; // Not used. CheckTxInputs() should always pass\n-    CAmount txfee = 0;\n-    bool fCheckResult = tx.IsCoinBase() || Consensus::CheckTxInputs(tx, dummy_state, mempoolDuplicate, spendheight, txfee);\n-    assert(fCheckResult);\n-    UpdateCoins(tx, mempoolDuplicate, std::numeric_limits<int>::max());\n-}\n ",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721225993,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed",
      "created_at": "2021-10-04T12:33:03Z",
      "updated_at": "2021-10-04T12:33:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721318517",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721318517"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 675,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721319192",
      "pull_request_review_id": 770233692,
      "id": 721319192,
      "node_id": "PRRC_kwDOABII584q_nUY",
      "diff_hunk": "@@ -693,28 +686,29 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n     uint64_t checkTotal = 0;\n     CAmount check_total_fee{0};\n     uint64_t innerUsage = 0;\n+    uint64_t prev_ancestor_count{0};\n \n     CCoinsViewCache& active_coins_tip = active_chainstate.CoinsTip();\n     CCoinsViewCache mempoolDuplicate(const_cast<CCoinsViewCache*>(&active_coins_tip));\n     const int64_t spendheight = active_chainstate.m_chain.Height() + 1;\n \n-    std::list<const CTxMemPoolEntry*> waitingOnDependants;\n-    for (indexed_transaction_set::const_iterator it = mapTx.begin(); it != mapTx.end(); it++) {\n+    for (const auto& it : GetSortedDepthAndScore()) {\n         unsigned int i = 0;\n         checkTotal += it->GetTxSize();\n         check_total_fee += it->GetFee();\n         innerUsage += it->DynamicMemoryUsage();\n         const CTransaction& tx = it->GetTx();\n         innerUsage += memusage::DynamicUsage(it->GetMemPoolParentsConst()) + memusage::DynamicUsage(it->GetMemPoolChildrenConst());\n-        bool fDependsWait = false;\n         CTxMemPoolEntry::Parents setParentCheck;\n         for (const CTxIn &txin : tx.vin) {\n             // Check that every mempool transaction's inputs refer to available coins, or other mempool tx's.\n             indexed_transaction_set::const_iterator it2 = mapTx.find(txin.prevout.hash);\n             if (it2 != mapTx.end()) {\n                 const CTransaction& tx2 = it2->GetTx();\n                 assert(tx2.vout.size() > txin.prevout.n && !tx2.vout[txin.prevout.n].IsNull());\n-                fDependsWait = true;\n+                // Sanity check: all parents should have been checked before their children, which\n+                // means its outputs must be available in the coins cache.\n+                assert(mempoolDuplicate.HaveCoin(txin.prevout));",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721230523,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, it can, but I thought people might find it scary. I've grouped this and the !IsCoinbase check you suggested into one \"simplify logic\" commit. ",
      "created_at": "2021-10-04T12:34:02Z",
      "updated_at": "2021-10-04T12:34:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721319192",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721319192"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 711,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721319410",
      "pull_request_review_id": 770234000,
      "id": 721319410,
      "node_id": "PRRC_kwDOABII584q_nXy",
      "diff_hunk": "@@ -769,24 +767,12 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n         // just a sanity check, not definitive that this calc is correct...\n         assert(it->GetSizeWithDescendants() >= child_sizes + it->GetTxSize());\n \n-        if (fDependsWait)\n-            waitingOnDependants.push_back(&(*it));\n-        else {\n-            CheckInputsAndUpdateCoins(tx, mempoolDuplicate, spendheight);\n-        }\n-    }\n-    unsigned int stepsSinceLastRemove = 0;\n-    while (!waitingOnDependants.empty()) {\n-        const CTxMemPoolEntry* entry = waitingOnDependants.front();\n-        waitingOnDependants.pop_front();\n-        if (!mempoolDuplicate.HaveInputs(entry->GetTx())) {\n-            waitingOnDependants.push_back(entry);\n-            stepsSinceLastRemove++;\n-            assert(stepsSinceLastRemove < waitingOnDependants.size());\n-        } else {\n-            CheckInputsAndUpdateCoins(entry->GetTx(), mempoolDuplicate, spendheight);\n-            stepsSinceLastRemove = 0;\n-        }\n+        TxValidationState dummy_state; // Not used. CheckTxInputs() should always pass\n+        CAmount txfee = 0;\n+        bool fCheckResult = tx.IsCoinBase() || Consensus::CheckTxInputs(tx, dummy_state, mempoolDuplicate, spendheight, txfee);",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 92,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "4bc0c8066e79f0d95053bcc2449a7d354eaa9c25",
      "in_reply_to_id": 721235682,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agree, added.",
      "created_at": "2021-10-04T12:34:18Z",
      "updated_at": "2021-10-04T12:34:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721319410",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721319410"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 772,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721328836",
      "pull_request_review_id": 770246424,
      "id": 721328836,
      "node_id": "PRRC_kwDOABII584q_prE",
      "diff_hunk": "@@ -671,16 +672,7 @@ void CTxMemPool::clear()\n     _clear();\n }\n \n-static void CheckInputsAndUpdateCoins(const CTransaction& tx, CCoinsViewCache& mempoolDuplicate, const int64_t spendheight)\n-{\n-    TxValidationState dummy_state; // Not used. CheckTxInputs() should always pass\n-    CAmount txfee = 0;\n-    bool fCheckResult = tx.IsCoinBase() || Consensus::CheckTxInputs(tx, dummy_state, mempoolDuplicate, spendheight, txfee);\n-    assert(fCheckResult);\n-    UpdateCoins(tx, mempoolDuplicate, std::numeric_limits<int>::max());",
      "path": "src/txmempool.cpp",
      "position": 18,
      "original_position": 18,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "a420bcb8ad6f61fad05941cecdcb5df693ee6cc0",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "After this commit, `UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, int nHeight)` is no longer used:\r\n\r\n```diff\r\ndiff --git a/src/validation.cpp b/src/validation.cpp\r\nindex 4504d2ca0a..c552577229 100644\r\n--- a/src/validation.cpp\r\n+++ b/src/validation.cpp\r\n@@ -1225,6 +1225,7 @@ void CChainState::InvalidBlockFound(CBlockIndex* pindex, const BlockValidationSt\r\n     }\r\n }\r\n \r\n+/** Apply the effects of this transaction on the UTXO set represented by view */\r\n void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, CTxUndo &txundo, int nHeight)\r\n {\r\n     // mark inputs spent\r\n@@ -1240,12 +1241,6 @@ void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, CTxUndo &txund\r\n     AddCoins(inputs, tx, nHeight);\r\n }\r\n \r\n-void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, int nHeight)\r\n-{\r\n-    CTxUndo txundo;\r\n-    UpdateCoins(tx, inputs, txundo, nHeight);\r\n-}\r\n-\r\n bool CScriptCheck::operator()() {\r\n     const CScript &scriptSig = ptxTo->vin[nIn].scriptSig;\r\n     const CScriptWitness *witness = &ptxTo->vin[nIn].scriptWitness;\r\ndiff --git a/src/validation.h b/src/validation.h\r\nindex b2282828ce..caa0832dd3 100644\r\n--- a/src/validation.h\r\n+++ b/src/validation.h\r\n@@ -229,9 +229,6 @@ PackageMempoolAcceptResult ProcessNewPackage(CChainState& active_chainstate, CTx\r\n                                                    const Package& txns, bool test_accept)\r\n                                                    EXCLUSIVE_LOCKS_REQUIRED(cs_main);\r\n \r\n-/** Apply the effects of this transaction on the UTXO set represented by view */\r\n-void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, int nHeight);\r\n-\r\n /** Transaction validation functions */\r\n \r\n /**\r\n```",
      "created_at": "2021-10-04T12:46:05Z",
      "updated_at": "2021-10-04T12:46:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721328836",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721328836"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 680,
      "original_line": 680,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721333376",
      "pull_request_review_id": 770252420,
      "id": 721333376,
      "node_id": "PRRC_kwDOABII584q_qyA",
      "diff_hunk": "@@ -671,16 +672,7 @@ void CTxMemPool::clear()\n     _clear();\n }\n \n-static void CheckInputsAndUpdateCoins(const CTransaction& tx, CCoinsViewCache& mempoolDuplicate, const int64_t spendheight)\n-{\n-    TxValidationState dummy_state; // Not used. CheckTxInputs() should always pass\n-    CAmount txfee = 0;\n-    bool fCheckResult = tx.IsCoinBase() || Consensus::CheckTxInputs(tx, dummy_state, mempoolDuplicate, spendheight, txfee);\n-    assert(fCheckResult);\n-    UpdateCoins(tx, mempoolDuplicate, std::numeric_limits<int>::max());",
      "path": "src/txmempool.cpp",
      "position": 18,
      "original_position": 18,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "a420bcb8ad6f61fad05941cecdcb5df693ee6cc0",
      "in_reply_to_id": 721328836,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "oh good point! removed now",
      "created_at": "2021-10-04T12:51:39Z",
      "updated_at": "2021-10-04T12:51:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r721333376",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721333376"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 680,
      "original_line": 680,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/722805484",
      "pull_request_review_id": 772102112,
      "id": 722805484,
      "node_id": "PRRC_kwDOABII584rFSLs",
      "diff_hunk": "@@ -79,6 +76,17 @@ static void ComplexMemPool(benchmark::Bench& bench)\n         ordered_coins.emplace_back(MakeTransactionRef(tx));\n         available_coins.emplace_back(ordered_coins.back(), tx_counter++);\n     }\n+    return ordered_coins;\n+}\n+\n+static void ComplexMemPool(benchmark::Bench& bench)\n+{\n+    FastRandomContext det_rand{true};\n+    int childTxs = 800;\n+    if (bench.complexityN() > 1) {\n+        childTxs = static_cast<int>(bench.complexityN());\n+    }",
      "path": "src/bench/mempool_stress.cpp",
      "position": 50,
      "original_position": 50,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "in_reply_to_id": null,
      "user": {
        "login": "SachinMeier",
        "id": 46731461,
        "node_id": "MDQ6VXNlcjQ2NzMxNDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/46731461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SachinMeier",
        "html_url": "https://github.com/SachinMeier",
        "followers_url": "https://api.github.com/users/SachinMeier/followers",
        "following_url": "https://api.github.com/users/SachinMeier/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/SachinMeier/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/SachinMeier/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/SachinMeier/subscriptions",
        "organizations_url": "https://api.github.com/users/SachinMeier/orgs",
        "repos_url": "https://api.github.com/users/SachinMeier/repos",
        "events_url": "https://api.github.com/users/SachinMeier/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/SachinMeier/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: This could be simplified to: \r\n```cpp \r\nint childTxs = bench.complexityN() > 1 ? static_cast<int>(bench.complexityN()) : 800;\r\n```\r\nas it is on line 105",
      "created_at": "2021-10-06T00:45:29Z",
      "updated_at": "2021-10-06T00:46:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r722805484",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/722805484"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": 85,
      "original_start_line": 85,
      "start_side": "RIGHT",
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738806372",
      "pull_request_review_id": 792468601,
      "id": 738806372,
      "node_id": "PRRC_kwDOABII584sCUpk",
      "diff_hunk": "@@ -751,6 +752,9 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n         assert(it->GetSizeWithAncestors() == nSizeCheck);\n         assert(it->GetSigOpCostWithAncestors() == nSigOpCheck);\n         assert(it->GetModFeesWithAncestors() == nFeesCheck);\n+        // Sanity check: we are walking in ascending ancestor count order.",
      "path": "src/txmempool.cpp",
      "position": 75,
      "original_position": 29,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "54c6f3c1da01090aee9691a2c2bee0984a054ce8",
      "in_reply_to_id": null,
      "user": {
        "login": "mjdietzx",
        "id": 7217256,
        "node_id": "MDQ6VXNlcjcyMTcyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7217256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mjdietzx",
        "html_url": "https://github.com/mjdietzx",
        "followers_url": "https://api.github.com/users/mjdietzx/followers",
        "following_url": "https://api.github.com/users/mjdietzx/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mjdietzx/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mjdietzx/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mjdietzx/subscriptions",
        "organizations_url": "https://api.github.com/users/mjdietzx/orgs",
        "repos_url": "https://api.github.com/users/mjdietzx/repos",
        "events_url": "https://api.github.com/users/mjdietzx/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mjdietzx/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why is this sanity check necessary? It's not like `GetSortedDepthAndScore()` is complicated or has non-deterministic behavior, right?\r\n\r\nAnd why do we really need to fail if somehow we do encounter this case? The only down-side I see is marking this as a \"check later\" transaction which is just a minor performance hit?\r\n\r\nAre there any race conditions where we could possibly see this assert throw?",
      "created_at": "2021-10-28T22:04:40Z",
      "updated_at": "2021-10-28T22:23:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r738806372",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738806372"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 742,
      "original_line": 755,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738811117",
      "pull_request_review_id": 792468601,
      "id": 738811117,
      "node_id": "PRRC_kwDOABII584sCVzt",
      "diff_hunk": "@@ -751,6 +752,9 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n         assert(it->GetSizeWithAncestors() == nSizeCheck);\n         assert(it->GetSigOpCostWithAncestors() == nSigOpCheck);\n         assert(it->GetModFeesWithAncestors() == nFeesCheck);\n+        // Sanity check: we are walking in ascending ancestor count order.",
      "path": "src/txmempool.cpp",
      "position": 75,
      "original_position": 29,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "54c6f3c1da01090aee9691a2c2bee0984a054ce8",
      "in_reply_to_id": 738806372,
      "user": {
        "login": "mjdietzx",
        "id": 7217256,
        "node_id": "MDQ6VXNlcjcyMTcyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7217256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mjdietzx",
        "html_url": "https://github.com/mjdietzx",
        "followers_url": "https://api.github.com/users/mjdietzx/followers",
        "following_url": "https://api.github.com/users/mjdietzx/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mjdietzx/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mjdietzx/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mjdietzx/subscriptions",
        "organizations_url": "https://api.github.com/users/mjdietzx/orgs",
        "repos_url": "https://api.github.com/users/mjdietzx/repos",
        "events_url": "https://api.github.com/users/mjdietzx/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mjdietzx/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Alright, I'm reviewing commit by commit, and now in e8639ec26aaf4de3fae280963434bf1cf2017b6f I am starting to understand why we have this assert.\r\n\r\nBut, I'm still wondering, why have this assert if `assert(mempoolDuplicate.HaveCoin(txin.prevout));` will take care of the job should we run into any problems? I still don't see why this is beneficial\r\n\r\n",
      "created_at": "2021-10-28T22:15:09Z",
      "updated_at": "2021-10-28T22:23:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r738811117",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738811117"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 742,
      "original_line": 755,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739091181",
      "pull_request_review_id": 792839161,
      "id": 739091181,
      "node_id": "PRRC_kwDOABII584sDaLt",
      "diff_hunk": "@@ -751,6 +752,9 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n         assert(it->GetSizeWithAncestors() == nSizeCheck);\n         assert(it->GetSigOpCostWithAncestors() == nSigOpCheck);\n         assert(it->GetModFeesWithAncestors() == nFeesCheck);\n+        // Sanity check: we are walking in ascending ancestor count order.",
      "path": "src/txmempool.cpp",
      "position": 75,
      "original_position": 29,
      "commit_id": "082c5bf099c64e3d27abe9b68a71ce500b693e7e",
      "original_commit_id": "54c6f3c1da01090aee9691a2c2bee0984a054ce8",
      "in_reply_to_id": 738806372,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's not strictly necessary, no. It's just a relatively cheap-to-run sanity check. It can make things easier to debug if we have any problems, but yes it can be removed and this code would still be checking the same things.",
      "created_at": "2021-10-29T09:45:11Z",
      "updated_at": "2021-10-29T09:45:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/23157#discussion_r739091181",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739091181"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23157"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 742,
      "original_line": 755,
      "side": "RIGHT"
    }
  ]
}