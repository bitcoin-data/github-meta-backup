{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857",
    "id": 1191042947,
    "node_id": "PR_kwDOABII585G_d-D",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/26857",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/26857.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/26857.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/8eacc25a06de641963d0616f1b659b0024feeed9",
    "number": 26857,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "OP_VAULT draft",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is a draft for a consensus change enabling on-chain vaults, as detailed in the BIP: https://github.com/bitcoin/bips/pull/1421\r\n\r\nIn short, it introduces two opcodes, `OP_VAULT` and `OP_UNVAULT`, that facilitate constructing vaults which\r\n\r\n- allow multiple deposits,\r\n- allow partial unvaultings and recursive re-vaults,\r\n- allow batch operations (recoveries and unvaultings) using vaults with compatible parameters,\r\n- support dynamic withdrawal target specification, and\r\n- support robust fee management.\r\n\r\nFor the last item, the proposal has a hard dependency on package relay and ephemeral anchors.\r\n\r\nThe code as-written here lacks specific activation mechanism, and there's probably some policy/wallet stuff missing,\r\n but in substance it is implemented and comes with some interesting functional tests.\r\n",
    "labels": [
      {
        "id": 192202000,
        "node_id": "MDU6TGFiZWwxOTIyMDIwMDA=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Consensus",
        "name": "Consensus",
        "color": "009800",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2023-01-09T16:02:53Z",
    "updated_at": "2023-03-21T16:41:34Z",
    "closed_at": "2023-03-21T16:41:32Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merge_commit_sha": "8e1c35e59220c9ed0dc937a48342e9bbeb2dbd84",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "jamesob:2023-01-opvault",
      "ref": "2023-01-opvault",
      "sha": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 42077031,
        "node_id": "MDEwOlJlcG9zaXRvcnk0MjA3NzAzMQ==",
        "name": "bitcoin",
        "full_name": "jamesob/bitcoin",
        "owner": {
          "login": "jamesob",
          "id": 73197,
          "node_id": "MDQ6VXNlcjczMTk3",
          "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/jamesob",
          "html_url": "https://github.com/jamesob",
          "followers_url": "https://api.github.com/users/jamesob/followers",
          "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
          "organizations_url": "https://api.github.com/users/jamesob/orgs",
          "repos_url": "https://api.github.com/users/jamesob/repos",
          "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/jamesob/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/jamesob/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/jamesob/bitcoin",
        "archive_url": "https://api.github.com/repos/jamesob/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/jamesob/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/jamesob/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/jamesob/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/jamesob/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/jamesob/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/jamesob/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/jamesob/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/jamesob/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/jamesob/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/jamesob/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/jamesob/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/jamesob/bitcoin/events",
        "forks_url": "https://api.github.com/repos/jamesob/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/jamesob/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/jamesob/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/jamesob/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/jamesob/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/jamesob/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/jamesob/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/jamesob/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/jamesob/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/jamesob/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/jamesob/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/jamesob/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/jamesob/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/jamesob/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/jamesob/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/jamesob/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:jamesob/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/jamesob/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/jamesob/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/jamesob/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/jamesob/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/jamesob/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/jamesob/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/jamesob/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/jamesob/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/jamesob/bitcoin/hooks",
        "svn_url": "https://github.com/jamesob/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 2,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 252891,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-05-31T19:20:56Z",
        "created_at": "2015-09-07T22:18:03Z",
        "updated_at": "2023-05-05T06:31:51Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "be2e748f378fc9ed40593a723dd18f2528705956",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34325,
        "stargazers_count": 69818,
        "watchers_count": 69818,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 626,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T07:29:24Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T06:49:43Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
      }
    },
    "author_association": "MEMBER",
    "draft": true,
    "additions": 2522,
    "deletions": 95,
    "changed_files": 30,
    "commits": 9,
    "review_comments": 17,
    "comments": 9
  },
  "events": [
    {
      "event": "convert_to_draft",
      "id": 8183326841,
      "node_id": "CTDE_lADOABII585a8wAszwAAAAHnw6h5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8183326841",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T16:03:29Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8183741891,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHnyf3D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8183741891",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T16:46:57Z"
    },
    {
      "event": "commented",
      "id": 1375934926,
      "node_id": "IC_kwDOABII585SAxnO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1375934926",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T16:46:59Z",
      "updated_at": "2023-03-07T23:41:28Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [1440000bytes](https://github.com/bitcoin/bitcoin/pull/26857#pullrequestreview-1269747286) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27223](https://github.com/bitcoin/bitcoin/pull/27223) (Update chainparams for 25.x by johnny9)\n* [#26749](https://github.com/bitcoin/bitcoin/pull/26749) (refactor: Use move semantics instead of custom swap functions by hebasto)\n* [#26201](https://github.com/bitcoin/bitcoin/pull/26201) (Remove Taproot activation height by Sjors)\n* [#26177](https://github.com/bitcoin/bitcoin/pull/26177) (refactor / kernel: Move non-gArgs chainparams functionality to kernel by TheCharlatan)\n* [#25740](https://github.com/bitcoin/bitcoin/pull/25740) (assumeutxo: background validation completion by jamesob)\n* [#24230](https://github.com/bitcoin/bitcoin/pull/24230) (indexes: Stop using node internal types and locking cs_main, improve sync logic by ryanofsky)\n* [#15606](https://github.com/bitcoin/bitcoin/pull/15606) (assumeutxo by jamesob)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#issuecomment-1375934926",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8183977887,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHnzZef",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8183977887",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T17:13:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8185090140,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHn3pBc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8185090140",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T19:23:00Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8185397562,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHn40E6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8185397562",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T19:58:35Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8185493338,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHn5Lda",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8185493338",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T20:09:12Z"
    },
    {
      "event": "reviewed",
      "id": 1241462822,
      "node_id": "PRR_kwDOABII585J_zgm",
      "url": null,
      "actor": null,
      "commit_id": "fbf344931a2224dc3ace0011c1a4cb5cd4187f3e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Congrats here -- Always cool to see new implemented ideas to extend the Script interpreter flexibility!\r\n\r\nFrom a primitive viewpoint, I think I've few open questions, like if the recovery path should be committed with a signature rather than protected by a simple scriptpubkey preimage. Beyond locking up the inputs/outputs fields for mempool issues, I think there is the accountability upsides of using new private and accountable Schnorr-compatible schemes (e.g [TAPS](https://eprint.iacr.org/2022/1636.pdf)). The current `OP_VAULT` implementation is using OP_NOP repurposing but this doesn't seem compatible with Taproot-only extensions (e.g `ANYPREVOUT`) and maybe a `OP_SUCCESS` could be used. There is a conceptual wonder, if a `CTV` and template malleability approach wouldn't better suit the vault use-case and allow other ones, as such better re-usability of primitives.\r\n\r\nFrom a procedural viewpoint, recently there has been proposed the [bitcoin-inquisition\r\nfork](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2022-September/020921.html) of Core as an experimental platform to test, iterate and play with Script interpreter extensions, notably also aiming to support package relay and ephemeral outputs to observe the fee-bumping primitives trade-offs. I believe the idea is to have a stable Core release where one can have a protocol proof-of-concept running with hopefully minimal rebase maintenance cost (yeah we all hate the rebase hell...). Looking forward to review things there!",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#pullrequestreview-1241462822",
      "submitted_at": "2023-01-10T02:58:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
    },
    {
      "event": "commented",
      "id": 1377014412,
      "node_id": "IC_kwDOABII585SE5KM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1377014412",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-10T10:07:56Z",
      "updated_at": "2023-01-10T10:07:56Z",
      "author_association": "MEMBER",
      "body": "Great to see this, I hope this functionality comes into Bitcoin one way or another, and this seems like a decent attempt. Your listing of the features makes sense, and I currently don't think a more optimal way to achieve them.\r\n\r\nBy no means blockers, but rather some thoughts I wanted to share on the design:\r\n1. I'm personally not sure batching withdrawals is that compelling... It's a nice-to-have, but I'd think about the benefits dropping this feature would provide.\r\n2. Or, from a different angle, the issue of malicious de-batching should not stop this idea from moving forward, as I'm not convinced this use case would be that widespread. I want to think more about use cases (solo user cold wallet, exchange cold wallet, fund cold wallet) and what their setups would look like.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#issuecomment-1377014412",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857"
    },
    {
      "event": "commented",
      "id": 1377114377,
      "node_id": "IC_kwDOABII585SFRkJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1377114377",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-10T11:28:35Z",
      "updated_at": "2023-02-08T15:01:39Z",
      "author_association": "MEMBER",
      "body": "I plan to comment about the design on the ML, but just a note about @naumenkogs' comment above.\r\n\r\nOn the contrary i think the batching feature is very compelling. The impossibility to batch Unvaults in [Revault](https://github.com/revault/practical-revault) is a major drawback: it significantly increases the cost of any realistic operation (you need one whole additional transaction per input, and each have likely more than one output). It also potentially increases the cost on the network (you'd likely want some sort of anchor output on each Unvault tx, that you might not spend, so that's `2*n` outputs created with `n` the number of coins spent): we definitely don't want to prevent batching. The ability to batch the recovery transactions (what we called Emergency tx in Revault) is also very compelling but i think your comment was only about batched withdrawals.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#issuecomment-1377114377",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857"
    },
    {
      "event": "mentioned",
      "id": 8190949831,
      "node_id": "MEE_lADOABII585a8wAszwAAAAHoN_nH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8190949831",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-10T11:28:35Z"
    },
    {
      "event": "subscribed",
      "id": 8190949840,
      "node_id": "SE_lADOABII585a8wAszwAAAAHoN_nQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8190949840",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-10T11:28:35Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8195871665,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHogxOx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8195871665",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-10T21:01:38Z"
    },
    {
      "event": "labeled",
      "id": 8202514254,
      "node_id": "LE_lADOABII585a8wAszwAAAAHo6G9O",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8202514254",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-11T14:53:26Z",
      "label": {
        "name": "Consensus",
        "color": "009800"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8223909704,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHqLudI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8223909704",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-13T19:44:19Z"
    },
    {
      "event": "labeled",
      "id": 8238856142,
      "node_id": "LE_lADOABII585a8wAszwAAAAHrEvfO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8238856142",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T17:11:50Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1384405553,
      "node_id": "IC_kwDOABII585ShFox",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384405553",
      "actor": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T18:09:40Z",
      "updated_at": "2023-01-16T18:09:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "I second most (if not all) of the comments thus far. Especially this from @ariard. \r\n\r\n> From a procedural viewpoint, recently there has been proposed the bitcoin-inquisition\r\nfork of Core as an experimental platform to test, iterate and play with Script interpreter extensions, notably also aiming to support package relay and ephemeral outputs to observe the fee-bumping primitives trade-offs\r\n\r\nThanks also for keeping this in draft for now @jamesob. For it to be moved out of draft I'd like to see a convergence on this being the best proposal to enable this functionality and proofs of concept on bitcoin-inquisition seem like a good step towards that (assuming the bitcoin-inquisition maintainer(s) think this is ready to be merged there).\r\n\r\n",
      "user": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#issuecomment-1384405553",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857"
    },
    {
      "event": "mentioned",
      "id": 8239210558,
      "node_id": "MEE_lADOABII585a8wAszwAAAAHrGGA-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8239210558",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T18:09:40Z"
    },
    {
      "event": "subscribed",
      "id": 8239210564,
      "node_id": "SE_lADOABII585a8wAszwAAAAHrGGBE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8239210564",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T18:09:40Z"
    },
    {
      "event": "mentioned",
      "id": 8239210574,
      "node_id": "MEE_lADOABII585a8wAszwAAAAHrGGBO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8239210574",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T18:09:40Z"
    },
    {
      "event": "subscribed",
      "id": 8239210587,
      "node_id": "SE_lADOABII585a8wAszwAAAAHrGGBb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8239210587",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T18:09:40Z"
    },
    {
      "event": "reviewed",
      "id": 1250651157,
      "node_id": "PRR_kwDOABII585Ki2wV",
      "url": null,
      "actor": null,
      "commit_id": "a8323b9cea602f4af8206f86c0193d189b721904",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Left some comments on the code, although a few may be more appropriate to followup on the mailing list about. Will also send a response to the mailing list.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#pullrequestreview-1250651157",
      "submitted_at": "2023-01-16T21:38:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8306498641,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHvGxxR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8306498641",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-18T22:26:08Z"
    },
    {
      "event": "commented",
      "id": 1396974683,
      "node_id": "IC_kwDOABII585TRCRb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1396974683",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-19T13:26:51Z",
      "updated_at": "2023-01-19T13:27:27Z",
      "author_association": "MEMBER",
      "body": "Any plans for a `vault()` descriptor? For Our wallet currently isn't designed for a two-stage transaction, which is necessary for the unvaulting part, so it'd be interesting to see someone attempting to implement a working vault in our wallet. Not saying you should be the one doing that, and it deserves a separate PR.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#issuecomment-1396974683",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857"
    },
    {
      "event": "commented",
      "id": 1399612075,
      "node_id": "IC_kwDOABII585TbGKr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1399612075",
      "actor": {
        "login": "john-moffett",
        "id": 116917595,
        "node_id": "U_kgDOBvgFWw",
        "avatar_url": "https://avatars.githubusercontent.com/u/116917595?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/john-moffett",
        "html_url": "https://github.com/john-moffett",
        "followers_url": "https://api.github.com/users/john-moffett/followers",
        "following_url": "https://api.github.com/users/john-moffett/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/john-moffett/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/john-moffett/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/john-moffett/subscriptions",
        "organizations_url": "https://api.github.com/users/john-moffett/orgs",
        "repos_url": "https://api.github.com/users/john-moffett/repos",
        "events_url": "https://api.github.com/users/john-moffett/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/john-moffett/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-22T21:22:25Z",
      "updated_at": "2023-01-22T21:22:25Z",
      "author_association": "MEMBER",
      "body": "I think the overall approach is sound for vault-specific functionality.\r\n\r\nI understand the implementation is a draft at this point, so you may already be aware of these issues, but I thought I'd flag them just in case. My apologies if these are premature!\r\n\r\nI believe the recursion [here](https://github.com/bitcoin/bitcoin/blob/f8d55bb32c267f2f02e67ad1dec1af65c6f16881/src/script/interpreter.cpp#L1334) ought to be explicitly limited. As it stands, an attacker could crash a node by crafting a transaction spending from a vault that has, as its `recov_spk_script`, a P2WSH scriptPubkey with a `witnessScript` of:\r\n\r\n`OP_3 OP_PICK OP_3 OP_PICK OP_3 OP_PICK OP_3 OP_PICK OP_VAULT`\r\n\r\nIf you supply `witnessScript, recovery_params, delay, 0x00*32, witnessScript` to the witness stack (in addition to the initial witness stack [here](https://github.com/bitcoin/bitcoin/blob/f8d55bb32c267f2f02e67ad1dec1af65c6f16881/test/functional/feature_vaults.py#L671-L676)), it'll recurse infinitely and crash. (See diff at the end of this comment for my addition to the test code.)\r\n\r\nA potential attacker could also perform almost any arbitrary computation using a similar method.\r\n\r\nThe recursion also doesn't count any potential additional signature operations toward the `sigOps` limits from what I can tell. (Maybe this is by design, though?)\r\n\r\nFinally, I don't think implementing these opcodes as `OP_NOPs` is workable as a soft fork. The current implementation is actually (I think) a hard fork, given that the stack will not be clean for old nodes and they'll reject most transactions using these opcodes. Even absent the cleanstack rule for witness scripts, the top element could be `false` in this case for old nodes yet the script would succeed in this PR, since it [pushes](https://github.com/bitcoin/bitcoin/blob/f8d55bb32c267f2f02e67ad1dec1af65c6f16881/src/script/interpreter.cpp#L1341) a `true`.\r\n\r\nI think it's generally unsafe for a reimplemented `NOP` to push to or pop the stack. My suggestion would be restricting `OP_VAULT` / `OP_UNVAULT` to be Tapscript only and using `OP_SUCCESSx` codes.  \r\n\r\nDiff for `feature_vaults.py`:\r\n\r\n```diff\r\n\r\n@@ -21,0 +22 @@ from test_framework.util import assert_equal, assert_raises_rpc_error\r\n+from test_framework.script_util import script_to_p2wsh_script\r\n@@ -64,0 +66,3 @@ class VaultsTest(BitcoinTestFramework):\r\n+            title(\"testing recursive attack sweep\")\r\n+            self.single_vault_test(node, wallet, sweep_from_vault=True)\r\n+\r\n@@ -447 +451,3 @@ DEFAULT_UNVAULT_SECRET = 3\r\n-\r\n+def get_recursive_witness_script() -> CScript:\r\n+    return CScript([script.OP_3, script.OP_PICK, script.OP_3, script.OP_PICK, script.OP_3,\r\n+                    script.OP_PICK, script.OP_3, script.OP_PICK, script.OP_VAULT])\r\n@@ -465 +471,3 @@ class VaultSpec:\r\n-        self.recovery_spk = CScript([script.OP_TRUE])\r\n+        recursive_script = get_recursive_witness_script()\r\n+        recursive_program = script_to_p2wsh_script(recursive_script)\r\n+        self.recovery_spk = recursive_program\r\n@@ -672,0 +681,5 @@ def get_sweep_to_recovery_tx(\r\n+                get_recursive_witness_script(),\r\n+                vault.recovery_params,\r\n+                CScript([vault.spend_delay]),\r\n+                CScript(b'\\x00' * 32),\r\n+                get_recursive_witness_script(),\r\n\r\n\r\n```",
      "user": {
        "login": "john-moffett",
        "id": 116917595,
        "node_id": "U_kgDOBvgFWw",
        "avatar_url": "https://avatars.githubusercontent.com/u/116917595?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/john-moffett",
        "html_url": "https://github.com/john-moffett",
        "followers_url": "https://api.github.com/users/john-moffett/followers",
        "following_url": "https://api.github.com/users/john-moffett/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/john-moffett/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/john-moffett/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/john-moffett/subscriptions",
        "organizations_url": "https://api.github.com/users/john-moffett/orgs",
        "repos_url": "https://api.github.com/users/john-moffett/repos",
        "events_url": "https://api.github.com/users/john-moffett/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/john-moffett/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#issuecomment-1399612075",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857"
    },
    {
      "event": "commented",
      "id": 1400642052,
      "node_id": "IC_kwDOABII585TfBoE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1400642052",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T16:35:13Z",
      "updated_at": "2023-01-23T16:35:13Z",
      "author_association": "MEMBER",
      "body": "> Any plans for a vault() descriptor?\r\n\r\nThat'd be great, though if no one else wants to do that work I'll have spend some time learning more about descriptors.\r\n\r\n> I understand the implementation is a draft at this point, so you may already be aware of these issues, but I thought I'd flag them just in case. My apologies if these are premature!\r\n\r\n@john-moffett this is all great! I'd planned to move OP_VAULT/OP_UNVAULT to OP_SUCCESSx as of late last week, and was vaguely aware that the recursion probably facilitates Bad Things, but your detailed explanations and test cases (!) are very valuable. Never too early to point out a crash bug! Thank you for your help.\r\n\r\nI'll remedy these things in the coming days.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#issuecomment-1400642052",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857"
    },
    {
      "event": "mentioned",
      "id": 8336131633,
      "node_id": "MEE_lADOABII585a8wAszwAAAAHw30Yx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8336131633",
      "actor": {
        "login": "john-moffett",
        "id": 116917595,
        "node_id": "U_kgDOBvgFWw",
        "avatar_url": "https://avatars.githubusercontent.com/u/116917595?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/john-moffett",
        "html_url": "https://github.com/john-moffett",
        "followers_url": "https://api.github.com/users/john-moffett/followers",
        "following_url": "https://api.github.com/users/john-moffett/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/john-moffett/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/john-moffett/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/john-moffett/subscriptions",
        "organizations_url": "https://api.github.com/users/john-moffett/orgs",
        "repos_url": "https://api.github.com/users/john-moffett/repos",
        "events_url": "https://api.github.com/users/john-moffett/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/john-moffett/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T16:35:13Z"
    },
    {
      "event": "subscribed",
      "id": 8336131656,
      "node_id": "SE_lADOABII585a8wAszwAAAAHw30ZI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8336131656",
      "actor": {
        "login": "john-moffett",
        "id": 116917595,
        "node_id": "U_kgDOBvgFWw",
        "avatar_url": "https://avatars.githubusercontent.com/u/116917595?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/john-moffett",
        "html_url": "https://github.com/john-moffett",
        "followers_url": "https://api.github.com/users/john-moffett/followers",
        "following_url": "https://api.github.com/users/john-moffett/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/john-moffett/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/john-moffett/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/john-moffett/subscriptions",
        "organizations_url": "https://api.github.com/users/john-moffett/orgs",
        "repos_url": "https://api.github.com/users/john-moffett/repos",
        "events_url": "https://api.github.com/users/john-moffett/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/john-moffett/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T16:35:13Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8338449013,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHxAqJ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8338449013",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T21:34:47Z"
    },
    {
      "event": "unlabeled",
      "id": 8338657856,
      "node_id": "UNLE_lADOABII585a8wAszwAAAAHxBdJA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8338657856",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T22:05:18Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8355622751,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHyCK9f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8355622751",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-25T14:57:41Z"
    },
    {
      "event": "reviewed",
      "id": 1269747286,
      "node_id": "PRR_kwDOABII585Lrs5W",
      "url": null,
      "actor": null,
      "commit_id": "b32ed43385e3a868ab74ce5bd7d3e3c45005562a",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "Concept: Specific covenant proposal instead of generalized covenant that achieves multiple things over years\r\n\r\nConcept NACK\r\n\r\nOverall I agree with covenants being implemented however only supporting one use case doesn't make sense. I could link to several other discussions including some in which reviewers of this PR were not satisfied with OP_CTV because it seems to be redundant and general covenants approach works better, however below links sums up everything without any drama.\r\n\r\n_Note: Its possible to [emulate CTV inefficiently](https://mailmanlists.org/pipermail/dlc-dev/2023-January/000170.html) if this is implemented._\r\n\r\nRelated links:\r\n\r\nhttps://twitter.com/tierotiero/status/1618133549294718976\r\n\r\nhttps://twitter.com/tierotiero/status/1618136358001967104\r\n\r\n--- \r\n\r\nI appreciate the efforts by PR author to write the paper, mailing list discussion etc. however this  has no consensus apart from a few vault enthusiasts in this repository. Author had also requested people to [participate in mailing list discussion](https://twitter.com/jamesob/status/1612863893977681920?s=20&t=pBm7JCiqKvJBiUEaRw6ikQ) to share other use cases, I think it has been done already and resulted in being called 'attack on bitcoin', 'personal attacks' etc. Also its not possible to discuss anything on mailing list related to coinjoin. Maybe we need a[ mailing list on nostr](https://snort.social/e/note14glew97hsrngjqswdd32pw8jdsd7xrjj46s22n7ac4qkm7yctjgqxayuxq).\r\n",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#pullrequestreview-1269747286",
      "submitted_at": "2023-01-25T16:57:10Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8366861665,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHytC1h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8366861665",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-26T18:45:07Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8367286912,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHyuqqA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8367286912",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-26T19:43:55Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8367353931,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHyu7BL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8367353931",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-26T19:53:34Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8369308751,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAHy2YRP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8369308751",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-27T01:38:13Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8436852580,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH24Cdk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8436852580",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-03T22:27:59Z"
    },
    {
      "event": "reviewed",
      "id": 1284012870,
      "node_id": "PRR_kwDOABII585MiHtG",
      "url": null,
      "actor": null,
      "commit_id": "aefe75178ab433d3fd66e27eceb73afba6dcc582",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#pullrequestreview-1284012870",
      "submitted_at": "2023-02-04T09:58:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
    },
    {
      "event": "labeled",
      "id": 8451478855,
      "node_id": "LE_lADOABII585a8wAszwAAAAH3v1VH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8451478855",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-06T20:24:17Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8462637274,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH4aZja",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8462637274",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-07T22:16:10Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8517714245,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH7sgFF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8517714245",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-14T16:57:43Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8529140049,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH8YFlR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8529140049",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-15T18:39:41Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8542682796,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH9Lv6s",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8542682796",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-17T01:23:42Z"
    },
    {
      "event": "unlabeled",
      "id": 8542894077,
      "node_id": "UNLE_lADOABII585a8wAszwAAAAH9Mjf9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8542894077",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-17T02:15:29Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8549502945,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH9lw_h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8549502945",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-17T17:44:51Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8549785192,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH9m15o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8549785192",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-17T18:17:55Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8549958794,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH9ngSK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8549958794",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-17T18:41:59Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8550430836,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH9pTh0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8550430836",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-17T19:52:19Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8550542068,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH9pur0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8550542068",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-17T20:09:34Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8583162167,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAH_mKk3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8583162167",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-22T16:52:13Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGIzMjQyZTIxYjQwNzEwYWRiYTY1N2FiOGU0MDg1ZmY4MTY0YmZhMDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b3242e21b40710adba657ab8e4085ff8164bfa07",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b3242e21b40710adba657ab8e4085ff8164bfa07",
      "tree": {
        "sha": "266a2ee919f16298721b1843630163e09ac9527b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/266a2ee919f16298721b1843630163e09ac9527b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/30874a7cc9e8ae92f5ee342b5457faf265af1415",
          "sha": "30874a7cc9e8ae92f5ee342b5457faf265af1415",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/30874a7cc9e8ae92f5ee342b5457faf265af1415"
        }
      ],
      "message": "test: make ECKey more easily constructable",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-22T17:59:37Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-01-07T14:40:14Z"
      },
      "sha": "b3242e21b40710adba657ab8e4085ff8164bfa07"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ2ODUyMTkzMWIxYmExOGQwMjg0NTE5YTFkM2JiZjI0YzkwNTFmYjM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d68521931b1ba18d0284519a1d3bbf24c9051fb3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d68521931b1ba18d0284519a1d3bbf24c9051fb3",
      "tree": {
        "sha": "f954b98313b73ff54625d5ad13ab9a9534010b42",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f954b98313b73ff54625d5ad13ab9a9534010b42"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b3242e21b40710adba657ab8e4085ff8164bfa07",
          "sha": "b3242e21b40710adba657ab8e4085ff8164bfa07",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b3242e21b40710adba657ab8e4085ff8164bfa07"
        }
      ],
      "message": "consensus: deferred check framework\n\nImplements a framework for accumulated \"deferred checks\" during vin\nscript execution, and then executing the checks after all inputs have\nbeen validated individually.\n\nThis facilitates new forms of validation which involve gathering\ninformation during vin script execution and then using that information\nto do \"aggregate\" checks on the transaction as a whole.\n\nFor vaults in particular, this allows us to conjoin operations across\nvaults with incompatible parameters into the same transaction, as well\nas include unrelated inputs and outputs, which facilitates more flexible\nfee management.\n\nThere are also applications re: batch validation and cross-input\nsignature aggregation.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-22T17:59:37Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-01-27T20:37:48Z"
      },
      "sha": "d68521931b1ba18d0284519a1d3bbf24c9051fb3"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg1NzE1ZmJhNDRmOTkyYTFmOTRmOTZiN2U4ODNjZmM0MWUwN2Y4OWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/85715fba44f992a1f94f96b7e883cfc41e07f89d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/85715fba44f992a1f94f96b7e883cfc41e07f89d",
      "tree": {
        "sha": "3ddaf59fa93bb4c42f033700b8f80d17be71d616",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3ddaf59fa93bb4c42f033700b8f80d17be71d616"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d68521931b1ba18d0284519a1d3bbf24c9051fb3",
          "sha": "d68521931b1ba18d0284519a1d3bbf24c9051fb3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d68521931b1ba18d0284519a1d3bbf24c9051fb3"
        }
      ],
      "message": "consensus: add OP_VAULT deployment parameters",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-22T17:59:37Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-03T20:29:40Z"
      },
      "sha": "85715fba44f992a1f94f96b7e883cfc41e07f89d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYyNGNmMjYxNzQzNzk0N2M4ZDY5MWM0OWEwZTY2NDc4YjUwNmIxYmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f24cf2617437947c8d691c49a0e66478b506b1bb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f24cf2617437947c8d691c49a0e66478b506b1bb",
      "tree": {
        "sha": "a01690db9ca721364c5a583ff5a53c7db17d320b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a01690db9ca721364c5a583ff5a53c7db17d320b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/85715fba44f992a1f94f96b7e883cfc41e07f89d",
          "sha": "85715fba44f992a1f94f96b7e883cfc41e07f89d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/85715fba44f992a1f94f96b7e883cfc41e07f89d"
        }
      ],
      "message": "consensus: implement OP_VAULT and OP_UNVAULT\n\nOP_VAULT adds a native way of doing vaults - that is, encumbering coins\nin such a way that they must pass through a delay period before being\nsuccessfully spent, aside from a predetermined path (the recovery\npath) which they can be swept to at any time during the life of the\nvault.\n\nVaulting\n========\n\nTo create a vault, coins must be encumbered under a scriptPubKey that\nlooks like\n\n  <recovery-params> <spend-delay> <trigger-sPK-hash> OP_VAULT\n\nOf course, this can be within a P2TR taptree.\n\n<recovery-params>\n-----------------\n\nThe `recovery-params` paramater is of the form\n\n  <32-byte-hash>[<arbitrary scriptPubKey>]\n\nwhere the first component is the hash of the recovery path scriptPubKey:\ni.e. the scriptPubKey which the full value of recovered vaults must be\nspent to in order to successfully sweep the coins from a vault.\n\nThe optional bytes following the recovery path hash dictate the optional\nrecovery authorization. When this is specified, the script given must be\nsatisfied when sweeping the vaulted inputs to recovery. Using this\nparameter has benefits and drawbacks. The benefits are\n\n  - unrelated inputs and outputs can be attached to a recovery, making\n    \"exogenous\" fee management like ephemeral anchor use unneccessary.\n\n  - vaults with incompatible recovery parameters can be recovered in the\n    same transaction, which allows fee managed UTXOs to be shared.\n\nhowever the drawbacks are\n\n  - increased risk/complexity around the ability to perform recovery\n    sweeps.\n\n  - if an attacker obtains the recovery authorization key and all\n    information necesary to attempt a recovery (the \"location\" of the\n    vaulted coins) as well as the trigger authorization key, they may\n    attempt to both trigger an unvault and pin a recovery. This is\n    mitigated by the necessary presence of an ephemeral anchor output\n    in every recovery transaction.\n\nIn either case, any vault outputs which share <recovery-params> can be\nrecovered together in the same transaction.\n\n<spend-delay>\n-------------\n\nThis is a relative timelock a la BIP-68 that specifies how many blocks\n(or how much time) must elapse before an OP_UNVAULT output becomes\nspendable to the declared unvault target (more on this below).\n\nVaults with compatible <recovery-params> and <spend-delay> can be\nunvaulted together.\n\n<trigger-sPK-hash>\n------------------\n\nThis is the hash of the scriptPubKey which needs to be satisfied in\norder to trigger the unvault process.\n\nOP_UNVAULT\n==========\n\nTo trigger the start of the unvault process, vaulted outputs must be\nspent into a transaction which has a corresponding OP_UNVAULT output of\nthe form\n\n  <recovery-params> <spend-delay> <target-hash> OP_UNVAULT\n\nwhere the first two parameters are identical to the input vault and the\nlast parameter, <target-hash>, is a content hash of the proposed unvault\ndestination. It is a hash of each target output's scriptPubKey and\namount.\n\nBecause triggers are always signed with the trigger authorization key,\nthese transaction can be always be accompanied by unrelated inputs and\noutputs, e.g. fee management coins or multiple incompatible vaults.\n\nTriggers support a special \"revault\" output, which allows depositing\nsome balance of the vault back into the OP_VAULT scriptPubKey that is\nbeing withdrawn from.\n\nWhen spending an OP_VAULT into an OP_UNVAULT trigger output, the witness\nstack must look like\n\n  [trigger witness stack ...] <trigger-sPK> <target-hash> <trigger-vout_idx>\n\nThe first two parameters are evaluated recursively as script. The\n<trigger-vout-idx> parameter indicates which vout is the related\nOP_UNVAULT, which allows us to handle script upgradeability for future\nwitness versions.\n\nFinal withdrawal\n================\n\nOnce an OP_UNVAULT output has been confirmed and the related\n<spend-delay> has elapsed, the output can be spent into a transaction\nmatching the <target-hash> given in the trigger transaction. This final\nwithdrawal transaction will be responsible for providing its own fees in\nwhatever manner the withdrawer prefers.\n\nRecovery\n========\n\nAt any point before final withdrawal, OP_VAULT or OP_UNVAULT outputs can\nbe swept to the recovery path.\n\nIf no optional recovery authorization is used, all inputs to the\nrecovery transaction must be from recovery-compatible vault outputs.\nThere can only be two outputs: one transferring the full value of the\nvault inputs to the recovery sPK, and one ephemeral anchor output.\n\nIf an optional recovery authorization has bene specified, the recovery\ntransaction can be more freeform. The only requirements are that the\nfull value of any vault inputs are transferred to a compatible recovery\nsPK output, and there must be at least one ephemeral anchor output. But\nunrelated inputs/outputs can \"ride along\" or provide fees, and otherwise\nrecovery-incompatible vaults can be recovered together.\n\n[NOTE TODO: this has yet to be implemented, but is planned]\n\nOther notes\n===========\n\nUse of OP_VAULT is restricted to witness v1 and up (Taproot).\n\nCredit\n======\n\nThanks to Greg Sanders, AJ Towns, and John Moffett for material\nsuggestions and review that wound up improving this proposal.\n\n- AJ: make recovery authorization optional, revault trigger outputs\n- Greg: put trigger-hash onto witness stack to avoid bare OP_UNVAULT\n- John Moffett: explicating recursive eval attack and providing a test\n  case.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-22T18:05:09Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-03T20:51:54Z"
      },
      "sha": "f24cf2617437947c8d691c49a0e66478b506b1bb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGE0NWI5MGVjMGM5OTc1MmQyNTAzNDg5Yjg1ZDRlYWMxZjhkMWI3MWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a45b90ec0c99752d2503489b85d4eac1f8d1b71e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a45b90ec0c99752d2503489b85d4eac1f8d1b71e",
      "tree": {
        "sha": "c27e1a6e4e6004dfc8a33f9866dfd90026449aba",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c27e1a6e4e6004dfc8a33f9866dfd90026449aba"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f24cf2617437947c8d691c49a0e66478b506b1bb",
          "sha": "f24cf2617437947c8d691c49a0e66478b506b1bb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f24cf2617437947c8d691c49a0e66478b506b1bb"
        }
      ],
      "message": "test: make TaprootInfo hashable",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-22T18:05:23Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-01-29T19:19:20Z"
      },
      "sha": "a45b90ec0c99752d2503489b85d4eac1f8d1b71e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFhNGYyYTU4ZTNiMDIwMzk3OTYzMjNiYTJmYWM0MzIzZDVmOGJjYzI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/aa4f2a58e3b02039796323ba2fac4323d5f8bcc2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/aa4f2a58e3b02039796323ba2fac4323d5f8bcc2",
      "tree": {
        "sha": "ed111598c51ff1ac3cc9167dfd2082070cf01c0c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ed111598c51ff1ac3cc9167dfd2082070cf01c0c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a45b90ec0c99752d2503489b85d4eac1f8d1b71e",
          "sha": "a45b90ec0c99752d2503489b85d4eac1f8d1b71e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a45b90ec0c99752d2503489b85d4eac1f8d1b71e"
        }
      ],
      "message": "test: add pprint_tx",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-22T18:05:23Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-01-29T19:19:36Z"
      },
      "sha": "aa4f2a58e3b02039796323ba2fac4323d5f8bcc2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDgxZGM4NDc1MDg2MmNlMzA2ZjEyZGI3MGUwZjdiNTlkNjA3OWFiNGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/81dc84750862ce306f12db70e0f7b59d6079ab4b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/81dc84750862ce306f12db70e0f7b59d6079ab4b",
      "tree": {
        "sha": "3da4299e245bfc903b745f1da6896a4e4030439b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3da4299e245bfc903b745f1da6896a4e4030439b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/aa4f2a58e3b02039796323ba2fac4323d5f8bcc2",
          "sha": "aa4f2a58e3b02039796323ba2fac4323d5f8bcc2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/aa4f2a58e3b02039796323ba2fac4323d5f8bcc2"
        }
      ],
      "message": "test: add MiniWallet.get_utxo_as_txin",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-22T18:05:23Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-03T21:19:21Z"
      },
      "sha": "81dc84750862ce306f12db70e0f7b59d6079ab4b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI5Nzk4YTM3NWExMTFkNTEzMWFhMzA4M2FiNzJhOGIxYzRmZDljNGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/29798a375a111d5131aa3083ab72a8b1c4fd9c4b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/29798a375a111d5131aa3083ab72a8b1c4fd9c4b",
      "tree": {
        "sha": "144d8981719f721842fd1ed314531522ae0e6397",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/144d8981719f721842fd1ed314531522ae0e6397"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/81dc84750862ce306f12db70e0f7b59d6079ab4b",
          "sha": "81dc84750862ce306f12db70e0f7b59d6079ab4b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/81dc84750862ce306f12db70e0f7b59d6079ab4b"
        }
      ],
      "message": "test: add OP_VAULT functional tests",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-22T18:05:23Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-03T21:19:53Z"
      },
      "sha": "29798a375a111d5131aa3083ab72a8b1c4fd9c4b"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8592330873,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAIAJJB5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8592330873",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-23T14:24:43Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8593462005,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAIANdL1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8593462005",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-23T16:07:28Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8593569331,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAIAN3Yz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8593569331",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-23T16:17:52Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhlYWNjMjVhMDZkZTY0MTk2M2QwNjE2ZjFiNjU5YjAwMjRmZWVlZDk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8eacc25a06de641963d0616f1b659b0024feeed9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8eacc25a06de641963d0616f1b659b0024feeed9",
      "tree": {
        "sha": "5ce7c85231eb36ff850c2ef6e813fc1990fb0d2e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5ce7c85231eb36ff850c2ef6e813fc1990fb0d2e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/29798a375a111d5131aa3083ab72a8b1c4fd9c4b",
          "sha": "29798a375a111d5131aa3083ab72a8b1c4fd9c4b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/29798a375a111d5131aa3083ab72a8b1c4fd9c4b"
        }
      ],
      "message": "fixup! deferred checks build fix",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-24T20:55:25Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2023-02-23T14:24:28Z"
      },
      "sha": "8eacc25a06de641963d0616f1b659b0024feeed9"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8605622169,
      "node_id": "HRFPE_lADOABII585a8wAszwAAAAIA71-Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8605622169",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-24T20:55:48Z"
    },
    {
      "event": "labeled",
      "id": 8691787130,
      "node_id": "LE_lADOABII585a8wAszwAAAAIGEiV6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8691787130",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-08T00:30:48Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1459081334,
      "node_id": "IC_kwDOABII585W99B2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1459081334",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-08T00:30:49Z",
      "updated_at": "2023-03-08T00:30:49Z",
      "author_association": "MEMBER",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#issuecomment-1459081334",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857"
    },
    {
      "event": "commented",
      "id": 1478200900,
      "node_id": "IC_kwDOABII585YG45E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1478200900",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T16:41:32Z",
      "updated_at": "2023-03-21T16:41:32Z",
      "author_association": "MEMBER",
      "body": "Closing this until the BIP is finalized and this has been tested on inquisition (https://github.com/bitcoin-inquisition/bitcoin/pull/21).",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#issuecomment-1478200900",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857"
    },
    {
      "event": "closed",
      "id": 8807991488,
      "node_id": "CE_lADOABII585a8wAszwAAAAIM_0jA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8807991488",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T16:41:33Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071570474",
      "pull_request_review_id": 1250651157,
      "id": 1071570474,
      "node_id": "PRRC_kwDOABII584_3t4q",
      "diff_hunk": "@@ -1781,6 +2096,132 @@ bool GenericTransactionSignatureChecker<T>::CheckSequence(const CScriptNum& nSeq\n     return true;\n }\n \n+//! Check that\n+//!\n+//!   1. The number of outputs is either 1 or 2.\n+//!   2. The total value of the vault is preserved.\n+//!   3. If there is a second output, it is a 0-value ephemeral anchor output.\n+//!   4. The recovery scriptPubKey is as expected.\n+template <class T>\n+bool GenericTransactionSignatureChecker<T>::CheckVaultSpendToRecoveryOutputs(\n+    const uint256& recovery_spk_hash) const\n+{\n+    if (!this->txdata) return HandleMissingData(m_mdb);\n+    const auto& txd{*this->txdata};\n+    const auto& vout = this->txTo->vout;\n+\n+    const auto num_outs = vout.size();\n+    if (num_outs < 1 || num_outs > 2) {\n+        return false;\n+    }\n+\n+    const CTxOut& value_out = vout[0];\n+    if (value_out.nValue != txd.m_total_in) {\n+        return false;\n+    }\n+\n+    // Ensure the second output, if one exists, is a 0-value ephemeral anchor.\n+    if (num_outs == 2 && !IsOutputEphemeralAnchor(vout[1])) {\n+        return false;\n+    }\n+\n+    return (VaultScriptHash(HASHER_VAULT_RECOVERY_SPK, value_out.scriptPubKey) ==\n+            recovery_spk_hash);\n+}\n+\n+\n+//! Return true if the given output is a 0-value anchor output.\n+static bool IsOutputEphemeralAnchor(const CTxOut& out)\n+{\n+    if (out.nValue != 0) {\n+        return false;\n+    }\n+    const CScript& spk = out.scriptPubKey;\n+    if (!(spk.size() == 1 && spk[0] == OP_2)) {",
      "path": "src/script/interpreter.cpp",
      "position": null,
      "original_position": 401,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a8323b9cea602f4af8206f86c0193d189b721904",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In fbf344931a2224dc3ace0011c1a4cb5cd4187f3e \"wip: draft implementation\"\r\n\r\nOP_2?",
      "created_at": "2023-01-16T20:46:16Z",
      "updated_at": "2023-01-16T21:38:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1071570474",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071570474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071577974",
      "pull_request_review_id": 1250651157,
      "id": 1071577974,
      "node_id": "PRRC_kwDOABII584_3vt2",
      "diff_hunk": "@@ -1213,6 +1342,185 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                 }\n                 break;\n \n+                case OP_VAULT:\n+                {\n+                    // only available post-segwit\n+                    if (sigversion == SigVersion::BASE) return set_error(serror, SCRIPT_ERR_BAD_OPCODE);\n+\n+                    // <recovery-spk-hash> <spend-delay> <trigger-spk-hash>\n+                    if (stack.size() < 3) return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+\n+                    valtype& hash_from_stack = stacktop(-3);\n+                    if (hash_from_stack.size() != 32) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+                    const uint256 recovery_spk_hash{hash_from_stack};\n+\n+                    // `spend-delay` is a CScriptNum, up to 4 bytes, that is interpreted\n+                    // in the same way as the first 23 bits of nSequence are per\n+                    // BIP 68 (relative time-locks). This enables users of vaults to\n+                    // express spend delays in either wall time or block count, and reuse\n+                    // the same machinery as OP_CHECKSEQUENCEVERIFY.\n+                    const CScriptNum spend_delay(stacktop(-2), fRequireMinimal);\n+\n+                    hash_from_stack = stacktop(-1);\n+                    if (hash_from_stack.size() != 32) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+                    const uint256 expected_trigger_spk_hash{hash_from_stack};\n+\n+                    popstack(stack);\n+                    popstack(stack);\n+                    popstack(stack);\n+\n+                    // Case 1: sweep to recovery\n+                    if (checker.CheckVaultSpendToRecoveryOutputs(recovery_spk_hash)) {\n+                        stack.push_back(vchTrue);\n+                        break;\n+                    }\n+\n+                    // Case 2: spend to compatible OP_UNVAULT\n+\n+                    // [trigger witness stack ...] <trigger-spk> [prev stack items]\n+                    if (stack.size() < 2) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+\n+                    CScript unvault_output_spk;\n+\n+                    if (!checker.CheckUnvaultTriggerOutputsCommon(\n+                            recovery_spk_hash,\n+                            spend_delay,\n+                            fRequireMinimal,\n+                            unvault_output_spk)) {\n+                        return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n+                    }\n+                    assert(unvault_output_spk.size() > 0);\n+\n+                    // Determine the type of the proposed OP_UNVAULT script.\n+                    // If it lives behind a scripthash, we will have to construct\n+                    // a specific expected scriptPubKey and compare to that. Otherwise\n+                    // we'll analyze its prefix as a bare script.\n+                    int opuv_witversion;\n+                    valtype opuv_witprogram;\n+                    const bool is_unvault_output_wit =\n+                        unvault_output_spk.IsWitnessProgram(opuv_witversion, opuv_witprogram);\n+\n+                    if (!is_unvault_output_wit) {\n+                        // Validate the OP_UNVAULT output as a bare script.\n+                        if (!CheckUnvaultTriggerOutputsBare(\n+                                unvault_output_spk,\n+                                recovery_spk_hash, spend_delay, fRequireMinimal)) {\n+                            return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n+                        }\n+                    } else {\n+                        // We now expect an additional item on the stack, <target-hash>,\n+                        // which is used to validate the proposed OP_UNVAULT witness\n+                        // output sPK - which hides the actual OP_UNVAULT script behind a\n+                        // scripthash.\n+                        if (stack.size() < 3) {\n+                            return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                        }\n+                        valtype& hash_from_stack = stacktop(-1);\n+                        if (hash_from_stack.size() != 32) {\n+                            return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                        }\n+                        const uint256 target_hash{hash_from_stack};\n+                        popstack(stack);\n+\n+                        if (!CheckUnvaultTriggerOutputsWitness(\n+                                opuv_witversion, opuv_witprogram,\n+                                recovery_spk_hash, spend_delay, target_hash,\n+                                fRequireMinimal, flags, serror)) {\n+                            return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n+                        }\n+                    }\n+\n+                    // Now that we have verified the structure of the outputs, verify\n+                    // the signature authorizing the beginning of the unvault.\n+                    //\n+                    // Check that a valid trigger signature has been put on the witness\n+                    // stack.\n+                    const valtype& trigger_witness_program = stacktop(-1);\n+                    auto trigger_witness_spk = CScript(\n+                        trigger_witness_program.begin(), trigger_witness_program.end());\n+\n+                    const uint256 trigger_spk_hash = VaultScriptHash(\n+                            HASHER_VAULT_UNVAULT_SPK, trigger_witness_spk);\n+\n+                    if (trigger_spk_hash != expected_trigger_spk_hash) {\n+                        return set_error(serror, SCRIPT_ERR_VAULT_WRONG_TRIGGER_WITNESS_PROGRAM);\n+                    }\n+                    popstack(stack);\n+                    // Everything remaining on the stack is the witness stack\n+                    // to be fed into the witness program above.\n+\n+                    CScriptWitness witness;\n+                    witness.stack = stack;\n+                    int witnessversion;\n+                    std::vector<unsigned char> witnessprogram;\n+\n+                    if (!trigger_witness_spk.IsWitnessProgram(witnessversion, witnessprogram)) {\n+                        return set_error(serror, SCRIPT_ERR_VAULT_INVALID_TRIGGER_WITNESS_PROGRAM);\n+                    }\n+                    // Note that this will recursively call EvalScript. We could get\n+                    // into a further recursion if OP_VAULT spends are included in the\n+                    // trigger witness program; the recursion depth is limited\n+                    // solely by script size constraints.\n+                    //\n+                    // TODO: think more about whether to limit recursive OP_VAULT\n+                    // evaluations in trigger witness programs.",
      "path": "src/script/interpreter.cpp",
      "position": null,
      "original_position": 287,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a8323b9cea602f4af8206f86c0193d189b721904",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In fbf344931a2224dc3ace0011c1a4cb5cd4187f3e \"wip: draft implementation\"\r\n\r\nI think it makes sense to disallow recursive OP_VAULTs in the OP_VAULT trigger script (? this was called unvault script in the paper). They necessarily have to have the same recovery spk hash and delay as the top level OP_VAULT, and at the end, would have some witness script which is what we actually care about at this point. So really all that would do is waste resources.",
      "created_at": "2023-01-16T21:03:41Z",
      "updated_at": "2023-01-16T21:38:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1071577974",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071577974"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": 1471,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071580298",
      "pull_request_review_id": 1250651157,
      "id": 1071580298,
      "node_id": "PRRC_kwDOABII584_3wSK",
      "diff_hunk": "@@ -1781,6 +1910,136 @@ bool GenericTransactionSignatureChecker<T>::CheckSequence(const CScriptNum& nSeq\n     return true;\n }\n \n+template <class T>\n+bool GenericTransactionSignatureChecker<T>::CheckVaultSpendToRecoveryOutputs(\n+    const uint256& recovery_spk_hash) const\n+{\n+    if (!this->txdata) return HandleMissingData(m_mdb);\n+    const auto& txd{*this->txdata};\n+\n+    if (!CommonVaultSpendChecks(txd, this->txTo->vout)) {\n+        return false;\n+    }\n+    const CTxOut& value_out = this->txTo->vout[0];\n+\n+    return (VaultScriptHash(HASHER_VAULT_RECOVERY_SPK, value_out.scriptPubKey) ==\n+            recovery_spk_hash);\n+}\n+\n+template <class T>\n+bool GenericTransactionSignatureChecker<T>::CheckUnvaultTriggerOutputs(\n+    const uint256& recovery_spk_hash,\n+    const CScriptNum& spend_delay,\n+    bool require_minimal) const\n+{\n+    if (!this->txdata) return HandleMissingData(m_mdb);\n+    const auto& txd{*this->txdata};\n+\n+    if (!CommonVaultSpendChecks(txd, this->txTo->vout)) {\n+        return false;\n+    }\n+    const CTxOut& value_out = this->txTo->vout[0];\n+    const CScript& value_spk = value_out.scriptPubKey;\n+\n+    auto pc = value_spk.begin();\n+    valtype pushdata;\n+    opcodetype opcode;\n+\n+    // Check for 32 bytes of recovery-spk-hash.\n+    if (!value_spk.GetOp(pc, opcode, pushdata) || opcode != 0x20) {\n+        return false;\n+    }\n+    uint256 proposed_recovery_spk_hash{pushdata};\n+\n+    if (proposed_recovery_spk_hash != recovery_spk_hash) {\n+        return false;\n+    }\n+\n+    // Check for spend-delay; must be between 1 and 4 bytes.\n+    if (!value_spk.GetOp(pc, opcode, pushdata)) {\n+        return false;\n+    }\n+    CScriptNum proposed_spend_delay{0};\n+\n+    // TODO: this is ugly, but basically we have to replicate EvalScript's parsing\n+    // of numbers here. If the number is between [1, 16], it will be OP_[n], but\n+    // if it's larger it's encoded as pushdata.\n+    if (opcode >= OP_1 && opcode <= OP_16) {\n+        proposed_spend_delay = (int)opcode - (int)(OP_1 - 1);\n+    } else {\n+        if (pushdata.size() < 1 || pushdata.size() > CScriptNum::nDefaultMaxNumSize) {\n+            return false;\n+        }\n+        proposed_spend_delay = CScriptNum(pushdata, require_minimal);\n+    }\n+\n+    if (proposed_spend_delay != spend_delay) {\n+        return false;\n+    }\n+\n+    // Check for target-hash; we don't care what it is as long as it's 32 bytes.\n+    if (!value_spk.GetOp(pc, opcode) || opcode != 0x20) {\n+        return false;\n+    }\n+\n+    // Finally, check that OP_UNVAULT is the last opcode.\n+    if (!value_spk.GetOp(pc, opcode) || opcode != OP_UNVAULT || pc != value_spk.end()) {\n+        return false;\n+    }\n+\n+    return true;\n+}\n+\n+template <class T>\n+bool GenericTransactionSignatureChecker<T>::CheckUnvaultTarget(\n+    const uint256& target_outputs_hash) const\n+{\n+    // We can't use precomputed transaction data here because, since the input lacks a\n+    // witness, the precomputation routines don't run. I.e. `txdata.hashOutputs` is blank.\n+    return SHA256Uint256(GetOutputsSHA256(*this->txTo)) == target_outputs_hash;",
      "path": "src/script/interpreter.cpp",
      "position": 438,
      "original_position": 251,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "fbf344931a2224dc3ace0011c1a4cb5cd4187f3e",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In fbf344931a2224dc3ace0011c1a4cb5cd4187f3e \"wip: draft implementation\"\r\n\r\nNote that this is a different serialization from the one described in the paper. The paper says to serialize the scriptPubKey first, then nValue. However `GetOutputsSHA256` serializes each output as nValue then scriptPubKey. I'm going to assume this is an error in the paper as I think it is better the way it is implemented rather than described.",
      "created_at": "2023-01-16T21:09:44Z",
      "updated_at": "2023-01-16T21:38:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1071580298",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071580298"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2178,
      "original_line": 2178,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071585163",
      "pull_request_review_id": 1250651157,
      "id": 1071585163,
      "node_id": "PRRC_kwDOABII584_3xeL",
      "diff_hunk": "@@ -1267,12 +1385,62 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     if (stack.size() < 2) {\n                         return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n                     }\n-                    if (!checker.CheckUnvaultTriggerOutputs(\n-                            recovery_spk_hash, spend_delay, fRequireMinimal)) {\n+\n+                    CScript unvault_output_spk;\n+\n+                    if (!checker.CheckUnvaultTriggerOutputsCommon(\n+                            recovery_spk_hash,\n+                            spend_delay,\n+                            fRequireMinimal,\n+                            unvault_output_spk)) {\n                         return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n                     }\n+                    assert(unvault_output_spk.size() > 0);\n+\n+                    // Determine the type of the proposed OP_UNVAULT script.\n+                    // If it lives behind a scripthash, we will have to construct\n+                    // a specific expected scriptPubKey and compare to that. Otherwise\n+                    // we'll analyze its prefix as a bare script.\n+                    int opuv_witversion;\n+                    valtype opuv_witprogram;\n+                    const bool is_unvault_output_wit =\n+                        unvault_output_spk.IsWitnessProgram(opuv_witversion, opuv_witprogram);\n+\n+                    if (!is_unvault_output_wit) {\n+                        // Validate the OP_UNVAULT output as a bare script.\n+                        if (!CheckUnvaultTriggerOutputsBare(\n+                                unvault_output_spk,\n+                                recovery_spk_hash, spend_delay, fRequireMinimal)) {\n+                            return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n+                        }",
      "path": "src/script/interpreter.cpp",
      "position": null,
      "original_position": 165,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a9db7392bf9d4d69d5a7a91db32dda7bd50479d8",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In a9db7392bf9d4d69d5a7a91db32dda7bd50479d8 \"consensus: allow OP_UNVAULT outputs to be behind scripthash\"\r\n\r\nIs it useful to allow OP_UNVAULT as a bare script? ISTM it would be simpler to just require that the the unvault script must be one of P2WSH or P2TR. It's not clear to me that it's actually useful to allow it as a bare script, especially since that requires further policy changes to allow such transactions to even be relayed.",
      "created_at": "2023-01-16T21:22:14Z",
      "updated_at": "2023-01-16T21:38:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1071585163",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071585163"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": 1409,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1434,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071588874",
      "pull_request_review_id": 1250651157,
      "id": 1071588874,
      "node_id": "PRRC_kwDOABII584_3yYK",
      "diff_hunk": "@@ -2137,11 +2166,49 @@ bool GenericTransactionSignatureChecker<T>::CheckUnvaultTriggerOutputsCommon(\n     if (!this->txdata) return HandleMissingData(m_mdb);\n     const auto& txd{*this->txdata};\n \n-    if (!CommonVaultSpendChecks(txd, this->txTo->vout)) {\n+    const auto num_outs = this->txTo->vout.size();\n+    if (num_outs < 1 || num_outs > 3) {\n         return false;\n     }\n \n-    unvault_output_spk = this->txTo->vout[0].scriptPubKey;\n+    CAmount total_val_out_to_vaults{0};\n+\n+    assert(txd.m_spent_outputs_ready);\n+    const CScript& vault_spk = txd.m_spent_outputs[this->nIn].scriptPubKey;\n+\n+    bool has_ea{false};\n+    bool has_revault{false};\n+\n+    // Verify that all optional outputs are either an ephemeral anchor or a revault.\n+    // Permit the optional outputs to appear in any order.",
      "path": "src/script/interpreter.cpp",
      "position": null,
      "original_position": 85,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "c00dad503d7dfa990afd24c9fde2555482cc247b",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In c00dad503d7dfa990afd24c9fde2555482cc247b \"consensus: allow one revault output during unvault\"\r\n\r\nI don't see why the OP_UNVAULT output has to be the 0th output if the optional ones can be in any order.",
      "created_at": "2023-01-16T21:31:07Z",
      "updated_at": "2023-01-16T21:38:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1071588874",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071588874"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": 2182,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2160,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081533018",
      "pull_request_review_id": 1262159625,
      "id": 1081533018,
      "node_id": "PRRC_kwDOABII585AduJa",
      "diff_hunk": "@@ -1267,12 +1385,62 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     if (stack.size() < 2) {\n                         return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n                     }\n-                    if (!checker.CheckUnvaultTriggerOutputs(\n-                            recovery_spk_hash, spend_delay, fRequireMinimal)) {\n+\n+                    CScript unvault_output_spk;\n+\n+                    if (!checker.CheckUnvaultTriggerOutputsCommon(\n+                            recovery_spk_hash,\n+                            spend_delay,\n+                            fRequireMinimal,\n+                            unvault_output_spk)) {\n                         return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n                     }\n+                    assert(unvault_output_spk.size() > 0);\n+\n+                    // Determine the type of the proposed OP_UNVAULT script.\n+                    // If it lives behind a scripthash, we will have to construct\n+                    // a specific expected scriptPubKey and compare to that. Otherwise\n+                    // we'll analyze its prefix as a bare script.\n+                    int opuv_witversion;\n+                    valtype opuv_witprogram;\n+                    const bool is_unvault_output_wit =\n+                        unvault_output_spk.IsWitnessProgram(opuv_witversion, opuv_witprogram);\n+\n+                    if (!is_unvault_output_wit) {\n+                        // Validate the OP_UNVAULT output as a bare script.\n+                        if (!CheckUnvaultTriggerOutputsBare(\n+                                unvault_output_spk,\n+                                recovery_spk_hash, spend_delay, fRequireMinimal)) {\n+                            return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n+                        }",
      "path": "src/script/interpreter.cpp",
      "position": null,
      "original_position": 165,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a9db7392bf9d4d69d5a7a91db32dda7bd50479d8",
      "in_reply_to_id": 1071585163,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah, this is a good point. I think I'll remove this.",
      "created_at": "2023-01-19T16:36:43Z",
      "updated_at": "2023-01-19T16:36:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1081533018",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081533018"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": 1409,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1434,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081688225",
      "pull_request_review_id": 1262415312,
      "id": 1081688225,
      "node_id": "PRRC_kwDOABII585AeUCh",
      "diff_hunk": "@@ -1781,6 +2096,132 @@ bool GenericTransactionSignatureChecker<T>::CheckSequence(const CScriptNum& nSeq\n     return true;\n }\n \n+//! Check that\n+//!\n+//!   1. The number of outputs is either 1 or 2.\n+//!   2. The total value of the vault is preserved.\n+//!   3. If there is a second output, it is a 0-value ephemeral anchor output.\n+//!   4. The recovery scriptPubKey is as expected.\n+template <class T>\n+bool GenericTransactionSignatureChecker<T>::CheckVaultSpendToRecoveryOutputs(\n+    const uint256& recovery_spk_hash) const\n+{\n+    if (!this->txdata) return HandleMissingData(m_mdb);\n+    const auto& txd{*this->txdata};\n+    const auto& vout = this->txTo->vout;\n+\n+    const auto num_outs = vout.size();\n+    if (num_outs < 1 || num_outs > 2) {\n+        return false;\n+    }\n+\n+    const CTxOut& value_out = vout[0];\n+    if (value_out.nValue != txd.m_total_in) {\n+        return false;\n+    }\n+\n+    // Ensure the second output, if one exists, is a 0-value ephemeral anchor.\n+    if (num_outs == 2 && !IsOutputEphemeralAnchor(vout[1])) {\n+        return false;\n+    }\n+\n+    return (VaultScriptHash(HASHER_VAULT_RECOVERY_SPK, value_out.scriptPubKey) ==\n+            recovery_spk_hash);\n+}\n+\n+\n+//! Return true if the given output is a 0-value anchor output.\n+static bool IsOutputEphemeralAnchor(const CTxOut& out)\n+{\n+    if (out.nValue != 0) {\n+        return false;\n+    }\n+    const CScript& spk = out.scriptPubKey;\n+    if (!(spk.size() == 1 && spk[0] == OP_2)) {",
      "path": "src/script/interpreter.cpp",
      "position": null,
      "original_position": 401,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a8323b9cea602f4af8206f86c0193d189b721904",
      "in_reply_to_id": 1071570474,
      "user": {
        "login": "john-moffett",
        "id": 116917595,
        "node_id": "U_kgDOBvgFWw",
        "avatar_url": "https://avatars.githubusercontent.com/u/116917595?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/john-moffett",
        "html_url": "https://github.com/john-moffett",
        "followers_url": "https://api.github.com/users/john-moffett/followers",
        "following_url": "https://api.github.com/users/john-moffett/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/john-moffett/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/john-moffett/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/john-moffett/subscriptions",
        "organizations_url": "https://api.github.com/users/john-moffett/orgs",
        "repos_url": "https://api.github.com/users/john-moffett/repos",
        "events_url": "https://api.github.com/users/john-moffett/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/john-moffett/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I believe that's what the current ephemeral anchors draft PR uses:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/04778d12898e226c0818b3317ac83cddd8348777/src/script/script.cpp#L201-L204",
      "created_at": "2023-01-19T18:52:45Z",
      "updated_at": "2023-01-19T18:52:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1081688225",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081688225"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096477805",
      "pull_request_review_id": 1284012870,
      "id": 1096477805,
      "node_id": "PRRC_kwDOABII585BWuxt",
      "diff_hunk": "@@ -122,10 +136,28 @@ class CCheckQueue\n                 fOk = fAllOk;\n             }\n             // execute work\n-            for (T& check : vChecks)\n-                if (fOk)\n+            for (T& check : vChecks) {\n+                if (fOk) {\n                     fOk = check();\n+\n+                    if (fOk && check.m_deferred_checks && check.m_deferred_checks->size() > 0) {\n+                        auto& dc = *check.m_deferred_checks;\n+                        results.insert(\n+                            results.end(),\n+                            std::make_move_iterator(dc.begin()),\n+                            std::make_move_iterator(dc.end()));\n+                    }",
      "path": "src/checkqueue.h",
      "position": 97,
      "original_position": 92,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a3ad8ecf96808a75431d98227fcb42d19d029606",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```c++\r\ntemplate<typename T1, typename T2>\r\nvoid move_to_end(T1& dest, T2& src)\r\n{\r\n    dest.insert(\r\n        dest.end(), \r\n        std::make_move_iterator(src.begin()),\r\n        std::make_move_iterator(src.end()));\r\n}\r\n\r\nmove_to_end(results, *check.m_deferred_checks);\r\n```\r\n?",
      "created_at": "2023-02-04T04:07:30Z",
      "updated_at": "2023-02-04T09:58:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1096477805",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096477805"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 154,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096478197",
      "pull_request_review_id": 1284012870,
      "id": 1096478197,
      "node_id": "PRRC_kwDOABII585BWu31",
      "diff_hunk": "@@ -193,6 +193,29 @@ enum class SigVersion\n     TAPSCRIPT = 3,   //!< Witness v1 with 32-byte program, not BIP16 P2SH-wrapped, script path spending, leaf version 0xc0; see BIP 342\n };\n \n+\n+//! Data that is accumulated during the script verification of a single input and then\n+//! used to perform aggregate checks after all inputs have been run through\n+//! `VerifyScript()`.\n+//!\n+//! TODO I realize this is kind of a hacky polymorphic-union thing; if there's a nicer\n+//! way to do this, please someone let me know.",
      "path": "src/script/interpreter.h",
      "position": 69,
      "original_position": 10,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a3ad8ecf96808a75431d98227fcb42d19d029606",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`std::variant`?",
      "created_at": "2023-02-04T04:09:57Z",
      "updated_at": "2023-02-04T09:58:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1096478197",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096478197"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 247,
      "original_line": 247,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096480622",
      "pull_request_review_id": 1284012870,
      "id": 1096480622,
      "node_id": "PRRC_kwDOABII585BWvdu",
      "diff_hunk": "@@ -26,9 +28,12 @@ class CCheckQueueControl;\n   * the master is done adding work, it temporarily joins the worker pool\n   * as an N'th worker, until all jobs are done.\n   */\n-template <typename T>\n+template <typename T, typename R>\n class CCheckQueue\n {\n+public:\n+    using ChecksReturn = std::pair<bool, std::optional<std::vector<R>>>;",
      "path": "src/checkqueue.h",
      "position": 32,
      "original_position": 23,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a3ad8ecf96808a75431d98227fcb42d19d029606",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could just be a `std::optional<std::vector>` -- `nullopt` is false, empty vector is true, non-empty vector is conditionally true.",
      "created_at": "2023-02-04T04:35:02Z",
      "updated_at": "2023-02-04T09:58:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1096480622",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096480622"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 44,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096511595",
      "pull_request_review_id": 1284012870,
      "id": 1096511595,
      "node_id": "PRRC_kwDOABII585BW3Br",
      "diff_hunk": "@@ -193,6 +193,29 @@ enum class SigVersion\n     TAPSCRIPT = 3,   //!< Witness v1 with 32-byte program, not BIP16 P2SH-wrapped, script path spending, leaf version 0xc0; see BIP 342\n };\n \n+\n+//! Data that is accumulated during the script verification of a single input and then\n+//! used to perform aggregate checks after all inputs have been run through\n+//! `VerifyScript()`.\n+//!\n+//! TODO I realize this is kind of a hacky polymorphic-union thing; if there's a nicer\n+//! way to do this, please someone let me know.\n+struct DeferredCheck\n+{\n+    //! Set when script execution happens asynchronously so that we can associate\n+    //! deferred checks with their related transaction when a block's worth of\n+    //! script executions are performed in batch.\n+    const CTransaction* m_tx_to;",
      "path": "src/script/interpreter.h",
      "position": null,
      "original_position": 16,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a3ad8ecf96808a75431d98227fcb42d19d029606",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think the way you're setting this up is that you give `CCheckQueue` a bunch of work, and it then returns a batch of deferred work back to you, that you then finish off. But if you're doing a whole block at once, maybe that's bad, because you're doing all the deferred checks for all txns in a single thread, rather than in parallel.\r\n\r\nMaybe it would be better to expand `CCheckQueue` into being more of a map/reduce model -- you map the scripts to many processes getting deferred checks in response, then you sort the deferred checks so related ones (from the same tx) all go to the same thread, then reduce/accumulate the results from them so that you've got your conclusion.\r\n\r\nCould be really clever and do the reduce work in parallel with mapping, I think; though you'd need some way of maintaining the accumulator state.",
      "created_at": "2023-02-04T09:52:25Z",
      "updated_at": "2023-02-04T09:58:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1096511595",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096511595"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 208,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1108665794",
      "pull_request_review_id": 1301750326,
      "id": 1108665794,
      "node_id": "PRRC_kwDOABII585CFOXC",
      "diff_hunk": "@@ -122,10 +136,28 @@ class CCheckQueue\n                 fOk = fAllOk;\n             }\n             // execute work\n-            for (T& check : vChecks)\n-                if (fOk)\n+            for (T& check : vChecks) {\n+                if (fOk) {\n                     fOk = check();\n+\n+                    if (fOk && check.m_deferred_checks && check.m_deferred_checks->size() > 0) {\n+                        auto& dc = *check.m_deferred_checks;\n+                        results.insert(\n+                            results.end(),\n+                            std::make_move_iterator(dc.begin()),\n+                            std::make_move_iterator(dc.end()));\n+                    }",
      "path": "src/checkqueue.h",
      "position": 97,
      "original_position": 92,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a3ad8ecf96808a75431d98227fcb42d19d029606",
      "in_reply_to_id": 1096477805,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good cleanup, done - thanks.",
      "created_at": "2023-02-16T15:42:11Z",
      "updated_at": "2023-02-16T15:42:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1108665794",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1108665794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 154,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1110150658",
      "pull_request_review_id": 1303948103,
      "id": 1110150658,
      "node_id": "PRRC_kwDOABII585CK44C",
      "diff_hunk": "@@ -193,6 +193,29 @@ enum class SigVersion\n     TAPSCRIPT = 3,   //!< Witness v1 with 32-byte program, not BIP16 P2SH-wrapped, script path spending, leaf version 0xc0; see BIP 342\n };\n \n+\n+//! Data that is accumulated during the script verification of a single input and then\n+//! used to perform aggregate checks after all inputs have been run through\n+//! `VerifyScript()`.\n+//!\n+//! TODO I realize this is kind of a hacky polymorphic-union thing; if there's a nicer\n+//! way to do this, please someone let me know.\n+struct DeferredCheck\n+{\n+    //! Set when script execution happens asynchronously so that we can associate\n+    //! deferred checks with their related transaction when a block's worth of\n+    //! script executions are performed in batch.\n+    const CTransaction* m_tx_to;",
      "path": "src/script/interpreter.h",
      "position": null,
      "original_position": 16,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a3ad8ecf96808a75431d98227fcb42d19d029606",
      "in_reply_to_id": 1096511595,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is good feedback, and in the general case you're right. In the specific case of the deferred checks being introduced here, they don't include any of the computationally expensive stuff that motivates parallelizing checks in the case of CScriptCheck - i.e. we're not doing any cryptographic ops or signature checking here; OP_VAULT deferred checks consist of summing and comparing integers.\r\n\r\nSo I'm not necessarily averse to doing the deferred-check parallelization in this changeset, but (i) I don't think it's strictly necessary from a resource standpoint and (ii) I can't think of a straightforward way to do it without introducing another thread pool devoted to the deferred checks, which is a decent amount of work.",
      "created_at": "2023-02-17T17:54:14Z",
      "updated_at": "2023-02-17T17:54:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1110150658",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1110150658"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 208,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1110154588",
      "pull_request_review_id": 1303952342,
      "id": 1110154588,
      "node_id": "PRRC_kwDOABII585CK51c",
      "diff_hunk": "@@ -193,6 +193,29 @@ enum class SigVersion\n     TAPSCRIPT = 3,   //!< Witness v1 with 32-byte program, not BIP16 P2SH-wrapped, script path spending, leaf version 0xc0; see BIP 342\n };\n \n+\n+//! Data that is accumulated during the script verification of a single input and then\n+//! used to perform aggregate checks after all inputs have been run through\n+//! `VerifyScript()`.\n+//!\n+//! TODO I realize this is kind of a hacky polymorphic-union thing; if there's a nicer\n+//! way to do this, please someone let me know.",
      "path": "src/script/interpreter.h",
      "position": 69,
      "original_position": 10,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a3ad8ecf96808a75431d98227fcb42d19d029606",
      "in_reply_to_id": 1096478197,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I looked at using `std::variant` but the end use in `ValidateDeferredChecks` winds up being much hairier. I've changed the specific checks from `std::unique_ptr` to `std::optional` for simplicity's sake. If we eventually decide that the memory implications of this approach are too heavyweight, we could do something with std::variant - but I think they're comparable, and given that we'll never have more than a few thousand deferred checks in flight at any given time, I think it's probably okay to leave this representation as-is.",
      "created_at": "2023-02-17T17:57:43Z",
      "updated_at": "2023-02-17T17:57:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1110154588",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1110154588"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 247,
      "original_line": 247,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1113120278",
      "pull_request_review_id": 1307509728,
      "id": 1113120278,
      "node_id": "PRRC_kwDOABII585CWN4W",
      "diff_hunk": "@@ -1213,6 +1342,185 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                 }\n                 break;\n \n+                case OP_VAULT:\n+                {\n+                    // only available post-segwit\n+                    if (sigversion == SigVersion::BASE) return set_error(serror, SCRIPT_ERR_BAD_OPCODE);\n+\n+                    // <recovery-spk-hash> <spend-delay> <trigger-spk-hash>\n+                    if (stack.size() < 3) return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+\n+                    valtype& hash_from_stack = stacktop(-3);\n+                    if (hash_from_stack.size() != 32) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+                    const uint256 recovery_spk_hash{hash_from_stack};\n+\n+                    // `spend-delay` is a CScriptNum, up to 4 bytes, that is interpreted\n+                    // in the same way as the first 23 bits of nSequence are per\n+                    // BIP 68 (relative time-locks). This enables users of vaults to\n+                    // express spend delays in either wall time or block count, and reuse\n+                    // the same machinery as OP_CHECKSEQUENCEVERIFY.\n+                    const CScriptNum spend_delay(stacktop(-2), fRequireMinimal);\n+\n+                    hash_from_stack = stacktop(-1);\n+                    if (hash_from_stack.size() != 32) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+                    const uint256 expected_trigger_spk_hash{hash_from_stack};\n+\n+                    popstack(stack);\n+                    popstack(stack);\n+                    popstack(stack);\n+\n+                    // Case 1: sweep to recovery\n+                    if (checker.CheckVaultSpendToRecoveryOutputs(recovery_spk_hash)) {\n+                        stack.push_back(vchTrue);\n+                        break;\n+                    }\n+\n+                    // Case 2: spend to compatible OP_UNVAULT\n+\n+                    // [trigger witness stack ...] <trigger-spk> [prev stack items]\n+                    if (stack.size() < 2) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+\n+                    CScript unvault_output_spk;\n+\n+                    if (!checker.CheckUnvaultTriggerOutputsCommon(\n+                            recovery_spk_hash,\n+                            spend_delay,\n+                            fRequireMinimal,\n+                            unvault_output_spk)) {\n+                        return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n+                    }\n+                    assert(unvault_output_spk.size() > 0);\n+\n+                    // Determine the type of the proposed OP_UNVAULT script.\n+                    // If it lives behind a scripthash, we will have to construct\n+                    // a specific expected scriptPubKey and compare to that. Otherwise\n+                    // we'll analyze its prefix as a bare script.\n+                    int opuv_witversion;\n+                    valtype opuv_witprogram;\n+                    const bool is_unvault_output_wit =\n+                        unvault_output_spk.IsWitnessProgram(opuv_witversion, opuv_witprogram);\n+\n+                    if (!is_unvault_output_wit) {\n+                        // Validate the OP_UNVAULT output as a bare script.\n+                        if (!CheckUnvaultTriggerOutputsBare(\n+                                unvault_output_spk,\n+                                recovery_spk_hash, spend_delay, fRequireMinimal)) {\n+                            return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n+                        }\n+                    } else {\n+                        // We now expect an additional item on the stack, <target-hash>,\n+                        // which is used to validate the proposed OP_UNVAULT witness\n+                        // output sPK - which hides the actual OP_UNVAULT script behind a\n+                        // scripthash.\n+                        if (stack.size() < 3) {\n+                            return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                        }\n+                        valtype& hash_from_stack = stacktop(-1);\n+                        if (hash_from_stack.size() != 32) {\n+                            return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                        }\n+                        const uint256 target_hash{hash_from_stack};\n+                        popstack(stack);\n+\n+                        if (!CheckUnvaultTriggerOutputsWitness(\n+                                opuv_witversion, opuv_witprogram,\n+                                recovery_spk_hash, spend_delay, target_hash,\n+                                fRequireMinimal, flags, serror)) {\n+                            return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n+                        }\n+                    }\n+\n+                    // Now that we have verified the structure of the outputs, verify\n+                    // the signature authorizing the beginning of the unvault.\n+                    //\n+                    // Check that a valid trigger signature has been put on the witness\n+                    // stack.\n+                    const valtype& trigger_witness_program = stacktop(-1);\n+                    auto trigger_witness_spk = CScript(\n+                        trigger_witness_program.begin(), trigger_witness_program.end());\n+\n+                    const uint256 trigger_spk_hash = VaultScriptHash(\n+                            HASHER_VAULT_UNVAULT_SPK, trigger_witness_spk);\n+\n+                    if (trigger_spk_hash != expected_trigger_spk_hash) {\n+                        return set_error(serror, SCRIPT_ERR_VAULT_WRONG_TRIGGER_WITNESS_PROGRAM);\n+                    }\n+                    popstack(stack);\n+                    // Everything remaining on the stack is the witness stack\n+                    // to be fed into the witness program above.\n+\n+                    CScriptWitness witness;\n+                    witness.stack = stack;\n+                    int witnessversion;\n+                    std::vector<unsigned char> witnessprogram;\n+\n+                    if (!trigger_witness_spk.IsWitnessProgram(witnessversion, witnessprogram)) {\n+                        return set_error(serror, SCRIPT_ERR_VAULT_INVALID_TRIGGER_WITNESS_PROGRAM);\n+                    }\n+                    // Note that this will recursively call EvalScript. We could get\n+                    // into a further recursion if OP_VAULT spends are included in the\n+                    // trigger witness program; the recursion depth is limited\n+                    // solely by script size constraints.\n+                    //\n+                    // TODO: think more about whether to limit recursive OP_VAULT\n+                    // evaluations in trigger witness programs.",
      "path": "src/script/interpreter.cpp",
      "position": null,
      "original_position": 287,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a8323b9cea602f4af8206f86c0193d189b721904",
      "in_reply_to_id": 1071577974,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point. This has been done; see the `limit_recursion` parameter. Thanks to @john-moffett for outlining a particular test case to ensure that recursion is limited to a single call.",
      "created_at": "2023-02-21T14:11:24Z",
      "updated_at": "2023-02-21T14:11:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1113120278",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1113120278"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": 1471,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1113121652",
      "pull_request_review_id": 1307511788,
      "id": 1113121652,
      "node_id": "PRRC_kwDOABII585CWON0",
      "diff_hunk": "@@ -1267,12 +1385,62 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     if (stack.size() < 2) {\n                         return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n                     }\n-                    if (!checker.CheckUnvaultTriggerOutputs(\n-                            recovery_spk_hash, spend_delay, fRequireMinimal)) {\n+\n+                    CScript unvault_output_spk;\n+\n+                    if (!checker.CheckUnvaultTriggerOutputsCommon(\n+                            recovery_spk_hash,\n+                            spend_delay,\n+                            fRequireMinimal,\n+                            unvault_output_spk)) {\n                         return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n                     }\n+                    assert(unvault_output_spk.size() > 0);\n+\n+                    // Determine the type of the proposed OP_UNVAULT script.\n+                    // If it lives behind a scripthash, we will have to construct\n+                    // a specific expected scriptPubKey and compare to that. Otherwise\n+                    // we'll analyze its prefix as a bare script.\n+                    int opuv_witversion;\n+                    valtype opuv_witprogram;\n+                    const bool is_unvault_output_wit =\n+                        unvault_output_spk.IsWitnessProgram(opuv_witversion, opuv_witprogram);\n+\n+                    if (!is_unvault_output_wit) {\n+                        // Validate the OP_UNVAULT output as a bare script.\n+                        if (!CheckUnvaultTriggerOutputsBare(\n+                                unvault_output_spk,\n+                                recovery_spk_hash, spend_delay, fRequireMinimal)) {\n+                            return set_error(serror, SCRIPT_ERR_UNVAULT_MISMATCH);\n+                        }",
      "path": "src/script/interpreter.cpp",
      "position": null,
      "original_position": 165,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "a9db7392bf9d4d69d5a7a91db32dda7bd50479d8",
      "in_reply_to_id": 1071585163,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Removed. Vault opcodes now only exist as OP_SUCCESSx overrides in tapscript. ",
      "created_at": "2023-02-21T14:12:33Z",
      "updated_at": "2023-02-21T14:12:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1113121652",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1113121652"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": 1409,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1434,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1113122540",
      "pull_request_review_id": 1307513132,
      "id": 1113122540,
      "node_id": "PRRC_kwDOABII585CWObs",
      "diff_hunk": "@@ -2137,11 +2166,49 @@ bool GenericTransactionSignatureChecker<T>::CheckUnvaultTriggerOutputsCommon(\n     if (!this->txdata) return HandleMissingData(m_mdb);\n     const auto& txd{*this->txdata};\n \n-    if (!CommonVaultSpendChecks(txd, this->txTo->vout)) {\n+    const auto num_outs = this->txTo->vout.size();\n+    if (num_outs < 1 || num_outs > 3) {\n         return false;\n     }\n \n-    unvault_output_spk = this->txTo->vout[0].scriptPubKey;\n+    CAmount total_val_out_to_vaults{0};\n+\n+    assert(txd.m_spent_outputs_ready);\n+    const CScript& vault_spk = txd.m_spent_outputs[this->nIn].scriptPubKey;\n+\n+    bool has_ea{false};\n+    bool has_revault{false};\n+\n+    // Verify that all optional outputs are either an ephemeral anchor or a revault.\n+    // Permit the optional outputs to appear in any order.",
      "path": "src/script/interpreter.cpp",
      "position": null,
      "original_position": 85,
      "commit_id": "8eacc25a06de641963d0616f1b659b0024feeed9",
      "original_commit_id": "c00dad503d7dfa990afd24c9fde2555482cc247b",
      "in_reply_to_id": 1071588874,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed. OP_UNVAULT outputs (and recovery outputs) are now specified explicitly by an index on the witness stack. Thanks for this feedback.",
      "created_at": "2023-02-21T14:13:20Z",
      "updated_at": "2023-02-21T14:13:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26857#discussion_r1113122540",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1113122540"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857"
        }
      },
      "start_line": null,
      "original_start_line": 2182,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2160,
      "side": "RIGHT"
    }
  ]
}