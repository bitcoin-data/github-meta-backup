{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471",
    "id": 1114599393,
    "node_id": "PR_kwDOABII585Cb2_h",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/26471",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/26471.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/26471.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/8e85164e7d12be324ea1af2e288ebcf689c930b7",
    "number": 26471,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "Reduce default mempool size in -blocksonly mode",
    "user": {
      "login": "willcl-ark",
      "id": 6606587,
      "node_id": "MDQ6VXNlcjY2MDY1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/willcl-ark",
      "html_url": "https://github.com/willcl-ark",
      "followers_url": "https://api.github.com/users/willcl-ark/followers",
      "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
      "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
      "repos_url": "https://api.github.com/users/willcl-ark/repos",
      "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixes #9526\r\n\r\nWhen `-blocksonly` has been set reduce default mempool size to avoid surprising resource usage via sharing un-used mempool cache space with dbcache.\r\n\r\nIn comparison to https://github.com/bitcoin/bitcoin/pull/9569 which either set `maxmempool` size to 0 when `-blocksonly` was set or else errored on startup, this change will permit `maxmempool` options being set.\r\n\r\nThis preserves the current (surprising?) behaviour of having a functional mempool in `-blocksonly` mode, to permit whitelisted peer transaction relay, whilst reducing average runtime memory usage for blocksonly nodes which either use the default settings or have otherwise configured a `maxmempool` size.\r\n\r\nTo use the previous old defaults node operators can configure their node with: `-blocksonly -maxmempool=300`.",
    "labels": [
      {
        "id": 164208572,
        "node_id": "MDU6TGFiZWwxNjQyMDg1NzI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Mempool",
        "name": "Mempool",
        "color": "fef2c0",
        "default": false
      },
      {
        "id": 326918230,
        "node_id": "MDU6TGFiZWwzMjY5MTgyMzA=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Resource%20usage",
        "name": "Resource usage",
        "color": "981023",
        "default": false
      }
    ],
    "milestone": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/56",
      "html_url": "https://github.com/bitcoin/bitcoin/milestone/56",
      "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/56/labels",
      "id": 7733968,
      "node_id": "MI_kwDOABII584AdgLQ",
      "number": 56,
      "state": "closed",
      "title": "25.0",
      "description": "",
      "creator": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "open_issues": 0,
      "closed_issues": 38,
      "created_at": "2022-03-03T18:51:29Z",
      "updated_at": "2023-05-25T13:24:42Z",
      "closed_at": "2023-05-25T13:24:42Z"
    },
    "created_at": "2022-11-08T15:22:52Z",
    "updated_at": "2023-01-30T09:39:02Z",
    "closed_at": "2023-01-22T14:57:31Z",
    "mergeable_state": "unknown",
    "merged_at": "2023-01-22T14:57:31Z",
    "merge_commit_sha": "ad09b762757a293ff970113c15bd9dee3057e556",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "willcl-ark:blocksonly_mempool_cache",
      "ref": "blocksonly_mempool_cache",
      "sha": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 164122552,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjQxMjI1NTI=",
        "name": "bitcoin",
        "full_name": "willcl-ark/bitcoin",
        "owner": {
          "login": "willcl-ark",
          "id": 6606587,
          "node_id": "MDQ6VXNlcjY2MDY1ODc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/willcl-ark",
          "html_url": "https://github.com/willcl-ark",
          "followers_url": "https://api.github.com/users/willcl-ark/followers",
          "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
          "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
          "repos_url": "https://api.github.com/users/willcl-ark/repos",
          "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/willcl-ark/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/willcl-ark/bitcoin",
        "archive_url": "https://api.github.com/repos/willcl-ark/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/willcl-ark/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/willcl-ark/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/willcl-ark/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/willcl-ark/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/willcl-ark/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/willcl-ark/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/willcl-ark/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/willcl-ark/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/willcl-ark/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/willcl-ark/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/willcl-ark/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/willcl-ark/bitcoin/events",
        "forks_url": "https://api.github.com/repos/willcl-ark/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/willcl-ark/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/willcl-ark/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/willcl-ark/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/willcl-ark/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/willcl-ark/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/willcl-ark/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/willcl-ark/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/willcl-ark/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/willcl-ark/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/willcl-ark/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/willcl-ark/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/willcl-ark/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/willcl-ark/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/willcl-ark/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/willcl-ark/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:willcl-ark/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/willcl-ark/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/willcl-ark/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/willcl-ark/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/willcl-ark/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/willcl-ark/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/willcl-ark/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/willcl-ark/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/willcl-ark/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/willcl-ark/bitcoin/hooks",
        "svn_url": "https://github.com/willcl-ark/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 217115,
        "default_branch": "master",
        "open_issues_count": 4,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-05T10:56:56Z",
        "created_at": "2019-01-04T15:17:29Z",
        "updated_at": "2023-05-05T12:10:23Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "392dc68e37be9fc7adb32496b13d9b50262e317d",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69818,
        "watchers_count": 69818,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T07:15:46Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T06:49:43Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 22,
    "deletions": 4,
    "changed_files": 4,
    "commits": 3,
    "review_comments": 58,
    "comments": 12
  },
  "events": [
    {
      "event": "labeled",
      "id": 7785979542,
      "node_id": "LE_lADOABII585V2u17zwAAAAHQFJ6W",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7785979542",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-10T18:25:47Z",
      "label": {
        "name": "Resource usage",
        "color": "981023"
      }
    },
    {
      "event": "reviewed",
      "id": 1176240824,
      "node_id": "PRR_kwDOABII585GHAK4",
      "url": null,
      "actor": null,
      "commit_id": "d68dc8244d81f899b28e0e7ca25501c02e99a986",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "It took me a surprisingly long time to figure out the rationale here. I'll write down my understanding both to have it validated/corrected, as well as hopefully to inform other people looking at this.\r\n\r\n---\r\n\r\nMy understanding:\r\n\r\nUsers running with `-blocksonly` expect to have a near zero-sized mempool, because it'll only contain transactions broadcasted by their own wallet (disabled by default) or transactions received from whitelisted peers (non-default). As such, when provisioning their system, a user would expect to only have to allocate `dbcache` amount of memory, instead of currently actually requiring `dbcache + maxmempool`, which could lead to stability issues.\r\n\r\nWithout `-blocksonly`, a user needs to ensure that his system is provisioned to support both the full dbcache and mempool. Since it's provisioned _anyway_, we might as well use the unused mempool space for dbcache, which is especially helpful during IBD.\r\n\r\nThe misunderstanding for me was that the resource sharing between `dbcache` and `maxmempool` is not a resource optimization (in which case \"we would benefit _even more_ with `-blocksonly`, so why disable the optimization?!\") but rather an accounting trick. Users running in `-blocksonly` should just increase their `dbcache` by whatever size `maxmempool` is for a similar effect (but not entirely, as explained below)\r\n\r\n---\r\n\r\nIf my understanding is correct, I'm Concept ACK (i.e. making resource usage less surprising) but not yet Approach ACK, because: \r\n- this would be a performance degradation for users running `-blocksonly` that don't realize they should update their `-dbcache`. Users running `-blocksonly` could get higher default `dbcache` defaults, but that seems messy too.\r\n- users can't really replicate current behaviour even if they're aware of the change. The intuitive solution would be to increase `-dbcache` by `-maxmempool`, however, `dbcache` is shared by multiple caches, [of which the coins cache receives 25-50%](https://github.com/bitcoin/bitcoin/blob/7ef730ca84bd71a06f986ae7070e7b2ac8e47582/src/node/caches.cpp#L28). It seems there's no way to allocate an extra 300MB (assuming default) to just the coins cache without increasing the `dbcache` by a total of 600MB - 1.2GB?",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1176240824",
      "submitted_at": "2022-11-10T20:19:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "commented",
      "id": 1311565859,
      "node_id": "IC_kwDOABII585OLOgj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311565859",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-11T11:16:26Z",
      "updated_at": "2022-11-11T11:16:26Z",
      "author_association": "MEMBER",
      "body": "Thanks for your review at this conceptual stage @stickies-v. Your understanding of the problem and solution matches my own, although I had not fully considered the knock-on effect that:\r\n\r\n> users can't really replicate current behaviour even if they're aware of the change ... without increasing the dbcache by a total of 600MB - 1.2GB?\r\n\r\nI also concur with you that altering default `dbcache` size for users who enable `blocksonly` seems kind of messy, although it could be made to work.\r\n\r\nTherefore I see x options available from here:\r\n\r\n1) Keep current behaviour, document it better, and close https://github.com/bitcoin/bitcoin/issues/9526 as wontfix\r\n2) Implement (something like) this change which introduces the performance reduction in IBD for `blocksonly` nodes and document it\r\n3) Add special-casing for `dbcache` size when nodes are run in `blocksonly` mode.\r\n\r\nIn writing the options out like that, my first preference might actually be 1), followed by 3) and last 2).",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1311565859",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "mentioned",
      "id": 7791314775,
      "node_id": "MEE_lADOABII585V2u17zwAAAAHQZgdX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7791314775",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-11T11:16:27Z"
    },
    {
      "event": "subscribed",
      "id": 7791314791,
      "node_id": "SE_lADOABII585V2u17zwAAAAHQZgdn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7791314791",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-11T11:16:27Z"
    },
    {
      "event": "commented",
      "id": 1311659320,
      "node_id": "IC_kwDOABII585OLlU4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311659320",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-11T12:47:06Z",
      "updated_at": "2022-11-11T12:47:06Z",
      "author_association": "MEMBER",
      "body": "> Therefore I see x options available from here:\r\n\r\nI think I'm not in favour of 1 & 3. Imo the direction should always be to reduce exceptional behaviour, if the short-term cost of that change is not exorbitant. I think in this case, the cost (potentially slower IBD which can be fixed with user config) is not exorbitant and increased stability (because of reduction of unexpected behaviour) is a worthwhile improvement.\r\n\r\nI can think of two other alternatives, both building on top of what you've currently implemented:\r\n\r\n4. add a `-increase-coins-cache=<n>` parameter to allow users keeping the current behaviour (and maybe even set it to 300 by default if `-blocksonly` in the first release to give users time to transition, and then change it to 0 in the release after. Pretty user-friendly/straightforward option, but it introduces another kinda one-off parameter.\r\n \r\n5. Allowing users to manually define sub-cache allocations (overriding the defaults), e.g. through `-dbcache.coins=<n|f>` where `n` is an absolute amount and `f` a 0-1 float indicating a percentage of total `dbcache`. This seems like the most transparent and generic solution, but probably at the cost of reduced user-friendliness. It would also be a significantly bigger code change introducing the new parameters as well as a bunch of validation, and allowing the auto-allocation to deal with partial specification (e.g. only `coins` and `tx_index` are specified but not the other ones)",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1311659320",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "commented",
      "id": 1311706344,
      "node_id": "IC_kwDOABII585OLwzo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311706344",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-11T13:38:26Z",
      "updated_at": "2022-11-11T13:38:26Z",
      "author_association": "MEMBER",
      "body": "Yes 4) is a possible solution.\r\n\r\nIMO by the time we hit 5), we're probably almost talking about people who have such an understanding of the system (developers) that they can most likely make the change to the source themselves before compiling if they truely need such fine-grained settings changes.\r\n\r\nWill leave it as is to see if we get any other suggestions, and mull it over myself...",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1311706344",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "commented",
      "id": 1314530791,
      "node_id": "IC_kwDOABII585OWiXn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1314530791",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-14T23:13:54Z",
      "updated_at": "2022-11-14T23:13:54Z",
      "author_association": "MEMBER",
      "body": "> The intuitive solution would be to increase -dbcache by -maxmempool, however, dbcache is shared by multiple caches, of which the coins cache receives 25-50%. It seems there's no way to allocate an extra 300MB (assuming default) to just the coins cache without increasing the dbcache by a total of 600MB - 1.2GB?\r\n\r\nFWIW, I have a related thought process for Knots, where it makes sense to leave the coins cache unlimited (and let memory pressure trigger flushing), yet it isn't sane to just increase `-dbcache` to the system memory size, because that would also increase other cache sizes which aren't handled when under memory pressure.\r\n\r\n>Therefore I see x options available from here:\r\n\r\n6) support specifying \"+mempool\" on the end of the `-dbcache` option to get the current behaviour even in blocksonly mode.\r\n",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1314530791",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "commented",
      "id": 1380727257,
      "node_id": "IC_kwDOABII585STDnZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1380727257",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-12T17:01:27Z",
      "updated_at": "2023-01-12T17:01:27Z",
      "author_association": "MEMBER",
      "body": "It seems the key issue is \"surprising memory usage,\" i.e. `-dbcache=n -blocksonly` can use n+300 while the user may have expected n. The trick of using `-blocksonly` to add mempool's memory to the coins cache seems quite esoteric (lmk if I'm mistaken), so preserving it would be a bit less important imo.\r\n\r\n> the current (surprising) behaviour of having a functional mempool in -blocksonly mode\r\n\r\nGiven how surprising this is to so many people (including those affected by this problem), I can see how disabling mempool in blocksonly would be the easiest option. But can also see how it's not acceptable for users that rely on the current whitelist relay behavior according to #9569.\r\n\r\n7. Perhaps setting a very small mempool `m_max_size_bytes` when in blocksonly mode unless overridden by `-maxmempool`, would be one solution? That seems to preserve the trick for those using it intentionally, while reducing the amount of \"surprising memory usage\" for those that assume 0 memory for `-blocksonly`. Those who benefit from the extra 300MB by accident can perhaps get their answer from the release notes if they see a performance reduction. If they want to continue doing what they were doing, they just need to set `-maxmempool`.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1380727257",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "commented",
      "id": 1380727341,
      "node_id": "IC_kwDOABII585STDot",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1380727341",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-12T17:01:29Z",
      "updated_at": "2023-01-22T00:06:32Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [ajtowns](https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1264669256) |\n| Stale ACK | [aureleoules](https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1261583973) |\n| Ignored review | [stickies-v](https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1264703343) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1380727341",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "commented",
      "id": 1382323564,
      "node_id": "IC_kwDOABII585SZJVs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1382323564",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-13T19:54:13Z",
      "updated_at": "2023-01-16T07:48:45Z",
      "author_association": "MEMBER",
      "body": "> 7. Perhaps setting a very small mempool `m_max_size_bytes` when in blocksonly mode unless overridden by `-maxmempool`, would be one solution? That seems to preserve the trick for those using it intentionally, while reducing the amount of \"surprising memory usage\" for those that assume 0 memory for `-blocksonly`. Those who benefit from the extra 300MB by accident can perhaps get their answer from the release notes if they see a performance reduction. If they want to continue doing what they were doing, they just need to set `-maxmempool`.\r\n\r\nI think this is a neat solution which covers all requirements so implemented it [in this second branch](https://github.com/bitcoin/bitcoin/compare/master...willcl-ark:bitcoin:blocksonly_mempool_cache_7) (it's also much cleaner implementation-wise).\r\n\r\nThe only question I had was how small is \"smaller\"? I opted for 5MB in blocksonly mode as this should be enough for quite a few transactions to be relayed for whitelisted peers, I think...\r\n\r\nIf this is preferred I will move it over to this branch...?",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1382323564",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "commented",
      "id": 1384189101,
      "node_id": "IC_kwDOABII585SgQyt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384189101",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T15:05:35Z",
      "updated_at": "2023-01-16T15:05:35Z",
      "author_association": "MEMBER",
      "body": "> The only question I had was how small is \"smaller\"? I opted for 5MB in blocksonly mode as this should be enough for quite a few transactions to be relayed for whitelisted peers, I think...\r\n\r\nThat definitely seems sufficient, and they can still make it higher if they need to. 5MB is the minimum `-maxmempool` config allowed as well, as the smaller the mempool size, the easier it is for your mempool min feerate to get driven up really high. Thinking out loud I guess this isn't as much of a concern for `-blocksonly` since you won't consider any transactions from strangers, so maybe smaller would be okay... but I can't say a different number with confidence.\r\n\r\n> If this is preferred I will move it over to this branch...?\r\n\r\nI think it's a relatively simple change to lessen this problem with minimal side effects? :shrug: though I don't know if we could say we've completely fixed it. fwiw I think it's sensible regardless since we're probably unlikely to need 300MB in blocksonly mode.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1384189101",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8239823912,
      "node_id": "HRFPE_lADOABII585V2u17zwAAAAHrIbwo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8239823912",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T20:09:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8240195632,
      "node_id": "HRFPE_lADOABII585V2u17zwAAAAHrJ2gw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8240195632",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T21:32:09Z"
    },
    {
      "event": "renamed",
      "id": 8243316530,
      "node_id": "RTE_lADOABII585V2u17zwAAAAHrVwcy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8243316530",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-17T09:09:03Z",
      "rename": {
        "from": "Don't share mempool with dbcache in -blocksonly mode",
        "to": "Reduce default mempool size in -blocksonly mode"
      }
    },
    {
      "event": "ready_for_review",
      "id": 8243322697,
      "node_id": "RFRE_lADOABII585V2u17zwAAAAHrVx9J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8243322697",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-17T09:09:36Z"
    },
    {
      "event": "commented",
      "id": 1385066164,
      "node_id": "IC_kwDOABII585Sjm60",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1385066164",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-17T09:12:24Z",
      "updated_at": "2023-01-17T09:12:24Z",
      "author_association": "MEMBER",
      "body": "OK I have moved the commits across, and updated the PR title and description. I also added a new release note commit which I thought was worth it, but happy to be persuaded otherwise.",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1385066164",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "reviewed",
      "id": 1251221155,
      "node_id": "PRR_kwDOABII585KlB6j",
      "url": null,
      "actor": null,
      "commit_id": "dd4325981bc79759d40e67cda91447a3da9fe083",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1251221155",
      "submitted_at": "2023-01-17T10:13:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8244337402,
      "node_id": "HRFPE_lADOABII585V2u17zwAAAAHrZpr6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8244337402",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-17T10:51:40Z"
    },
    {
      "event": "reviewed",
      "id": 1251339051,
      "node_id": "PRR_kwDOABII585Klesr",
      "url": null,
      "actor": null,
      "commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK 931924f5cc1dd9c82306a0ce59b62cf5c9276565\r\nTested with `-blocksonly` and `-blocksonly -maxmempool=n` and verified the logs, seems to work as intended.\r\n\r\n(Please avoid rebasing when there is no need.)",
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1251339051",
      "submitted_at": "2023-01-17T11:10:27Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "reviewed",
      "id": 1251428711,
      "node_id": "PRR_kwDOABII585Kl0ln",
      "url": null,
      "actor": null,
      "commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Approach ACK 931924f5cc1dd9c82306a0ce59b62cf5c9276565, [except](https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072155280) for setting mempool_opts.max_size_bytes in two different locations and times.\r\n\r\nI think this approach tackles a nice balance between addressing the most important issue (node crashing because of unexpected resource usage), reducing additional code overhead (compared to the other approaches considered) and allowing users to maintain existing performance profile without too much admin overhead. The biggest (but manageable) downside is that everyone that upgrades and doesn't manually override `-maxmempool` will silently experience a performance degradation, especially during IBD. I expect this performance degradation to be manageable, especially since most users that have the resources available, will probably have manually increased their `dbcache` anyway for IBD, lowering the relative impact of this change.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1251428711",
      "submitted_at": "2023-01-17T12:39:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8246885105,
      "node_id": "HRFPE_lADOABII585V2u17zwAAAAHrjXrx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8246885105",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-17T15:27:08Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8246925827,
      "node_id": "HRFPE_lADOABII585V2u17zwAAAAHrjhoD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8246925827",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-17T15:31:18Z"
    },
    {
      "event": "labeled",
      "id": 8247248013,
      "node_id": "LE_lADOABII585V2u17zwAAAAHrkwSN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8247248013",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-17T16:04:32Z",
      "label": {
        "name": "Mempool",
        "color": "fef2c0"
      }
    },
    {
      "event": "reviewed",
      "id": 1261583973,
      "node_id": "PRR_kwDOABII585LMj5l",
      "url": null,
      "actor": null,
      "commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "reACK ed5ce6d0c911ac66bd5870a1711edef03a18ebeb - Wording updated and logic cleaned up since my last review.",
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1261583973",
      "submitted_at": "2023-01-19T11:16:59Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "reviewed",
      "id": 1262313329,
      "node_id": "PRR_kwDOABII585LPV9x",
      "url": null,
      "actor": null,
      "commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK ed5ce6d0c",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1262313329",
      "submitted_at": "2023-01-19T17:51:09Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "reviewed",
      "id": 1262522690,
      "node_id": "PRR_kwDOABII585LQJFC",
      "url": null,
      "actor": null,
      "commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Approach ACK",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1262522690",
      "submitted_at": "2023-01-19T20:04:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "reviewed",
      "id": 1253163234,
      "node_id": "PRR_kwDOABII585KscDi",
      "url": null,
      "actor": null,
      "commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1253163234",
      "submitted_at": "2023-01-20T10:29:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDExMzQ2ODZlZjkyZmI2MjJhYzMyZGM3NDYzZDM3NjNjZjE4Yzg1YWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1134686ef92fb622ac32dc7463d3763cf18c85ad",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1134686ef92fb622ac32dc7463d3763cf18c85ad",
      "tree": {
        "sha": "54138415b447d4ee4187cc57240aba0e43a307d9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/54138415b447d4ee4187cc57240aba0e43a307d9"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 54138415b447d4ee4187cc57240aba0e43a307d9\nparent 8339f3cea841005066239fa43e16586fdfd9d19a\nauthor willcl-ark <will@256k1.dev> 1667915569 +0000\ncommitter willcl-ark <will@256k1.dev> 1674219193 +0000\n\nmempool: Don't share mempool with dbcache in blocksonly\n\nWhen -blockonly is set, reduce mempool size to 5MB unless -maxmempool\nis also set.\n\nSee #9569\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEoAg2YPI1onAAzTyBzm7EmUXBfqYFAmPKjrkACgkQzm7EmUXB\nfqY7kA//S8sqqVmL5cQ+k7qhsRStPFS5ng4kMc2qfZZHi2aGxtobIH3rsMMPXAFs\nlblS1say2xvviyAQjwkJimDYPjFpUDNRtXe9kIZ0sG/uc9Ie4hB5N9J/EAFW5CRt\nCC481I/IjsTLfkkNwLYiFnIa423cf8G3/xxyBm7p6OSFv7Q5/CbKtEVZ5UtnFDIx\nvD4JfdFYCG6WIx2t/IREx48hICCo1W9JqSoX0uoRJMOd9arNHY6M//EvfNzh5LcF\nNH7WP+Z+/10qGmMDb/X261/z4dZ1t9VjfxxCuZJ0MVyckHs0gU/eYvcONewfU1Nm\ntO7c66IIkAjHcJjphazd5/Ot++Y0+0s0FqNOwAu8zqKJEaizT9P3SGD8BtOUmK3E\n8QUP9/ETvdvLfN2Pd5dqoyYgpO+OLVcpczIn+MFmQOn4fpM16QVmeU+Gic8l9haJ\nWHczqt7EnnT5+KMPA8IeURFQy7zwzfFcVH6jJ8s0KsGH13n6BkCwMrFn1XVuzCzn\nWcN48AAWjonZpg4zRXKIgwn7zVjfDbls6KdpJsJvKc2w7yep4t92LAfTEl8NQlJ2\n5IpUU1QrjoD27CKLUFmN9bLyYK4n6d1xBDegDeVj575jrCSxqDZAXBYYZLHh9W2h\nXCz7YGL5EMkL7nwuA16oW1VEe4ijmzlANl6Un2j3aQc2rm31TqQ=\n=I3F5\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8339f3cea841005066239fa43e16586fdfd9d19a",
          "sha": "8339f3cea841005066239fa43e16586fdfd9d19a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8339f3cea841005066239fa43e16586fdfd9d19a"
        }
      ],
      "message": "mempool: Don't share mempool with dbcache in blocksonly\n\nWhen -blockonly is set, reduce mempool size to 5MB unless -maxmempool\nis also set.\n\nSee #9569",
      "committer": {
        "name": "willcl-ark",
        "email": "will@256k1.dev",
        "date": "2023-01-20T12:53:13Z"
      },
      "author": {
        "name": "willcl-ark",
        "email": "will@256k1.dev",
        "date": "2022-11-08T13:52:49Z"
      },
      "sha": "1134686ef92fb622ac32dc7463d3763cf18c85ad"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFlNzk3NDYzZGM3YzcyZDk5MGFmYTNjYTUzZWVjZWQ3NTYzY2NkMjk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ae797463dc7c72d990afa3ca53eeced7563ccd29",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ae797463dc7c72d990afa3ca53eeced7563ccd29",
      "tree": {
        "sha": "04dd02a9de8ab7f4cef6d1ec6f2bf25e26ce622a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/04dd02a9de8ab7f4cef6d1ec6f2bf25e26ce622a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 04dd02a9de8ab7f4cef6d1ec6f2bf25e26ce622a\nparent 1134686ef92fb622ac32dc7463d3763cf18c85ad\nauthor willcl-ark <will@256k1.dev> 1673640526 +0000\ncommitter willcl-ark <will@256k1.dev> 1674221227 +0000\n\ndoc: Update blocksonly behaviour in reduce-memory\n\nChanges to the default mempool allocation size now documented.\n\nProvides users with guidance on the mempool implications of -blocksonly\nmode, along with instructions on how to re-enable old behaviour.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEoAg2YPI1onAAzTyBzm7EmUXBfqYFAmPKlqsACgkQzm7EmUXB\nfqaENg//YKdLSl7ZwF2ODXrmaD0WCjFfgl2s3h2X3MTJKIHvzBJhTiQiUkzSqJww\n2WJttSUPYafnCG/NGzVKtQVvOZd0CBmSB1JIbTiAIr85rhU+0NdfoMXrQIfdVLkA\nerFRTT6sipjvEATZEQ1Mo3OeMu6zOlJrzRzU4sl7edx8pahMITmrRUOuRNUb5020\nfgIivZ7ro4tC6k+UY3e67QWZuka+1zLvNsLLhNtTubzXPTMnEzynanf/IKIkmpu3\nNPZ5C55vhZlRAHlMYSGwn0oRbhnOp8PT8VwOHdrT5WJBir6Nax5/U/X3dbLdkBPH\nfkq21BYEZzzR7bh1HAvcrM43xEENAzf7KlaEVBanUhXpZPKhb2FL//zRCrDE4UCF\nB6Hk7muxaKSRZEfNNl8j/112n+jt3xtwVVqq5LLeIN/gGSzh6yAwN0HU6aQjReVh\nsyPgdA5SOWxykI6K4csvGrwHaO2Hv9V3ieG3FeJK6RtX7TMTJEsw4Crtb04knWVA\nuxzIPfpDxMBK8F4VJc5DNLDpARPEU/x1/W6EThlMc9odQzRcxUzNOWjHqBmbltTD\nHH6XLPBzKXTBXC22yTQAmFyZVNvfq+zAnsAFt5S2MautHufAFOv6pM62730RtcLp\n5+czrIahChPiBnZNGHGfbFqR03qn6+WCnON+x0ybzCrSka0Pt50=\n=4uNm\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1134686ef92fb622ac32dc7463d3763cf18c85ad",
          "sha": "1134686ef92fb622ac32dc7463d3763cf18c85ad",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1134686ef92fb622ac32dc7463d3763cf18c85ad"
        }
      ],
      "message": "doc: Update blocksonly behaviour in reduce-memory\n\nChanges to the default mempool allocation size now documented.\n\nProvides users with guidance on the mempool implications of -blocksonly\nmode, along with instructions on how to re-enable old behaviour.",
      "committer": {
        "name": "willcl-ark",
        "email": "will@256k1.dev",
        "date": "2023-01-20T13:27:07Z"
      },
      "author": {
        "name": "willcl-ark",
        "email": "will@256k1.dev",
        "date": "2023-01-13T20:08:46Z"
      },
      "sha": "ae797463dc7c72d990afa3ca53eeced7563ccd29"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8321477224,
      "node_id": "HRFPE_lADOABII585V2u17zwAAAAHv_6po",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8321477224",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-20T13:31:25Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhlODUxNjRlN2QxMmJlMzI0ZWExYWYyZTI4OGViY2Y2ODljOTMwYjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "tree": {
        "sha": "a3aa25e10404e13f3a4b33f5a3f7c983f86f5c3f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a3aa25e10404e13f3a4b33f5a3f7c983f86f5c3f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a3aa25e10404e13f3a4b33f5a3f7c983f86f5c3f\nparent ae797463dc7c72d990afa3ca53eeced7563ccd29\nauthor willcl-ark <will@256k1.dev> 1673899203 +0000\ncommitter willcl-ark <will@256k1.dev> 1674222845 +0000\n\ndoc: release note on mempool size in -blocksonly\n\nAdds a release note detailing the new mempool sizing behaviour when\nrunning in blocksonly mode, and instruction on how to override the new\ndefaults.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEoAg2YPI1onAAzTyBzm7EmUXBfqYFAmPKnP8ACgkQzm7EmUXB\nfqYfuxAApzU4W2GqXtoJebpwKK1or7jSCsaq8C2fPmhjiKB7Ox+hIkrOHLes1v65\nnlEestRNHgK6vQzjCnqssRW0IshxCBOQb8RM7RW2Gl9JlaOsELCZ31Z7XrhGMwkW\nygupMNbY/9MKDg8Gk8vLpNxdOZwGo/8qOVjxYYrVTRkyB+yLQOHD9/egxkpdXiL3\nRY71In5Aw4AxCD5maW0xUD+aYPOonbDfNCI+bcctTU9uZBeA1th97AkvMPnWtLEa\nYFDn6FPS3/xxyijvaFEHW1U7Ebspg6JRSBE0TUuencVpCJ+uMYRi39O95nfd0UHy\nmiZtKsO9Qgfr4jkTJSHwDC3HDkVm/QkQ31f45S/5kTuTiuJ4TiaCiQx/wEEcIVOA\niwIh1Vg8gO5PJPokGCXfyzAvgyaAxkW+nv5Gx8KR4beHhUkZLiwJN30vZtJzW1DL\nLcr95Kud731TlHmgiSeRNjHKah8y5f/mWWBOMYbZX0TwALfkZGM4+BTDE9xBuEaw\noX2SaIxJg6evCrP5PVBTQaV8VasjMSoZlcXWC/TkCe8AlmiCC5WZsSMm491Lx9X+\n9WUmAZTZDBIDcx6TUOl7LAD4nzFYn7eKtKBVO5SwqBnRSW35XdVpAgZrwOtdluYv\nL6aJI4noadsmSJLYTWwPeRqFsaCvepyy74nigiIZ3UBfUQ6/ZiI=\n=NGmn\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ae797463dc7c72d990afa3ca53eeced7563ccd29",
          "sha": "ae797463dc7c72d990afa3ca53eeced7563ccd29",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ae797463dc7c72d990afa3ca53eeced7563ccd29"
        }
      ],
      "message": "doc: release note on mempool size in -blocksonly\n\nAdds a release note detailing the new mempool sizing behaviour when\nrunning in blocksonly mode, and instruction on how to override the new\ndefaults.",
      "committer": {
        "name": "willcl-ark",
        "email": "will@256k1.dev",
        "date": "2023-01-20T13:54:05Z"
      },
      "author": {
        "name": "willcl-ark",
        "email": "will@256k1.dev",
        "date": "2023-01-16T20:00:03Z"
      },
      "sha": "8e85164e7d12be324ea1af2e288ebcf689c930b7"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8321667982,
      "node_id": "HRFPE_lADOABII585V2u17zwAAAAHwApOO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8321667982",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-20T13:54:34Z"
    },
    {
      "event": "commented",
      "id": 1398613914,
      "node_id": "IC_kwDOABII585TXSea",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1398613914",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-20T16:13:16Z",
      "updated_at": "2023-01-20T16:13:16Z",
      "author_association": "MEMBER",
      "body": "Thanks for the comments, I've updated the branch taking them into consideration.",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1398613914",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "reviewed",
      "id": 1264669256,
      "node_id": "PRR_kwDOABII585LYVJI",
      "url": null,
      "actor": null,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK 8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1264669256",
      "submitted_at": "2023-01-21T22:36:54Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "reviewed",
      "id": 1264703343,
      "node_id": "PRR_kwDOABII585LYddv",
      "url": null,
      "actor": null,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "re-ACK https://github.com/bitcoin/bitcoin/commit/8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1264703343",
      "submitted_at": "2023-01-22T00:06:28Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "reviewed",
      "id": 1264787233,
      "node_id": "PRR_kwDOABII585LYx8h",
      "url": null,
      "actor": null,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1264787233",
      "submitted_at": "2023-01-22T14:57:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "merged",
      "id": 8328933264,
      "node_id": "ME_lADOABII585V2u17zwAAAAHwcW-Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8328933264",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ad09b762757a293ff970113c15bd9dee3057e556",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ad09b762757a293ff970113c15bd9dee3057e556",
      "created_at": "2023-01-22T14:57:31Z"
    },
    {
      "event": "closed",
      "id": 8328933277,
      "node_id": "CE_lADOABII585V2u17zwAAAAHwcW-d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8328933277",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-22T14:57:32Z"
    },
    {
      "event": "milestoned",
      "id": 8328934012,
      "node_id": "MIE_lADOABII585V2u17zwAAAAHwcXJ8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8328934012",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-22T14:57:57Z",
      "milestone": {
        "title": "25.0"
      }
    },
    {
      "event": "head_ref_deleted",
      "id": 8329552062,
      "node_id": "HRDE_lADOABII585V2u17zwAAAAHweuC-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8329552062",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-22T20:52:58Z"
    },
    {
      "event": "reviewed",
      "id": 1265211607,
      "node_id": "PRR_kwDOABII585LaZjX",
      "url": null,
      "actor": null,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#pullrequestreview-1265211607",
      "submitted_at": "2023-01-23T09:09:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
    },
    {
      "event": "referenced",
      "id": 8336774368,
      "node_id": "REFE_lADOABII585V2u17zwAAAAHw6RTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8336774368",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7613a0173d8cbe6b16f62c550041f51037dbbbee",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/7613a0173d8cbe6b16f62c550041f51037dbbbee",
      "created_at": "2023-01-23T17:47:33Z"
    },
    {
      "event": "commented",
      "id": 1408272259,
      "node_id": "IC_kwDOABII585T8IeD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1408272259",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-30T09:37:43Z",
      "updated_at": "2023-01-30T09:37:43Z",
      "author_association": "MEMBER",
      "body": "@willcl-ark will you be taking the followups https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1083792487 and https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1083469754?",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1408272259",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "mentioned",
      "id": 8386005421,
      "node_id": "MEE_lADOABII585V2u17zwAAAAHz2Emt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8386005421",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-30T09:37:43Z"
    },
    {
      "event": "subscribed",
      "id": 8386005443,
      "node_id": "SE_lADOABII585V2u17zwAAAAHz2EnD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8386005443",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-30T09:37:43Z"
    },
    {
      "event": "commented",
      "id": 1408275104,
      "node_id": "IC_kwDOABII585T8JKg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1408275104",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-30T09:39:02Z",
      "updated_at": "2023-01-30T09:39:02Z",
      "author_association": "MEMBER",
      "body": "Yes I can do those @glozow ",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#issuecomment-1408275104",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26471"
    },
    {
      "event": "mentioned",
      "id": 8386018255,
      "node_id": "MEE_lADOABII585V2u17zwAAAAHz2HvP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8386018255",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-30T09:39:02Z"
    },
    {
      "event": "subscribed",
      "id": 8386018268,
      "node_id": "SE_lADOABII585V2u17zwAAAAHz2Hvc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8386018268",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-30T09:39:02Z"
    },
    {
      "event": "referenced",
      "id": 8409515242,
      "node_id": "REFE_lADOABII585V2u17zwAAAAH1PwTq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8409515242",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "22ccf4e3603a141e5f9485854ba6294cd6876f1e",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/22ccf4e3603a141e5f9485854ba6294cd6876f1e",
      "created_at": "2023-02-01T11:46:45Z"
    },
    {
      "event": "referenced",
      "id": 8411521700,
      "node_id": "REFE_lADOABII585V2u17zwAAAAH1XaKk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8411521700",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e1e1fab923940f5266738e36ef6553128e17d7e9",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/e1e1fab923940f5266738e36ef6553128e17d7e9",
      "created_at": "2023-02-01T15:16:13Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019443822",
      "pull_request_review_id": 1176240824,
      "id": 1019443822,
      "node_id": "PRRC_kwDOABII5848w3pu",
      "diff_hunk": "@@ -2336,8 +2336,16 @@ CoinsCacheSizeState Chainstate::GetCoinsCacheSizeState(\n     AssertLockHeld(::cs_main);\n     const int64_t nMempoolUsage = m_mempool ? m_mempool->DynamicMemoryUsage() : 0;\n     int64_t cacheSize = CoinsTip().DynamicMemoryUsage();\n-    int64_t nTotalSpace =\n-        max_coins_cache_size_bytes + std::max<int64_t>(int64_t(max_mempool_size_bytes) - nMempoolUsage, 0);\n+    int64_t nTotalSpace;\n+    // Don't share unused mempool space with dbcache in blocksonly mode to avoid surprising resource usage\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (gArgs.GetBoolArg(\"-blocksonly\", false)) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d68dc8244d81f899b28e0e7ca25501c02e99a986",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    if (gArgs.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY)) {\r\n```",
      "created_at": "2022-11-10T17:48:00Z",
      "updated_at": "2022-11-10T20:19:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1019443822",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019443822"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2342,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019447582",
      "pull_request_review_id": 1176240824,
      "id": 1019447582,
      "node_id": "PRRC_kwDOABII5848w4ke",
      "diff_hunk": "@@ -2336,8 +2336,16 @@ CoinsCacheSizeState Chainstate::GetCoinsCacheSizeState(\n     AssertLockHeld(::cs_main);\n     const int64_t nMempoolUsage = m_mempool ? m_mempool->DynamicMemoryUsage() : 0;\n     int64_t cacheSize = CoinsTip().DynamicMemoryUsage();\n-    int64_t nTotalSpace =\n-        max_coins_cache_size_bytes + std::max<int64_t>(int64_t(max_mempool_size_bytes) - nMempoolUsage, 0);\n+    int64_t nTotalSpace;\n+    // Don't share unused mempool space with dbcache in blocksonly mode to avoid surprising resource usage\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (gArgs.GetBoolArg(\"-blocksonly\", false)) {\n+        nTotalSpace =\n+            max_coins_cache_size_bytes;\n+    } else {\n+        nTotalSpace =\n+            max_coins_cache_size_bytes + std::max<int64_t>(int64_t(max_mempool_size_bytes) - nMempoolUsage, 0);\n+    }",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d68dc8244d81f899b28e0e7ca25501c02e99a986",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    int64_t nTotalSpace{max_coins_cache_size_bytes};\r\n    // Don't share unused mempool space with dbcache in blocksonly mode to avoid surprising resource usage\r\n    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\r\n    if (!gArgs.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY)) {\r\n        nTotalSpace += std::max<int64_t>(int64_t(max_mempool_size_bytes) - nMempoolUsage, 0);\r\n    }\r\n```",
      "created_at": "2022-11-10T17:52:06Z",
      "updated_at": "2022-11-10T20:19:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1019447582",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019447582"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 2339,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2348,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019448405",
      "pull_request_review_id": 1176240824,
      "id": 1019448405,
      "node_id": "PRRC_kwDOABII5848w4xV",
      "diff_hunk": "@@ -1467,7 +1467,8 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    float shared_mempool_space = args.GetBoolArg(\"-blocksonly\", false) ? 0 : mempool_opts.max_size_bytes * (1.0 / 1024 / 1024);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d68dc8244d81f899b28e0e7ca25501c02e99a986",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    float shared_mempool_space{args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) ? 0 : mempool_opts.max_size_bytes * (1.0 / 1024 / 1024)};\r\n```",
      "created_at": "2022-11-10T17:53:00Z",
      "updated_at": "2022-11-10T20:19:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1019448405",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019448405"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1470,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1020227691",
      "pull_request_review_id": 1177352470,
      "id": 1020227691,
      "node_id": "PRRC_kwDOABII5848z3Br",
      "diff_hunk": "@@ -2336,8 +2336,16 @@ CoinsCacheSizeState Chainstate::GetCoinsCacheSizeState(\n     AssertLockHeld(::cs_main);\n     const int64_t nMempoolUsage = m_mempool ? m_mempool->DynamicMemoryUsage() : 0;\n     int64_t cacheSize = CoinsTip().DynamicMemoryUsage();\n-    int64_t nTotalSpace =\n-        max_coins_cache_size_bytes + std::max<int64_t>(int64_t(max_mempool_size_bytes) - nMempoolUsage, 0);\n+    int64_t nTotalSpace;\n+    // Don't share unused mempool space with dbcache in blocksonly mode to avoid surprising resource usage\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (gArgs.GetBoolArg(\"-blocksonly\", false)) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d68dc8244d81f899b28e0e7ca25501c02e99a986",
      "in_reply_to_id": 1019443822,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is in net.h, which I don't really want to add as a new dependency for validation.cpp 🤔 ",
      "created_at": "2022-11-11T13:39:35Z",
      "updated_at": "2022-11-11T13:39:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1020227691",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1020227691"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2342,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1020254514",
      "pull_request_review_id": 1177392924,
      "id": 1020254514,
      "node_id": "PRRC_kwDOABII5848z9ky",
      "diff_hunk": "@@ -2336,8 +2336,16 @@ CoinsCacheSizeState Chainstate::GetCoinsCacheSizeState(\n     AssertLockHeld(::cs_main);\n     const int64_t nMempoolUsage = m_mempool ? m_mempool->DynamicMemoryUsage() : 0;\n     int64_t cacheSize = CoinsTip().DynamicMemoryUsage();\n-    int64_t nTotalSpace =\n-        max_coins_cache_size_bytes + std::max<int64_t>(int64_t(max_mempool_size_bytes) - nMempoolUsage, 0);\n+    int64_t nTotalSpace;\n+    // Don't share unused mempool space with dbcache in blocksonly mode to avoid surprising resource usage\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (gArgs.GetBoolArg(\"-blocksonly\", false)) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d68dc8244d81f899b28e0e7ca25501c02e99a986",
      "in_reply_to_id": 1019443822,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fair enough, but then I think `DEFAULT_BLOCKSONLY` should be declared in a different header (not too sure where that would be, hopefully someone more familiar can chime in). Redeclaring default values in multiple locations scares me.",
      "created_at": "2022-11-11T14:13:27Z",
      "updated_at": "2022-11-11T14:13:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1020254514",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1020254514"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2342,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071341512",
      "pull_request_review_id": 1250318830,
      "id": 1071341512,
      "node_id": "PRRC_kwDOABII584_21_I",
      "diff_hunk": "@@ -2336,8 +2336,16 @@ CoinsCacheSizeState Chainstate::GetCoinsCacheSizeState(\n     AssertLockHeld(::cs_main);\n     const int64_t nMempoolUsage = m_mempool ? m_mempool->DynamicMemoryUsage() : 0;\n     int64_t cacheSize = CoinsTip().DynamicMemoryUsage();\n-    int64_t nTotalSpace =\n-        max_coins_cache_size_bytes + std::max<int64_t>(int64_t(max_mempool_size_bytes) - nMempoolUsage, 0);\n+    int64_t nTotalSpace;\n+    // Don't share unused mempool space with dbcache in blocksonly mode to avoid surprising resource usage\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (gArgs.GetBoolArg(\"-blocksonly\", false)) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d68dc8244d81f899b28e0e7ca25501c02e99a986",
      "in_reply_to_id": 1019443822,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ideally we should probably remove Chainstate's dependency on `ArgsManager` and introduce some chainstate options. That should probably happen in a separate PR though.",
      "created_at": "2023-01-16T15:02:59Z",
      "updated_at": "2023-01-16T15:03:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1071341512",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071341512"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2342,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071982767",
      "pull_request_review_id": 1251221155,
      "id": 1071982767,
      "node_id": "PRRC_kwDOABII584_5Siv",
      "diff_hunk": "@@ -1467,7 +1467,16 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (args.GetBoolArg(\"-blocksonly\", 0) && !args.IsArgSet(\"-maxmempool\")) {",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "4a17be6d4d025e1381fc37e43794a413b3654b6d",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 4a17be6d4d025e1381fc37e43794a413b3654b6d: Now that you're in `init.cpp` you can use `DEFAULT_BLOCKSONLY`.\r\n\r\n```suggestion\r\n    if (args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) && !args.IsArgSet(\"-maxmempool\")) {\r\n```\r\n",
      "created_at": "2023-01-17T09:44:54Z",
      "updated_at": "2023-01-17T10:13:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1071982767",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071982767"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1473,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071988837",
      "pull_request_review_id": 1251221155,
      "id": 1071988837,
      "node_id": "PRRC_kwDOABII584_5UBl",
      "diff_hunk": "@@ -16,10 +16,14 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except for from whitelisted peers and as part of blocks.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 5,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "a0af9931bc84f44a64daa87860c524eab44c76b1",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in a0af9931bc84f44a64daa87860c524eab44c76b1\r\n```suggestion\r\n- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\r\n```",
      "created_at": "2023-01-17T09:50:17Z",
      "updated_at": "2023-01-17T10:13:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1071988837",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1071988837"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072010938",
      "pull_request_review_id": 1251221155,
      "id": 1072010938,
      "node_id": "PRRC_kwDOABII584_5Za6",
      "diff_hunk": "@@ -1467,7 +1467,16 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (args.GetBoolArg(\"-blocksonly\", 0) && !args.IsArgSet(\"-maxmempool\")) {\n+        // Re-use descendant_limit_bytes as the minimum mempool size\n+        mempool_opts.max_size_bytes = descendant_limit_bytes;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "4a17be6d4d025e1381fc37e43794a413b3654b6d",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: `descendant_limit_bytes` is around 3.9MB and not 5MB as claimed. Should the documentation be changed to reflect this or it doesn't really matter?",
      "created_at": "2023-01-17T10:07:01Z",
      "updated_at": "2023-01-17T10:13:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072010938",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072010938"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1475,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072017880",
      "pull_request_review_id": 1251221155,
      "id": 1072017880,
      "node_id": "PRRC_kwDOABII584_5bHY",
      "diff_hunk": "@@ -16,10 +16,14 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except for from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n+  - In `-blocksonly` mode the node will by default use a 5MB mempool size, avoiding unexpected memory usage from dbcache sharing the 300MB default mempool cache size.\n+\n+  - If you would like to continue using the mempool cache allocation for dbcache in `-blocksonly` mode then you can specify the mempool size using the `maxmempoolsize` option.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 11,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "dd4325981bc79759d40e67cda91447a3da9fe083",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: Maybe also add a note saying that setting `-limitdescendantsize` can also alter the cache size with `-blocksonly`?\r\n\r\n`./src/bitcoind -limitdescendantsize=0`\r\n> Using 440.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n\r\n`./src/bitcoind -limitdescendantsize=300`\r\n> Using 440.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n\r\n---\r\n`./src/bitcoind -limitdescendantsize=0 -blocksonly`\r\n> Using 440.0 MiB for in-memory UTXO set (plus up to 0.0 MiB of unused mempool space)\r\n\r\n`./src/bitcoind -limitdescendantsize=300 -blocksonly`\r\n> Using 440.0 MiB for in-memory UTXO set (plus up to 11.4 MiB of unused mempool space)",
      "created_at": "2023-01-17T10:13:25Z",
      "updated_at": "2023-01-17T10:13:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072017880",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072017880"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 23,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072020217",
      "pull_request_review_id": 1251274711,
      "id": 1072020217,
      "node_id": "PRRC_kwDOABII584_5br5",
      "diff_hunk": "@@ -1467,7 +1467,16 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (args.GetBoolArg(\"-blocksonly\", 0) && !args.IsArgSet(\"-maxmempool\")) {",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "4a17be6d4d025e1381fc37e43794a413b3654b6d",
      "in_reply_to_id": 1071982767,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah yes indeed. Thanks!",
      "created_at": "2023-01-17T10:15:35Z",
      "updated_at": "2023-01-17T10:15:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072020217",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072020217"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1473,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072021960",
      "pull_request_review_id": 1251277203,
      "id": 1072021960,
      "node_id": "PRRC_kwDOABII584_5cHI",
      "diff_hunk": "@@ -16,10 +16,14 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except for from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n+  - In `-blocksonly` mode the node will by default use a 5MB mempool size, avoiding unexpected memory usage from dbcache sharing the 300MB default mempool cache size.\n+\n+  - If you would like to continue using the mempool cache allocation for dbcache in `-blocksonly` mode then you can specify the mempool size using the `maxmempoolsize` option.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 11,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "dd4325981bc79759d40e67cda91447a3da9fe083",
      "in_reply_to_id": 1072017880,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Hmmm you are right. I wanted to avoid another magic constant if possible, but this does indeed have unintended side effects. I am going to revert it to 5MB for now",
      "created_at": "2023-01-17T10:17:08Z",
      "updated_at": "2023-01-17T10:17:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072021960",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072021960"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 23,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072063828",
      "pull_request_review_id": 1251339051,
      "id": 1072063828,
      "node_id": "PRRC_kwDOABII584_5mVU",
      "diff_hunk": "@@ -1467,7 +1467,15 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) && !args.IsArgSet(\"-maxmempool\")) {\n+        mempool_opts.max_size_bytes = 5 * 1'000'000;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: This should probably be stored as a constant such as `DEFAULT_BLOCKSONLY_MEMPOOL_MAX_SIZE`.",
      "created_at": "2023-01-17T10:57:59Z",
      "updated_at": "2023-01-17T11:10:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072063828",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072063828"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1474,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072124052",
      "pull_request_review_id": 1251428711,
      "id": 1072124052,
      "node_id": "PRRC_kwDOABII584_51CU",
      "diff_hunk": "@@ -16,10 +16,14 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 5,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n- To disable most of the mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\r\n```",
      "created_at": "2023-01-17T12:03:28Z",
      "updated_at": "2023-01-17T12:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072124052",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072124052"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072128199",
      "pull_request_review_id": 1251428711,
      "id": 1072128199,
      "node_id": "PRRC_kwDOABII584_52DH",
      "diff_hunk": "@@ -16,10 +16,14 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n+  - In `-blocksonly` mode the node will by default use a 5MB mempool size, avoiding unexpected memory usage from dbcache sharing the 300MB default mempool cache size.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It seems we're not doing this in other parts of the document, but if we reference the constant ([suggested](https://github.com/bitcoin/bitcoin/pull/26471/files#r1072063828) by aureleoules which I +1) that would make it easier to keep the docs in sync with future changes to the constant? \r\n\r\n```suggestion\r\n  - In `-blocksonly` mode the node will by default use a 5MB mempool size (`DEFAULT_BLOCKSONLY_MEMPOOL_MAX_SIZE`), avoiding unexpected memory usage from dbcache sharing the 300MB default mempool cache size.\r\n```",
      "created_at": "2023-01-17T12:08:04Z",
      "updated_at": "2023-01-17T12:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072128199",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072128199"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072132472",
      "pull_request_review_id": 1251428711,
      "id": 1072132472,
      "node_id": "PRRC_kwDOABII584_53F4",
      "diff_hunk": "@@ -16,10 +16,14 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n+  - In `-blocksonly` mode the node will by default use a 5MB mempool size, avoiding unexpected memory usage from dbcache sharing the 300MB default mempool cache size.\n+\n+  - If you would like to continue using the mempool cache allocation for dbcache in `-blocksonly` mode then you can specify the mempool size using the `maxmempoolsize` option.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 11,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n  - If you would like to continue using the mempool cache allocation for dbcache in `-blocksonly` mode then you can specify the mempool size using the `-maxmempool` option.\r\n```",
      "created_at": "2023-01-17T12:12:40Z",
      "updated_at": "2023-01-17T12:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072132472",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072132472"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072133159",
      "pull_request_review_id": 1251428711,
      "id": 1072133159,
      "node_id": "PRRC_kwDOABII584_53Qn",
      "diff_hunk": "@@ -0,0 +1,14 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n- Previously running with the `-blocksonly` option all but disabled the\r\n```",
      "created_at": "2023-01-17T12:13:26Z",
      "updated_at": "2023-01-17T12:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072133159",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072133159"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072134429",
      "pull_request_review_id": 1251428711,
      "id": 1072134429,
      "node_id": "PRRC_kwDOABII584_53kd",
      "diff_hunk": "@@ -0,0 +1,14 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the\n+  mempool but continued to allocate 300MB of cache for it, which would be\n+  shared with the dbcache. This might lead to unexpected resource usage of\n+  nodes running with this option during for example IBD.",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 7,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n  shared with the dbcache. This might lead to nodes running with this\r\n  option using more resources than anticipated, especially during IBD.\r\n```",
      "created_at": "2023-01-17T12:14:44Z",
      "updated_at": "2023-01-17T12:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072134429",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072134429"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 6,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 7,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072135993",
      "pull_request_review_id": 1251428711,
      "id": 1072135993,
      "node_id": "PRRC_kwDOABII584_5385",
      "diff_hunk": "@@ -0,0 +1,14 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the\n+  mempool but continued to allocate 300MB of cache for it, which would be\n+  shared with the dbcache. This might lead to unexpected resource usage of\n+  nodes running with this option during for example IBD.\n+\n+  In this release running with `-blocksonly` will only allocate 5MB to the\n+  mempool by default, permitting the use-case of relaying transactions from\n+  whitelisted peers, but avoiding unexpected resource usage.",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 11,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n  whitelisted peers, but avoiding unexpected resource usage. It reduces the\r\n  available `dbcache` size by 295MB, impacting performance especially during\r\n  IBD.\r\n```",
      "created_at": "2023-01-17T12:16:21Z",
      "updated_at": "2023-01-17T12:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072135993",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072135993"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 11,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072142630",
      "pull_request_review_id": 1251428711,
      "id": 1072142630,
      "node_id": "PRRC_kwDOABII584_55km",
      "diff_hunk": "@@ -1467,7 +1467,15 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In quite a few places we refer to mempool cache being added to dbcache, but it's added specifically to the coins/UTXO cache so I think our language should reflect that consistently? (here and in other places)\r\n\r\n```suggestion\r\n    // unless the user specifies -maxmempool, as otherwise it will leak into UTXO cache allowance.\r\n```",
      "created_at": "2023-01-17T12:23:12Z",
      "updated_at": "2023-01-17T12:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072142630",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072142630"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1471,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072155280",
      "pull_request_review_id": 1251428711,
      "id": 1072155280,
      "node_id": "PRRC_kwDOABII584_58qQ",
      "diff_hunk": "@@ -1467,7 +1467,15 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) && !args.IsArgSet(\"-maxmempool\")) {\n+        mempool_opts.max_size_bytes = 5 * 1'000'000;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Have you considered adding this logic to `mempool_args.cpp::ApplyArgsManOptions()` instead, so we don't set our `mempool_opts.max_size_bytes` in two different locations? I think this has the benefit of 1) being easier to understand why options are set to the values they are and 2) avoid unexpected issues/behaviour where `mempool_opts.max_size_bytes` is temporarily set to 300MB before being changed to 5MB.\r\n\r\nThe downside, [as previously discussed](https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1020227691), is including `net.h`, which probably needs fixing anyway (perhaps in separate PR?).\r\n\r\nI think I'd much prefer this approach.\r\n\r\n<details>\r\n<summary>git diff on 931924f5cc1dd9c82306a0ce59b62cf5c9276565</summary>\r\n\r\n```diff\r\ndiff --git a/src/init.cpp b/src/init.cpp\r\nindex c4b15392c..641fef81c 100644\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -1467,12 +1467,6 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\r\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\r\n     }\r\n-    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\r\n-    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\r\n-    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\r\n-    if (args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) && !args.IsArgSet(\"-maxmempool\")) {\r\n-        mempool_opts.max_size_bytes = 5 * 1'000'000;\r\n-    }\r\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\",\r\n               cache_sizes.coins * (1.0 / 1024 / 1024),\r\n               mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\r\ndiff --git a/src/node/mempool_args.cpp b/src/node/mempool_args.cpp\r\nindex 8c929e5e0..b530ac981 100644\r\n--- a/src/node/mempool_args.cpp\r\n+++ b/src/node/mempool_args.cpp\r\n@@ -10,6 +10,7 @@\r\n #include <chainparams.h>\r\n #include <consensus/amount.h>\r\n #include <logging.h>\r\n+#include <net.h>\r\n #include <policy/feerate.h>\r\n #include <policy/policy.h>\r\n #include <script/standard.h>\r\n@@ -42,7 +43,14 @@ std::optional<bilingual_str> ApplyArgsManOptions(const ArgsManager& argsman, con\r\n {\r\n     mempool_opts.check_ratio = argsman.GetIntArg(\"-checkmempool\", mempool_opts.check_ratio);\r\n \r\n-    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) mempool_opts.max_size_bytes = *mb * 1'000'000;\r\n+    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) {\r\n+        mempool_opts.max_size_bytes = *mb * 1'000'000;\r\n+    } else if (argsman.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY)) {\r\n+        // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\r\n+        // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\r\n+        // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\r\n+        mempool_opts.max_size_bytes = 5 * 1'000'000;\r\n+    }\r\n \r\n     if (auto hours = argsman.GetIntArg(\"-mempoolexpiry\")) mempool_opts.expiry = std::chrono::hours{*hours};\r\n ```\r\n</details>\r\n",
      "created_at": "2023-01-17T12:36:24Z",
      "updated_at": "2023-01-17T12:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072155280",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072155280"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 1473,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1474,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072276959",
      "pull_request_review_id": 1251655422,
      "id": 1072276959,
      "node_id": "PRRC_kwDOABII584_6aXf",
      "diff_hunk": "@@ -1467,7 +1467,15 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) && !args.IsArgSet(\"-maxmempool\")) {\n+        mempool_opts.max_size_bytes = 5 * 1'000'000;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072155280,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The docstring can also be simplified now btw, since the described behaviour is in the same if/else",
      "created_at": "2023-01-17T14:26:52Z",
      "updated_at": "2023-01-17T14:26:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072276959",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072276959"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 1473,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1474,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072302193",
      "pull_request_review_id": 1251694267,
      "id": 1072302193,
      "node_id": "PRRC_kwDOABII584_6ghx",
      "diff_hunk": "@@ -16,10 +16,14 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 5,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072124052,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-01-17T14:47:24Z",
      "updated_at": "2023-01-17T14:47:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072302193",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072302193"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072302491",
      "pull_request_review_id": 1251694716,
      "id": 1072302491,
      "node_id": "PRRC_kwDOABII584_6gmb",
      "diff_hunk": "@@ -16,10 +16,14 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n+  - In `-blocksonly` mode the node will by default use a 5MB mempool size, avoiding unexpected memory usage from dbcache sharing the 300MB default mempool cache size.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072128199,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done (for now, pending including net.h)",
      "created_at": "2023-01-17T14:47:38Z",
      "updated_at": "2023-01-17T14:47:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072302491",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072302491"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072302695",
      "pull_request_review_id": 1251695065,
      "id": 1072302695,
      "node_id": "PRRC_kwDOABII584_6gpn",
      "diff_hunk": "@@ -16,10 +16,14 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- To disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n+  - In `-blocksonly` mode the node will by default use a 5MB mempool size, avoiding unexpected memory usage from dbcache sharing the 300MB default mempool cache size.\n+\n+  - If you would like to continue using the mempool cache allocation for dbcache in `-blocksonly` mode then you can specify the mempool size using the `maxmempoolsize` option.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 11,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072132472,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Whoops, fixed.",
      "created_at": "2023-01-17T14:47:49Z",
      "updated_at": "2023-01-17T14:47:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072302695",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072302695"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072303420",
      "pull_request_review_id": 1251696175,
      "id": 1072303420,
      "node_id": "PRRC_kwDOABII584_6g08",
      "diff_hunk": "@@ -0,0 +1,14 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072133159,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Personally I feel \"effectively disabled\" is cleared here, so I've left it as-is for now (but happy to be persuaded)",
      "created_at": "2023-01-17T14:48:24Z",
      "updated_at": "2023-01-17T14:48:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072303420",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072303420"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072303555",
      "pull_request_review_id": 1251696373,
      "id": 1072303555,
      "node_id": "PRRC_kwDOABII584_6g3D",
      "diff_hunk": "@@ -0,0 +1,14 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the\n+  mempool but continued to allocate 300MB of cache for it, which would be\n+  shared with the dbcache. This might lead to unexpected resource usage of\n+  nodes running with this option during for example IBD.",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 7,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072134429,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-01-17T14:48:30Z",
      "updated_at": "2023-01-17T14:48:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072303555",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072303555"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 6,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 7,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072303774",
      "pull_request_review_id": 1251696680,
      "id": 1072303774,
      "node_id": "PRRC_kwDOABII584_6g6e",
      "diff_hunk": "@@ -0,0 +1,14 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the\n+  mempool but continued to allocate 300MB of cache for it, which would be\n+  shared with the dbcache. This might lead to unexpected resource usage of\n+  nodes running with this option during for example IBD.\n+\n+  In this release running with `-blocksonly` will only allocate 5MB to the\n+  mempool by default, permitting the use-case of relaying transactions from\n+  whitelisted peers, but avoiding unexpected resource usage.",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 11,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072135993,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-01-17T14:48:40Z",
      "updated_at": "2023-01-17T14:48:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072303774",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072303774"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 11,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072304359",
      "pull_request_review_id": 1251697562,
      "id": 1072304359,
      "node_id": "PRRC_kwDOABII584_6hDn",
      "diff_hunk": "@@ -1467,7 +1467,15 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072142630,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agreed and changed.",
      "created_at": "2023-01-17T14:49:08Z",
      "updated_at": "2023-01-17T14:49:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072304359",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072304359"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1471,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072347689",
      "pull_request_review_id": 1251772408,
      "id": 1072347689,
      "node_id": "PRRC_kwDOABII584_6rop",
      "diff_hunk": "@@ -0,0 +1,14 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072133159,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The definition \"actually but not officially or explicitly\" captures \"effectively\" quite well for me, and in that sense I think is wrong here. But won't comment further, not that important.",
      "created_at": "2023-01-17T15:22:48Z",
      "updated_at": "2023-01-17T15:22:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072347689",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072347689"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072355078",
      "pull_request_review_id": 1251784500,
      "id": 1072355078,
      "node_id": "PRRC_kwDOABII584_6tcG",
      "diff_hunk": "@@ -2336,8 +2336,16 @@ CoinsCacheSizeState Chainstate::GetCoinsCacheSizeState(\n     AssertLockHeld(::cs_main);\n     const int64_t nMempoolUsage = m_mempool ? m_mempool->DynamicMemoryUsage() : 0;\n     int64_t cacheSize = CoinsTip().DynamicMemoryUsage();\n-    int64_t nTotalSpace =\n-        max_coins_cache_size_bytes + std::max<int64_t>(int64_t(max_mempool_size_bytes) - nMempoolUsage, 0);\n+    int64_t nTotalSpace;\n+    // Don't share unused mempool space with dbcache in blocksonly mode to avoid surprising resource usage\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (gArgs.GetBoolArg(\"-blocksonly\", false)) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d68dc8244d81f899b28e0e7ca25501c02e99a986",
      "in_reply_to_id": 1019443822,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Right. Have taken a new direction though for now as per https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072155280",
      "created_at": "2023-01-17T15:28:27Z",
      "updated_at": "2023-01-17T15:28:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072355078",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072355078"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2342,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072360117",
      "pull_request_review_id": 1251792321,
      "id": 1072360117,
      "node_id": "PRRC_kwDOABII584_6uq1",
      "diff_hunk": "@@ -1467,7 +1467,15 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) && !args.IsArgSet(\"-maxmempool\")) {\n+        mempool_opts.max_size_bytes = 5 * 1'000'000;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072063828,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done (as `DEFAULT_BLOCKSONLY_MAX_MEMPOOL_SIZE_MB`)",
      "created_at": "2023-01-17T15:32:36Z",
      "updated_at": "2023-01-17T15:32:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072360117",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072360117"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1474,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072362377",
      "pull_request_review_id": 1251795605,
      "id": 1072362377,
      "node_id": "PRRC_kwDOABII584_6vOJ",
      "diff_hunk": "@@ -1467,7 +1467,15 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     if (mempool_opts.max_size_bytes < 0 || mempool_opts.max_size_bytes < descendant_limit_bytes) {\n         return InitError(strprintf(_(\"-maxmempool must be at least %d MB\"), std::ceil(descendant_limit_bytes / 1'000'000.0)));\n     }\n-    LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n+    // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+    // unless the user specifies -maxmempool, as otherwise it will leak into dbcache allowance.\n+    // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+    if (args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) && !args.IsArgSet(\"-maxmempool\")) {\n+        mempool_opts.max_size_bytes = 5 * 1'000'000;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072155280,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Moved logic into `mempool_args.cpp::ApplyArgsManOptions()` as this seems both cleaner, and a more logical place for it.\r\n\r\nAdding net.h to mempool_args.cpp increased translation unit line count by 29 lines",
      "created_at": "2023-01-17T15:34:24Z",
      "updated_at": "2023-01-17T15:34:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072362377",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1072362377"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 1473,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1474,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073324347",
      "pull_request_review_id": 1253163234,
      "id": 1073324347,
      "node_id": "PRRC_kwDOABII584_-aE7",
      "diff_hunk": "@@ -18,6 +18,8 @@ class CBlockPolicyEstimator;\n \n /** Default for -maxmempool, maximum megabytes of mempool memory usage */\n static constexpr unsigned int DEFAULT_MAX_MEMPOOL_SIZE_MB{300};\n+//** Defaul for -maxmempool when blocksonly is set */",
      "path": "src/kernel/mempool_options.h",
      "position": null,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d4b0d062e413e73c70de4532cab677bd026db655",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit d4b0d062e413e73c70de4532cab677bd026db655\r\n```suggestion\r\n/** Default for -maxmempool when blocksonly is set */\r\n```",
      "created_at": "2023-01-18T09:58:43Z",
      "updated_at": "2023-01-20T10:29:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1073324347",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073324347"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073344764",
      "pull_request_review_id": 1253163234,
      "id": 1073344764,
      "node_id": "PRRC_kwDOABII584_-fD8",
      "diff_hunk": "@@ -42,7 +43,14 @@ std::optional<bilingual_str> ApplyArgsManOptions(const ArgsManager& argsman, con\n {\n     mempool_opts.check_ratio = argsman.GetIntArg(\"-checkmempool\", mempool_opts.check_ratio);\n \n-    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) mempool_opts.max_size_bytes = *mb * 1'000'000;\n+    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) {\n+        mempool_opts.max_size_bytes = *mb * 1'000'000;\n+    } else if (argsman.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY)) {\n+        // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+        // unless the user specifies -maxmempool, as otherwise it will leak into coins/UTXO cache allowance.\n+        // Keeping the mempool enabled will still permit transaction relay for whitelisted peers",
      "path": "src/node/mempool_args.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "d4b0d062e413e73c70de4532cab677bd026db655\r\n\r\n\"leaking\" doesn't seem like the right term for this, and I think the more precise explanation is \"we probably won't need it.\"\r\n```suggestion\r\n        // If we are running in blocksonly mode, unless the user specified -maxmempool,\r\n        // reduce the capacity to 5MB, as we only expect to store transactions from whitelisted\r\n        // peers and are thus unlikely to require 300MB.\r\n```",
      "created_at": "2023-01-18T10:17:11Z",
      "updated_at": "2023-01-20T10:29:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1073344764",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073344764"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 49,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 51,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073370474",
      "pull_request_review_id": 1253163234,
      "id": 1073370474,
      "node_id": "PRRC_kwDOABII584_-lVq",
      "diff_hunk": "@@ -16,11 +16,15 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+\n+- To disable most of the mempool functionality there is the `-blocksonly` option. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 7,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "a5c33e7e5f8dc068b66178830e80431f87e0e4b8",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "a5c33e7e5f8dc068b66178830e80431f87e0e4b8\r\n\r\n```suggestion\r\n- To disable most of the mempool functionality there is the `-blocksonly` option. This will reduce the default memory usage to 5MB and make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\r\n```",
      "created_at": "2023-01-18T10:40:59Z",
      "updated_at": "2023-01-20T10:29:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1073370474",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073370474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073371615",
      "pull_request_review_id": 1253163234,
      "id": 1073371615,
      "node_id": "PRRC_kwDOABII584_-lnf",
      "diff_hunk": "@@ -16,11 +16,15 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+\n+- To disable most of the mempool functionality there is the `-blocksonly` option. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n-- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+  - In `-blocksonly` mode the node will by default use a 5MB (`DEFAULT_BLOCKSONLY_MEMPOOL_MAX_SIZE_MB`) mempool size, avoiding unexpected memory usage from the UTXO cache sharing the 300MB default mempool cache size.\n+\n+  - If you would like to continue using the mempool cache allocation for the UTXO cache in `-blocksonly` mode (to help speed up IBD) then you can specify the mempool size using the `-maxmempool` option.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 14,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "a5c33e7e5f8dc068b66178830e80431f87e0e4b8",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "a5c33e7e5f8dc068b66178830e80431f87e0e4b8 \r\n\r\nI would recommend just adding the 5MB note to the -blocksonly bullet point (see other comment). This last bullet point is unnecessary imo, this is the doc about saving memory.",
      "created_at": "2023-01-18T10:42:04Z",
      "updated_at": "2023-01-20T10:29:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1073371615",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073371615"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 25,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073376094",
      "pull_request_review_id": 1253163234,
      "id": 1073376094,
      "node_id": "PRRC_kwDOABII584_-mte",
      "diff_hunk": "@@ -0,0 +1,16 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the\n+  mempool but continued to allocate 300MB of cache for it, which would be\n+  shared with the UTXO cache. This might lead to nodes running with this\n+  option using more resources than anticipated, especially during IBD.\n+\n+  In this release running with `-blocksonly` will only allocate 5MB to the\n+  mempool by default, permitting the use-case of relaying transactions from\n+  whitelisted peers, but avoiding unexpected resource usage. It reduces the\n+  available `dbcache` size by 295MB, impacting performance especially during\n+  IBD.",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 13,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb\r\n\r\n> Previously running with the `-blocksonly` option effectively disabled the mempool ...\r\n\r\n> ... In this release running with `-blocksonly` will only allocate 5MB to the mempool by default, permitting the use-case of relaying transactions from whitelisted peers\"\r\n\r\nI think \"effectively disabled\" is fine. But this mention of the whitelist relay behavior later sounds, to me, sounds like it is new. I don't think it needs to be mentioned at all?\r\n\r\n```suggestion\r\n- Setting `-blocksonly` will now reduce the maximum mempool memory\r\n  to 5MB (users may still use `-maxmempool` to override). Previously,\r\n  the default 300MB would be used, leading to unexpected memory usage\r\n  for users running with `-blocksonly` expecting it to eliminate\r\n  mempool memory usage.\r\n  \r\n  As unused mempool memory is shared with dbcache, this also reduces\r\n  the dbcache size for users running with `-blocksonly`, potentially\r\n  impacting performance.\r\n```",
      "created_at": "2023-01-18T10:46:40Z",
      "updated_at": "2023-01-20T10:29:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1073376094",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1073376094"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 4,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 13,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081618786",
      "pull_request_review_id": 1262313329,
      "id": 1081618786,
      "node_id": "PRRC_kwDOABII585AeDFi",
      "diff_hunk": "@@ -18,6 +18,8 @@ class CBlockPolicyEstimator;\n \n /** Default for -maxmempool, maximum megabytes of mempool memory usage */\n static constexpr unsigned int DEFAULT_MAX_MEMPOOL_SIZE_MB{300};\n+//** Defaul for -maxmempool when blocksonly is set */",
      "path": "src/kernel/mempool_options.h",
      "position": null,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n/** Default for -maxmempool when blocksonly is set */\r\n```",
      "created_at": "2023-01-19T17:48:58Z",
      "updated_at": "2023-01-19T17:51:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1081618786",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081618786"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081620192",
      "pull_request_review_id": 1262313329,
      "id": 1081620192,
      "node_id": "PRRC_kwDOABII585AeDbg",
      "diff_hunk": "@@ -0,0 +1,16 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the\n+  mempool but continued to allocate 300MB of cache for it, which would be\n+  shared with the UTXO cache. This might lead to nodes running with this\n+  option using more resources than anticipated, especially during IBD.\n+\n+  In this release running with `-blocksonly` will only allocate 5MB to the\n+  mempool by default, permitting the use-case of relaying transactions from\n+  whitelisted peers, but avoiding unexpected resource usage. It reduces the\n+  available `dbcache` size by 295MB, impacting performance especially during",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 12,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Perhaps need to add here that this is only true if `-maxmempool` is not set? We say it in other places, but better to not assume everyone reads everything, so seems like a safe option.",
      "created_at": "2023-01-19T17:50:09Z",
      "updated_at": "2023-01-19T17:51:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1081620192",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081620192"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 12,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081765373",
      "pull_request_review_id": 1262522690,
      "id": 1081765373,
      "node_id": "PRRC_kwDOABII585Aem39",
      "diff_hunk": "@@ -16,11 +16,15 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+\n+- To disable most of the mempool functionality there is the `-blocksonly` option. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n-- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+  - In `-blocksonly` mode the node will by default use a 5MB (`DEFAULT_BLOCKSONLY_MEMPOOL_MAX_SIZE_MB`) mempool size, avoiding unexpected memory usage from the UTXO cache sharing the 300MB default mempool cache size.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 12,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't think the internal constant name needs to be here?",
      "created_at": "2023-01-19T19:50:17Z",
      "updated_at": "2023-01-19T20:04:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1081765373",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081765373"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081769813",
      "pull_request_review_id": 1262522690,
      "id": 1081769813,
      "node_id": "PRRC_kwDOABII585Aen9V",
      "diff_hunk": "@@ -0,0 +1,16 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the\n+  mempool but continued to allocate 300MB of cache for it, which would be\n+  shared with the UTXO cache. This might lead to nodes running with this\n+  option using more resources than anticipated, especially during IBD.\n+\n+  In this release running with `-blocksonly` will only allocate 5MB to the\n+  mempool by default, permitting the use-case of relaying transactions from\n+  whitelisted peers, but avoiding unexpected resource usage. It reduces the\n+  available `dbcache` size by 295MB, impacting performance especially during",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 12,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": 1081620192,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe \"`-blocksonly` will reduce the default for `-maxmempool` from 300MB to 5MB\" ?",
      "created_at": "2023-01-19T19:52:41Z",
      "updated_at": "2023-01-19T20:04:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1081769813",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081769813"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 12,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081787510",
      "pull_request_review_id": 1262522690,
      "id": 1081787510,
      "node_id": "PRRC_kwDOABII585AesR2",
      "diff_hunk": "@@ -42,7 +43,14 @@ std::optional<bilingual_str> ApplyArgsManOptions(const ArgsManager& argsman, con\n {\n     mempool_opts.check_ratio = argsman.GetIntArg(\"-checkmempool\", mempool_opts.check_ratio);\n \n-    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) mempool_opts.max_size_bytes = *mb * 1'000'000;\n+    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) {\n+        mempool_opts.max_size_bytes = *mb * 1'000'000;\n+    } else if (argsman.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY)) {\n+        // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+        // unless the user specifies -maxmempool, as otherwise it will leak into coins/UTXO cache allowance.\n+        // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+        mempool_opts.max_size_bytes = DEFAULT_BLOCKSONLY_MAX_MEMPOOL_SIZE_MB * 1'000'000;",
      "path": "src/node/mempool_args.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I would have expected:\r\n\r\n```c++\r\nif (args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY)) {\r\n    if (args.SoftSetArg(\"-maxmempool\", ToString(DEFAULT_BLOCKSONLY_MAX_MEMPOOL_SIZE_MB))) {\r\n        LogPrintf(\"%s: parameter interaction: -blocksonly=1 -> setting -maxmempool=%d\\n\", __func__, DEFAULT_BLOCKSONLY_MAX_MEMPOOL_SIZE_MB);\r\n    }\r\n}\r\n```\r\n\r\nin `InitParameterInteraction`.",
      "created_at": "2023-01-19T20:03:42Z",
      "updated_at": "2023-01-19T20:04:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1081787510",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1081787510"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082325871",
      "pull_request_review_id": 1263277383,
      "id": 1082325871,
      "node_id": "PRRC_kwDOABII585Agvtv",
      "diff_hunk": "@@ -16,11 +16,15 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+\n+- To disable most of the mempool functionality there is the `-blocksonly` option. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n-- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+  - In `-blocksonly` mode the node will by default use a 5MB (`DEFAULT_BLOCKSONLY_MEMPOOL_MAX_SIZE_MB`) mempool size, avoiding unexpected memory usage from the UTXO cache sharing the 300MB default mempool cache size.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 12,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": 1081765373,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I agree it looks a bit awkward but I suggested it to make it less likely we forget to keep the docs up to date when the constant changes in the future: https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1072128199\r\n\r\nNo strong view either way.",
      "created_at": "2023-01-20T10:16:50Z",
      "updated_at": "2023-01-20T10:17:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082325871",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082325871"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082356487",
      "pull_request_review_id": 1263322544,
      "id": 1082356487,
      "node_id": "PRRC_kwDOABII585Ag3MH",
      "diff_hunk": "@@ -18,6 +18,8 @@ class CBlockPolicyEstimator;\n \n /** Default for -maxmempool, maximum megabytes of mempool memory usage */\n static constexpr unsigned int DEFAULT_MAX_MEMPOOL_SIZE_MB{300};\n+//** Defaul for -maxmempool when blocksonly is set */",
      "path": "src/kernel/mempool_options.h",
      "position": null,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d4b0d062e413e73c70de4532cab677bd026db655",
      "in_reply_to_id": 1073324347,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "beat ya to it https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1081618786",
      "created_at": "2023-01-20T10:49:54Z",
      "updated_at": "2023-01-20T10:49:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082356487",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082356487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082492239",
      "pull_request_review_id": 1263534672,
      "id": 1082492239,
      "node_id": "PRRC_kwDOABII585AhYVP",
      "diff_hunk": "@@ -42,7 +43,14 @@ std::optional<bilingual_str> ApplyArgsManOptions(const ArgsManager& argsman, con\n {\n     mempool_opts.check_ratio = argsman.GetIntArg(\"-checkmempool\", mempool_opts.check_ratio);\n \n-    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) mempool_opts.max_size_bytes = *mb * 1'000'000;\n+    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) {\n+        mempool_opts.max_size_bytes = *mb * 1'000'000;\n+    } else if (argsman.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY)) {\n+        // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+        // unless the user specifies -maxmempool, as otherwise it will leak into coins/UTXO cache allowance.\n+        // Keeping the mempool enabled will still permit transaction relay for whitelisted peers\n+        mempool_opts.max_size_bytes = DEFAULT_BLOCKSONLY_MAX_MEMPOOL_SIZE_MB * 1'000'000;",
      "path": "src/node/mempool_args.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": 1081787510,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks! This both makes more sense, and avoids needing to include _net.h_ in _mempool_args.cpp_, which I didn't particularly like",
      "created_at": "2023-01-20T12:54:06Z",
      "updated_at": "2023-01-20T12:54:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082492239",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082492239"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082506345",
      "pull_request_review_id": 1263547053,
      "id": 1082506345,
      "node_id": "PRRC_kwDOABII585Ahbxp",
      "diff_hunk": "@@ -16,11 +16,15 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+\n+- To disable most of the mempool functionality there is the `-blocksonly` option. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n-- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+  - In `-blocksonly` mode the node will by default use a 5MB (`DEFAULT_BLOCKSONLY_MEMPOOL_MAX_SIZE_MB`) mempool size, avoiding unexpected memory usage from the UTXO cache sharing the 300MB default mempool cache size.\n+\n+  - If you would like to continue using the mempool cache allocation for the UTXO cache in `-blocksonly` mode (to help speed up IBD) then you can specify the mempool size using the `-maxmempool` option.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 14,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "a5c33e7e5f8dc068b66178830e80431f87e0e4b8",
      "in_reply_to_id": 1073371615,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agreed and done",
      "created_at": "2023-01-20T13:03:52Z",
      "updated_at": "2023-01-20T13:03:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082506345",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082506345"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 25,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082506517",
      "pull_request_review_id": 1263547233,
      "id": 1082506517,
      "node_id": "PRRC_kwDOABII585Ahb0V",
      "diff_hunk": "@@ -16,11 +16,15 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+\n+- To disable most of the mempool functionality there is the `-blocksonly` option. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 7,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "a5c33e7e5f8dc068b66178830e80431f87e0e4b8",
      "in_reply_to_id": 1073370474,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-01-20T13:03:59Z",
      "updated_at": "2023-01-20T13:04:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082506517",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082506517"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082508132",
      "pull_request_review_id": 1263548696,
      "id": 1082508132,
      "node_id": "PRRC_kwDOABII585AhcNk",
      "diff_hunk": "@@ -42,7 +43,14 @@ std::optional<bilingual_str> ApplyArgsManOptions(const ArgsManager& argsman, con\n {\n     mempool_opts.check_ratio = argsman.GetIntArg(\"-checkmempool\", mempool_opts.check_ratio);\n \n-    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) mempool_opts.max_size_bytes = *mb * 1'000'000;\n+    if (auto mb = argsman.GetIntArg(\"-maxmempool\")) {\n+        mempool_opts.max_size_bytes = *mb * 1'000'000;\n+    } else if (argsman.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY)) {\n+        // If we are running in blocksonly mode don't allocate the default 300MB of space for mempool\n+        // unless the user specifies -maxmempool, as otherwise it will leak into coins/UTXO cache allowance.\n+        // Keeping the mempool enabled will still permit transaction relay for whitelisted peers",
      "path": "src/node/mempool_args.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": 1073344764,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Removed text as part of using AJ's suggestion with `InitParameterInteraction`. I think combined with git log it should be easy enough for people to find out why this interaction was added.",
      "created_at": "2023-01-20T13:05:07Z",
      "updated_at": "2023-01-20T13:05:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082508132",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082508132"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 49,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 51,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082508610",
      "pull_request_review_id": 1263549144,
      "id": 1082508610,
      "node_id": "PRRC_kwDOABII585AhcVC",
      "diff_hunk": "@@ -18,6 +18,8 @@ class CBlockPolicyEstimator;\n \n /** Default for -maxmempool, maximum megabytes of mempool memory usage */\n static constexpr unsigned int DEFAULT_MAX_MEMPOOL_SIZE_MB{300};\n+//** Defaul for -maxmempool when blocksonly is set */",
      "path": "src/kernel/mempool_options.h",
      "position": null,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "d4b0d062e413e73c70de4532cab677bd026db655",
      "in_reply_to_id": 1073324347,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-01-20T13:05:28Z",
      "updated_at": "2023-01-20T13:05:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082508610",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082508610"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082530607",
      "pull_request_review_id": 1263571397,
      "id": 1082530607,
      "node_id": "PRRC_kwDOABII585Ahhsv",
      "diff_hunk": "@@ -0,0 +1,14 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "931924f5cc1dd9c82306a0ce59b62cf5c9276565",
      "in_reply_to_id": 1072133159,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Removed in new version",
      "created_at": "2023-01-20T13:22:50Z",
      "updated_at": "2023-01-20T13:22:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082530607",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082530607"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082530876",
      "pull_request_review_id": 1263571759,
      "id": 1082530876,
      "node_id": "PRRC_kwDOABII585Ahhw8",
      "diff_hunk": "@@ -18,6 +18,8 @@ class CBlockPolicyEstimator;\n \n /** Default for -maxmempool, maximum megabytes of mempool memory usage */\n static constexpr unsigned int DEFAULT_MAX_MEMPOOL_SIZE_MB{300};\n+//** Defaul for -maxmempool when blocksonly is set */",
      "path": "src/kernel/mempool_options.h",
      "position": null,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": 1081618786,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed",
      "created_at": "2023-01-20T13:23:06Z",
      "updated_at": "2023-01-20T13:23:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082530876",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082530876"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082531333",
      "pull_request_review_id": 1263572319,
      "id": 1082531333,
      "node_id": "PRRC_kwDOABII585Ahh4F",
      "diff_hunk": "@@ -16,11 +16,15 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+\n+- To disable most of the mempool functionality there is the `-blocksonly` option. This will make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.\n \n   - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n \n-- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n+  - In `-blocksonly` mode the node will by default use a 5MB (`DEFAULT_BLOCKSONLY_MEMPOOL_MAX_SIZE_MB`) mempool size, avoiding unexpected memory usage from the UTXO cache sharing the 300MB default mempool cache size.",
      "path": "doc/reduce-memory.md",
      "position": null,
      "original_position": 12,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": 1081765373,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Constant removed",
      "created_at": "2023-01-20T13:23:34Z",
      "updated_at": "2023-01-20T13:23:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082531333",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082531333"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082532985",
      "pull_request_review_id": 1263574648,
      "id": 1082532985,
      "node_id": "PRRC_kwDOABII585AhiR5",
      "diff_hunk": "@@ -0,0 +1,16 @@\n+Updated settings\n+----------------\n+\n+- Previously running with the `-blocksonly` option effectively disabled the\n+  mempool but continued to allocate 300MB of cache for it, which would be\n+  shared with the UTXO cache. This might lead to nodes running with this\n+  option using more resources than anticipated, especially during IBD.\n+\n+  In this release running with `-blocksonly` will only allocate 5MB to the\n+  mempool by default, permitting the use-case of relaying transactions from\n+  whitelisted peers, but avoiding unexpected resource usage. It reduces the\n+  available `dbcache` size by 295MB, impacting performance especially during\n+  IBD.",
      "path": "doc/release-notes-26471.md",
      "position": null,
      "original_position": 13,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "ed5ce6d0c911ac66bd5870a1711edef03a18ebeb",
      "in_reply_to_id": 1073376094,
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I agree that we don't  need to mention the whitelist relay behaviour, but its apparently something some people (might) [have been doing](https://github.com/bitcoin/bitcoin/pull/9569#issuecomment-273338305).\r\n\r\nAnyway, removed/",
      "created_at": "2023-01-20T13:25:24Z",
      "updated_at": "2023-01-20T13:25:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1082532985",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1082532985"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": 4,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 13,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083469754",
      "pull_request_review_id": 1264787233,
      "id": 1083469754,
      "node_id": "PRRC_kwDOABII585AlG-6",
      "diff_hunk": "@@ -18,6 +18,8 @@ class CBlockPolicyEstimator;\n \n /** Default for -maxmempool, maximum megabytes of mempool memory usage */\n static constexpr unsigned int DEFAULT_MAX_MEMPOOL_SIZE_MB{300};\n+//** Default for -maxmempool when blocksonly is set */",
      "path": "src/kernel/mempool_options.h",
      "position": 4,
      "original_position": 4,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n/** Default for -maxmempool when blocksonly is set */\r\n```",
      "created_at": "2023-01-22T14:57:04Z",
      "updated_at": "2023-01-22T14:57:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1083469754",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083469754"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 21,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083792487",
      "pull_request_review_id": 1265211607,
      "id": 1083792487,
      "node_id": "PRRC_kwDOABII585AmVxn",
      "diff_hunk": "@@ -16,11 +16,11 @@ The size of some in-memory caches can be reduced. As caches trade off memory usa\n   - The minimum value for `-maxmempool` is 5.\n   - A lower maximum mempool size means that transactions will be evicted sooner. This will affect any uses of `bitcoind` that process unconfirmed transactions.\n \n-- To completely disable mempool functionality there is the option `-blocksonly`. This will make the client opt out of receiving (and thus relaying) transactions completely, except as part of blocks.\n+- Since `0.14.0`, unused memory allocated to the mempool (default: 300MB) is shared with the UTXO cache, so when trying to reduce memory usage you should limit the mempool, with the `-maxmempool` command line argument.\n \n-  - Do not use this when using the client to broadcast transactions as any transaction sent will stick out like a sore thumb, affecting privacy. When used with the wallet it should be combined with `-walletbroadcast=0` and `-spendzeroconfchange=0`. Another mechanism for broadcasting outgoing transactions (if any) should be used.\n+- To disable most of the mempool functionality there is the `-blocksonly` option. This will reduce the default memory usage to 5MB and make the client opt out of receiving (and thus relaying) transactions, except from whitelisted peers and as part of blocks.",
      "path": "doc/reduce-memory.md",
      "position": 8,
      "original_position": 8,
      "commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "original_commit_id": "8e85164e7d12be324ea1af2e288ebcf689c930b7",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: Instead of whitelisted, it would be good to mention the exact permission flag.",
      "created_at": "2023-01-23T09:09:23Z",
      "updated_at": "2023-01-23T09:09:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26471#discussion_r1083792487",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083792487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26471"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 21,
      "original_line": 21,
      "side": "RIGHT"
    }
  ]
}