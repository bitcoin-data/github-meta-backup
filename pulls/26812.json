{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812",
    "id": 1185011431,
    "node_id": "PR_kwDOABII585Godbn",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/26812",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/26812.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/26812.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/4c867de996f58655aec3911f45367eb31865fb4d",
    "number": 26812,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "test: add end-to-end tests for CConnman and PeerManager",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Add fuzz and unit tests that write (fuzzed) data to a mocked socket and inspect what CConnman/PeerManager have written back to the socket, or check the internal state to verify that the behavior is as expected.\r\n\r\nThis is now possible, after most of https://github.com/bitcoin/bitcoin/pull/21878 has been merged - we don't do any syscalls (e.g. `connect()`, `recv()`) from the high level code and using a mocked socket allows testing the entire networking stack without opening actual network connections.",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "created_at": "2023-01-04T14:39:37Z",
    "updated_at": "2023-06-06T23:26:47Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "1bf817690540add0e8641ab8872f6bfa75ab1627",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "vasild:e2e_tests",
      "ref": "e2e_tests",
      "sha": "4c867de996f58655aec3911f45367eb31865fb4d",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 120608826,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMjA2MDg4MjY=",
        "name": "bitcoin",
        "full_name": "vasild/bitcoin",
        "owner": {
          "login": "vasild",
          "id": 266751,
          "node_id": "MDQ6VXNlcjI2Njc1MQ==",
          "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/vasild",
          "html_url": "https://github.com/vasild",
          "followers_url": "https://api.github.com/users/vasild/followers",
          "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
          "organizations_url": "https://api.github.com/users/vasild/orgs",
          "repos_url": "https://api.github.com/users/vasild/repos",
          "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/vasild/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/vasild/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/vasild/bitcoin",
        "archive_url": "https://api.github.com/repos/vasild/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/vasild/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/vasild/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/vasild/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/vasild/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/vasild/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/vasild/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/vasild/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/vasild/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/vasild/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/vasild/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/vasild/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/vasild/bitcoin/events",
        "forks_url": "https://api.github.com/repos/vasild/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/vasild/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/vasild/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/vasild/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/vasild/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/vasild/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/vasild/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/vasild/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/vasild/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/vasild/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/vasild/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/vasild/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/vasild/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/vasild/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/vasild/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/vasild/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:vasild/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/vasild/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/vasild/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/vasild/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/vasild/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/vasild/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/vasild/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/vasild/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/vasild/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/vasild/bitcoin/hooks",
        "svn_url": "https://github.com/vasild/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 3,
        "watchers_count": 3,
        "size": 211824,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T10:22:48Z",
        "created_at": "2018-02-07T11:52:47Z",
        "updated_at": "2023-01-31T16:56:52Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "8cc65f093c0cf7a27b3bfc6da90fd7a6ac8f5e48",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34325,
        "stargazers_count": 69818,
        "watchers_count": 69818,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T07:15:46Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T06:49:43Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 953,
    "deletions": 147,
    "changed_files": 18,
    "commits": 7,
    "review_comments": 26,
    "comments": 8
  },
  "events": [
    {
      "event": "commented",
      "id": 1371011959,
      "node_id": "IC_kwDOABII585Rt_t3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1371011959",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-04T14:39:40Z",
      "updated_at": "2023-06-06T23:26:47Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27385](https://github.com/bitcoin/bitcoin/pull/27385) (net, refactor: extract Network and BIP155Network logic to node/network by jonatack)\n* [#26312](https://github.com/bitcoin/bitcoin/pull/26312) (Remove Sock::Get() and Sock::Sock() by vasild)\n* [#25572](https://github.com/bitcoin/bitcoin/pull/25572) (refactor: Introduce EvictionManager and use it for the inbound eviction logic by dergoegge)\n* [#25268](https://github.com/bitcoin/bitcoin/pull/25268) (refactor: Introduce EvictionManager by dergoegge)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#issuecomment-1371011959",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812"
    },
    {
      "event": "labeled",
      "id": 8151779370,
      "node_id": "LE_lADOABII585ai4RkzwAAAAHl4kgq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8151779370",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-04T14:39:42Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "reviewed",
      "id": 1235986976,
      "node_id": "PRR_kwDOABII585Jq6og",
      "url": null,
      "actor": null,
      "commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#pullrequestreview-1235986976",
      "submitted_at": "2023-01-04T14:46:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
    },
    {
      "event": "reviewed",
      "id": 1236481487,
      "node_id": "PRR_kwDOABII585JszXP",
      "url": null,
      "actor": null,
      "commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#pullrequestreview-1236481487",
      "submitted_at": "2023-01-04T22:09:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8211729232,
      "node_id": "HRFPE_lADOABII585ai4RkzwAAAAHpdQtQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8211729232",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-12T14:07:19Z"
    },
    {
      "event": "commented",
      "id": 1380407070,
      "node_id": "IC_kwDOABII585SR1ce",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1380407070",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-12T14:07:53Z",
      "updated_at": "2023-01-12T14:07:53Z",
      "author_association": "MEMBER",
      "body": "`9b7e9dad27...daee83c1c5`: optimize the fuzz test a bit",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#issuecomment-1380407070",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8212121329,
      "node_id": "HRFPE_lADOABII585ai4RkzwAAAAHpewbx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8212121329",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-12T14:46:56Z"
    },
    {
      "event": "labeled",
      "id": 8409430281,
      "node_id": "LE_lADOABII585ai4RkzwAAAAH1PbkJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8409430281",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-01T11:35:37Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8479721911,
      "node_id": "HRFPE_lADOABII585ai4RkzwAAAAH5bkm3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8479721911",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-09T14:00:21Z"
    },
    {
      "event": "commented",
      "id": 1424234586,
      "node_id": "IC_kwDOABII585U5Bha",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1424234586",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-09T14:00:28Z",
      "updated_at": "2023-02-09T14:00:28Z",
      "author_association": "MEMBER",
      "body": "`32ab679f54...7c591c868d`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#issuecomment-1424234586",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812"
    },
    {
      "event": "unlabeled",
      "id": 8480084825,
      "node_id": "UNLE_lADOABII585ai4RkzwAAAAH5c9NZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8480084825",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-09T14:33:42Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8561545829,
      "node_id": "HRFPE_lADOABII585ai4RkzwAAAAH-TtJl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8561545829",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-20T13:04:23Z"
    },
    {
      "event": "commented",
      "id": 1436999481,
      "node_id": "IC_kwDOABII585Vpt85",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1436999481",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-20T13:07:08Z",
      "updated_at": "2023-02-20T13:07:08Z",
      "author_association": "MEMBER",
      "body": "`7c591c868d...a81fe4ff9b`: rebase and put the fuzz tests in `fuzz/process_message.cpp` instead of in a new file, as [suggested](https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068245906).",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#issuecomment-1436999481",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812"
    },
    {
      "event": "commented",
      "id": 1514904243,
      "node_id": "IC_kwDOABII585aS5qz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1514904243",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-19T15:06:46Z",
      "updated_at": "2023-04-19T15:06:46Z",
      "author_association": "MEMBER",
      "body": "There may be a silent merge conflict. After rebase to current master at fde224a6610699a6a28cc27e299ac14cbf7e16ca, building with Clang 16 fails at commit `test: add a mocked Sock that allows inspecting what has been Send() to it`.\r\n\r\n<details><summary>build error</summary><p>\r\n\r\n```\r\ntest/util/net.cpp:280:12: error: no viable conversion from returned value of type 'const CNetMessage' to function return type 'std::optional<CNetMessage>'\r\n    return msg;\r\n           ^~~\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:736:41: note: candidate constructor not viable: no known conversion from 'const CNetMessage' to 'const optional<CNetMessage> &' for 1st argument\r\n    _LIBCPP_INLINE_VISIBILITY constexpr optional(const optional&) = default;\r\n                                        ^\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:737:41: note: candidate constructor not viable: no known conversion from 'const CNetMessage' to 'optional<CNetMessage> &&' for 1st argument\r\n    _LIBCPP_INLINE_VISIBILITY constexpr optional(optional&&) = default;\r\n                                        ^\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:738:41: note: candidate constructor not viable: no known conversion from 'const CNetMessage' to 'nullopt_t' for 1st argument\r\n    _LIBCPP_INLINE_VISIBILITY constexpr optional(nullopt_t) noexcept {}\r\n                                        ^\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:762:15: note: candidate template ignored: requirement '_CheckOptionalArgsCtor<const CNetMessage &>::__enable_implicit()' was not satisfied [with _Up = const CNetMessage &]\r\n    constexpr optional(_Up&& __v)\r\n              ^\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:777:35: note: candidate template ignored: could not match 'const optional<_Up>' against 'const CNetMessage'\r\n    _LIBCPP_CONSTEXPR_SINCE_CXX20 optional(const optional<_Up>& __v)\r\n                                  ^\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:795:35: note: candidate template ignored: could not match 'optional<_Up>' against 'const CNetMessage'\r\n    _LIBCPP_CONSTEXPR_SINCE_CXX20 optional(optional<_Up>&& __v)\r\n                                  ^\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:748:24: note: explicit constructor is not a candidate\r\n    constexpr explicit optional(_InPlaceT, _Args&&... __args)\r\n                       ^\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:769:24: note: explicit constructor is not a candidate\r\n    constexpr explicit optional(_Up&& __v)\r\n                       ^\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:785:44: note: explicit constructor is not a candidate\r\n    _LIBCPP_CONSTEXPR_SINCE_CXX20 explicit optional(const optional<_Up>& __v)\r\n                                           ^\r\n/opt/homebrew/opt/llvm/bin/../include/c++/v1/optional:803:44: note: explicit constructor is not a candidate\r\n    _LIBCPP_CONSTEXPR_SINCE_CXX20 explicit optional(optional<_Up>&& __v)\r\n                                           ^\r\n1 error generated.\r\nmake[2]: *** [test/util/libtest_util_a-net.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\nmake[1]: *** [all-recursive] Error 1\r\nmake: *** [all-recursive] Error 1\r\n```\r\n</p></details>\r\n\r\n```\r\n$ clang --version\r\nHomebrew clang version 16.0.1\r\nTarget: arm64-apple-darwin22.4.0\r\nThread model: posix\r\n```",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#issuecomment-1514904243",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812"
    },
    {
      "event": "commented",
      "id": 1514913010,
      "node_id": "IC_kwDOABII585aS7zy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1514913010",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-19T15:12:21Z",
      "updated_at": "2023-04-19T15:12:21Z",
      "author_association": "MEMBER",
      "body": "> There may be a silent merge conflict.\r\n\r\nProbably because of https://github.com/bitcoin/bitcoin/pull/27324, copying `CNetMessage`s is no longer possible.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#issuecomment-1514913010",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812"
    },
    {
      "event": "labeled",
      "id": 9102674890,
      "node_id": "LE_lADOABII585ai4RkzwAAAAIej8vK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9102674890",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-26T11:55:00Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9232085403,
      "node_id": "HRFPE_lADOABII585ai4RkzwAAAAImRnGb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9232085403",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-12T11:34:15Z"
    },
    {
      "event": "commented",
      "id": 1545603904,
      "node_id": "IC_kwDOABII585cIAtA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545603904",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-12T11:34:40Z",
      "updated_at": "2023-05-12T11:34:40Z",
      "author_association": "MEMBER",
      "body": "`a81fe4ff9b...f559067e27`: rebase due to conflicts, thanks for looking into this!",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#issuecomment-1545603904",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812"
    },
    {
      "event": "unlabeled",
      "id": 9233108130,
      "node_id": "UNLE_lADOABII585ai4RkzwAAAAImVgyi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9233108130",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-12T13:30:58Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9326083898,
      "node_id": "LE_lADOABII585ai4RkzwAAAAIr4L86",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9326083898",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-24T10:39:50Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unsubscribed",
      "id": 9328617400,
      "node_id": "UE_lADOABII585ai4RkzwAAAAIsB2e4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9328617400",
      "actor": {
        "login": "joostjager",
        "id": 4638168,
        "node_id": "MDQ6VXNlcjQ2MzgxNjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4638168?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joostjager",
        "html_url": "https://github.com/joostjager",
        "followers_url": "https://api.github.com/users/joostjager/followers",
        "following_url": "https://api.github.com/users/joostjager/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/joostjager/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/joostjager/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/joostjager/subscriptions",
        "organizations_url": "https://api.github.com/users/joostjager/orgs",
        "repos_url": "https://api.github.com/users/joostjager/repos",
        "events_url": "https://api.github.com/users/joostjager/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/joostjager/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-24T14:27:08Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFhNDFkZDE4OTZjNDI4MDIyMWMzMWQ0NTZmOWY2NzE0ZTZmN2I0NjY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/aa41dd1896c4280221c31d456f9f6714e6f7b466",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/aa41dd1896c4280221c31d456f9f6714e6f7b466",
      "tree": {
        "sha": "38380a4e7fdbae93d799f4c47552ea5cf677c73a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/38380a4e7fdbae93d799f4c47552ea5cf677c73a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 38380a4e7fdbae93d799f4c47552ea5cf677c73a\nparent f4a8269dfc144cc918570bdb870aa5143a11c1fe\nauthor Vasil Dimov <vd@FreeBSD.org> 1670330301 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1686041101 +0200\n\ntest: put the generic parts from StaticContentsSock into a separate class\n\nThis allows reusing them in other mocked implementations.\n\nAlso move the implementation (method definitions) to\n`test/util/net.cpp` to make the header `test/util/net.h` easier to follow.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmR+8g0ACgkQVN8G9ktV\ny7+QfB/8C05MudBYSfxsWTY9gObADU2zlBbfKAhrhf0YSdL3PVYs4/7nnONGYVKh\nXXcCDkKsZv4A9VfZfRdhA+SfgP1jOshxEeToHww2dDgA4BHpTXz9CxW+c0e08cI9\nZ+q3KfDtfPGSnDdth/rArhMWbH3NUDGz+NKti2dhuYN0DVpXwcFRTgm75OKFqLSh\n0SCQWbpCvmDPxV/GuyvSA+RYLGEx+vVRgq/E9W1RCAt+pJrBvSqZpQnhVsXpm7Qa\nM/fNzQ93XD0nbVWKSDE0TMwmZQzRwjBLY3c9ak1O2W5yh95vmoqW/E26ypZW4O8T\nZTS77f+E/FxmNMPZLuT0l0onYYSEKfvduQYUPBjB5r8j7vKxDG07AGj6O8JRim20\nWGYm/84qzitEmcLIyeD5Pz7OIWuG0+JC/O4qM56cUWyVa9IDoNxpGxjdWTdDFni3\nj0QaN0e4HOWJW3p3IJHOiPeaE8/GxeSbiKTrbauMvZCmBnag31dQYNLvEG2Q4qow\n2V6cjfYSsADczaY969ixuvSp2rHfInmQiYORVolUXgbJokn0ej/83ZnGJlM/IfLy\nL/KdMRYY1tqLJfKFKXgpOwniTbD+Tm+/x25w2BOrc6sxMTsqJk9xQTcP/ZQyuNc6\nCuZDrJ9INM5NmMIEp0w8yCTCJSINiWtvBByKeXEF2tMPsP1+/eGYNGFZnCgYG6jz\nf0FbhFc7qjqI2FeBuXWCJ2shtT6D3Pn7d7bv6Vh4d7PPuRHFxcBP6Xvn6FD15nfl\nDlyB45eRVzboRPontZLFbrQCNAT3T6O9lGAeBRhqkcahbB5MRK+bMAgAW3zWzqG6\n0KVVB9Iv2wjvGtV4llWvlBq0WmFk9JO/zzGSqUFRm7znh4pImewR3Ftq90sfRBE/\nIosZxrgeoyNg39TeBvlYTGLt/j4OoGmr5pusKn0aYOCVjeEf31sTZ27a/VcfuYu+\n9qObIry2KCC6qxg37GkIETTrK5DDmGsButI34ejudhGf3JoKh9NhwsJoX+g7cBC8\nlMMqZbuyokOPeEpfu6YehsK7G3T4mMqJCzYg6/uvQ9FI/+4g84DagjoPH3JPVIt1\nGPhbxPoSzZL24ssqCkeIopqpYG59cfqF9N29M0EwG1zBV6nAWT1B7s4M+59Hqu6o\n1YxtrnUkZ0FJr75jCA96zq+Xi78uOOM3JvlRN3A7LheO0t2tD2zcoob7cOmdD2aj\n/+pNIpZKC9xUEL///dzcT8y9TjmLAE0k1LgY4bu0DKEWvCGrrpMGv9DB3bic8BVK\nk3ZGz3/Y+eiGM06sT34HXvh0Q3cdn5kcltLgXVbueJWxuKQ/OZT5uGkEp2UKUdHb\nSEmN61xfOecJIlQ4vX2+wRPGsJUbsQ==\n=pKHM\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f4a8269dfc144cc918570bdb870aa5143a11c1fe",
          "sha": "f4a8269dfc144cc918570bdb870aa5143a11c1fe",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f4a8269dfc144cc918570bdb870aa5143a11c1fe"
        }
      ],
      "message": "test: put the generic parts from StaticContentsSock into a separate class\n\nThis allows reusing them in other mocked implementations.\n\nAlso move the implementation (method definitions) to\n`test/util/net.cpp` to make the header `test/util/net.h` easier to follow.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-06-06T08:45:01Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2022-12-06T12:38:21Z"
      },
      "sha": "aa41dd1896c4280221c31d456f9f6714e6f7b466"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGUzNDk3ODZiMTZjMGQyYzRlNjMwMGI2NDdiZmYyY2M5OGQxYjQzMmQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e349786b16c0d2c4e6300b647bff2cc98d1b432d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e349786b16c0d2c4e6300b647bff2cc98d1b432d",
      "tree": {
        "sha": "0042c6ad8b36b0be91270f2d2bdd2da63bb7bdad",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0042c6ad8b36b0be91270f2d2bdd2da63bb7bdad"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 0042c6ad8b36b0be91270f2d2bdd2da63bb7bdad\nparent aa41dd1896c4280221c31d456f9f6714e6f7b466\nauthor Vasil Dimov <vd@FreeBSD.org> 1670330523 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1686041104 +0200\n\ntest: add a mocked Sock that allows inspecting what has been Send() to it\n\nAnd also allows gradually providing the data to be returned by `Recv()`\nand sending and receiving net messages (`CNetMessage`).\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmR+8hAACgkQVN8G9ktV\ny7+I/x//cmuPzRPthi9pRQxVou9G/evAn/VIVBCuFvJUKyqtIaZ3eFCj9vY8mb3A\nsYTUbr9ZbYvgH/OmuL/iwhkL9qx83hm32aOJ1WvJrExWVmhVee2rvy37ZV2QSzyj\nzngI5JKUO9UQBKvPqs4ThwqYnCRcO0gxJG9i3LbT0GrUVZV7EfXttgZ71uv3An76\nkMu/YDOm9Lc7To0gEwvZyP9slZ9zXM6T9h2gqPZiJq3W37bSqvPV4/OMQ8TvgfHt\ndnre7nsbZjB4LAnlUNxndl0Zg2b8QXd9Zu6ySnDnfJBEq1jzlHHYoN3z+y8tf1Ky\nrnqzfx23NTUBUiHfmsCyw1jfoNFOK6YJwNLb8Lvv03nRv2WlQPpK+iRudY01D1De\nS3Y9IPTMKtrR4zvh5PxzF/SIMHV7UwrJHvZWANs1+jhK1zpJmj65dP/WkUKW1mnw\n0lXEwgA8md07Lk9ddw7AqDy6nVJk4tSGYlcsaAKpoOB6BdfHtsBi6WuJi7YLS/RN\nX7AEBfU+wn6ghm0dEV+uPEkFIYxCBz1HPfe9e+NhrBu185wSDywqMKniMRQB+I/b\nbGHenL0gpDSfFDHdUaFWRbugFZBzOQQgvM2rOiafPhCklGWhlbGoAb9pzfPWL/jc\nJ5u6ufcEwmvTdXTLDwxlcWHJAVPObA6lVdxtOz6xZulndDAt0fzkuybUqQV6MF4o\n2qcFMX6Sm4zDGrRXE8GFjUZfjz9Mp2WF2KkPtJq08jv4v17T7hdND8IJM9Cgp9XL\nc0DX2OulCrn0SCCmVzFoefjxxtE39mDkLffGqsMkqr/lZpPpH0ulOTTHsL/TUaR6\nd/iv7jhuqIrllSUYFfr0Fgr9MVKKzbs4STR7bbVwx41Vv/U65RdrybgjWX1hATES\nvBvS+Kbd/M4h0bSZXhovVMsI6O4BnS/UHZhUSrABRiCIt6pCUKiW1nhNCrLC+1Yt\njFe28imnMy0u38n6RqmlYvFi4BaHAgOBEcCXknJmqoFCtiIrjLwwfYMKqccdMwPK\nEnDUfF1+aRwTUcIkvWcuu7g36NJ5jvzOCmPvfXfe11CmR8DjzQL1kkr/RyHLd9Ou\nfXL0YFwjfPQOC3Se3ix+QJkMXC5+QDnzMup4Uw9U/j0FbBhjqoX91YXIe6l7sKTH\nDTR8057zgqL/DjZQtFNLEK27ttAaSwYPaB187bB+GTYeJ560Tu6cxw4r29JH7sEw\n+WjmnNEfwy1yX6DHQd12MiHDHFBQyQdMsj7pRjymacz8810dM4aeJoUie+XP4325\neCzJq9XIwe3jD0v1mip/xqg/4dkSQlmg9fJNWOLBnO7moKUi9BRkcZspWuxapZ2J\nrUy5mlf1n6X38gThwq6eZSg+VRlMpw==\n=TsLS\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/aa41dd1896c4280221c31d456f9f6714e6f7b466",
          "sha": "aa41dd1896c4280221c31d456f9f6714e6f7b466",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/aa41dd1896c4280221c31d456f9f6714e6f7b466"
        }
      ],
      "message": "test: add a mocked Sock that allows inspecting what has been Send() to it\n\nAnd also allows gradually providing the data to be returned by `Recv()`\nand sending and receiving net messages (`CNetMessage`).",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-06-06T08:45:04Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2022-12-06T12:42:03Z"
      },
      "sha": "e349786b16c0d2c4e6300b647bff2cc98d1b432d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg1Njk1ODZlOTk4ODg5OTM5ODIyZmQxMjM1ZDliNmYxZDRkYThlOTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8569586e998889939822fd1235d9b6f1d4da8e94",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8569586e998889939822fd1235d9b6f1d4da8e94",
      "tree": {
        "sha": "8d6368e5ca6fcb545c54925b7a3331d10b9fb383",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8d6368e5ca6fcb545c54925b7a3331d10b9fb383"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 8d6368e5ca6fcb545c54925b7a3331d10b9fb383\nparent e349786b16c0d2c4e6300b647bff2cc98d1b432d\nauthor Vasil Dimov <vd@FreeBSD.org> 1670408170 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1686041105 +0200\n\ntest: add NetTestingSetup that starts connman with mocked sockets\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmR+8hEACgkQVN8G9ktV\ny7/gQh/8CiUyPdwt4QwMRiWiRw9tALlwHcs0etwr1fETmzKZYv/gYeYRhcYnRbU5\nZ8oBAP8kTdjUNxGV4ki+hDOSlQtFihKaWsPsHz9XzXwK1pd3fSWu+BaTRMoVJEDX\nmKT9gu56OgnmFM0On4Uy7dwxNONyZxR/VNHzPQE+ScARqvmGHhuz+Uxr4SBRWW9w\n1foYazXl4Wna8tXLElsYGcytqQOoNasTmatC6hPuG9wumvgIfQ+tLS9zkI2GPm4V\nrKicJZ/UYOY8tlhlD96C2rI+Nl7Kb+UyBVLUD6VefdEqbqFCm3VqneawxVDmWXGj\nXThlRctY34Gj2oYaHaLQe4pK8AyV+c5RDuqJrRQQl3Bvo2LEs7d831oUGiYUh5zR\nDwNy0vlW2mdISmjx+4zPN2E8bcNNVwmi2dAQGgdQLMI58C/DEx61uY91WOaKT5cM\nNAayDS/PNc9rlnrwfQoMy++BNglYa7Bgn6sAyeDcoAF/GqCdhchO4pU/EHJUjRyH\nJA5rXVGyjqV6XIobrS5Z4cfwSBeJwzvIlX2Mita9KYU1dFenBQIrSs4Ko90ocW35\nJNO8NCWDgfww1vev0jwBOuoe2BZp9W1eiMea6GSP0ynk+fsu+aKp9RbxrLh/9CKq\nNYyzUs+ERqKlV3Ojn0hcCzXypkmruqUweEs10LDaxF8h9FVZXmfSJ+ZH7COJFSYX\nP1CXYdm3RVsy/eoLq/IZ3kkQ1DhBzP0dmqGhTj0wBU6KVJaJ/crOzl8Ky0Zxpfuv\n2ByiWTtIHPTsF0sZ2O/KnGAN08adMfCGVtkBQhe8OJom/9KWdIMdk3jELJmV8BbM\n2lmyInxZE0vcT8U4ujQU4MD3NqYgAghB0qwsqKQVB7eFW65S/Nf8kyrHwVsotME+\nDmwJgQ5ywhNXnht6LcrjY96Y/5AUJ69isfoHD7lxKQfyJOE08IimWuJ9HRSbk1vr\nuLTKU3PFFVbL4u66VNwJl1d4gCmhms8EIC80180MnUHyzscwlVYK34b8n2hQIG3a\n14OKBAgHfO5JkBOW0Jof02fAaCE2cy7sk/rbrj7OP3qW9vUc3Ypt5nSvaX5/al/W\ne4XOJH5T2U3iDomwa2tYyw8Ozj4IUHdz1rthsrxbHlAGXyGVJGcbpw8ukr19GXa7\nBvnIr56wTdvXbmsIEbYOjGQZcVf1UtiGcKPyp3scUUkx8ZLfruTHDr0sNlN2DxyX\nmAH+7IajkkZ6gj/OpcrbWe9oeMo+cW6tluheUlShdUdBRL32Ag6gwnRK/I8Yjd4U\njIetq9MjZJ5Y1ijpk2h8HafPtE5b3/8FIy+eINhAf+ei8phgr7OTT3g774X1+oTJ\nrgOIa/1iucwKqHVN+vORfymKKUDu5w==\n=xUL8\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e349786b16c0d2c4e6300b647bff2cc98d1b432d",
          "sha": "e349786b16c0d2c4e6300b647bff2cc98d1b432d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e349786b16c0d2c4e6300b647bff2cc98d1b432d"
        }
      ],
      "message": "test: add NetTestingSetup that starts connman with mocked sockets",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-06-06T08:45:05Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2022-12-07T10:16:10Z"
      },
      "sha": "8569586e998889939822fd1235d9b6f1d4da8e94"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDU3MzA0YWE5YTFkOWFkNmIyYjgyY2RkNjQxMGQ0ZmY0MTZiN2MxNDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/57304aa9a1d9ad6b2b82cdd6410d4ff416b7c144",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/57304aa9a1d9ad6b2b82cdd6410d4ff416b7c144",
      "tree": {
        "sha": "ceb754977022312c25cbf929ae4b23b4174266c0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ceb754977022312c25cbf929ae4b23b4174266c0"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree ceb754977022312c25cbf929ae4b23b4174266c0\nparent 8569586e998889939822fd1235d9b6f1d4da8e94\nauthor Vasil Dimov <vd@FreeBSD.org> 1671786206 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1686041105 +0200\n\ntest: don't throw from the destructor of DebugLogHelper\n\nThrowing an exception from the destructor of a class is a bad practice\nbecause the destructor will be called when an object of that type is\nalive and another exception is thrown, which will result in \"exception\nduring the exception\". This is not allowed in C++.\n\nInstead add an explicit method in `DebugLogHelper` to check for a match.\nThis changes usage from:\n\n```cpp\n{\n    ASSERT_DEBUG_LOG(\"foo\");\n    produce_log_messages();\n}\n```\n\nto\n\n```cpp\nDebugLogHelper debug_log{\"foo\"};\nproduce_log_messages();\ndebug_log.EndAndThrowIfNotFound();\n```\n\nAlso, simplify the semantic of `DebugLogHelper::MatchFn` a bit. No\ncaller was using it to alter the default behavior of \"throw if no\nmatch at the end\", so don't call it at the end.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmR+8hIACgkQVN8G9ktV\ny7/vAh//S4thHRKHzwaTvlR5qgsv9WTAfEsCTaLGgxDafAzx5IzjPkFSD2jXPebe\nTRY5k3H3kdIGcM5rpkWE8JGsucJUAJVUX+zPCXG61V3FLLhIxUQMXFu03RO8wEHU\nT1oqeM6jnX/04QR0Bo0dMHqk9nkwJD8Zu+5+Yy9JELCllFTzRaA+isgToF6+KVsZ\n0VuF13RU5XcrxG+WZHZlM8bbgA2SICMtscHhhzdbFkgkTVMJL23SQLg+1J+Dn7g+\nz8Cf4LK/CGW0i15gVaG2d/j+86IvUgqbRT5j+4s65mRmO8HtyQ/PPNDe2swwCQag\n6Eio/ds54EWraFJytUq70tROSiPyruFs9kn73rI/1xjvfsyBayLs8ydt/AP1Svxo\nE8CGj3CSzi4krYoiIPtv1onuC7XHvGjEQ2qx90Fc2hbmzXLg0hsZ+Q8hrpWO1miW\naCSq30tYkRNi8u97BKl3uLqRnNEb2AL9mGZ+cfXNFDFvYbNhsXs/bPBcDNhTiK1y\nsnlsk9qlzpmuJnjan8zJu4kBccLLpiayvuB/FSEVLJt6eOJvkzMg1jSa/QI2HbUL\nAYkbueCqhVn8q7fgh61a+Zf65rE8/eslVo10pJqd2b5JtbqCilU8TKv131Ruudki\nFtpF/54NDFfd+zioBBFBDrpSptZ4nilKzPn6wNqHtRsLmD5MwN9xyLrd/bS1ByhC\nZ+KF/SoMfiKofk8eH4eCNxU53KyujMsUx5bjja7xt7zlF/P2T/fNGELzx6io1Xdc\nC3pLK7POgwX1LvoZRqx8JTr2JLrF4P3J7JMwi/g0+71sVvG3SB68ShC5mGXK0N9t\niUE0mtLnqZj3kO8AovGY9AlXkiSl3na1ZG8iVc3EkE/66ca+sag7GnhiDipqIG/3\noXG673FZ9D5jAkcT+IipgmLvkBzDEoh75Q2gBQXwNhXZuuSBQLJ9Q+7m3K8yKQCZ\nJb4dq10MVuzEPVZUkGTEWtWw13AFbG/muATuicLEQmGi6lu0x0euvifd0/BreWWy\njNrKFRB/AINA6lQy+VQHsSi9yCD2uUxqkEMqIjC3HHtZS2Ig8QMLYlAiYVmvCfXq\ngr6ejdr83/JPXC1l34bV1wc4GO3g+hNgWFOb8QPY6KTvzI+bLNAJ1/VZzkDrvOc5\nF8Vk+4E+prcQoA3YK5JbMivjGHqwf5Sd7mIBdWkL+KW8ai57mN81jBP9PX9cPguM\nsWz7ojmn8vUhPY6eHOmK+7kIpRNRuaRVYSuFI6nW/xsjK7zSd/CDApFIUXFECgwu\nf4kCKD1PqPMV4A6J+SWhg59QMdszNyxN0jZjMiRibcz5d5FnKbOIdN0pqkzndcc/\nu2ugWhxgXUrcrxv3NJh23pEkpxPrDQ==\n=XiHd\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8569586e998889939822fd1235d9b6f1d4da8e94",
          "sha": "8569586e998889939822fd1235d9b6f1d4da8e94",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8569586e998889939822fd1235d9b6f1d4da8e94"
        }
      ],
      "message": "test: don't throw from the destructor of DebugLogHelper\n\nThrowing an exception from the destructor of a class is a bad practice\nbecause the destructor will be called when an object of that type is\nalive and another exception is thrown, which will result in \"exception\nduring the exception\". This is not allowed in C++.\n\nInstead add an explicit method in `DebugLogHelper` to check for a match.\nThis changes usage from:\n\n```cpp\n{\n    ASSERT_DEBUG_LOG(\"foo\");\n    produce_log_messages();\n}\n```\n\nto\n\n```cpp\nDebugLogHelper debug_log{\"foo\"};\nproduce_log_messages();\ndebug_log.EndAndThrowIfNotFound();\n```\n\nAlso, simplify the semantic of `DebugLogHelper::MatchFn` a bit. No\ncaller was using it to alter the default behavior of \"throw if no\nmatch at the end\", so don't call it at the end.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-06-06T08:45:05Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2022-12-23T09:03:26Z"
      },
      "sha": "57304aa9a1d9ad6b2b82cdd6410d4ff416b7c144"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM1ODRmZDNmMDljMDZjNDUwMjE3NWRlYTc0YWFmNTdiZjA1MjBhODk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c584fd3f09c06c4502175dea74aaf57bf0520a89",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c584fd3f09c06c4502175dea74aaf57bf0520a89",
      "tree": {
        "sha": "9c29361779602f8d54ddd53f9f5e4b4469a188f2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9c29361779602f8d54ddd53f9f5e4b4469a188f2"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9c29361779602f8d54ddd53f9f5e4b4469a188f2\nparent 57304aa9a1d9ad6b2b82cdd6410d4ff416b7c144\nauthor Vasil Dimov <vd@FreeBSD.org> 1671789519 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1686041106 +0200\n\ntest: make it possible for DebugLogHelper to wait for messages\n\nExtend `DebugLogHelper::EndAndThrowIfNotFound()` to be able to\noptionally wait for messages, possibly logged from another thread, to\narrive before performing the final check.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmR+8hIACgkQVN8G9ktV\ny78TLB/+L3MgMLkQiXJxcv1wmIJQuU1tPtuAVhVJ2hCP/a8ZSI23jmFiJRjvPT4c\nIoznAeEcGgAucqjV9pab2aggrO9Ca1NanuSkQ7LBjsUV3JHVNd2RR3leNHnEjw8f\nt18T8QCEAIb107oIsSrQdr1QZuJR+gv7DG2q8S6UPKfy9ryY+Y10zFXnyg3TXvtl\n1zLC4c14QG126uCxgZmFhBxUTFVVXfoR8hnP8/r1Ht7NOQEejgHgqe46kZw/y1ab\nxr73AyAJmR4iYQi+2FXr8Q+Schx+u3egXk3DrLdNnPyKTk2rv85Aj0cUM4F9yr1p\nGu1skcEGdM4cTrnhnZSlSUM9G3S70iyiQXoXUbBfK/WBX/9sGo3nCb0UPHR2Kgtu\nqSd5OzeOg/z5AfkwUrlhNPoWa9mXzXLFd1L5HBnF1K2YF5VSSVf3pOQFLiSUfWwQ\nWz4SuyKIXCg84CLw9DI+QowucOra0fleh2Bkssr1DlB97U2XBjFm/keCiLvcOiRI\nUe98ajNAsCnTdeOxZR0wihwoMMheNBSSt1wxTYk2cQXeLO1xbl94KA9AY42fxlYu\nbXO5I1S4Elazx6MZo6MZtIhnXvT0OS+CMa8BB2zS92bZvsplF2+Sp+MhzFcqpKE2\n62AytDSgrduRQ0fNdcdgvilrWRa/b5qWxIaoBzBVrB2+XybEV0mWLVejTtjTY/KI\n/cqq97psVoy+A+ijpvir/IkLFtdHw/e+Socac6FI6Hutuf6eH74XGEoTOGFj8otR\niTSmd+uCm1yL8FQjvnBcwLOqU4if4cM/+LSYDM28wsFhGACOxFVeLD/3Ns9b2cai\nEPx+K1BaiFEewp4gJH3NAr6OKG5E3sN6w0wQ7eRfZixAYSikv4CEJ+40yXFbRRwL\nCmDg0HsTGJRXDht8qC1MKmtYig2PlFtJoaa/kvNKcHAHhFtqiYldciLBxKffyf0c\ndDOtA6P8FvUAq3KqETeLLnNEoUk1kQNa+EBfajdYxc1fiJHy+HKf+KF59Hwm24pQ\ngOUJLR3L4MijZJcfWkmRbZ4rD3XpINKESsVUdgcWK4rp0MV3lvfIX9nqecEWeI1F\nyogHMRrMrf/Zj3qW6PWjwyh2XBFSRX8vFSsUxsRCuzKwG04YXvtPyYT2GbnOOedQ\nxyx7g995iHcNv8D0Y6CQKoPJecbony82eJHajxT7gITSrmxPwOZ+/wMbSrw+9OqV\ncC0eQ86w6XTTEH7nQzaT68Ceq6NgnAdibBpZymE41WY7S6zQ5rZOjMbKmcoltvtF\ntc7EP0bx0N2S467aa76QNs8YqqaeE9j1cIMlLf75jXh5o4gYkC27k/Ts52HSfMXu\nWPKb3WTwHMz+1r+8QLEJNLmjduicMw==\n=Ojpl\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/57304aa9a1d9ad6b2b82cdd6410d4ff416b7c144",
          "sha": "57304aa9a1d9ad6b2b82cdd6410d4ff416b7c144",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/57304aa9a1d9ad6b2b82cdd6410d4ff416b7c144"
        }
      ],
      "message": "test: make it possible for DebugLogHelper to wait for messages\n\nExtend `DebugLogHelper::EndAndThrowIfNotFound()` to be able to\noptionally wait for messages, possibly logged from another thread, to\narrive before performing the final check.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-06-06T08:45:06Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2022-12-23T09:58:39Z"
      },
      "sha": "c584fd3f09c06c4502175dea74aaf57bf0520a89"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhhYzQ1NzBjZWRlNzFlYjUzOTBlM2EzZTBhMWUzNTI0OGQ5OWI4MDg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8ac4570cede71eb5390e3a3e0a1e35248d99b808",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8ac4570cede71eb5390e3a3e0a1e35248d99b808",
      "tree": {
        "sha": "08b857d5c8d2d7e321b288782d2ee727066c0523",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/08b857d5c8d2d7e321b288782d2ee727066c0523"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 08b857d5c8d2d7e321b288782d2ee727066c0523\nparent c584fd3f09c06c4502175dea74aaf57bf0520a89\nauthor Vasil Dimov <vd@FreeBSD.org> 1670409920 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1686041171 +0200\n\ntest: add unit tests exercising full call chain of CConnman and PeerManager\n\nAdd tests that use a mocked socket to similate network IO and cover the\nfull `CConnman`, `PeerManager` and the interaction between them.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmR+8lUACgkQVN8G9ktV\ny7/MbCAAmQpHPtMhlux/LwCpS1cQ11B4I9soYkp34GFMVRaUOw9jxWECdWd71QJJ\nVjtnvp2LGSIVW6G2mNCMsWc1ZGTo56+ieHQqdI0izyJyd8ycjueEkSj/yDCNuOgI\ngbwDoQabVCwN8gBtYxydqzHAqcELQOg8t5BY7ghIbOO/O9A9vbrrt2J0OoDhKBvW\nmgRN9lIsvB2uzJvjmWRyqG+JM4RqhZA1nNyvL2hsRMCk+HHRqPOnFMaOu4zlXYiE\nU81YgrEr+VCnX4/TliEkjrRSZcd8MVqMFsVPbH7rPIjdQGL1qg1WIcaZxafhpOUl\nRzzWa834KnI2eCa682VvEujGeg1FJ14HzA/J+tiMhyy80sXZEX/L9/eIYB0TtnhL\nJpjFwD8MWHrSJTGhjK6miMx63K2oz0DFisf1I83aOajD/Rk4kt/C/CZ4rfVBnj7w\nIM6hi947dotxZJ2xF4Ioz+Bskiosv1NcOvNkr/2OHrpIaPuqCVQjJjF9vnkBKaWo\njascNuRYVlvXo2FRWLZtcjfuA+pXkQI7rLtAuvF9xRyAQsPgpHRR9YkoZGe3kJ8O\n/8BotqUi5kN0te4ZFIg3fZyap4ovbXkwQFTXPluuUoXp7b8Kj6WSvR6J3RuVp62T\nxJIJZlfrRUNv6LYD5ZPxLBS3/r7ab2ekYaUQ4stmWAzdn+YOPYNBKej3e/Rjr7x6\nUxIKOR5wPUy3xQPBVxz44aTuah4cfP36H3XpOY5hPt5oTgcUx7K27OisFHcfzKKR\nvFwL5neJQIO+4zjiNriBUzQd8neuJcnJKRFb0GpdBMLitUi/jYvWsQC54VIkJKhv\nnXs3wpsMBbneHR3v4AGsxRgH59vKs2hJlbLgpz6WOv+P1PfChfIDu5L4GmBNaGE9\nhKjpBfPijkKGBuTKvEIjd/OFqpr+AitVgvGyEPTdRr3Aurg6rnxL1/M3J9SHu5a7\nVekmXjTaSib3WvoVX+H/adbc/f2UZaQTop67LMhl9JmJKSdC3shfGRmnhGPEpCFO\nB6V03KjUcMlhSNExs+7bnqrC9JhW4C3K+ns+vLq6aiQkZHIP/ZOBi2dAzue8Z7Fx\ncUCjAQDZhRraR4Phof6ZxqWji8AAj8DtGCRNHVu/OYIznceFzTfms7UvHRvavmsJ\nRTtWG59xfpGitMoGbt3cAoMo8xPaxrERW4Z0dM5c6nzHl5z0sOIZkUCWqULp6jpC\nbTeyH6hIa61LnNlJElw1Qks8UWpKb9wEGQsfYzWOI21mgnUBdxOrepe+zF25shu8\nkXqjhz9TYwi19sQWqNs+NMNc/7C19pqadi5SxeqsgfkLO6PiBOGuuQmIlC6uyOni\nbngRywUVNt4Ukm9BvWnIIdLjPavaww==\n=Ymwh\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c584fd3f09c06c4502175dea74aaf57bf0520a89",
          "sha": "c584fd3f09c06c4502175dea74aaf57bf0520a89",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c584fd3f09c06c4502175dea74aaf57bf0520a89"
        }
      ],
      "message": "test: add unit tests exercising full call chain of CConnman and PeerManager\n\nAdd tests that use a mocked socket to similate network IO and cover the\nfull `CConnman`, `PeerManager` and the interaction between them.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-06-06T08:46:11Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2022-12-07T10:45:20Z"
      },
      "sha": "8ac4570cede71eb5390e3a3e0a1e35248d99b808"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRjODY3ZGU5OTZmNTg2NTVhZWMzOTExZjQ1MzY3ZWIzMTg2NWZiNGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4c867de996f58655aec3911f45367eb31865fb4d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4c867de996f58655aec3911f45367eb31865fb4d",
      "tree": {
        "sha": "a697d441d3aca5c50895c91719fe5f8f1344d7d3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a697d441d3aca5c50895c91719fe5f8f1344d7d3"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a697d441d3aca5c50895c91719fe5f8f1344d7d3\nparent 8ac4570cede71eb5390e3a3e0a1e35248d99b808\nauthor Vasil Dimov <vd@FreeBSD.org> 1670938504 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1686046860 +0200\n\nfuzz: add a test that pushes fuzzed data to the p2p socket\n\nThis way the full call chain is being tested/fuzzed, from the socket,\nto `CConnman`, to `PeerManager` and the interaction between them.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmR/CJgACgkQVN8G9ktV\ny7+ZzyAAowV9NOAJ1+vpBxAjAQoxBahgusfijm88k0RQUDVX9SBbFUWluXTePQZd\nbhRjEl+7cNLd6muB6Hip+kM/qnV3C7wbJGIshNlODr3rOc4lZfz4zokrcZxHHBAi\nXJM76+GagJSdKbcgA8Vsv68M67d9XZtS44KAnAobWcTtcbi/WATPPQuKGufVzyK+\nbAf1ugXsav8AKVQ5gb0T5SbdkDRYeEgTVIg4O2uzzOxAllfXPGSvJTDL8Dyr2GXP\nb1wYznEWJjcox9hJjolDxVcQIPlBp7kHa7a8F0SKNxxK8q4d2ZcBkq9ASY1l4O6Q\nrQrJ7IJfd7oihtfz69wO86W2NqAN6AsMbFfKZJT92PdBe/ocOKYj1dSX0oDqoa+X\nHZNGVypd7CIvBM1cnX+Hdp+j3rxc+5BvNUnyd3lsBr+5kgCJ+mkmUWjSV1oevNmN\nAJov6cNR8xFgitzeriEypfJ2CVMvkmpgkLw8s/Sn2iD9M7dtV5GHBrPPddJ/yrzB\nbxu1o/EfumOvEUYiPSfZJcbcrsL1IzwhbosWSstPPuCoTQW+YwglxpaKQKNnvymY\nHPsD1oxZYw0npLxc2HxMyt1ZXgrQrs1q2MVPI3PAKGpCalLfJcrhXk5eTVlV3Duo\n+5p/GGazlR+7LGC6BDNb5DHmXlMsiJ5nM+ni1NmUQLxkNlvgF8tqKStL97T4cAvT\nrHN83+n0ZNxiQz/D6v3aKEi14HUwaV4PNfpv7ZA6dkWH76GuomqRUc3Fwp3EDFA7\nPYoxKWllhbOyRftoBM9lv2dtqjvH4gfARj/lOQQcuJu5v1vWEdCjz4uzIt6Ui11h\njusw6y7SbLPGpNzgotlWFS8E19cm6Vg4tUIZU0TynjkH5YlpgGwYpB/uWzajPC2x\nxHBmCpYMxFS3nNzdVgs1VxIbKJP+7pqt+hzz46vRw+QOtJgM6QhOrzwPbFxKM6Ni\nVGpkj1wNrOwpfRNJKSwYTJt1N8U0TM8vVleB0KdYJoUcUtGvVbVWWio8J13F5znS\nj6unH02z4wt++jAZB2n/5W6OsbV6bF3KTnKGenshZtCsQ1R8HCssSeRVSLsYuB28\nMoid3qkaRZdHIT/viQrlFg8diHOZVytVAwTKzHa7JPPzmjfwGk7KdAXQtoE3y9V1\nP+rzSML6f6UQke2D6pODWrHMHDKqFX1U1GQXds6UdkK/uczh1bgABeaSPp/zUjud\nvd7tRQVUfeCsGHjK+eMJXqOLJQ5U8gxM4yCZo1HheRQwVwj3lOmNfq8nOaN60mbC\nBIj7W530IknewV9VfoCekVGK/M8fImrbYb4wg7R1d4Kqa1DGoWwwTr9x/ISk1yqJ\n5NC8kI9YM3HP9Vim2d8qSbVg47yuWg==\n=KwF1\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8ac4570cede71eb5390e3a3e0a1e35248d99b808",
          "sha": "8ac4570cede71eb5390e3a3e0a1e35248d99b808",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8ac4570cede71eb5390e3a3e0a1e35248d99b808"
        }
      ],
      "message": "fuzz: add a test that pushes fuzzed data to the p2p socket\n\nThis way the full call chain is being tested/fuzzed, from the socket,\nto `CConnman`, to `PeerManager` and the interaction between them.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-06-06T10:21:00Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2022-12-13T13:35:04Z"
      },
      "sha": "4c867de996f58655aec3911f45367eb31865fb4d"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9444404490,
      "node_id": "HRFPE_lADOABII585ai4RkzwAAAAIy7i0K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9444404490",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-06T10:22:55Z"
    },
    {
      "event": "commented",
      "id": 1578372952,
      "node_id": "IC_kwDOABII585eFA9Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1578372952",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-06T10:23:17Z",
      "updated_at": "2023-06-06T10:23:17Z",
      "author_association": "MEMBER",
      "body": "`f559067e27...4c867de996`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#issuecomment-1578372952",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26812"
    },
    {
      "event": "reviewed",
      "id": 1464897993,
      "node_id": "PRR_kwDOABII585XUJHJ",
      "url": null,
      "actor": null,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#pullrequestreview-1464897993",
      "submitted_at": "2023-06-06T10:55:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
    },
    {
      "event": "unlabeled",
      "id": 9445203261,
      "node_id": "UNLE_lADOABII585ai4RkzwAAAAIy-l09",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9445203261",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-06T11:46:25Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061551756",
      "pull_request_review_id": 1235986976,
      "id": 1061551756,
      "node_id": "PRRC_kwDOABII584_Rf6M",
      "diff_hunk": "@@ -0,0 +1,183 @@\n+// Copyright (c) 2022-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net_processing.h>\n+#include <netaddress.h>\n+#include <protocol.h>\n+#include <test/util/logging.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/time.h>\n+#include <version.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <chrono>\n+#include <string>\n+#include <unordered_map>\n+\n+BOOST_FIXTURE_TEST_SUITE(netmsg_tests, NetTestingSetup)\n+\n+BOOST_AUTO_TEST_CASE(initial_messages_exchange)\n+{\n+    std::unordered_map<std::string, size_t> count_sent_messages;\n+    auto pipes = m_sockets_pipes.PopFront();\n+\n+    // Wait for all messages due to the initial handshake to be Send() to the socket.\n+    // The FEEFILTER is the last one, so quit when we get that.\n+    for (;;) {\n+        auto msg = pipes->send.GetNetMsg();\n+        if (msg.has_value()) {\n+            count_sent_messages[msg->m_type]++;\n+            if (msg->m_type == NetMsgType::FEEFILTER) {\n+                break;\n+            }\n+        } else {\n+            break;\n+        }\n+    }\n+\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::VERSION], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::WTXIDRELAY], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::SENDADDRV2], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::VERACK], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::GETADDR], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::SENDCMPCT], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::PING], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::GETHEADERS], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::FEEFILTER], 1);\n+}\n+\n+BOOST_AUTO_TEST_CASE(addr)\n+{\n+    auto pipes = m_sockets_pipes.PopFront();\n+    std::vector<CAddress> addresses{5};\n+\n+    DebugLogHelper debug_log{strprintf(\"Received addr: %u addresses\", addresses.size())};\n+    pipes->recv.PushNetMsg(NetMsgType::ADDRV2, addresses);\n+    debug_log.EndAndThrowIfNotFound(30s);\n+}\n+\n+BOOST_AUTO_TEST_CASE(getblocks)\n+{\n+    auto pipes = m_sockets_pipes.PopFront();\n+    std::vector<uint256> hashes{5};\n+    CBlockLocator block_locator{std::move(hashes)};\n+    uint256 hash_stop;\n+\n+    DebugLogHelper debug_log{\"getblocks -1 to end\"};\n+    pipes->recv.PushNetMsg(NetMsgType::GETBLOCKS, block_locator, hash_stop);\n+    debug_log.EndAndThrowIfNotFound(30s);\n+}\n+\n+BOOST_AUTO_TEST_CASE(ping)",
      "path": "src/test/netmsg_tests.cpp",
      "position": 74,
      "original_position": 74,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is inspired by https://github.com/bitcoin/bitcoin/pull/25515",
      "created_at": "2023-01-04T14:41:02Z",
      "updated_at": "2023-01-04T14:46:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1061551756",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061551756"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 74,
      "original_line": 74,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061557476",
      "pull_request_review_id": 1235986976,
      "id": 1061557476,
      "node_id": "PRRC_kwDOABII584_RhTk",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is duplicated from `src/test/fuzz/process_message.cpp`. It should be deduplicated by putting it in a common header file, but I wonder if the new tests in `fuzz/netmsg.cpp` make the tests from `fuzz/process_message.cpp` and `fuzz/process_messages.cpp` obsolete and whether the latter should be removed. @MarcoFalke, as the author of `process_message[s]`, what do you think?",
      "created_at": "2023-01-04T14:46:19Z",
      "updated_at": "2023-01-04T14:46:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1061557476",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061557476"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061884646",
      "pull_request_review_id": 1236481487,
      "id": 1061884646,
      "node_id": "PRRC_kwDOABII584_SxLm",
      "diff_hunk": "@@ -0,0 +1,183 @@\n+// Copyright (c) 2022-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net_processing.h>\n+#include <netaddress.h>\n+#include <protocol.h>\n+#include <test/util/logging.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/time.h>\n+#include <version.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <chrono>\n+#include <string>\n+#include <unordered_map>\n+\n+BOOST_FIXTURE_TEST_SUITE(netmsg_tests, NetTestingSetup)\n+\n+BOOST_AUTO_TEST_CASE(initial_messages_exchange)\n+{\n+    std::unordered_map<std::string, size_t> count_sent_messages;\n+    auto pipes = m_sockets_pipes.PopFront();\n+\n+    // Wait for all messages due to the initial handshake to be Send() to the socket.\n+    // The FEEFILTER is the last one, so quit when we get that.\n+    for (;;) {\n+        auto msg = pipes->send.GetNetMsg();\n+        if (msg.has_value()) {\n+            count_sent_messages[msg->m_type]++;\n+            if (msg->m_type == NetMsgType::FEEFILTER) {\n+                break;\n+            }\n+        } else {\n+            break;\n+        }\n+    }\n+\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::VERSION], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::WTXIDRELAY], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::SENDADDRV2], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::VERACK], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::GETADDR], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::SENDCMPCT], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::PING], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::GETHEADERS], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::FEEFILTER], 1);\n+}\n+\n+BOOST_AUTO_TEST_CASE(addr)\n+{\n+    auto pipes = m_sockets_pipes.PopFront();\n+    std::vector<CAddress> addresses{5};\n+\n+    DebugLogHelper debug_log{strprintf(\"Received addr: %u addresses\", addresses.size())};\n+    pipes->recv.PushNetMsg(NetMsgType::ADDRV2, addresses);\n+    debug_log.EndAndThrowIfNotFound(30s);\n+}\n+\n+BOOST_AUTO_TEST_CASE(getblocks)\n+{\n+    auto pipes = m_sockets_pipes.PopFront();\n+    std::vector<uint256> hashes{5};\n+    CBlockLocator block_locator{std::move(hashes)};\n+    uint256 hash_stop;\n+\n+    DebugLogHelper debug_log{\"getblocks -1 to end\"};\n+    pipes->recv.PushNetMsg(NetMsgType::GETBLOCKS, block_locator, hash_stop);\n+    debug_log.EndAndThrowIfNotFound(30s);\n+}\n+\n+BOOST_AUTO_TEST_CASE(ping)",
      "path": "src/test/netmsg_tests.cpp",
      "position": 74,
      "original_position": 74,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061551756,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Key difference in #25515 is that it is testing net processing in isolation (at least isolated from CConnman), which imo is something we definitely should be doing. We already have e2e tests i.e. the functional tests, so I don't see the benefit to your approach here (besides the c++ tests being faster than the python ones).",
      "created_at": "2023-01-04T21:08:42Z",
      "updated_at": "2023-01-04T22:09:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1061884646",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061884646"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 74,
      "original_line": 74,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061894472",
      "pull_request_review_id": 1236481487,
      "id": 1061894472,
      "node_id": "PRRC_kwDOABII584_SzlI",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }\n+\n+void initialize_netmsg()\n+{\n+    Assert(GetNumMsgTypes() == getAllNetMessageTypes().size()); // If this fails, add or remove the message type below\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>();\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+static void fuzz_target(FuzzBufferType buffer, const std::string& limit_to_message_type)",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 57,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": null,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This target is averaging 2 execs/s on my machine. A good target should average a 1000 execs/s (https://github.com/google/fuzzing/blob/master/docs/good-fuzz-target.md#speed).\r\n\r\nI don't quite see the upside of this target over the `process_message(s)` targets. It might be able to find additional bugs if run with ThreadSanitizer but the current performance is gonna stop it from doing so effectively.\r\n\r\nFuzzing is particularly effective when the targets are kept narrow. For example: fuzzing net, net processing, validation or any of their sub components (e.g. TxRequestTracker or AddrMan) in isolation makes sense but all of it together will be inefficient.",
      "created_at": "2023-01-04T21:24:39Z",
      "updated_at": "2023-01-04T22:09:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1061894472",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061894472"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061896055",
      "pull_request_review_id": 1236481487,
      "id": 1061896055,
      "node_id": "PRRC_kwDOABII584_Sz93",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }\n+\n+void initialize_netmsg()\n+{\n+    Assert(GetNumMsgTypes() == getAllNetMessageTypes().size()); // If this fails, add or remove the message type below\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>();\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+static void fuzz_target(FuzzBufferType buffer, const std::string& limit_to_message_type)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    g_setup->m_node.banman->TestOnlyReset();\n+\n+    // Addrman and CConnman deprioritize addresses tried in the last 10min. Avoid that since\n+    // our addrman has very few addresses.\n+    SetMockTime(GetMockTime() + std::chrono::minutes{\n+                                    fuzzed_data_provider.ConsumeIntegralInRange<uint8_t>(11, 255)});\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type =\n+            limit_to_message_type.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                limit_to_message_type;\n+\n+        CDataStream payload{\n+            ConsumeRandomLengthByteVector(fuzzed_data_provider), SER_NETWORK, PROTOCOL_VERSION};\n+\n+        pipes->recv.PushNetMsg(message_type, payload);\n+\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) { // EOF, the socket has been closed.\n+            return;\n+        }\n+    }\n+\n+    TestChainState& chainstate = *static_cast<TestChainState*>(&g_setup->m_node.chainman->ActiveChainstate());\n+\n+    // Force a disconnect and wait for it.\n+    for (;;) {\n+        // Push a message that will cause a disconnect and socket closure (EOF on the Send() pipe).\n+        pipes->recv.PushNetMsg(\n+            NetMsgType::GETBLOCKTXN,\n+            BlockTransactionsRequest{.blockhash = chainstate.m_chain.Tip()->GetBlockHash(),\n+                                     .indexes = {1, UINT16_MAX}});\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) {\n+            break;\n+        }\n+        std::this_thread::sleep_for(50ms);",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 101,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": null,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I suspect this is the main reason for the poor performance, but the additional threading also doesn't help.",
      "created_at": "2023-01-04T21:27:00Z",
      "updated_at": "2023-01-04T22:09:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1061896055",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061896055"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 101,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061896936",
      "pull_request_review_id": 1236481487,
      "id": 1061896936,
      "node_id": "PRRC_kwDOABII584_S0Lo",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }\n+\n+void initialize_netmsg()\n+{\n+    Assert(GetNumMsgTypes() == getAllNetMessageTypes().size()); // If this fails, add or remove the message type below\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>();\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+static void fuzz_target(FuzzBufferType buffer, const std::string& limit_to_message_type)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    g_setup->m_node.banman->TestOnlyReset();\n+\n+    // Addrman and CConnman deprioritize addresses tried in the last 10min. Avoid that since\n+    // our addrman has very few addresses.\n+    SetMockTime(GetMockTime() + std::chrono::minutes{\n+                                    fuzzed_data_provider.ConsumeIntegralInRange<uint8_t>(11, 255)});\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type =\n+            limit_to_message_type.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                limit_to_message_type;\n+\n+        CDataStream payload{\n+            ConsumeRandomLengthByteVector(fuzzed_data_provider), SER_NETWORK, PROTOCOL_VERSION};\n+\n+        pipes->recv.PushNetMsg(message_type, payload);\n+\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) { // EOF, the socket has been closed.\n+            return;\n+        }\n+    }\n+\n+    TestChainState& chainstate = *static_cast<TestChainState*>(&g_setup->m_node.chainman->ActiveChainstate());\n+\n+    // Force a disconnect and wait for it.\n+    for (;;) {\n+        // Push a message that will cause a disconnect and socket closure (EOF on the Send() pipe).\n+        pipes->recv.PushNetMsg(\n+            NetMsgType::GETBLOCKTXN,\n+            BlockTransactionsRequest{.blockhash = chainstate.m_chain.Tip()->GetBlockHash(),\n+                                     .indexes = {1, UINT16_MAX}});\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) {\n+            break;\n+        }\n+        std::this_thread::sleep_for(50ms);\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 102,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": null,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think this is missing a call to `SyncWithValidationInterfaceQueue` here.",
      "created_at": "2023-01-04T21:28:10Z",
      "updated_at": "2023-01-04T22:09:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1061896936",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061896936"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068176623",
      "pull_request_review_id": 1245688508,
      "id": 1068176623,
      "node_id": "PRRC_kwDOABII584_qxTv",
      "diff_hunk": "@@ -0,0 +1,183 @@\n+// Copyright (c) 2022-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net_processing.h>\n+#include <netaddress.h>\n+#include <protocol.h>\n+#include <test/util/logging.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/time.h>\n+#include <version.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <chrono>\n+#include <string>\n+#include <unordered_map>\n+\n+BOOST_FIXTURE_TEST_SUITE(netmsg_tests, NetTestingSetup)\n+\n+BOOST_AUTO_TEST_CASE(initial_messages_exchange)\n+{\n+    std::unordered_map<std::string, size_t> count_sent_messages;\n+    auto pipes = m_sockets_pipes.PopFront();\n+\n+    // Wait for all messages due to the initial handshake to be Send() to the socket.\n+    // The FEEFILTER is the last one, so quit when we get that.\n+    for (;;) {\n+        auto msg = pipes->send.GetNetMsg();\n+        if (msg.has_value()) {\n+            count_sent_messages[msg->m_type]++;\n+            if (msg->m_type == NetMsgType::FEEFILTER) {\n+                break;\n+            }\n+        } else {\n+            break;\n+        }\n+    }\n+\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::VERSION], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::WTXIDRELAY], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::SENDADDRV2], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::VERACK], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::GETADDR], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::SENDCMPCT], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::PING], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::GETHEADERS], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::FEEFILTER], 1);\n+}\n+\n+BOOST_AUTO_TEST_CASE(addr)\n+{\n+    auto pipes = m_sockets_pipes.PopFront();\n+    std::vector<CAddress> addresses{5};\n+\n+    DebugLogHelper debug_log{strprintf(\"Received addr: %u addresses\", addresses.size())};\n+    pipes->recv.PushNetMsg(NetMsgType::ADDRV2, addresses);\n+    debug_log.EndAndThrowIfNotFound(30s);\n+}\n+\n+BOOST_AUTO_TEST_CASE(getblocks)\n+{\n+    auto pipes = m_sockets_pipes.PopFront();\n+    std::vector<uint256> hashes{5};\n+    CBlockLocator block_locator{std::move(hashes)};\n+    uint256 hash_stop;\n+\n+    DebugLogHelper debug_log{\"getblocks -1 to end\"};\n+    pipes->recv.PushNetMsg(NetMsgType::GETBLOCKS, block_locator, hash_stop);\n+    debug_log.EndAndThrowIfNotFound(30s);\n+}\n+\n+BOOST_AUTO_TEST_CASE(ping)",
      "path": "src/test/netmsg_tests.cpp",
      "position": 74,
      "original_position": 74,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061551756,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, both testing in isolation and e2e is good to have. The difference between the tests included in this PR and the functional tests is that when the test code runs inside the same process:\r\n\r\n* it has greater control and observability - the test can read any global or member variable and can call arbitrary functions \r\n* it can do fuzzing\r\n\r\nI think all those tests are complementary, not mutually exclusive.",
      "created_at": "2023-01-12T14:16:57Z",
      "updated_at": "2023-01-12T14:16:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068176623",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068176623"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 74,
      "original_line": 74,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068182302",
      "pull_request_review_id": 1245697308,
      "id": 1068182302,
      "node_id": "PRRC_kwDOABII584_qyse",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }\n+\n+void initialize_netmsg()\n+{\n+    Assert(GetNumMsgTypes() == getAllNetMessageTypes().size()); // If this fails, add or remove the message type below\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>();\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+static void fuzz_target(FuzzBufferType buffer, const std::string& limit_to_message_type)",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 57,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061894472,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Pushed an improvement that changes it to about 17 exec/s, it tends to increase if the test is left to run for some time.\r\n\r\nIMO e2e fuzzing has some value.",
      "created_at": "2023-01-12T14:21:50Z",
      "updated_at": "2023-01-12T14:21:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068182302",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068182302"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068182986",
      "pull_request_review_id": 1245698381,
      "id": 1068182986,
      "node_id": "PRRC_kwDOABII584_qy3K",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }\n+\n+void initialize_netmsg()\n+{\n+    Assert(GetNumMsgTypes() == getAllNetMessageTypes().size()); // If this fails, add or remove the message type below\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>();\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+static void fuzz_target(FuzzBufferType buffer, const std::string& limit_to_message_type)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    g_setup->m_node.banman->TestOnlyReset();\n+\n+    // Addrman and CConnman deprioritize addresses tried in the last 10min. Avoid that since\n+    // our addrman has very few addresses.\n+    SetMockTime(GetMockTime() + std::chrono::minutes{\n+                                    fuzzed_data_provider.ConsumeIntegralInRange<uint8_t>(11, 255)});\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type =\n+            limit_to_message_type.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                limit_to_message_type;\n+\n+        CDataStream payload{\n+            ConsumeRandomLengthByteVector(fuzzed_data_provider), SER_NETWORK, PROTOCOL_VERSION};\n+\n+        pipes->recv.PushNetMsg(message_type, payload);\n+\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) { // EOF, the socket has been closed.\n+            return;\n+        }\n+    }\n+\n+    TestChainState& chainstate = *static_cast<TestChainState*>(&g_setup->m_node.chainman->ActiveChainstate());\n+\n+    // Force a disconnect and wait for it.\n+    for (;;) {\n+        // Push a message that will cause a disconnect and socket closure (EOF on the Send() pipe).\n+        pipes->recv.PushNetMsg(\n+            NetMsgType::GETBLOCKTXN,\n+            BlockTransactionsRequest{.blockhash = chainstate.m_chain.Tip()->GetBlockHash(),\n+                                     .indexes = {1, UINT16_MAX}});\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) {\n+            break;\n+        }\n+        std::this_thread::sleep_for(50ms);",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 101,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061896055,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It wasn't but I ditched it anyway in `9b7e9dad27...daee83c1c5`.",
      "created_at": "2023-01-12T14:22:26Z",
      "updated_at": "2023-01-12T14:22:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068182986",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068182986"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 101,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068185233",
      "pull_request_review_id": 1245701729,
      "id": 1068185233,
      "node_id": "PRRC_kwDOABII584_qzaR",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }\n+\n+void initialize_netmsg()\n+{\n+    Assert(GetNumMsgTypes() == getAllNetMessageTypes().size()); // If this fails, add or remove the message type below\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>();\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+static void fuzz_target(FuzzBufferType buffer, const std::string& limit_to_message_type)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    g_setup->m_node.banman->TestOnlyReset();\n+\n+    // Addrman and CConnman deprioritize addresses tried in the last 10min. Avoid that since\n+    // our addrman has very few addresses.\n+    SetMockTime(GetMockTime() + std::chrono::minutes{\n+                                    fuzzed_data_provider.ConsumeIntegralInRange<uint8_t>(11, 255)});\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type =\n+            limit_to_message_type.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                limit_to_message_type;\n+\n+        CDataStream payload{\n+            ConsumeRandomLengthByteVector(fuzzed_data_provider), SER_NETWORK, PROTOCOL_VERSION};\n+\n+        pipes->recv.PushNetMsg(message_type, payload);\n+\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) { // EOF, the socket has been closed.\n+            return;\n+        }\n+    }\n+\n+    TestChainState& chainstate = *static_cast<TestChainState*>(&g_setup->m_node.chainman->ActiveChainstate());\n+\n+    // Force a disconnect and wait for it.\n+    for (;;) {\n+        // Push a message that will cause a disconnect and socket closure (EOF on the Send() pipe).\n+        pipes->recv.PushNetMsg(\n+            NetMsgType::GETBLOCKTXN,\n+            BlockTransactionsRequest{.blockhash = chainstate.m_chain.Tip()->GetBlockHash(),\n+                                     .indexes = {1, UINT16_MAX}});\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) {\n+            break;\n+        }\n+        std::this_thread::sleep_for(50ms);\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 102,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061896936,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe. I am probably missing something. Can you elaborate why it is missing a call to `SyncWithValidationInterfaceQueue()`?",
      "created_at": "2023-01-12T14:24:17Z",
      "updated_at": "2023-01-12T14:24:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068185233",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068185233"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068191630",
      "pull_request_review_id": 1245711657,
      "id": 1068191630,
      "node_id": "PRRC_kwDOABII584_q0-O",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }\n+\n+void initialize_netmsg()\n+{\n+    Assert(GetNumMsgTypes() == getAllNetMessageTypes().size()); // If this fails, add or remove the message type below\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>();\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+static void fuzz_target(FuzzBufferType buffer, const std::string& limit_to_message_type)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    g_setup->m_node.banman->TestOnlyReset();\n+\n+    // Addrman and CConnman deprioritize addresses tried in the last 10min. Avoid that since\n+    // our addrman has very few addresses.\n+    SetMockTime(GetMockTime() + std::chrono::minutes{\n+                                    fuzzed_data_provider.ConsumeIntegralInRange<uint8_t>(11, 255)});\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type =\n+            limit_to_message_type.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                limit_to_message_type;\n+\n+        CDataStream payload{\n+            ConsumeRandomLengthByteVector(fuzzed_data_provider), SER_NETWORK, PROTOCOL_VERSION};\n+\n+        pipes->recv.PushNetMsg(message_type, payload);\n+\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) { // EOF, the socket has been closed.\n+            return;\n+        }\n+    }\n+\n+    TestChainState& chainstate = *static_cast<TestChainState*>(&g_setup->m_node.chainman->ActiveChainstate());\n+\n+    // Force a disconnect and wait for it.\n+    for (;;) {\n+        // Push a message that will cause a disconnect and socket closure (EOF on the Send() pipe).\n+        pipes->recv.PushNetMsg(\n+            NetMsgType::GETBLOCKTXN,\n+            BlockTransactionsRequest{.blockhash = chainstate.m_chain.Tip()->GetBlockHash(),\n+                                     .indexes = {1, UINT16_MAX}});\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) {\n+            break;\n+        }\n+        std::this_thread::sleep_for(50ms);\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 102,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061896936,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If (in theory) it is possible to push an event on the queue, it should be handled before starting the next input. (Not sure if applicable here)",
      "created_at": "2023-01-12T14:29:52Z",
      "updated_at": "2023-01-12T14:29:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068191630",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068191630"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068212938",
      "pull_request_review_id": 1245744856,
      "id": 1068212938,
      "node_id": "PRRC_kwDOABII584_q6LK",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }\n+\n+void initialize_netmsg()\n+{\n+    Assert(GetNumMsgTypes() == getAllNetMessageTypes().size()); // If this fails, add or remove the message type below\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>();\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+static void fuzz_target(FuzzBufferType buffer, const std::string& limit_to_message_type)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    g_setup->m_node.banman->TestOnlyReset();\n+\n+    // Addrman and CConnman deprioritize addresses tried in the last 10min. Avoid that since\n+    // our addrman has very few addresses.\n+    SetMockTime(GetMockTime() + std::chrono::minutes{\n+                                    fuzzed_data_provider.ConsumeIntegralInRange<uint8_t>(11, 255)});\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type =\n+            limit_to_message_type.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                limit_to_message_type;\n+\n+        CDataStream payload{\n+            ConsumeRandomLengthByteVector(fuzzed_data_provider), SER_NETWORK, PROTOCOL_VERSION};\n+\n+        pipes->recv.PushNetMsg(message_type, payload);\n+\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) { // EOF, the socket has been closed.\n+            return;\n+        }\n+    }\n+\n+    TestChainState& chainstate = *static_cast<TestChainState*>(&g_setup->m_node.chainman->ActiveChainstate());\n+\n+    // Force a disconnect and wait for it.\n+    for (;;) {\n+        // Push a message that will cause a disconnect and socket closure (EOF on the Send() pipe).\n+        pipes->recv.PushNetMsg(\n+            NetMsgType::GETBLOCKTXN,\n+            BlockTransactionsRequest{.blockhash = chainstate.m_chain.Tip()->GetBlockHash(),\n+                                     .indexes = {1, UINT16_MAX}});\n+        if (pipes->send.GetBytes(buf, sizeof(buf)) == 0) {\n+            break;\n+        }\n+        std::this_thread::sleep_for(50ms);\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 102,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061896936,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Added.",
      "created_at": "2023-01-12T14:47:14Z",
      "updated_at": "2023-01-12T14:47:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068212938",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068212938"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068245906",
      "pull_request_review_id": 1245795841,
      "id": 1068245906,
      "node_id": "PRRC_kwDOABII584_rCOS",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061557476,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why not de-duplicate by putting it in the existing `./src/test/fuzz/process_message.cpp` file?",
      "created_at": "2023-01-12T15:12:13Z",
      "updated_at": "2023-01-12T15:12:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068245906",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068245906"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068310185",
      "pull_request_review_id": 1245900568,
      "id": 1068310185,
      "node_id": "PRRC_kwDOABII584_rR6p",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061557476,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You mean to put the entire contents of the newly introduced `fuzz/netmsg.cpp` inside `fuzz/process_message.cpp`?",
      "created_at": "2023-01-12T16:03:46Z",
      "updated_at": "2023-01-12T16:03:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068310185",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068310185"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068314583",
      "pull_request_review_id": 1245907668,
      "id": 1068314583,
      "node_id": "PRRC_kwDOABII584_rS_X",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061557476,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "yes",
      "created_at": "2023-01-12T16:07:36Z",
      "updated_at": "2023-01-12T16:07:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068314583",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068314583"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068407369",
      "pull_request_review_id": 1246114670,
      "id": 1068407369,
      "node_id": "PRRC_kwDOABII584_rppJ",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }\n+\n+void initialize_netmsg()\n+{\n+    Assert(GetNumMsgTypes() == getAllNetMessageTypes().size()); // If this fails, add or remove the message type below\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>();\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+static void fuzz_target(FuzzBufferType buffer, const std::string& limit_to_message_type)",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 57,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061894472,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> IMO e2e fuzzing has some value.\r\n\r\nYes, but I think it should focus on what you are trying to test. If you keep the target to broad the fuzzer is gonna have a hard time finding interesting test cases (especially if the target is slow). One obvious way of focusing is to only fuzz smaller units of code and in the e2e case you probably want to narrow the way you are interpreting the fuzz input so that you are actually testing what you want to test.\r\n\r\nThe approach here currently seems to be very similar to the `process_message(s)` targets (which is why you suggested to replace them iiuc), in that you are interpreting most of the fuzz input as a sequence of arbitrary messages, so the questions that I have are:\r\n* What do you want to test here? Message processing? connman internals? the interactions between connman/peerman?\r\n* What bugs is your target capable of finding that `process_message(s)` (or other targets) are not? In other words which areas/interactions is this fuzzing that are previously not covered?\r\n* Are the message contents (and their mutations) of all message types useful for what you are trying to test here? e.g. does it matter if a tx message contains a transaction with 1 input or 5? because the fuzzer will likely find that difference interesting but it doesn't seem like this would add value to what you are trying to test here, since the goal (correct me if I am wrong) isn't fuzzing validation.\r\n* Could the input interpretation be narrowed to only include the messages that lead to interactions you are trying to test?",
      "created_at": "2023-01-12T17:31:09Z",
      "updated_at": "2023-01-12T17:31:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1068407369",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1068407369"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1070262419",
      "pull_request_review_id": 1248763319,
      "id": 1070262419,
      "node_id": "PRRC_kwDOABII584_yuiT",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061557476,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Looks plausible. I will try to do that and see how it will look.",
      "created_at": "2023-01-14T12:58:20Z",
      "updated_at": "2023-01-14T12:58:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1070262419",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1070262419"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1111936979",
      "pull_request_review_id": 1305767542,
      "id": 1111936979,
      "node_id": "PRRC_kwDOABII585CRs_T",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061557476,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done. This also reduced the size of the diff (the last commit). Thanks!",
      "created_at": "2023-02-20T13:05:33Z",
      "updated_at": "2023-02-20T13:05:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1111936979",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1111936979"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171479645",
      "pull_request_review_id": 1392285351,
      "id": 1171479645,
      "node_id": "PRRC_kwDOABII585F01xd",
      "diff_hunk": "@@ -0,0 +1,183 @@\n+// Copyright (c) 2022-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net_processing.h>\n+#include <netaddress.h>\n+#include <protocol.h>\n+#include <test/util/logging.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/time.h>\n+#include <version.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <chrono>\n+#include <string>\n+#include <unordered_map>\n+\n+BOOST_FIXTURE_TEST_SUITE(netmsg_tests, NetTestingSetup)\n+\n+BOOST_AUTO_TEST_CASE(initial_messages_exchange)\n+{\n+    std::unordered_map<std::string, size_t> count_sent_messages;\n+    auto pipes = m_sockets_pipes.PopFront();\n+\n+    // Wait for all messages due to the initial handshake to be Send() to the socket.\n+    // The FEEFILTER is the last one, so quit when we get that.\n+    for (;;) {\n+        auto msg = pipes->send.GetNetMsg();\n+        if (msg.has_value()) {\n+            count_sent_messages[msg->m_type]++;\n+            if (msg->m_type == NetMsgType::FEEFILTER) {\n+                break;\n+            }\n+        } else {\n+            break;\n+        }\n+    }\n+\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::VERSION], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::WTXIDRELAY], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::SENDADDRV2], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::VERACK], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::GETADDR], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::SENDCMPCT], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::PING], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::GETHEADERS], 1);\n+    BOOST_CHECK_EQUAL(count_sent_messages[NetMsgType::FEEFILTER], 1);\n+}\n+\n+BOOST_AUTO_TEST_CASE(addr)\n+{\n+    auto pipes = m_sockets_pipes.PopFront();\n+    std::vector<CAddress> addresses{5};\n+\n+    DebugLogHelper debug_log{strprintf(\"Received addr: %u addresses\", addresses.size())};\n+    pipes->recv.PushNetMsg(NetMsgType::ADDRV2, addresses);\n+    debug_log.EndAndThrowIfNotFound(30s);\n+}\n+\n+BOOST_AUTO_TEST_CASE(getblocks)\n+{\n+    auto pipes = m_sockets_pipes.PopFront();\n+    std::vector<uint256> hashes{5};\n+    CBlockLocator block_locator{std::move(hashes)};\n+    uint256 hash_stop;\n+\n+    DebugLogHelper debug_log{\"getblocks -1 to end\"};\n+    pipes->recv.PushNetMsg(NetMsgType::GETBLOCKS, block_locator, hash_stop);\n+    debug_log.EndAndThrowIfNotFound(30s);\n+}\n+\n+BOOST_AUTO_TEST_CASE(ping)",
      "path": "src/test/netmsg_tests.cpp",
      "position": 74,
      "original_position": 74,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061551756,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The unit tests are what I run locally over and over, as they run so much more quickly.  IIRC there was a project idea a few years ago to convert the functional tests in Python to C++.  Having better unit test coverage, or shifting coverage from the Python tests to C++ ones, seems beneficial.",
      "created_at": "2023-04-19T15:03:10Z",
      "updated_at": "2023-04-19T15:03:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1171479645",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171479645"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 74,
      "original_line": 74,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219375776",
      "pull_request_review_id": 1464849019,
      "id": 1219375776,
      "node_id": "PRRC_kwDOABII585IrjKg",
      "diff_hunk": "@@ -0,0 +1,140 @@\n+// Copyright (c) 2020-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <banman.h>\n+#include <blockencodings.h>\n+#include <consensus/consensus.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validationinterface.h>\n+\n+#include <chrono>\n+#include <string>\n+#include <thread>\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+} // namespace\n+\n+static size_t& GetNumMsgTypes()\n+{\n+    static size_t g_num_msg_types{0};\n+    return g_num_msg_types;\n+}\n+#define FUZZ_TARGET_MSG(msg_type)                          \\\n+    struct msg_type##CountBeforeMain {                     \\\n+        msg_type##CountBeforeMain()                        \\\n+        {                                                  \\\n+            ++GetNumMsgTypes();                            \\\n+        }                                                  \\\n+    } const static g_##msg_type##count_before_main;        \\\n+    FUZZ_TARGET_INIT(netmsg_##msg_type, initialize_netmsg) \\\n+    {                                                      \\\n+        fuzz_target(buffer, #msg_type);                    \\\n+    }",
      "path": "src/test/fuzz/netmsg.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "9b7e9dad271167af913828aaf3b75a9942770a34",
      "in_reply_to_id": 1061557476,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I put the new e2e tests in a separate new file because this code (which I was trying to avoid duplicating) is gone after https://github.com/bitcoin/bitcoin/pull/27766",
      "created_at": "2023-06-06T10:26:55Z",
      "updated_at": "2023-06-06T10:26:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1219375776",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219375776"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219413577",
      "pull_request_review_id": 1464897993,
      "id": 1219413577,
      "node_id": "PRRC_kwDOABII585IrsZJ",
      "diff_hunk": "@@ -0,0 +1,107 @@\n+// Copyright (c) 2020-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <primitives/transaction.h>\n+#include <protocol.h>\n+#include <script/script.h>\n+#include <serialize.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <sync.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/fuzz/util/net.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/chaintype.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+#include <version.h>\n+\n+\n+#include <atomic>\n+#include <cstdlib>\n+#include <iostream>\n+#include <memory>\n+#include <string>\n+#include <string_view>\n+#include <vector>\n+\n+// There are two sets of tests:\n+// - direct: pass the fuzzed message directly to PeerManager::ProcessMessage() (fuzz/process_message.cpp)\n+// - e2e: send the fuzzed message to a mocked socket which is read from Connman\n+//   and processed by PeerManager (like it is happening in the \"real world\") (fuzz/process_message_e2e.cpp)\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+std::string_view LIMIT_TO_MESSAGE_TYPE{};\n+} // namespace\n+\n+void initialize_process_message_e2e()\n+{\n+    if (const auto val{std::getenv(\"LIMIT_TO_MESSAGE_TYPE\")}) {\n+        LIMIT_TO_MESSAGE_TYPE = val;\n+        Assert(std::count(getAllNetMessageTypes().begin(), getAllNetMessageTypes().end(), LIMIT_TO_MESSAGE_TYPE)); // Unknown message type passed\n+    }\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>(\n+            /*chain_type=*/ChainType::REGTEST,\n+            /*extra_args=*/{\"-txreconciliation\"});\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+FUZZ_TARGET_INIT(process_message_e2e, initialize_process_message_e2e)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    SetMockTime(GetMockTime() + std::chrono::minutes{fuzzed_data_provider.ConsumeIntegral<uint8_t>()});\n+\n+    g_setup->m_node.connman->OpenNetworkConnection(\n+        CAddress{}, false, nullptr, \"1.2.3.4:8333\", ConnectionType::OUTBOUND_FULL_RELAY);\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type{\n+            LIMIT_TO_MESSAGE_TYPE.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                LIMIT_TO_MESSAGE_TYPE};",
      "path": "src/test/fuzz/process_message_e2e.cpp",
      "position": 84,
      "original_position": 84,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changing the fuzz input format with a run-time setting seems fragile and not intuitive when one wants to re-use fuzz inputs or reproduce runs.",
      "created_at": "2023-06-06T10:53:23Z",
      "updated_at": "2023-06-06T10:55:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1219413577",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219413577"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 84,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219414855",
      "pull_request_review_id": 1464897993,
      "id": 1219414855,
      "node_id": "PRRC_kwDOABII585IrstH",
      "diff_hunk": "@@ -0,0 +1,107 @@\n+// Copyright (c) 2020-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <primitives/transaction.h>\n+#include <protocol.h>\n+#include <script/script.h>\n+#include <serialize.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <sync.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/fuzz/util/net.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/chaintype.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+#include <version.h>\n+\n+\n+#include <atomic>\n+#include <cstdlib>\n+#include <iostream>\n+#include <memory>\n+#include <string>\n+#include <string_view>\n+#include <vector>\n+\n+// There are two sets of tests:\n+// - direct: pass the fuzzed message directly to PeerManager::ProcessMessage() (fuzz/process_message.cpp)\n+// - e2e: send the fuzzed message to a mocked socket which is read from Connman\n+//   and processed by PeerManager (like it is happening in the \"real world\") (fuzz/process_message_e2e.cpp)\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+std::string_view LIMIT_TO_MESSAGE_TYPE{};\n+} // namespace\n+\n+void initialize_process_message_e2e()\n+{\n+    if (const auto val{std::getenv(\"LIMIT_TO_MESSAGE_TYPE\")}) {\n+        LIMIT_TO_MESSAGE_TYPE = val;\n+        Assert(std::count(getAllNetMessageTypes().begin(), getAllNetMessageTypes().end(), LIMIT_TO_MESSAGE_TYPE)); // Unknown message type passed\n+    }\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>(\n+            /*chain_type=*/ChainType::REGTEST,\n+            /*extra_args=*/{\"-txreconciliation\"});\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+FUZZ_TARGET_INIT(process_message_e2e, initialize_process_message_e2e)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    SetMockTime(GetMockTime() + std::chrono::minutes{fuzzed_data_provider.ConsumeIntegral<uint8_t>()});\n+\n+    g_setup->m_node.connman->OpenNetworkConnection(\n+        CAddress{}, false, nullptr, \"1.2.3.4:8333\", ConnectionType::OUTBOUND_FULL_RELAY);\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type{\n+            LIMIT_TO_MESSAGE_TYPE.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                LIMIT_TO_MESSAGE_TYPE};\n+\n+        CDataStream payload{",
      "path": "src/test/fuzz/process_message_e2e.cpp",
      "position": 86,
      "original_position": 86,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could this use `DataStream`, or drop it completely?",
      "created_at": "2023-06-06T10:54:24Z",
      "updated_at": "2023-06-06T10:55:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1219414855",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219414855"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 86,
      "original_line": 86,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219560287",
      "pull_request_review_id": 1465085877,
      "id": 1219560287,
      "node_id": "PRRC_kwDOABII585IsQNf",
      "diff_hunk": "@@ -0,0 +1,107 @@\n+// Copyright (c) 2020-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <primitives/transaction.h>\n+#include <protocol.h>\n+#include <script/script.h>\n+#include <serialize.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <sync.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/fuzz/util/net.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/chaintype.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+#include <version.h>\n+\n+\n+#include <atomic>\n+#include <cstdlib>\n+#include <iostream>\n+#include <memory>\n+#include <string>\n+#include <string_view>\n+#include <vector>\n+\n+// There are two sets of tests:\n+// - direct: pass the fuzzed message directly to PeerManager::ProcessMessage() (fuzz/process_message.cpp)\n+// - e2e: send the fuzzed message to a mocked socket which is read from Connman\n+//   and processed by PeerManager (like it is happening in the \"real world\") (fuzz/process_message_e2e.cpp)\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+std::string_view LIMIT_TO_MESSAGE_TYPE{};\n+} // namespace\n+\n+void initialize_process_message_e2e()\n+{\n+    if (const auto val{std::getenv(\"LIMIT_TO_MESSAGE_TYPE\")}) {\n+        LIMIT_TO_MESSAGE_TYPE = val;\n+        Assert(std::count(getAllNetMessageTypes().begin(), getAllNetMessageTypes().end(), LIMIT_TO_MESSAGE_TYPE)); // Unknown message type passed\n+    }\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>(\n+            /*chain_type=*/ChainType::REGTEST,\n+            /*extra_args=*/{\"-txreconciliation\"});\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+FUZZ_TARGET_INIT(process_message_e2e, initialize_process_message_e2e)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    SetMockTime(GetMockTime() + std::chrono::minutes{fuzzed_data_provider.ConsumeIntegral<uint8_t>()});\n+\n+    g_setup->m_node.connman->OpenNetworkConnection(\n+        CAddress{}, false, nullptr, \"1.2.3.4:8333\", ConnectionType::OUTBOUND_FULL_RELAY);\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type{\n+            LIMIT_TO_MESSAGE_TYPE.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                LIMIT_TO_MESSAGE_TYPE};",
      "path": "src/test/fuzz/process_message_e2e.cpp",
      "position": 84,
      "original_position": 84,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "in_reply_to_id": 1219413577,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Are you suggesting to replace it with this:\r\n\r\n```cpp\r\n        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE)};\r\n        if (!LIMIT_TO_MESSAGE_TYPE.empty() && random_message_type != LIMIT_TO_MESSAGE_TYPE) { \r\n            continue;\r\n        } \r\n```",
      "created_at": "2023-06-06T12:31:32Z",
      "updated_at": "2023-06-06T12:31:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1219560287",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219560287"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 84,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219568001",
      "pull_request_review_id": 1465095909,
      "id": 1219568001,
      "node_id": "PRRC_kwDOABII585IsSGB",
      "diff_hunk": "@@ -0,0 +1,107 @@\n+// Copyright (c) 2020-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <primitives/transaction.h>\n+#include <protocol.h>\n+#include <script/script.h>\n+#include <serialize.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <sync.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/fuzz/util/net.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <test/util/validation.h>\n+#include <util/chaintype.h>\n+#include <util/check.h>\n+#include <util/time.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+#include <version.h>\n+\n+\n+#include <atomic>\n+#include <cstdlib>\n+#include <iostream>\n+#include <memory>\n+#include <string>\n+#include <string_view>\n+#include <vector>\n+\n+// There are two sets of tests:\n+// - direct: pass the fuzzed message directly to PeerManager::ProcessMessage() (fuzz/process_message.cpp)\n+// - e2e: send the fuzzed message to a mocked socket which is read from Connman\n+//   and processed by PeerManager (like it is happening in the \"real world\") (fuzz/process_message_e2e.cpp)\n+\n+namespace {\n+NetTestingSetup* g_setup;\n+std::string_view LIMIT_TO_MESSAGE_TYPE{};\n+} // namespace\n+\n+void initialize_process_message_e2e()\n+{\n+    if (const auto val{std::getenv(\"LIMIT_TO_MESSAGE_TYPE\")}) {\n+        LIMIT_TO_MESSAGE_TYPE = val;\n+        Assert(std::count(getAllNetMessageTypes().begin(), getAllNetMessageTypes().end(), LIMIT_TO_MESSAGE_TYPE)); // Unknown message type passed\n+    }\n+\n+    static const auto testing_setup = MakeNoLogFileContext<NetTestingSetup>(\n+            /*chain_type=*/ChainType::REGTEST,\n+            /*extra_args=*/{\"-txreconciliation\"});\n+    g_setup = testing_setup.get();\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+FUZZ_TARGET_INIT(process_message_e2e, initialize_process_message_e2e)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    SetMockTime(GetMockTime() + std::chrono::minutes{fuzzed_data_provider.ConsumeIntegral<uint8_t>()});\n+\n+    g_setup->m_node.connman->OpenNetworkConnection(\n+        CAddress{}, false, nullptr, \"1.2.3.4:8333\", ConnectionType::OUTBOUND_FULL_RELAY);\n+\n+    auto pipes = g_setup->m_sockets_pipes.PopFront();\n+\n+    uint8_t buf[1024];\n+\n+    LIMITED_WHILE(fuzzed_data_provider.remaining_bytes() > 0, 100) {\n+\n+        const std::string message_type{\n+            LIMIT_TO_MESSAGE_TYPE.empty() ?\n+                fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE) :\n+                LIMIT_TO_MESSAGE_TYPE};\n+\n+        CDataStream payload{",
      "path": "src/test/fuzz/process_message_e2e.cpp",
      "position": 86,
      "original_position": 86,
      "commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "original_commit_id": "4c867de996f58655aec3911f45367eb31865fb4d",
      "in_reply_to_id": 1219414855,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point, dropped it!",
      "created_at": "2023-06-06T12:36:45Z",
      "updated_at": "2023-06-06T12:36:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26812#discussion_r1219568001",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219568001"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26812"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 86,
      "original_line": 86,
      "side": "RIGHT"
    }
  ]
}