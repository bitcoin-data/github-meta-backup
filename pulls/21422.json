{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422",
    "id": 591559189,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NTkxNTU5MTg5",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21422",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/21422.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/21422.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
    "number": 21422,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "Add feerate histogram to getmempoolinfo",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This PR is a slightly modified version of #15836 (jonasschnelli):\r\n\r\n> This follows the approach of adding statistical information to Bitcoin Core that would otherwise be inefficient to calculate outside of the codebase.\r\n> \r\n> Adds an optional feerate histogram to `getmempoolinfo`.\r\n> \r\n> The concept and code is heavily inspired by the stats jhoenicke runs (https://github.com/jhoenicke/mempool, http://bitcoin-mempool.info).\r\n> \r\n> If someone has a good idea how to make the feerate-groups dynamic but also semi-constant for similar fee environments, please comment.\r\n> \r\n> If this is feature we'd like to have in master (concept ACKs), I'd continue this with writing tests.\r\n> \r\n> A simple plot of the data is [here](https://bitcointools.jonasschnelli.ch/mempool-histogram/).\r\n> RPC output sample is [here](https://gist.github.com/jonasschnelli/f5b8a701375c280b65842f44e4f6c046).\r\n\r\n<s>My attempts to contact jonasschnelli were, unfortunately, unsuccessful so I decided to create this PR in an attempt to move this forward. If this is somehow problematic, please let me know to work it out.</s> **edit:** Jonas is happy the work continues.\r\n\r\n### This PR\r\n\r\nNote that REST support which is in #15836 is not included in this PR. It can be improved in this PR or in a follow-up one if it is deemed useful/required/etc.\r\n\r\n#### Applied review comments from the old PR\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/15836#discussion_r304327165 - \"Remove these files and maybe update .gitignore?\"\r\n* https://github.com/bitcoin/bitcoin/pull/15836#discussion_r304346834 - \"This must be before the above line (order is important) otherwise `rest_mempool_info_with_fee_histogram` is never called.\"\r\n* https://github.com/bitcoin/bitcoin/pull/15836#issuecomment-499886548 - \"This gives me a new warning on build: [...]\" This is already addressed, I believe.\r\n* https://github.com/bitcoin/bitcoin/pull/15836#discussion_r588927756 - Simplify `if (feeperbyte >= feelimits[i] && (i == feelimits.size() - 1 || feeperbyte < feelimits[i + 1])) {`\r\n* https://github.com/bitcoin/bitcoin/commit/0b6ba66238c377116bc6c21e19cffbf1b6dfc788 - Added test proposed by promag\r\n* https://github.com/bitcoin/bitcoin/pull/15836#discussion_r437788703 - `std::to_string(...)` replaced with `ToString(...) as done in #18134\r\n\r\n#### Test commands\r\n\r\n```bash\r\n$ ./bitcoin-cli -testnet getmempoolinfo \"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\" # To test the new behavior\r\n```\r\n\r\n```bash\r\n$ test/functional/test_runner.py mempool_fee_histogram.py # To run the new test\r\n```\r\n\r\n```bash\r\n$ ./bitcoin-cli -testnet -rpcuser=test -rpcpassword=test help getmempoolinfo\r\ngetmempoolinfo ( [fee_rate,...] )\r\n\r\nReturns details on the active state of the TX memory pool.\r\n\r\nArguments:\r\n1. fee_histogram    (json array, optional) Fee statistics grouped by fee rate ranges\r\n     [\r\n       fee_rate,    (numeric, required) Fee rate (in sat/vB) to group the fees by\r\n       ...\r\n     ]\r\n\r\nResult:\r\n{                               (json object)\r\n  \"loaded\" : true|false,        (boolean) True if the mempool is fully loaded\r\n  \"size\" : n,                   (numeric) Current tx count\r\n  \"bytes\" : n,                  (numeric) Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\r\n  \"usage\" : n,                  (numeric) Total memory usage for the mempool\r\n  \"total_fee\" : n,              (numeric) Total fees for the mempool in BTC, ignoring modified fees through prioritizetransaction\r\n  \"maxmempool\" : n,             (numeric) Maximum memory usage for the mempool\r\n  \"mempoolminfee\" : n,          (numeric) Minimum fee rate in BTC/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\r\n  \"minrelaytxfee\" : n,          (numeric) Current minimum relay fee for transactions\r\n  \"unbroadcastcount\" : n,       (numeric) Current number of transactions that haven't passed initial broadcast yet\r\n  \"fee_histogram\" : {           (json object)\r\n    \"fee_rate_groups\" : {       (json object)\r\n      \"<fee_rate_group>\" : {    (json object) Fee rate group named by its lower bound (in sat/vB), identical to the \"from\" field below\r\n        \"size\" : n,             (numeric) Cumulative size of all transactions in the fee rate group (in vBytes)\r\n        \"count\" : n,            (numeric) Number of transactions in the fee rate group\r\n        \"fees\" : n,             (numeric) Cumulative fees of all transactions in the fee rate group (in sat)\r\n        \"from\" : n             (numeric) Group contains transactions with fee rates equal or greater than this value (in sat/vB)\r\n      },\r\n      ...\r\n    },\r\n    \"total_fees\" : n            (numeric) Total available fees in mempool (in sat)\r\n  }\r\n}\r\n\r\nExamples:\r\n> bitcoin-cli getmempoolinfo\r\n> bitcoin-cli getmempoolinfo \"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\"\r\n> curl --user myusername --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"getmempoolinfo\", \"params\": []}' -H 'content-type: text/plain;' http://127.0.0.1:8332/\r\n> curl --user myusername --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"getmempoolinfo\", \"params\": [[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]]}' -H 'content-type: text/plain;' http://127.0.0.1:8332/\r\n```\r\n\r\n#### Output on testnet (2022-07-09)\r\n\r\n```bash\r\n./bitcoin-cli -testnet -rpcuser=test -rpcpassword=test getmempoolinfo \"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\"\r\n```\r\n\r\n<details>\r\n  <summary>JSON output</summary>\r\n\r\n  ```json\r\n{\r\n  \"loaded\": true,\r\n  \"size\": 10,\r\n  \"bytes\": 2652,\r\n  \"usage\": 13504,\r\n  \"total_fee\": 0.00363010,\r\n  \"maxmempool\": 300000000,\r\n  \"mempoolminfee\": 0.00001000,\r\n  \"minrelaytxfee\": 0.00001000,\r\n  \"unbroadcastcount\": 0,\r\n  \"fee_histogram\": {\r\n    \"fee_rate_groups\": {\r\n      \"0\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 0\r\n      },\r\n      \"1\": {\r\n        \"size\": 403,\r\n        \"count\": 2,\r\n        \"fees\": 403,\r\n        \"from\": 1\r\n      },\r\n      \"2\": {\r\n        \"size\": 554,\r\n        \"count\": 2,\r\n        \"fees\": 561,\r\n        \"from\": 2\r\n      },\r\n      \"3\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 3\r\n      },\r\n      \"4\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 4\r\n      },\r\n      \"5\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 5\r\n      },\r\n      \"6\": {\r\n        \"size\": 255,\r\n        \"count\": 1,\r\n        \"fees\": 1345,\r\n        \"from\": 6\r\n      },\r\n      \"7\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 7\r\n      },\r\n      \"8\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 8\r\n      },\r\n      \"10\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 10\r\n      },\r\n      \"12\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 12\r\n      },\r\n      \"14\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 14\r\n      },\r\n      \"17\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 17\r\n      },\r\n      \"20\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 20\r\n      },\r\n      \"25\": {\r\n        \"size\": 352,\r\n        \"count\": 1,\r\n        \"fees\": 9505,\r\n        \"from\": 25\r\n      },\r\n      \"30\": {\r\n        \"size\": 144,\r\n        \"count\": 1,\r\n        \"fees\": 4520,\r\n        \"from\": 30\r\n      },\r\n      \"40\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 40\r\n      },\r\n      \"50\": {\r\n        \"size\": 374,\r\n        \"count\": 1,\r\n        \"fees\": 20000,\r\n        \"from\": 50\r\n      },\r\n      \"60\": {\r\n        \"size\": 351,\r\n        \"count\": 1,\r\n        \"fees\": 23937,\r\n        \"from\": 60\r\n      },\r\n      \"70\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 70\r\n      },\r\n      \"80\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 80\r\n      },\r\n      \"100\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 100\r\n      },\r\n      \"120\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 120\r\n      },\r\n      \"140\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 140\r\n      },\r\n      \"170\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 170\r\n      },\r\n      \"200\": {\r\n        \"size\": 219,\r\n        \"count\": 1,\r\n        \"fees\": 302739,\r\n        \"from\": 200\r\n      }\r\n    },\r\n    \"total_fees\": 363010\r\n  }\r\n}\r\n```\r\n</details>\r\n\r\n#### Various inputs\r\n\r\n```bash\r\n./bitcoin-cli -testnet -rpcuser=test -rpcpassword=test getmempoolinfo \"[0]\"       # OK, one fee rate group covering all possible transaction fee rates (i.e. `>=0`); total_fee = fee_histogram.total_fees\r\n./bitcoin-cli -testnet -rpcuser=test -rpcpassword=test getmempoolinfo \"[-1]\"      # reports: Non-negative values are expected\r\n./bitcoin-cli -testnet -rpcuser=test -rpcpassword=test getmempoolinfo \"[0,0]\"     # reports: Strictly increasing values are expected\r\n./bitcoin-cli -testnet -rpcuser=test -rpcpassword=test getmempoolinfo \"[0,1,0]\"   # reports: Strictly increasing values are expected\r\n./bitcoin-cli -testnet -rpcuser=test -rpcpassword=test getmempoolinfo \"[0, 1000000000000000000000000000000000]\" # reports: JSON integer out of range\r\n./bitcoin-cli -testnet -rpcuser=test -rpcpassword=test getmempoolinfo '[1.2,2,3]' # reports: JSON integer out of range\r\n./bitcoin-cli -testnet -rpcuser=test -rpcpassword=test getmempoolinfo '[\"2\"]'     # reports: Error parsing JSON: ['2']\r\n```",
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "created_at": "2021-03-12T10:32:00Z",
    "updated_at": "2023-03-30T07:50:08Z",
    "closed_at": "2023-03-20T14:42:45Z",
    "mergeable_state": "unknown",
    "merge_commit_sha": "d1a4a17fe0ba035c31a7712d84b28062a262f3c7",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "kiminuo:feature/2021-03-Feerate-histogram",
      "ref": "feature/2021-03-Feerate-histogram",
      "sha": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 243075753,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNDMwNzU3NTM=",
        "name": "bitcoin",
        "full_name": "kiminuo/bitcoin",
        "owner": {
          "login": "kiminuo",
          "id": 58662979,
          "node_id": "MDQ6VXNlcjU4NjYyOTc5",
          "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/kiminuo",
          "html_url": "https://github.com/kiminuo",
          "followers_url": "https://api.github.com/users/kiminuo/followers",
          "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
          "organizations_url": "https://api.github.com/users/kiminuo/orgs",
          "repos_url": "https://api.github.com/users/kiminuo/repos",
          "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/kiminuo/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/kiminuo/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/kiminuo/bitcoin",
        "archive_url": "https://api.github.com/repos/kiminuo/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/kiminuo/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/kiminuo/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/kiminuo/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/kiminuo/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/kiminuo/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/kiminuo/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/kiminuo/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/kiminuo/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/kiminuo/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/kiminuo/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/kiminuo/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/kiminuo/bitcoin/events",
        "forks_url": "https://api.github.com/repos/kiminuo/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/kiminuo/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/kiminuo/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/kiminuo/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/kiminuo/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/kiminuo/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/kiminuo/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/kiminuo/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/kiminuo/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/kiminuo/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/kiminuo/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/kiminuo/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/kiminuo/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/kiminuo/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/kiminuo/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/kiminuo/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:kiminuo/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/kiminuo/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/kiminuo/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/kiminuo/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/kiminuo/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/kiminuo/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/kiminuo/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/kiminuo/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/kiminuo/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/kiminuo/bitcoin/hooks",
        "svn_url": "https://github.com/kiminuo/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "forks_count": 2,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 203819,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-03-20T14:43:02Z",
        "created_at": "2020-02-25T18:49:46Z",
        "updated_at": "2021-05-11T15:03:53Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "40d0b0a524dfe8cc70cc116a6c76a3f834824fe5",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69819,
        "watchers_count": 69819,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T22:42:00Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T04:47:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 273,
    "deletions": 8,
    "changed_files": 6,
    "commits": 2,
    "review_comments": 155,
    "comments": 59
  },
  "events": [
    {
      "event": "mentioned",
      "id": 4449961715,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQ0OTk2MTcxNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4449961715",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:32:01Z"
    },
    {
      "event": "subscribed",
      "id": 4449961729,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0NDk5NjE3Mjk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4449961729",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:32:02Z"
    },
    {
      "event": "mentioned",
      "id": 4449961739,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQ0OTk2MTczOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4449961739",
      "actor": {
        "login": "jhoenicke",
        "id": 897826,
        "node_id": "MDQ6VXNlcjg5NzgyNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/897826?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jhoenicke",
        "html_url": "https://github.com/jhoenicke",
        "followers_url": "https://api.github.com/users/jhoenicke/followers",
        "following_url": "https://api.github.com/users/jhoenicke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jhoenicke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jhoenicke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jhoenicke/subscriptions",
        "organizations_url": "https://api.github.com/users/jhoenicke/orgs",
        "repos_url": "https://api.github.com/users/jhoenicke/repos",
        "events_url": "https://api.github.com/users/jhoenicke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jhoenicke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:32:02Z"
    },
    {
      "event": "subscribed",
      "id": 4449961744,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0NDk5NjE3NDQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4449961744",
      "actor": {
        "login": "jhoenicke",
        "id": 897826,
        "node_id": "MDQ6VXNlcjg5NzgyNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/897826?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jhoenicke",
        "html_url": "https://github.com/jhoenicke",
        "followers_url": "https://api.github.com/users/jhoenicke/followers",
        "following_url": "https://api.github.com/users/jhoenicke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jhoenicke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jhoenicke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jhoenicke/subscriptions",
        "organizations_url": "https://api.github.com/users/jhoenicke/orgs",
        "repos_url": "https://api.github.com/users/jhoenicke/repos",
        "events_url": "https://api.github.com/users/jhoenicke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jhoenicke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:32:02Z"
    },
    {
      "event": "mentioned",
      "id": 4449961754,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQ0OTk2MTc1NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4449961754",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:32:02Z"
    },
    {
      "event": "subscribed",
      "id": 4449961758,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0NDk5NjE3NTg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4449961758",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:32:02Z"
    },
    {
      "event": "commented",
      "id": 797405001,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc5NzQwNTAwMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797405001",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:45:10Z",
      "updated_at": "2021-03-12T10:45:10Z",
      "author_association": "MEMBER",
      "body": "Hey @kiminuo, can you amend the commit and remove my mention? Keep in mind that mentions in commits lead to notifications. Ty.",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-797405001",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 4450021353,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQ1MDAyMTM1Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4450021353",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:45:10Z"
    },
    {
      "event": "subscribed",
      "id": 4450021355,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0NTAwMjEzNTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4450021355",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:45:10Z"
    },
    {
      "event": "commented",
      "id": 797405777,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc5NzQwNTc3Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797405777",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:46:35Z",
      "updated_at": "2021-03-12T10:46:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Hey @kiminuo, can you amend the commit and remove my mention? Keep in mind that mentions in commits lead to notifications. Ty.\r\n\r\nYes, sorry for that.",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-797405777",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 4450027590,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQ1MDAyNzU5MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4450027590",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:46:35Z"
    },
    {
      "event": "subscribed",
      "id": 4450027597,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0NTAwMjc1OTc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4450027597",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T10:46:35Z"
    },
    {
      "event": "labeled",
      "id": 4450264741,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ0NTAyNjQ3NDE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4450264741",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T11:43:19Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4450768941,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQ1MDc2ODk0MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4450768941",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T13:43:41Z"
    },
    {
      "event": "commented",
      "id": 797707560,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc5NzcwNzU2MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797707560",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-12T19:34:03Z",
      "updated_at": "2021-03-12T19:34:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for picking this up.",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-797707560",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 800167374,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwMDE2NzM3NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/800167374",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-16T11:09:02Z",
      "updated_at": "2023-03-14T15:42:05Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [0xB10C](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1467960000) |\n| Concept ACK | [jonatack](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-803550651), [JeremyRubin](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-819566377), [ghost](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-899258623), [jamesob](https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-813031121), [molnard](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1369590171), [sipa](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1369866129) |\n| Stale ACK | [stratospher](https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-805113100), [kristapsk](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1468044559) |\n| Ignored review | [glozow](https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-1336717945) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26525](https://github.com/bitcoin/bitcoin/pull/26525) (Remove -mempoolfullrbf option by BitcoinErrorLog)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-800167374",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4486039608,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQ4NjAzOTYwOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4486039608",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-20T21:39:50Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4486471375,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQ4NjQ3MTM3NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4486471375",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-21T08:10:47Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4486549537,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQ4NjU0OTUzNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4486549537",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-21T09:55:28Z"
    },
    {
      "event": "commented",
      "id": 803550651,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzU1MDY1MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803550651",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-21T10:31:34Z",
      "updated_at": "2021-03-21T10:31:34Z",
      "author_association": "MEMBER",
      "body": "Concept ACK. For the test commit, maybe a more descriptive title that can be understood on its own.\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-803550651",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "reviewed",
      "id": 617005701,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE3MDA1NzAx",
      "url": null,
      "actor": null,
      "commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "A few initial comments.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-617005701",
      "submitted_at": "2021-03-21T11:00:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 617007432,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE3MDA3NDMy",
      "url": null,
      "actor": null,
      "commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-617007432",
      "submitted_at": "2021-03-21T11:06:03Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "commented",
      "id": 803653818,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzY1MzgxOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803653818",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-21T20:23:22Z",
      "updated_at": "2021-03-21T20:23:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "@jonatack Thanks for the superb review! I'm working on incorporating your suggestions.",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-803653818",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 4487159424,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQ4NzE1OTQyNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4487159424",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-21T20:23:23Z"
    },
    {
      "event": "subscribed",
      "id": 4487159426,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0ODcxNTk0MjY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4487159426",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-21T20:23:23Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4488259680,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQ4ODI1OTY4MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4488259680",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-22T07:04:56Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4497626026,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQ5NzYyNjAyNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4497626026",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-23T17:36:47Z"
    },
    {
      "event": "reviewed",
      "id": 618993997,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE4OTkzOTk3",
      "url": null,
      "actor": null,
      "commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-618993997",
      "submitted_at": "2021-03-23T19:36:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 619000071,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE5MDAwMDcx",
      "url": null,
      "actor": null,
      "commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-619000071",
      "submitted_at": "2021-03-23T19:44:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 619005710,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE5MDA1NzEw",
      "url": null,
      "actor": null,
      "commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-619005710",
      "submitted_at": "2021-03-23T19:50:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 619007089,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE5MDA3MDg5",
      "url": null,
      "actor": null,
      "commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-619007089",
      "submitted_at": "2021-03-23T19:52:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 619010167,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE5MDEwMTY3",
      "url": null,
      "actor": null,
      "commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-619010167",
      "submitted_at": "2021-03-23T19:56:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 619011160,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE5MDExMTYw",
      "url": null,
      "actor": null,
      "commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-619011160",
      "submitted_at": "2021-03-23T19:57:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4498651456,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQ5ODY1MTQ1Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4498651456",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-23T21:30:57Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4503781290,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUwMzc4MTI5MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4503781290",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-24T19:02:54Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4503823657,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUwMzgyMzY1Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4503823657",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-24T19:11:45Z"
    },
    {
      "event": "reviewed",
      "id": 621285483,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjIxMjg1NDgz",
      "url": null,
      "actor": null,
      "commit_id": "fb0824ce3c7b9d1b5432da38321ba5b06e74c908",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Thanks for switching it from BTC/kvB to sat/vB!\r\n\r\nI looked over this more thoroughly and saw quite a few remaining fixups and suggestions. One thing to ensure is that the help docs are the same as the actual output and use the correct fee rate units and arg types.\r\n\r\nIt would be good if the functional test actually verified that the values are correctly calculated after creating a few txns; ATM it is only really a smoke test that verifies the output structure.\r\n\r\n<details><summary>suggestions</summary><p>\r\n\r\n```diff\r\ndiff --git a/src/rpc/blockchain.cpp b/src/rpc/blockchain.cpp\r\nindex 8d7ce13e57..fbae7cdbaf 100644\r\n--- a/src/rpc/blockchain.cpp\r\n+++ b/src/rpc/blockchain.cpp\r\n@@ -1512,7 +1512,7 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool, const std::optional<MempoolHi\r\n          * ... cumulated fees */\r\n         std::vector<uint64_t> sizes(limits.size(), 0);\r\n         std::vector<uint64_t> count(limits.size(), 0);\r\n-        std::vector<uint64_t> fees(limits.size(), 0);\r\n+        std::vector<CAmount> fees(limits.size(), 0);\r\n \r\n         for (const CTxMemPoolEntry& e : pool.mapTx) {\r\n             const CAmount fee{e.GetFee()};\r\n@@ -1528,15 +1528,19 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool, const std::optional<MempoolHi\r\n             CHECK_NONFATAL(dsize > 0);\r\n             CHECK_NONFATAL(asize + dsize - size > 0);\r\n\r\n-            CAmount fpb{fee / size};     // fee per byte\r\n-            CAmount afpb{afees / asize}; // fee per byte including ancestors\r\n-            CAmount dfpb{dfees / dsize}; // fee per byte including descendants\r\n-            CAmount tfpb{(afees + dfees - fee) / (asize + dsize - size)};\r\n-            CAmount feeperbyte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\r\n+            const CAmount fpb{fee / size};     // fee per byte\r\n+            const CAmount afpb{afees / asize}; // fee per byte including ancestors\r\n+            const CAmount dfpb{dfees / dsize}; // fee per byte including descendants\r\n+            const CAmount tfpb{(afees + dfees - fee) / (asize + dsize - size)};\r\n+            const CAmount fee_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\r\n+ \r\n+            assert(fpb == CFeeRate(fee, size).GetFee(1));\r\n+            assert(afpb == CFeeRate(afees, asize).GetFee(1));\r\n+            assert(dfpb == CFeeRate(dfees, dsize).GetFee(1));\r\n+            assert(tfpb == CFeeRate(afees + dfees - fee, asize + dsize - size).GetFee(1));\r\n+\r\n-            // Distribute feerates into feelimits\r\n+            // Distribute fee rates into fee limits\r\n             for (int i = limits.size() - 1; i >= 0; --i) {\r\n-                if (feeperbyte >= limits[i]) {\r\n+                if (fee_per_byte >= limits[i]) {\r\n                     sizes[i] += size;\r\n                     ++count[i];\r\n                     fees[i] += fee;\r\n@@ -1545,23 +1549,23 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool, const std::optional<MempoolHi\r\n             }\r\n         }\r\n \r\n         UniValue ranges(UniValue::VOBJ);\r\n         for (size_t i = 0; i < limits.size(); ++i) {\r\n             UniValue info_sub(UniValue::VOBJ);\r\n-            info_sub.pushKV(\"sizes\", sizes[i]);\r\n-            info_sub.pushKV(\"count\", count[i]);\r\n-            info_sub.pushKV(\"fees\", fees[i]);\r\n-            info_sub.pushKV(\"from_feerate\", limits[i]);\r\n+            info_sub.pushKV(\"size\", sizes.at(i));\r\n+            info_sub.pushKV(\"count\", count.at(i));\r\n+            info_sub.pushKV(\"fees\", fees.at(i));\r\n+            info_sub.pushKV(\"from\", limits.at(i));\r\n \r\n             if (i == limits.size() - 1) {\r\n-                info_sub.pushKV(\"to_feerate\", \"Max\"); // TODO.\r\n+                info_sub.pushKV(\"to\", \"max\"); // TODO.\r\n             } else {\r\n-                info_sub.pushKV(\"to_feerate\", limits[i + 1]);\r\n+                info_sub.pushKV(\"to\", limits[i + 1]);\r\n             }\r\n \r\n-            total_fees += fees[i];\r\n-            ranges.pushKV(ToString(limits[i]), info_sub);\r\n+            total_fees += fees.at(i);\r\n+            ranges.pushKV(ToString(limits.at(i)), info_sub);\r\n         }\r\n \r\n         UniValue info(UniValue::VOBJ);\r\n@@ -1580,7 +1584,7 @@ static RPCHelpMan getmempoolinfo()\r\n                 {\r\n                     {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\r\n                         {\r\n-                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in satoshis) to group the fees by\"},\r\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\r\n                         },\r\n                     },\r\n                 },\r\n@@ -1591,31 +1595,31 @@ static RPCHelpMan getmempoolinfo()\r\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\r\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\r\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\r\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\r\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\r\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\r\n-                        {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\r\n+                        {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\r\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\r\n                         {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\r\n                         {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\r\n                             {\r\n-                                {RPCResult::Type::OBJ_DYN, \"ranges\", \"Feerate groups\",\r\n+                                {RPCResult::Type::OBJ_DYN, \"ranges\", \"\",\r\n                                 {\r\n-                                    {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\r\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\r\n                                     {\r\n-                                        {RPCResult::Type::NUM, \"size\", \"Cumulated size of all transactions in feerate group\"},\r\n-                                        {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\r\n-                                        {RPCResult::Type::NUM, \"fees\", \"Cumulated fees of all transactions in feerate group (in satoshis)\"},\r\n-                                        {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transactions with feerates equal or greater than this value (in satoshis)\"},\r\n-                                        {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transactions with feerates less than this value (in satoshis)\"},\r\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\r\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\r\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\r\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\r\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\r\n                                     }}}},\r\n-                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in satoshis)\"},\r\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\r\n                             }},\r\n                     }},\r\n                 RPCExamples{\r\n                     HelpExampleCli(\"getmempoolinfo\", \"\") +\r\n-                    HelpExampleCli(\"getmempoolinfo\", R\"([1, 10, 100, 200, 400, 800])\") +\r\n+                    HelpExampleCli(\"getmempoolinfo\", R\"('[1, 5, 10, 25, 50, 100]')\") +\r\n                     HelpExampleRpc(\"getmempoolinfo\", \"\") +\r\n-                    HelpExampleRpc(\"getmempoolinfo\", R\"([1, 10, 100, 200, 400, 800])\")\r\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([1, 5, 10, 25, 50, 100])\")\r\n                 },\r\n\r\ndiff --git a/test/functional/mempool_fee_histogram.py b/test/functional/mempool_fee_histogram.py\r\nindex 0cbaa97bfc..91c6dccc30 100755\r\n--- a/test/functional/mempool_fee_histogram.py\r\n+++ b/test/functional/mempool_fee_histogram.py\r\n@@ -31,15 +31,15 @@ class MempoolFeeHistogramTest(BitcoinTestFramework):\r\n         total_fees = 0\r\n \r\n         for key, bin in info['fee_histogram']['ranges'].items():\r\n-            assert_equal(int(key), bin['from_feerate'])\r\n+            assert_equal(int(key), bin['from'])\r\n             if bin['fees'] > 0:\r\n                 assert_greater_than(bin['count'], 0)\r\n             else:\r\n                 assert_equal(bin['count'], 0)\r\n             assert_greater_than_or_equal(bin['fees'], 0)\r\n-            assert_greater_than_or_equal(bin['sizes'], 0)\r\n-            if bin['to_feerate'] != 'Max':\r\n-                assert_greater_than(bin['to_feerate'], bin['from_feerate'])\r\n+            assert_greater_than_or_equal(bin['size'], 0)\r\n+            if bin['to'] != 'max':\r\n+                assert_greater_than(bin['to'], bin['from'])\r\n             total_fees += bin['fees']\r\n```\r\n</p></details>\r\n\r\n\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-621285483",
      "submitted_at": "2021-03-25T18:00:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4512617626,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUxMjYxNzYyNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4512617626",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-26T09:00:00Z"
    },
    {
      "event": "commented",
      "id": 808056236,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwODA1NjIzNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808056236",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-26T09:07:05Z",
      "updated_at": "2021-03-26T09:07:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "> It would be good if the functional test actually verified that the values are correctly calculated after creating a few txns; ATM it is only really a smoke test that verifies the output structure.\r\n\r\nThis is on my TODO list. So I will improve it over coming days.",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-808056236",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "reviewed",
      "id": 622572094,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjIyNTcyMDk0",
      "url": null,
      "actor": null,
      "commit_id": "ccb043c8099f7a4cadd85274221b67dda0731caf",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-622572094",
      "submitted_at": "2021-03-26T22:34:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4516962267,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUxNjk2MjI2Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4516962267",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-27T11:24:33Z"
    },
    {
      "event": "reviewed",
      "id": 622754580,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjIyNzU0NTgw",
      "url": null,
      "actor": null,
      "commit_id": "7b6da9fa33c94553436721d39634b53b706a1e72",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "A couple more suggestions. Will re-review after the TODO you mention in https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-808056236.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-622754580",
      "submitted_at": "2021-03-28T15:13:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 622756564,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjIyNzU2NTY0",
      "url": null,
      "actor": null,
      "commit_id": "7b6da9fa33c94553436721d39634b53b706a1e72",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-622756564",
      "submitted_at": "2021-03-28T15:23:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4519491666,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUxOTQ5MTY2Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4519491666",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-29T06:23:26Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4519496014,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUxOTQ5NjAxNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4519496014",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-29T06:24:44Z"
    },
    {
      "event": "commented",
      "id": 809108278,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTEwODI3OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/809108278",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-29T06:31:14Z",
      "updated_at": "2021-03-29T06:31:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Will re-review after the TODO you mention in [#21422 (comment)](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-808056236).\r\n\r\nThank you. I'm slowly getting familiar with Bitcoin's `BitcoinTestFramework`. I'm almost ready to start writing the test. So slow progress, but progress too. I would kind of want to start with `self.setup_clean_chain = True` because I will be more confident about the blockchain's state. It can be improved further later.",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-809108278",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4525861451,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUyNTg2MTQ1MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4525861451",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T08:00:47Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4532680584,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUzMjY4MDU4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4532680584",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-31T07:33:12Z"
    },
    {
      "event": "reviewed",
      "id": 625150489,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjI1MTUwNDg5",
      "url": null,
      "actor": null,
      "commit_id": "3b2db54fbd3a40ef44a1af28d046f920ef2c9620",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-625150489",
      "submitted_at": "2021-03-31T10:50:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 633000042,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjMzMDAwMDQy",
      "url": null,
      "actor": null,
      "commit_id": "3b2db54fbd3a40ef44a1af28d046f920ef2c9620",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-633000042",
      "submitted_at": "2021-04-11T11:08:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4580457470,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU4MDQ1NzQ3MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4580457470",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-12T08:06:43Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4593829203,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU5MzgyOTIwMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4593829203",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-14T14:00:47Z"
    },
    {
      "event": "commented",
      "id": 819558569,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxOTU1ODU2OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/819558569",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-14T14:23:53Z",
      "updated_at": "2021-04-14T14:23:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "> A couple more suggestions. Will re-review after the TODO you mention in [#21422 (comment)](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-808056236).\r\n\r\nI have improved the test. I find it much better than before but I still think it should be tested more. What do you think?",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-819558569",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 819566377,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxOTU2NjM3Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/819566377",
      "actor": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-14T14:34:05Z",
      "updated_at": "2021-04-14T14:34:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK!\r\n\r\nIt might make sense to have the API be more similar to https://numpy.org/doc/stable/reference/generated/numpy.histogram.html",
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-819566377",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 819572940,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxOTU3Mjk0MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/819572940",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-14T14:42:54Z",
      "updated_at": "2021-04-14T14:42:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "> It might make sense to have the API be more similar to https://numpy.org/doc/stable/reference/generated/numpy.histogram.html\r\n\r\nThank you for the suggestion, I'll have a look!",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-819572940",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "ready_for_review",
      "id": 4604766345,
      "node_id": "MDE5OlJlYWR5Rm9yUmV2aWV3RXZlbnQ0NjA0NzY2MzQ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4604766345",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T13:09:47Z"
    },
    {
      "event": "labeled",
      "id": 4608115981,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ2MDgxMTU5ODE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4608115981",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-17T16:26:30Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4608946228,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDYwODk0NjIyOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4608946228",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-18T11:12:39Z"
    },
    {
      "event": "unlabeled",
      "id": 4609058165,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NDYwOTA1ODE2NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4609058165",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-18T13:10:27Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 853786199,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg1Mzc4NjE5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/853786199",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-03T11:06:32Z",
      "updated_at": "2021-06-03T11:06:32Z",
      "author_association": "MEMBER",
      "body": "This, as merged on master, gives me the following build error with clang 13:\r\n```\r\n…/bitcoin/src/rpc/blockchain.cpp:1666:45: error: non-constant-expression cannot be narrowed from type 'size_t' (aka 'unsigned long') to 'uint32_t' (aka 'unsigned int') in initializer list [-Wc++11-narrowing]\r\n            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\r\n                                            ^~~~\r\n…/bitcoin/src/rpc/blockchain.cpp:1666:45: note: insert an explicit cast to silence this issue\r\n            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\r\n                                            ^~~~\r\n                                            static_cast<uint32_t>( )\r\n…/bitcoin/src/rpc/blockchain.cpp:1667:48: error: non-constant-expression cannot be narrowed from type 'size_t' (aka 'unsigned long') to 'uint32_t' (aka 'unsigned int') in initializer list [-Wc++11-narrowing]\r\n            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\r\n                                               ^~~~~\r\n…/bitcoin/src/rpc/blockchain.cpp:1667:48: note: insert an explicit cast to silence this issue\r\n            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\r\n                                               ^~~~~\r\n                                               static_cast<uint32_t>( )\r\n…/bitcoin/src/rpc/blockchain.cpp:1668:48: error: non-constant-expression cannot be narrowed from type 'size_t' (aka 'unsigned long') to 'uint32_t' (aka 'unsigned int') in initializer list [-Wc++11-narrowing]\r\n            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\r\n                                               ^~~~~\r\n…/bitcoin/src/rpc/blockchain.cpp:1668:48: note: insert an explicit cast to silence this issue\r\n            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\r\n                                               ^~~~~\r\n                                               static_cast<uint32_t>( )\r\n…/bitcoin/src/rpc/blockchain.cpp:1671:62: error: non-constant-expression cannot be narrowed from type 'unsigned long' to 'uint32_t' (aka 'unsigned int') in initializer list [-Wc++11-narrowing]\r\n            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\r\n                                                             ^~~~~~~~~~~~~~~~~~~~\r\n…/bitcoin/src/rpc/blockchain.cpp:1671:62: note: insert an explicit cast to silence this issue\r\n            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\r\n                                                             ^~~~~~~~~~~~~~~~~~~~\r\n                                                             static_cast<uint32_t>( )\r\n4 errors generated.\r\nmake[2]: *** [Makefile:9273: rpc/libbitcoin_server_a-blockchain.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\nmake[2]: Leaving directory '/store2/build/bitcoin/bitcoin/src'\r\nmake[1]: *** [Makefile:16124: all-recursive] Error 1\r\nmake[1]: Leaving directory '/store2/build/bitcoin/bitcoin/src'\r\nmake: *** [Makefile:821: all-recursive] Error 1\r\n```\r\nI can't say I've ever seen these before.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-853786199",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "reviewed",
      "id": 675206546,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njc1MjA2NTQ2",
      "url": null,
      "actor": null,
      "commit_id": "ce1bf409274a1156eb5644e468b3951cbb6e7c1e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-675206546",
      "submitted_at": "2021-06-03T12:13:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4838939445,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDgzODkzOTQ0NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4838939445",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-03T17:36:46Z"
    },
    {
      "event": "commented",
      "id": 856042676,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg1NjA0MjY3Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/856042676",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-07T15:35:26Z",
      "updated_at": "2021-06-07T15:35:26Z",
      "author_association": "MEMBER",
      "body": "It builds succesfully now, thanks!",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-856042676",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "reviewed",
      "id": 687628439,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njg3NjI4NDM5",
      "url": null,
      "actor": null,
      "commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-687628439",
      "submitted_at": "2021-06-19T21:46:25Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "commented",
      "id": 864467671,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NDQ2NzY3MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864467671",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-19T21:47:00Z",
      "updated_at": "2021-06-19T21:47:00Z",
      "author_association": "MEMBER",
      "body": "Note: This PR drops the REST support",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-864467671",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "reviewed",
      "id": 687852918,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njg3ODUyOTE4",
      "url": null,
      "actor": null,
      "commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-687852918",
      "submitted_at": "2021-06-19T21:57:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4913183388,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDkxMzE4MzM4OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4913183388",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-20T08:42:44Z"
    },
    {
      "event": "commented",
      "id": 864521472,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NDUyMTQ3Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864521472",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-20T08:53:45Z",
      "updated_at": "2021-06-20T08:53:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Note: This PR drops the REST support\r\n\r\nI have added a note about this in the PR description. Thanks.",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-864521472",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4913191785,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDkxMzE5MTc4NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4913191785",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-20T08:54:03Z"
    },
    {
      "event": "referenced",
      "id": 4944268935,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ5NDQyNjg5MzU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4944268935",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "0e037084b4584cebe0ba4d0cb88a580c60497a39",
      "commit_url": "https://api.github.com/repos/bitcoinknots/bitcoin/commits/0e037084b4584cebe0ba4d0cb88a580c60497a39",
      "created_at": "2021-06-27T19:59:29Z"
    },
    {
      "event": "referenced",
      "id": 4955807129,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ5NTU4MDcxMjk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4955807129",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "3cf62e989e9cde34cfa8b6c46086fb84c6df749d",
      "commit_url": "https://api.github.com/repos/bitcoinknots/bitcoin/commits/3cf62e989e9cde34cfa8b6c46086fb84c6df749d",
      "created_at": "2021-06-29T20:02:43Z"
    },
    {
      "event": "reviewed",
      "id": 728853354,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzI4ODUzMzU0",
      "url": null,
      "actor": null,
      "commit_id": "36f5e224f5f555ed68d373f0c1ee739ff6d4bf46",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-728853354",
      "submitted_at": "2021-08-12T16:46:39Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5154014541,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTE1NDAxNDU0MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5154014541",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-13T06:35:25Z"
    },
    {
      "event": "commented",
      "id": 899258623,
      "node_id": "IC_kwDOABII5841mZj_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/899258623",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-16T06:30:45Z",
      "updated_at": "2021-08-16T06:30:45Z",
      "author_association": "NONE",
      "body": "Concept ACK. Tested the PR commits building on master branch.\r\n\r\n```\r\n$ bitcoin-cli getmempoolinfo \"[1,10,20,30]\"\r\n\r\n  \"loaded\": true,\r\n  \"size\": 22,\r\n  \"bytes\": 4472,\r\n  \"usage\": 31152,\r\n  \"total_fee\": 0.00096947,\r\n  \"maxmempool\": 300000000,\r\n  \"mempoolminfee\": 0.00001000,\r\n  \"minrelaytxfee\": 0.00001000,\r\n  \"unbroadcastcount\": 0,\r\n  \"fee_histogram\": {\r\n    \"fee_rate_groups\": {\r\n      \"1\": {\r\n        \"size\": 3274,\r\n        \"count\": 15,\r\n        \"fees\": 4577,\r\n        \"from\": 1,\r\n        \"to\": 9\r\n      },\r\n      \"10\": {\r\n        \"size\": 141,\r\n        \"count\": 1,\r\n        \"fees\": 2800,\r\n        \"from\": 10,\r\n        \"to\": 19\r\n      },\r\n      \"20\": {\r\n        \"size\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from\": 20,\r\n        \"to\": 29\r\n      },\r\n      \"30\": {\r\n        \"size\": 1057,\r\n        \"count\": 6,\r\n        \"fees\": 89570,\r\n        \"from\": 30,\r\n        \"to\": null\r\n      }\r\n    },\r\n    \"total_fees\": 96947\r\n  }\r\n}\r\n\r\n```\r\n\r\n[Fee distribution chart](https://github.com/prayank23/bitcoin-histogram) using the results from `bitcoin-cli getmempoolinfo \"[1,10,20,30]\"`:\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/129519871-06ca6071-cf39-4f68-8370-eb4ae11f44c3.png)\r\n\r\n\r\n```python\r\nfrom flask import Flask, render_template\r\nimport requests\r\nimport json\r\n\r\napp = Flask(__name__)\r\n\r\n@app.route('/')\r\n\r\ndef chart(chartID = 'chart_ID', chart_type = 'bar', chart_height = 200):\r\n\tsize_group1 = size(1)\r\n\tsize_group2 = size(10)\r\n\tsize_group3 = size(20)\r\n\t\r\n\tchart = {\"renderTo\": chartID, \"type\": chart_type, \"height\": chart_height,}\r\n\tseries = [{\"name\": 'Size (vByte)', \"data\": [int(size_group1), int(size_group2), int(size_group3)]}]\r\n\ttitle = {\"text\": 'Fee rate distribution'}\r\n\txAxis = {\"categories\": ['1-9', '10-19', '20-29']}\r\n\tyAxis = {\"title\": {\"text\": ''}}\r\n\treturn render_template('index.html', chartID=chartID, chart=chart, series=series, title=title, xAxis=xAxis, yAxis=yAxis)\r\n\r\ndef size(group):\r\n\turl = \"http://127.0.0.1:18333/\"\r\n\tpayload = \"{\\\"jsonrpc\\\": \\\"1.0\\\", \\\"id\\\": \\\"bitcoin-histogram\\\", \\\"method\\\": \\\"getmempoolinfo\\\", \\\"params\\\": [[1,10,20,30]]}\"\r\n\theaders = {\r\n  \t  'Authorization': 'Basic dXNlcjMzOnBhc3N3b3JkMzM=',\r\n  \t  'Content-Type': 'text/plain'\r\n\t}\r\n\tresponse = requests.request(\"POST\", url, headers=headers, data=payload, )\r\n\tfee_dist = response.json()\r\n\tsize_group = fee_dist['result']['fee_histogram']['fee_rate_groups'][\"\" +str(group)+ \"\"]['size']\t\r\n\treturn str(size_group)\r\n\r\nif __name__ == \"__main__\":\r\n\tapp.run(debug = True, host='127.0.0.1', port=8080, passthrough_errors=True)\r\n```\r\n\r\n\r\n",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-899258623",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 959858353,
      "node_id": "IC_kwDOABII5845Nkax",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/959858353",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-03T19:30:17Z",
      "updated_at": "2021-11-03T19:30:17Z",
      "author_association": "NONE",
      "body": "@kiminuo https://github.com/bitcoin/bitcoin/pull/22891 adds fee rate distribution bars in `-getinfo`. Its on top of this PR. Will be helpful if you could review :)\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/140179579-34cd5599-fa09-47c5-a02c-d5e8abf3844b.png)\r\n\r\n\r\nAlso waiting for reviewers in this PR to leave some ACKs or comments to improve so that other projects can also use this histogram",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-959858353",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 5564338265,
      "node_id": "MEE_lADOABII584xeHwozwAAAAFLqRBZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5564338265",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-03T19:30:17Z"
    },
    {
      "event": "subscribed",
      "id": 5564338270,
      "node_id": "SE_lADOABII584xeHwozwAAAAFLqRBe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5564338270",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-03T19:30:17Z"
    },
    {
      "event": "reviewed",
      "id": 805113100,
      "node_id": "PRR_kwDOABII584v_Q0M",
      "url": null,
      "actor": null,
      "commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK f2ca3d3. I really like this idea.\r\n- [x] 6466eb6\r\n    - Introduces an optional argument `feeLimits` to MempoolInfoToJSON() in order to specify the required fee rate ranges of the histogram. `fee_rate_per_byte` is calculated and the transaction is placed in the correct fee rate group.\r\n- [x] f2ca3d3\r\n    - Tests  whether the correct histogram is generated for various cases when the mempool contains 0, 1, 2 and 3 transactions.\r\n",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-805113100",
      "submitted_at": "2021-11-12T18:29:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "commented",
      "id": 967404182,
      "node_id": "IC_kwDOABII5845qWqW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/967404182",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-12T19:38:43Z",
      "updated_at": "2021-11-12T19:38:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-967404182",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "reviewed",
      "id": 805214579,
      "node_id": "PRR_kwDOABII584v_plz",
      "url": null,
      "actor": null,
      "commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK f2ca3d35ee999e0be309a65c4f69865824e27a4b. Reviewed code, ran new functional test and did basic manual testing on signet and mainnet.",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-805214579",
      "submitted_at": "2021-11-12T20:47:40Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 812542880,
      "node_id": "PRR_kwDOABII584wbmug",
      "url": null,
      "actor": null,
      "commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-812542880",
      "submitted_at": "2021-11-22T13:37:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 812749707,
      "node_id": "PRR_kwDOABII584wcZOL",
      "url": null,
      "actor": null,
      "commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-812749707",
      "submitted_at": "2021-11-22T16:30:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "commented",
      "id": 975711424,
      "node_id": "IC_kwDOABII5846KCzA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975711424",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-22T16:39:17Z",
      "updated_at": "2021-11-22T16:39:17Z",
      "author_association": "MEMBER",
      "body": "Approach NACK as-is, this will result in distorted numbers. https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754438676",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-975711424",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "reviewed",
      "id": 812481523,
      "node_id": "PRR_kwDOABII584wbXvz",
      "url": null,
      "actor": null,
      "commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Thanks for picking this up. Left a few comments.\r\n\r\nTest currently only cover the count and not the fees or sizes per feerate group.",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-812481523",
      "submitted_at": "2021-11-22T16:50:07Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 812885610,
      "node_id": "PRR_kwDOABII584wc6Zq",
      "url": null,
      "actor": null,
      "commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "Xekyo",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Xekyo",
        "html_url": "https://github.com/Xekyo",
        "followers_url": "https://api.github.com/users/Xekyo/followers",
        "following_url": "https://api.github.com/users/Xekyo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Xekyo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Xekyo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Xekyo/subscriptions",
        "organizations_url": "https://api.github.com/users/Xekyo/orgs",
        "repos_url": "https://api.github.com/users/Xekyo/repos",
        "events_url": "https://api.github.com/users/Xekyo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Xekyo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-812885610",
      "submitted_at": "2021-11-22T18:45:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5658490930,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFRRbgy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5658490930",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T07:46:33Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5658495502,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFRRcoO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5658495502",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T07:47:51Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5658510389,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFRRgQ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5658510389",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T07:51:52Z"
    },
    {
      "event": "convert_to_draft",
      "id": 5658546909,
      "node_id": "CTDE_lADOABII584xeHwozwAAAAFRRpLd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5658546909",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T08:00:49Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5658792636,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFRSlK8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5658792636",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T08:52:10Z"
    },
    {
      "event": "reviewed",
      "id": 813526690,
      "node_id": "PRR_kwDOABII584wfW6i",
      "url": null,
      "actor": null,
      "commit_id": "47b5c3e03a71bb4c51e4948effec2a12943a7071",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-813526690",
      "submitted_at": "2021-11-23T11:19:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 813031121,
      "node_id": "PRR_kwDOABII584wdd7R",
      "url": null,
      "actor": null,
      "commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nIt's a good feature but needs some cleanup as many have noted. Rumor has it that a well-known wallet is currently using Bitcoin Knots solely because this feature isn't available in this RPC interface, so maybe worth prioritizing review on that basis.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-813031121",
      "submitted_at": "2021-11-23T15:10:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5662638612,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFRhQIU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5662638612",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T19:52:14Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5662649223,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFRhSuH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5662649223",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T19:54:34Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5662769706,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFRhwIq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5662769706",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T20:19:47Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5662923296,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFRiVog",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5662923296",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-23T20:54:06Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5665831358,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFRtbm-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5665831358",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-24T10:16:31Z"
    },
    {
      "event": "commented",
      "id": 978235017,
      "node_id": "IC_kwDOABII5846Tq6J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/978235017",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-24T21:21:49Z",
      "updated_at": "2021-11-24T22:28:42Z",
      "author_association": "MEMBER",
      "body": "@kiminuo See https://github.com/sipa/bitcoin/commits/202111_mempoolfr for code that gets histogram data using the mining algorithm. Feel free to cherry pick or whatever; if you don't, I may clean it up to make use it after this PR is merged.\r\n\r\nNow, it is somewhat slow (currently ~150ms for me for ~12000 mempool transactions, which is only a small fraction of the maximum). If we expect that go that direction, maybe that calls for having the functionality in a separate RPC than `getmempoolinfo`.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-978235017",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 5669435098,
      "node_id": "MEE_lADOABII584xeHwozwAAAAFR7Lba",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5669435098",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-24T21:21:49Z"
    },
    {
      "event": "subscribed",
      "id": 5669435103,
      "node_id": "SE_lADOABII584xeHwozwAAAAFR7Lbf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5669435103",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-24T21:21:49Z"
    },
    {
      "event": "commented",
      "id": 978941401,
      "node_id": "IC_kwDOABII5846WXXZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/978941401",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-25T08:23:04Z",
      "updated_at": "2022-03-09T21:44:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "@sipa That looks great!\r\n\r\nI would like to go with the simple approach first.",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-978941401",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 5671304154,
      "node_id": "MEE_lADOABII584xeHwozwAAAAFSCTva",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5671304154",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-25T08:23:04Z"
    },
    {
      "event": "subscribed",
      "id": 5671304157,
      "node_id": "SE_lADOABII584xeHwozwAAAAFSCTvd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5671304157",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-25T08:23:04Z"
    },
    {
      "event": "ready_for_review",
      "id": 5675866485,
      "node_id": "RFRE_lADOABII584xeHwozwAAAAFSTtl1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5675866485",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-26T06:39:08Z"
    },
    {
      "event": "reviewed",
      "id": 869142320,
      "node_id": "PRR_kwDOABII584zzg8w",
      "url": null,
      "actor": null,
      "commit_id": "2d2bae70ab56ae15a21768ecf642f2747687aa97",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-869142320",
      "submitted_at": "2022-02-01T13:40:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5994563548,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFlTcfc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5994563548",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T10:01:23Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5995434471,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFlWxHn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5995434471",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T12:34:00Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6215473600,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAFyeJnA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6215473600",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-10T07:30:05Z"
    },
    {
      "event": "commented",
      "id": 1065843808,
      "node_id": "IC_kwDOABII584_h3xg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1065843808",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-12T08:51:34Z",
      "updated_at": "2022-03-12T08:51:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "(1️⃣ year anniversary today 🎉)",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1065843808",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "labeled",
      "id": 6249764355,
      "node_id": "LE_lADOABII584xeHwozwAAAAF0g9YD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6249764355",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T10:33:52Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6274317897,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAF1-n5J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6274317897",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-21T10:28:40Z"
    },
    {
      "event": "commented",
      "id": 1073731814,
      "node_id": "IC_kwDOABII584__9jm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1073731814",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-21T10:30:15Z",
      "updated_at": "2022-03-21T10:30:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased after #24537.",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1073731814",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "unlabeled",
      "id": 6274974396,
      "node_id": "UNLE_lADOABII584xeHwozwAAAAF2BIK8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6274974396",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-21T12:11:22Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1073959589,
      "node_id": "IC_kwDOABII585AA1Kl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1073959589",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-21T14:21:37Z",
      "updated_at": "2022-03-21T14:21:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "@jamesob \r\n\r\n> Concept ACK\r\n> \r\n> It's a good feature but needs some cleanup as many have noted. Rumor has it that a well-known wallet is currently using Bitcoin Knots solely because this feature isn't available in this RPC interface, so maybe worth prioritizing review on that basis.\r\n\r\nCan you clarify what you mean by the cleanup?",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1073959589",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 6275971789,
      "node_id": "MEE_lADOABII584xeHwozwAAAAF2E7rN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6275971789",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-21T14:21:37Z"
    },
    {
      "event": "subscribed",
      "id": 6275971793,
      "node_id": "SE_lADOABII584xeHwozwAAAAF2E7rR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6275971793",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-21T14:21:37Z"
    },
    {
      "event": "unsubscribed",
      "id": 6276003990,
      "node_id": "UE_lADOABII584xeHwozwAAAAF2FDiW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6276003990",
      "actor": {
        "login": "jhoenicke",
        "id": 897826,
        "node_id": "MDQ6VXNlcjg5NzgyNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/897826?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jhoenicke",
        "html_url": "https://github.com/jhoenicke",
        "followers_url": "https://api.github.com/users/jhoenicke/followers",
        "following_url": "https://api.github.com/users/jhoenicke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jhoenicke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jhoenicke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jhoenicke/subscriptions",
        "organizations_url": "https://api.github.com/users/jhoenicke/orgs",
        "repos_url": "https://api.github.com/users/jhoenicke/repos",
        "events_url": "https://api.github.com/users/jhoenicke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jhoenicke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-21T14:25:23Z"
    },
    {
      "event": "reviewed",
      "id": 916341762,
      "node_id": "PRR_kwDOABII5842nkQC",
      "url": null,
      "actor": null,
      "commit_id": "84418b05c310c58cfac21e7b7d8fece2cea91eff",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-916341762",
      "submitted_at": "2022-03-21T20:49:58Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "reviewed",
      "id": 916365174,
      "node_id": "PRR_kwDOABII5842np92",
      "url": null,
      "actor": null,
      "commit_id": "84418b05c310c58cfac21e7b7d8fece2cea91eff",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-916365174",
      "submitted_at": "2022-03-21T21:14:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6279398765,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAF2SAVt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6279398765",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-21T23:08:31Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6281003985,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAF2YIPR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6281003985",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-22T06:43:08Z"
    },
    {
      "event": "labeled",
      "id": 6316149370,
      "node_id": "LE_lADOABII584xeHwozwAAAAF4eMp6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6316149370",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-28T07:55:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6321414931,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAF4ySMT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6321414931",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-28T20:11:49Z"
    },
    {
      "event": "unlabeled",
      "id": 6321518685,
      "node_id": "UNLE_lADOABII584xeHwozwAAAAF4yrhd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6321518685",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-28T20:29:48Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 6377700154,
      "node_id": "LE_lADOABII584xeHwozwAAAAF8I_s6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6377700154",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-06T07:50:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6512819512,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAGEMb04",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6512819512",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-28T07:50:42Z"
    },
    {
      "event": "commented",
      "id": 1111867292,
      "node_id": "IC_kwDOABII585CRb-c",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111867292",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-28T07:56:07Z",
      "updated_at": "2022-04-28T07:56:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "@Xekyo Would you be interested in having another look at the PR, please?",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1111867292",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 6512855580,
      "node_id": "MEE_lADOABII584xeHwozwAAAAGEMkoc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6512855580",
      "actor": {
        "login": "Xekyo",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Xekyo",
        "html_url": "https://github.com/Xekyo",
        "followers_url": "https://api.github.com/users/Xekyo/followers",
        "following_url": "https://api.github.com/users/Xekyo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Xekyo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Xekyo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Xekyo/subscriptions",
        "organizations_url": "https://api.github.com/users/Xekyo/orgs",
        "repos_url": "https://api.github.com/users/Xekyo/repos",
        "events_url": "https://api.github.com/users/Xekyo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Xekyo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-28T07:56:07Z"
    },
    {
      "event": "subscribed",
      "id": 6512855585,
      "node_id": "SE_lADOABII584xeHwozwAAAAGEMkoh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6512855585",
      "actor": {
        "login": "Xekyo",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Xekyo",
        "html_url": "https://github.com/Xekyo",
        "followers_url": "https://api.github.com/users/Xekyo/followers",
        "following_url": "https://api.github.com/users/Xekyo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Xekyo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Xekyo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Xekyo/subscriptions",
        "organizations_url": "https://api.github.com/users/Xekyo/orgs",
        "repos_url": "https://api.github.com/users/Xekyo/repos",
        "events_url": "https://api.github.com/users/Xekyo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Xekyo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-28T07:56:07Z"
    },
    {
      "event": "unlabeled",
      "id": 6513196303,
      "node_id": "UNLE_lADOABII584xeHwozwAAAAGEN30P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6513196303",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-28T08:44:51Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1111943050,
      "node_id": "IC_kwDOABII585CRueK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111943050",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-28T09:01:57Z",
      "updated_at": "2022-04-28T09:01:57Z",
      "author_association": "MEMBER",
      "body": "The CI seems to be unhappy with the changes you've pushed. Probably best to make sure the tests pass locally first before there's another round of review.",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1111943050",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6517506220,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAGEeUCs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6517506220",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-28T18:46:49Z"
    },
    {
      "event": "reviewed",
      "id": 957154737,
      "node_id": "PRR_kwDOABII5845DQWx",
      "url": null,
      "actor": null,
      "commit_id": "1de334c5f704f15d098f72f329f5a73e37b7898d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-957154737",
      "submitted_at": "2022-04-29T00:03:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6525346440,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAGE8OKI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6525346440",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-29T17:56:28Z"
    },
    {
      "event": "referenced",
      "id": 6655417468,
      "node_id": "REFE_lADOABII584xeHwozwAAAAGMsZx8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6655417468",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "01ab8e3dde8d9555865755c275ef4fb9f79183f1",
      "commit_url": "https://api.github.com/repos/luke-jr/bitcoin/commits/01ab8e3dde8d9555865755c275ef4fb9f79183f1",
      "created_at": "2022-05-21T21:51:48Z"
    },
    {
      "event": "referenced",
      "id": 6655417470,
      "node_id": "REFE_lADOABII584xeHwozwAAAAGMsZx-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6655417470",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7fe3b241227f09d56e1b058c2c6a28ef38226924",
      "commit_url": "https://api.github.com/repos/luke-jr/bitcoin/commits/7fe3b241227f09d56e1b058c2c6a28ef38226924",
      "created_at": "2022-05-21T21:51:48Z"
    },
    {
      "event": "labeled",
      "id": 6693039462,
      "node_id": "LE_lADOABII584xeHwozwAAAAGO761m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6693039462",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-27T14:36:09Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6964074367,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAGfF1d_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6964074367",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-09T15:32:41Z"
    },
    {
      "event": "unlabeled",
      "id": 6964114510,
      "node_id": "UNLE_lADOABII584xeHwozwAAAAGfF_RO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6964114510",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-09T16:17:20Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 7013343197,
      "node_id": "LE_lADOABII584xeHwozwAAAAGiBx_d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7013343197",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T15:54:29Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 7024002894,
      "node_id": "UNLE_lADOABII584xeHwozwAAAAGiqcdO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7024002894",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T21:17:00Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 7136617353,
      "node_id": "LE_lADOABII584xeHwozwAAAAGpYCOJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7136617353",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-05T15:02:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7163715161,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAGq_Z5Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7163715161",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-10T13:11:29Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7166767391,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAGrLDEf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7166767391",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-10T19:48:52Z"
    },
    {
      "event": "unlabeled",
      "id": 7167435032,
      "node_id": "UNLE_lADOABII584xeHwozwAAAAGrNmEY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7167435032",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-10T21:51:12Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 8067614618,
      "node_id": "LE_lADOABII584xeHwozwAAAAHg3gea",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8067614618",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-19T09:40:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8128032146,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAHkd-2S",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8128032146",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-29T20:57:09Z"
    },
    {
      "event": "unlabeled",
      "id": 8128141917,
      "node_id": "UNLE_lADOABII584xeHwozwAAAAHkeZpd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8128141917",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-29T21:37:56Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8128338968,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAHkfJwY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8128338968",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-29T23:03:39Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8129442116,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAHkjXFE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8129442116",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-30T08:16:41Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8131762120,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAHksNfI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8131762120",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-30T21:29:20Z"
    },
    {
      "event": "commented",
      "id": 1368191205,
      "node_id": "IC_kwDOABII585RjPDl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1368191205",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-31T09:32:45Z",
      "updated_at": "2022-12-31T09:32:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "@sipa Would you mind reconsidering your concept NACK (https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-975711424) given that the algorithm is now as you [proposed](https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754438676) (variant I)?",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1368191205",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8132505716,
      "node_id": "MEE_lADOABII584xeHwozwAAAAHkvDB0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8132505716",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-31T09:32:45Z"
    },
    {
      "event": "subscribed",
      "id": 8132505719,
      "node_id": "SE_lADOABII584xeHwozwAAAAHkvDB3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8132505719",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-31T09:32:45Z"
    },
    {
      "event": "reviewed",
      "id": 1233921575,
      "node_id": "PRR_kwDOABII585JjCYn",
      "url": null,
      "actor": null,
      "commit_id": "56512a06800781cde7bc63fe386ba7301db6f40a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 56512a06800781cde7bc63fe386ba7301db6f40a",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-1233921575",
      "submitted_at": "2023-01-02T17:32:07Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "commented",
      "id": 1369590171,
      "node_id": "IC_kwDOABII585Rokmb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1369590171",
      "actor": {
        "login": "molnard",
        "id": 9844978,
        "node_id": "MDQ6VXNlcjk4NDQ5Nzg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9844978?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/molnard",
        "html_url": "https://github.com/molnard",
        "followers_url": "https://api.github.com/users/molnard/followers",
        "following_url": "https://api.github.com/users/molnard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/molnard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/molnard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/molnard/subscriptions",
        "organizations_url": "https://api.github.com/users/molnard/orgs",
        "repos_url": "https://api.github.com/users/molnard/repos",
        "events_url": "https://api.github.com/users/molnard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/molnard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-03T10:10:36Z",
      "updated_at": "2023-01-03T10:10:36Z",
      "author_association": "NONE",
      "body": "cACK",
      "user": {
        "login": "molnard",
        "id": 9844978,
        "node_id": "MDQ6VXNlcjk4NDQ5Nzg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9844978?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/molnard",
        "html_url": "https://github.com/molnard",
        "followers_url": "https://api.github.com/users/molnard/followers",
        "following_url": "https://api.github.com/users/molnard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/molnard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/molnard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/molnard/subscriptions",
        "organizations_url": "https://api.github.com/users/molnard/orgs",
        "repos_url": "https://api.github.com/users/molnard/repos",
        "events_url": "https://api.github.com/users/molnard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/molnard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1369590171",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1369866129,
      "node_id": "IC_kwDOABII585Rpn-R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1369866129",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-03T15:00:17Z",
      "updated_at": "2023-01-03T15:00:17Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1369866129",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1399236036,
      "node_id": "IC_kwDOABII585TZqXE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1399236036",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-21T11:47:52Z",
      "updated_at": "2023-01-21T11:47:52Z",
      "author_association": "CONTRIBUTOR",
      "body": "Isn't this good for merge? Or waiting for some more reviews?",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1399236036",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "reviewed",
      "id": 1265252459,
      "node_id": "PRR_kwDOABII585Lajhr",
      "url": null,
      "actor": null,
      "commit_id": "56512a06800781cde7bc63fe386ba7301db6f40a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Left some minor comments.",
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-1265252459",
      "submitted_at": "2023-01-23T10:00:29Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "commented",
      "id": 1400083152,
      "node_id": "IC_kwDOABII585Tc5LQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1400083152",
      "actor": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T10:01:52Z",
      "updated_at": "2023-01-23T10:01:52Z",
      "author_association": "MEMBER",
      "body": "Needs rebase",
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1400083152",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8338385816,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAHxAauY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8338385816",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T21:25:42Z"
    },
    {
      "event": "commented",
      "id": 1401027649,
      "node_id": "IC_kwDOABII585TgfxB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1401027649",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-23T21:41:46Z",
      "updated_at": "2023-01-23T21:41:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Needs rebase\r\n\r\nRebased.",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1401027649",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8666899528,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAIElmRI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8666899528",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-04T22:19:31Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8724684600,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAIICB84",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8724684600",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-11T21:28:36Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8724716161,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAIICJqB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8724716161",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-11T22:01:13Z"
    },
    {
      "event": "commented",
      "id": 1465033134,
      "node_id": "IC_kwDOABII585XUqGu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1465033134",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-11T22:01:22Z",
      "updated_at": "2023-03-11T22:01:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "> It would be good if the functional test actually verified that the values are correctly calculated after creating a few txns; ATM it is only really a smoke test that verifies the output structure. (by @jonatack)\r\n> Test currently only cover the count and not the fees or sizes per feerate group. (by @0xB10C)\r\n\r\nAdded explicit assert lines in the test for this. ",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1465033134",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8724716303,
      "node_id": "MEE_lADOABII584xeHwozwAAAAIICJsP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8724716303",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-11T22:01:22Z"
    },
    {
      "event": "subscribed",
      "id": 8724716306,
      "node_id": "SE_lADOABII584xeHwozwAAAAIICJsS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8724716306",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-11T22:01:22Z"
    },
    {
      "event": "mentioned",
      "id": 8724716310,
      "node_id": "MEE_lADOABII584xeHwozwAAAAIICJsW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8724716310",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-11T22:01:22Z"
    },
    {
      "event": "subscribed",
      "id": 8724716312,
      "node_id": "SE_lADOABII584xeHwozwAAAAIICJsY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8724716312",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-11T22:01:23Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQyNDJhYTUyZGU3ZTA5ZWU3NTZlNTZmZTFkNmY4OTQxZmZkNDhmMDY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d242aa52de7e09ee756e56fe1d6f8941ffd48f06",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d242aa52de7e09ee756e56fe1d6f8941ffd48f06",
      "tree": {
        "sha": "a0f939073b1a3ad6747357a358a7c4fbadf072f6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a0f939073b1a3ad6747357a358a7c4fbadf072f6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/40d0b0a524dfe8cc70cc116a6c76a3f834824fe5",
          "sha": "40d0b0a524dfe8cc70cc116a6c76a3f834824fe5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/40d0b0a524dfe8cc70cc116a6c76a3f834824fe5"
        }
      ],
      "message": "Introduce fee histogram in getmempoolinfo RPC command\n\nCo-authored-by: Jonas Schnelli <dev@jonasschnelli.ch>\nCo-authored-by: Jon Atack <jon@atack.com>",
      "committer": {
        "name": "Kiminuo",
        "email": "kiminuo@protonmail.com",
        "date": "2023-03-11T22:05:12Z"
      },
      "author": {
        "name": "Kiminuo",
        "email": "kiminuo@protonmail.com",
        "date": "2021-03-06T19:30:17Z"
      },
      "sha": "d242aa52de7e09ee756e56fe1d6f8941ffd48f06"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM1ZTUzZDBkMjFmZjE2NmVlOWFiMjFmMDQzZDgzOWFhMTEyZmNmOTY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "tree": {
        "sha": "2496dc665040778f7f8346f50a60f12e240946b5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2496dc665040778f7f8346f50a60f12e240946b5"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d242aa52de7e09ee756e56fe1d6f8941ffd48f06",
          "sha": "d242aa52de7e09ee756e56fe1d6f8941ffd48f06",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d242aa52de7e09ee756e56fe1d6f8941ffd48f06"
        }
      ],
      "message": "test: Add mempool fee histogram test coverage\n\nOriginal commit: https://github.com/bitcoin/bitcoin/commit/0b6ba66238c377116bc6c21e19cffbf1b6dfc788\n\nCo-authored-by: João Barbosa <joao.paulo.barbosa@gmail.com>\nCo-authored-by: Jon Atack <jon@atack.com>",
      "committer": {
        "name": "Kiminuo",
        "email": "kiminuo@protonmail.com",
        "date": "2023-03-11T22:05:12Z"
      },
      "author": {
        "name": "Kiminuo",
        "email": "kiminuo@protonmail.com",
        "date": "2021-03-06T21:54:05Z"
      },
      "sha": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8724720337,
      "node_id": "HRFPE_lADOABII584xeHwozwAAAAIICKrR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8724720337",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-11T22:05:26Z"
    },
    {
      "event": "commented",
      "id": 1465035161,
      "node_id": "IC_kwDOABII585XUqmZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1465035161",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-11T22:10:43Z",
      "updated_at": "2023-03-11T22:10:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Concept ACK!\r\n> \r\n> It might make sense to have the API be more similar to https://numpy.org/doc/stable/reference/generated/numpy.histogram.html\r\n\r\nHonestly, I'm not sure. Anyone else who prefer that approach?",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1465035161",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1465824503,
      "node_id": "IC_kwDOABII585XXrT3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1465824503",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-13T09:52:17Z",
      "updated_at": "2023-03-13T09:52:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "(2️ year anniversary today 🎉)",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1465824503",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "reviewed",
      "id": 1336717945,
      "node_id": "PRR_kwDOABII585PrLJ5",
      "url": null,
      "actor": null,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "I'd be a pretty strong concept ACK to what seems like the original intent of the PR, enabling users/callers to get an understanding of the distribution of \"effective\" feerates of transactions taking into account ancestors/descendants. I definitely agree with the discussion at https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754438676 and other comments about the implementation being much more complex and involved.\r\n\r\nHowever, given that the functionality added is currently to just build a histogram based on the individual feerates, I'm a little less clear on its utility and why it is necessary to add and maintain this in Bitcoin Core given how easy it would be to do it externally (which may or may not have been the case when people first asked for this?). I personally think we should have good reasons for putting something in Bitcoin Core as opposed to somewhere else in the software stack. Just my own opinion, and hopefully provides a reasonable explanation for why I haven't prioritized reviewing this.\r\n\r\nThank you very much for maintaining this PR for 2 years. If previous reviewers want to come back and drop a new review, maybe we can make some progress here.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-1336717945",
      "submitted_at": "2023-03-13T11:31:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
    },
    {
      "event": "commented",
      "id": 1466363604,
      "node_id": "IC_kwDOABII585XZu7U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1466363604",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-13T15:26:36Z",
      "updated_at": "2023-03-13T15:26:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "@glozow Thank you for the review.\r\n\r\n> given how easy it would be to do it externally (which may or may not have been the case when people first asked for this?)\r\n\r\nSo what would be your approach to do it externally then? Especially if you want to get this information more often.",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1466363604",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8733208504,
      "node_id": "MEE_lADOABII584xeHwozwAAAAIIii-4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8733208504",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-13T15:26:47Z"
    },
    {
      "event": "subscribed",
      "id": 8733208534,
      "node_id": "SE_lADOABII584xeHwozwAAAAIIii_W",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8733208534",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-13T15:26:47Z"
    },
    {
      "event": "commented",
      "id": 1466377732,
      "node_id": "IC_kwDOABII585XZyYE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1466377732",
      "actor": {
        "login": "kouloumos",
        "id": 18506343,
        "node_id": "MDQ6VXNlcjE4NTA2MzQz",
        "avatar_url": "https://avatars.githubusercontent.com/u/18506343?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kouloumos",
        "html_url": "https://github.com/kouloumos",
        "followers_url": "https://api.github.com/users/kouloumos/followers",
        "following_url": "https://api.github.com/users/kouloumos/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kouloumos/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kouloumos/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kouloumos/subscriptions",
        "organizations_url": "https://api.github.com/users/kouloumos/orgs",
        "repos_url": "https://api.github.com/users/kouloumos/repos",
        "events_url": "https://api.github.com/users/kouloumos/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kouloumos/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-13T15:34:48Z",
      "updated_at": "2023-03-13T15:34:48Z",
      "author_association": "MEMBER",
      "body": "> So what would be your approach to do it externally then? Especially if you want to get this information more often.\r\n\r\nCould a tracepoints approach, similar to https://github.com/bitcoin/bitcoin/pull/26531, work?\r\n",
      "user": {
        "login": "kouloumos",
        "id": 18506343,
        "node_id": "MDQ6VXNlcjE4NTA2MzQz",
        "avatar_url": "https://avatars.githubusercontent.com/u/18506343?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kouloumos",
        "html_url": "https://github.com/kouloumos",
        "followers_url": "https://api.github.com/users/kouloumos/followers",
        "following_url": "https://api.github.com/users/kouloumos/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kouloumos/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kouloumos/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kouloumos/subscriptions",
        "organizations_url": "https://api.github.com/users/kouloumos/orgs",
        "repos_url": "https://api.github.com/users/kouloumos/repos",
        "events_url": "https://api.github.com/users/kouloumos/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kouloumos/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1466377732",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1466387944,
      "node_id": "IC_kwDOABII585XZ03o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1466387944",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-13T15:40:09Z",
      "updated_at": "2023-03-13T15:40:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > So what would be your approach to do it externally then? Especially if you want to get this information more often.\r\n> \r\n> Could a tracepoints approach, similar to #26531, work?\r\n\r\nI need to research that in detail but it looks promising. Thank you for sharing it here!",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1466387944",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1467960000,
      "node_id": "IC_kwDOABII585Xf0rA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1467960000",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-14T11:53:34Z",
      "updated_at": "2023-03-14T11:53:34Z",
      "author_association": "MEMBER",
      "body": "> > Could a tracepoints approach, similar to #26531, work?\r\n> \r\n> I need to research that in detail but it looks promising. Thank you for sharing it here!\r\n\r\nI don't think tracepoints are suited for this use-case. Tracepoints allow you to react to a specific event. Here, you request / pull data when a consumer needs it.\r\n\r\n> So what would be your approach to do it externally then? Especially if you want to get this information more often.\r\n\r\nYou can query the `getrawmempool` RPC with the verbose flag set and build the histogram yourself. This Python script produces a similar histogram to what your adding in this PR. \r\n\r\n```Python\r\nfrom bisect import bisect_left\r\nimport json\r\nimport sys\r\n\r\nBUCKETS = [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\r\nCOIN = 100000000\r\n\r\nhistogram = {}\r\ntotal_fees = 0\r\n\r\ndef feerate_bucket(feerate):\r\n    # Depending on how many buckets you have you probably don't even want to use a binary search. As the lower buckets are likely used more frequently a linear search should work fine too.\r\n    i = bisect_left(BUCKETS, feerate)\r\n    if i == len(BUCKETS):\r\n        return BUCKETS[-1]\r\n    return BUCKETS[i]\r\n\r\nmempool = json.load(sys.stdin)\r\n\r\nfor txid in mempool:\r\n    tx = mempool[txid]\r\n    fee_sat = int(tx[\"fees\"][\"base\"] * COIN)\r\n    feerate = fee_sat / tx[\"vsize\"]\r\n    bucket = feerate_bucket(feerate)\r\n    if bucket not in histogram:\r\n        histogram[bucket] = { \"vsize\": 0, \"count\": 0, \"fees\": 0, \"from\": bucket }\r\n    histogram[bucket][\"vsize\"] += tx[\"vsize\"]\r\n    histogram[bucket][\"fees\"] += fee_sat\r\n    histogram[bucket][\"count\"] += 1\r\n    total_fees += fee_sat\r\n\r\nfee_histogram = { \"fee_rate_groups\": histogram, \"total_fees\": total_fees }\r\nprint(json.dumps(fee_histogram, sort_keys = True, indent = 2))\r\n```\r\n\r\nRuninng `bitcoin-cli getrawmempool true | python3 feerate-histogram.py` produces the following output for my current mempool.\r\n\r\n\r\n<details>\r\n<summary>\r\nJSON output\r\n</summary>\r\n\r\n```JSON\r\n{\r\n  \"fee_rate_groups\": {\r\n    \"2\": {\r\n      \"count\": 7819,\r\n      \"fees\": 88283562,\r\n      \"from\": 2,\r\n      \"vsize\": 44785089\r\n    },\r\n    \"3\": {\r\n      \"count\": 255,\r\n      \"fees\": 10961381,\r\n      \"from\": 3,\r\n      \"vsize\": 5227332\r\n    },\r\n    \"4\": {\r\n      \"count\": 469,\r\n      \"fees\": 9411549,\r\n      \"from\": 4,\r\n      \"vsize\": 3072663\r\n    },\r\n    \"5\": {\r\n      \"count\": 341,\r\n      \"fees\": 1203867,\r\n      \"from\": 5,\r\n      \"vsize\": 250260\r\n    },\r\n    \"6\": {\r\n      \"count\": 325,\r\n      \"fees\": 507162,\r\n      \"from\": 6,\r\n      \"vsize\": 88589\r\n    },\r\n    \"7\": {\r\n      \"count\": 197,\r\n      \"fees\": 574863,\r\n      \"from\": 7,\r\n      \"vsize\": 94766\r\n    },\r\n    \"8\": {\r\n      \"count\": 99,\r\n      \"fees\": 180911,\r\n      \"from\": 8,\r\n      \"vsize\": 23703\r\n    },\r\n    \"10\": {\r\n      \"count\": 664,\r\n      \"fees\": 2645382,\r\n      \"from\": 10,\r\n      \"vsize\": 270908\r\n    },\r\n    \"12\": {\r\n      \"count\": 177,\r\n      \"fees\": 605631,\r\n      \"from\": 12,\r\n      \"vsize\": 55444\r\n    },\r\n    \"14\": {\r\n      \"count\": 588,\r\n      \"fees\": 3090496,\r\n      \"from\": 14,\r\n      \"vsize\": 229933\r\n    },\r\n    \"17\": {\r\n      \"count\": 495,\r\n      \"fees\": 1748418,\r\n      \"from\": 17,\r\n      \"vsize\": 115549\r\n    },\r\n    \"20\": {\r\n      \"count\": 1904,\r\n      \"fees\": 9727850,\r\n      \"from\": 20,\r\n      \"vsize\": 510756\r\n    },\r\n    \"25\": {\r\n      \"count\": 1335,\r\n      \"fees\": 15926338,\r\n      \"from\": 25,\r\n      \"vsize\": 718764\r\n    },\r\n    \"30\": {\r\n      \"count\": 1095,\r\n      \"fees\": 8700416,\r\n      \"from\": 30,\r\n      \"vsize\": 320272\r\n    },\r\n    \"40\": {\r\n      \"count\": 819,\r\n      \"fees\": 7622226,\r\n      \"from\": 40,\r\n      \"vsize\": 221100\r\n    },\r\n    \"50\": {\r\n      \"count\": 435,\r\n      \"fees\": 4196189,\r\n      \"from\": 50,\r\n      \"vsize\": 94752\r\n    },\r\n    \"60\": {\r\n      \"count\": 165,\r\n      \"fees\": 2173791,\r\n      \"from\": 60,\r\n      \"vsize\": 39825\r\n    },\r\n    \"70\": {\r\n      \"count\": 106,\r\n      \"fees\": 1241456,\r\n      \"from\": 70,\r\n      \"vsize\": 19369\r\n    },\r\n    \"80\": {\r\n      \"count\": 53,\r\n      \"fees\": 1136711,\r\n      \"from\": 80,\r\n      \"vsize\": 15458\r\n    },\r\n    \"100\": {\r\n      \"count\": 64,\r\n      \"fees\": 26645889,\r\n      \"from\": 100,\r\n      \"vsize\": 269273\r\n    },\r\n    \"120\": {\r\n      \"count\": 67,\r\n      \"fees\": 42826729,\r\n      \"from\": 120,\r\n      \"vsize\": 418795\r\n    },\r\n    \"140\": {\r\n      \"count\": 25,\r\n      \"fees\": 598662,\r\n      \"from\": 140,\r\n      \"vsize\": 4723\r\n    },\r\n    \"170\": {\r\n      \"count\": 76,\r\n      \"fees\": 2294307,\r\n      \"from\": 170,\r\n      \"vsize\": 14943\r\n    },\r\n    \"200\": {\r\n      \"count\": 60,\r\n      \"fees\": 3159137,\r\n      \"from\": 200,\r\n      \"vsize\": 10590\r\n    }\r\n  },\r\n  \"total_fees\": 245462923\r\n}\r\n```\r\n</details>\r\n\r\nThe `getrawmempool true` RPC **was** quite slow when the mempool is full (https://github.com/bitcoin/bitcoin/issues/14765, https://github.com/chris-belcher/electrum-personal-server/issues/96#issuecomment-481396276). This was improved in https://github.com/bitcoin/bitcoin/pull/14984 (merged after #15836 was opened) and might be fine now. I haven't had problems with it in a while. \r\n\r\n> However, given that the functionality added is currently to just build a histogram based on the individual feerates, I'm a little less clear on its utility and why it is necessary to add and maintain this in Bitcoin Core given how easy it would be to do it externally (which may or may not have been the case when people first asked for this?). I personally think we should have good reasons for putting something in Bitcoin Core as opposed to somewhere else in the software stack. \r\n\r\nIIRC there was also an out-of-band push to review this PR as \"rumor has it that a well-known wallet is currently using Bitcoin Knots solely because this feature isn't available in this RPC interface (https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-813031121) \". Would be good to hear if that's still the case and why calculating the histogram in the wallet isn't possible/inefficient.\r\n\r\nI agree with @glozow. It might not be worth maintaining this in Core given the simplicity of doing it externally. \r\nAs is, without utilizing information something that would indeed be inefficient to calculate, e.g. transaction lookups for each input, and without considering transaction relationships (https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-978235017, https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754438676), I'm slightly leaning towards a Concept NACK at this point.\r\n\r\n",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1467960000",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8742673587,
      "node_id": "MEE_lADOABII584xeHwozwAAAAIJGpyz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8742673587",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-14T11:53:35Z"
    },
    {
      "event": "subscribed",
      "id": 8742673608,
      "node_id": "SE_lADOABII584xeHwozwAAAAIJGpzI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8742673608",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-14T11:53:35Z"
    },
    {
      "event": "commented",
      "id": 1468044559,
      "node_id": "IC_kwDOABII585XgJUP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1468044559",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-14T12:49:02Z",
      "updated_at": "2023-03-14T12:49:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "@0xB10C In general I agree it's better to keep Core simple if things can be done with some simple workarounds using existing APIs, but I feel this is something that could make some use in Qt GUI too, and for that reason it makes sense to implement inside Core codebase.\r\n\r\n> IIRC there was also an out-of-band push to review this PR as \"rumor has it that a well-known wallet is currently using Bitcoin Knots solely because this feature isn't available in this RPC interface (https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-813031121) \". Would be good to hear if that's still the case and why calculating the histogram in the wallet isn't possible/inefficient.\r\n\r\nIt's used by Wasabi Wallet. https://github.com/zkSNACKs/WalletWasabi/blob/17f0995df568dbdbef9b1faf15da56aec29767bb/WalletWasabi/BitcoinCore/Rpc/RpcClientBase.cs#L63",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1468044559",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8743224570,
      "node_id": "MEE_lADOABII584xeHwozwAAAAIJIwT6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8743224570",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-14T12:49:02Z"
    },
    {
      "event": "subscribed",
      "id": 8743224592,
      "node_id": "SE_lADOABII584xeHwozwAAAAIJIwUQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8743224592",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-14T12:49:02Z"
    },
    {
      "event": "commented",
      "id": 1468344458,
      "node_id": "IC_kwDOABII585XhSiK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1468344458",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-14T15:41:58Z",
      "updated_at": "2023-03-14T15:41:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "@0xB10C\r\n\r\n> > > Could a tracepoints approach, similar to #26531, work?\r\n> > \r\n> > \r\n> > I need to research that in detail but it looks promising. Thank you for sharing it here!\r\n> \r\n> I don't think tracepoints are suited for this use-case. Tracepoints allow you to react to a specific event. Here, you request / pull data when a consumer needs it.\r\n\r\nTracepoints would be nice if I need to compute the histograms at specified intervals and fast (to avoid getting complete mempool from a full node). It would be very similar to how people work with order books in trading - first, start listening to mempool updates and start queuing them, then fetch a mempool snapshot and possibly apply updates not present in the snapshot and keep updating. This gives one a local copy of the mempool that one updates as new transactions comes and the amount of transfered data is acceptable. So then you don't need to get full mempool every time you want to do a computation based on mempool data. AFAIK it can be up to 300 MB of data which is a lot. But looking at the tracepoints, I'm not sure whether one can do that easily. From my point of view, this would be a nice solution to the problem this PR is about.\r\n\r\n> The `getrawmempool true` RPC **was** quite slow when the mempool is full (#14765, [chris-belcher/electrum-personal-server#96 (comment)](https://github.com/chris-belcher/electrum-personal-server/issues/96#issuecomment-481396276)). This was improved in #14984 (merged after #15836 was opened) and might be fine now. I haven't had problems with it in a while.\r\n\r\nI agree that this is an acceptable solution when one does not want to compute the histogram too often. I need to research this more in detail to know what is \"too often\".",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1468344458",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8745297406,
      "node_id": "MEE_lADOABII584xeHwozwAAAAIJQqX-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8745297406",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-14T15:41:59Z"
    },
    {
      "event": "subscribed",
      "id": 8745297419,
      "node_id": "SE_lADOABII584xeHwozwAAAAIJQqYL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8745297419",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-14T15:41:59Z"
    },
    {
      "event": "commented",
      "id": 1476309129,
      "node_id": "IC_kwDOABII585X_rCJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476309129",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T14:12:03Z",
      "updated_at": "2023-03-20T14:12:03Z",
      "author_association": "MEMBER",
      "body": "> [However, given that the functionality added is currently to just build a histogram based on the individual feerates, I'm a little less clear on its utility and why it is necessary to add and maintain this in Bitcoin Core given how easy it would be to do it externally](https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-1336717945)\r\n\r\nI agree. I don't think this is something that needs to exist in Core. The fact that you've had this PR open for a long time is unfortunate, but also not a reason to merge something. If the goal of this change can be achieved externally, with 20 lines of Python, then that's where it should be done. ",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1476309129",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1476361661,
      "node_id": "IC_kwDOABII585X_329",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476361661",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T14:42:45Z",
      "updated_at": "2023-03-20T14:42:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "Closing the PR.\r\n\r\n>  If the goal of this change can be achieved externally, with 20 lines of Python, then that's where it should be done.\r\n\r\nI would say it's rather a proof that one can _inefficiently_ achieve the goal. \r\n\r\nAn efficient solution would be to mirror mempool using tracepoints (that did not exist when the PR was created), if[^1] it is possible.\r\n\r\n[^1]: I have not found the time to test it yet but **if** it is not possible then that would be imho a very nice PR to allow people to externally compute various mempool statistics efficiently (including feerate histograms).",
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1476361661",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "closed",
      "id": 8795508674,
      "node_id": "CE_lADOABII584xeHwozwAAAAIMQM_C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8795508674",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T14:42:46Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 8795511821,
      "node_id": "HRDE_lADOABII584xeHwozwAAAAIMQNwN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8795511821",
      "actor": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T14:43:02Z"
    },
    {
      "event": "commented",
      "id": 1476574236,
      "node_id": "IC_kwDOABII585YArwc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476574236",
      "actor": {
        "login": "prusnak",
        "id": 42201,
        "node_id": "MDQ6VXNlcjQyMjAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/42201?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/prusnak",
        "html_url": "https://github.com/prusnak",
        "followers_url": "https://api.github.com/users/prusnak/followers",
        "following_url": "https://api.github.com/users/prusnak/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/prusnak/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/prusnak/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/prusnak/subscriptions",
        "organizations_url": "https://api.github.com/users/prusnak/orgs",
        "repos_url": "https://api.github.com/users/prusnak/repos",
        "events_url": "https://api.github.com/users/prusnak/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/prusnak/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T16:37:27Z",
      "updated_at": "2023-03-20T19:38:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "I think it's quite unfortunate there is no interest in merging this feature. How can we expect the Bitcoin Core wallet to behave reasonably if it can't predict the fees well?",
      "user": {
        "login": "prusnak",
        "id": 42201,
        "node_id": "MDQ6VXNlcjQyMjAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/42201?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/prusnak",
        "html_url": "https://github.com/prusnak",
        "followers_url": "https://api.github.com/users/prusnak/followers",
        "following_url": "https://api.github.com/users/prusnak/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/prusnak/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/prusnak/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/prusnak/subscriptions",
        "organizations_url": "https://api.github.com/users/prusnak/orgs",
        "repos_url": "https://api.github.com/users/prusnak/repos",
        "events_url": "https://api.github.com/users/prusnak/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/prusnak/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1476574236",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1476790070,
      "node_id": "IC_kwDOABII585YBgc2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476790070",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T19:07:28Z",
      "updated_at": "2023-03-20T19:07:28Z",
      "author_association": "NONE",
      "body": "> I think it's quite unfortunate there is no interest in this feature. How can we expect the Bitcoin Core wallet to behave reasonably if it can't predict the fees well?\r\n\r\nThere is enough interest if you look at all the comments in this PR and the one opened by @jonasschnelli in 2019 except 3 developers. Could have been useful.",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1476790070",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8798279236,
      "node_id": "MEE_lADOABII584xeHwozwAAAAIMaxZE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8798279236",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T19:07:29Z"
    },
    {
      "event": "subscribed",
      "id": 8798279252,
      "node_id": "SE_lADOABII584xeHwozwAAAAIMaxZU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8798279252",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T19:07:29Z"
    },
    {
      "event": "commented",
      "id": 1476829212,
      "node_id": "IC_kwDOABII585YBqAc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476829212",
      "actor": {
        "login": "prusnak",
        "id": 42201,
        "node_id": "MDQ6VXNlcjQyMjAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/42201?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/prusnak",
        "html_url": "https://github.com/prusnak",
        "followers_url": "https://api.github.com/users/prusnak/followers",
        "following_url": "https://api.github.com/users/prusnak/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/prusnak/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/prusnak/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/prusnak/subscriptions",
        "organizations_url": "https://api.github.com/users/prusnak/orgs",
        "repos_url": "https://api.github.com/users/prusnak/repos",
        "events_url": "https://api.github.com/users/prusnak/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/prusnak/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T19:39:27Z",
      "updated_at": "2023-03-20T19:39:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "> There is enough interest if you look\r\n\r\nWhat I meant to say was \"there is no interest in **_merging_** this feature\", updated the comment.",
      "user": {
        "login": "prusnak",
        "id": 42201,
        "node_id": "MDQ6VXNlcjQyMjAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/42201?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/prusnak",
        "html_url": "https://github.com/prusnak",
        "followers_url": "https://api.github.com/users/prusnak/followers",
        "following_url": "https://api.github.com/users/prusnak/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/prusnak/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/prusnak/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/prusnak/subscriptions",
        "organizations_url": "https://api.github.com/users/prusnak/orgs",
        "repos_url": "https://api.github.com/users/prusnak/repos",
        "events_url": "https://api.github.com/users/prusnak/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/prusnak/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1476829212",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1477392747,
      "node_id": "IC_kwDOABII585YDzlr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1477392747",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T07:41:26Z",
      "updated_at": "2023-03-21T07:41:26Z",
      "author_association": "MEMBER",
      "body": "> How can we expect the Bitcoin Core wallet to behave reasonably if it can't predict the fees well?\r\n\r\nThe Bitcoin Core wallet does not use this feature?\r\n\r\n\r\n\r\n",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1477392747",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1477425501,
      "node_id": "IC_kwDOABII585YD7ld",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1477425501",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T08:15:20Z",
      "updated_at": "2023-03-21T20:58:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "The original idea of this patch was to add a small and easy to maintain **efficient** way to generate a fee histogram to bitcoin core (see original PR description https://github.com/bitcoin/bitcoin/pull/15836#issue-434109585).\r\n\r\nAs described there, it was always possible to use `getrawmempool` (@jhoenicke script) to achieve this goal.\r\n\r\nHowever, it is **not efficient** to dumb out all transactions of the complete mempool in a json format just to calculate the fee histogram with a python script.\r\n\r\nThus I think this is a valuable addition to Bitcoin Core.\r\n\r\nThe patch size is minimal and it seems like there is some interest in this feature.\r\n\r\nEDIT: this PR has nothing to do with the Bitcoin cores internal wallet. It's pure mempool statistics.",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1477425501",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8802487335,
      "node_id": "MEE_lADOABII584xeHwozwAAAAIMq0wn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8802487335",
      "actor": {
        "login": "jhoenicke",
        "id": 897826,
        "node_id": "MDQ6VXNlcjg5NzgyNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/897826?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jhoenicke",
        "html_url": "https://github.com/jhoenicke",
        "followers_url": "https://api.github.com/users/jhoenicke/followers",
        "following_url": "https://api.github.com/users/jhoenicke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jhoenicke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jhoenicke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jhoenicke/subscriptions",
        "organizations_url": "https://api.github.com/users/jhoenicke/orgs",
        "repos_url": "https://api.github.com/users/jhoenicke/repos",
        "events_url": "https://api.github.com/users/jhoenicke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jhoenicke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T08:15:21Z"
    },
    {
      "event": "subscribed",
      "id": 8802487354,
      "node_id": "SE_lADOABII584xeHwozwAAAAIMq0w6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8802487354",
      "actor": {
        "login": "jhoenicke",
        "id": 897826,
        "node_id": "MDQ6VXNlcjg5NzgyNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/897826?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jhoenicke",
        "html_url": "https://github.com/jhoenicke",
        "followers_url": "https://api.github.com/users/jhoenicke/followers",
        "following_url": "https://api.github.com/users/jhoenicke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jhoenicke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jhoenicke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jhoenicke/subscriptions",
        "organizations_url": "https://api.github.com/users/jhoenicke/orgs",
        "repos_url": "https://api.github.com/users/jhoenicke/repos",
        "events_url": "https://api.github.com/users/jhoenicke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jhoenicke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T08:15:21Z"
    },
    {
      "event": "commented",
      "id": 1477532882,
      "node_id": "IC_kwDOABII585YEVzS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1477532882",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T09:43:50Z",
      "updated_at": "2023-03-21T09:43:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > How can we expect the Bitcoin Core wallet to behave reasonably if it can't predict the fees well?\r\n> \r\n> The Bitcoin Core wallet does not use this feature?\r\n\r\nDoes not use yet?",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1477532882",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1477559496,
      "node_id": "IC_kwDOABII585YEcTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1477559496",
      "actor": {
        "login": "prusnak",
        "id": 42201,
        "node_id": "MDQ6VXNlcjQyMjAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/42201?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/prusnak",
        "html_url": "https://github.com/prusnak",
        "followers_url": "https://api.github.com/users/prusnak/followers",
        "following_url": "https://api.github.com/users/prusnak/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/prusnak/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/prusnak/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/prusnak/subscriptions",
        "organizations_url": "https://api.github.com/users/prusnak/orgs",
        "repos_url": "https://api.github.com/users/prusnak/repos",
        "events_url": "https://api.github.com/users/prusnak/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/prusnak/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T10:03:24Z",
      "updated_at": "2023-03-21T10:03:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "> The Bitcoin Core wallet does not use this feature?\r\n\r\nMy point is that a wallet without fee estimation is not very usable and harms the overall network. If we don't want to have an effective way of determining the fee in Bitcoin Core, we might as well remove the entire wallet from the codebase.",
      "user": {
        "login": "prusnak",
        "id": 42201,
        "node_id": "MDQ6VXNlcjQyMjAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/42201?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/prusnak",
        "html_url": "https://github.com/prusnak",
        "followers_url": "https://api.github.com/users/prusnak/followers",
        "following_url": "https://api.github.com/users/prusnak/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/prusnak/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/prusnak/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/prusnak/subscriptions",
        "organizations_url": "https://api.github.com/users/prusnak/orgs",
        "repos_url": "https://api.github.com/users/prusnak/repos",
        "events_url": "https://api.github.com/users/prusnak/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/prusnak/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1477559496",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1477583517,
      "node_id": "IC_kwDOABII585YEiKd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1477583517",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T10:19:36Z",
      "updated_at": "2023-03-21T10:21:38Z",
      "author_association": "MEMBER",
      "body": "There seems to be confusion here. This PR does not touch the fee estimator or the wallet in any way. The fee estimator already keeps track of how many transactions at specific feerates {in the mempool, have confirmed within N blocks, haven't confirmed within N blocks} there are internally; the wallet queries it directly for feerate estimates. I don't know of any examples where the wallet needs to see a graph of something.\r\n\r\nIf you feel that the fee estimation algorithms need improvement, by all means I'd say some review/PRs there would be welcome. Maybe take a look at #25380 or #21161.\r\n\r\nFor those that feel very passionately about improving how the wallet calculates fees, my personal recommendation would be to review #26152 to have the strongest impact.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1477583517",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1477586224,
      "node_id": "IC_kwDOABII585YEi0w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1477586224",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T10:21:47Z",
      "updated_at": "2023-03-21T10:22:23Z",
      "author_association": "MEMBER",
      "body": "It's confusing to me why this PR, tagged as `[RPC/REST/ZMQ]` and only touching `src/rest.cpp` and files in `src/rpc/*`, should have anything to do with the wallet or the GUI. AFAIK the wallet doesn't use the RPC interface to communicate with bitcoind. If the wallet or the GUI would want a histogram, it couldn't use the code added in this PR. \r\n\r\nedit: glozow was 1min faster",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1477586224",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1477594252,
      "node_id": "IC_kwDOABII585YEkyM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1477594252",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T10:27:45Z",
      "updated_at": "2023-03-21T10:27:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "> If the wallet or the GUI would want a histogram, it couldn't use the code added in this PR.\r\n\r\nThat would require just moving fee histogram code out of `MempoolInfoToJSON()` to a separate function somewhere out of `rpc/`, code itself seems to me reusable.",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1477594252",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1477705117,
      "node_id": "IC_kwDOABII585YE_2d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1477705117",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T11:54:04Z",
      "updated_at": "2023-03-21T11:54:04Z",
      "author_association": "MEMBER",
      "body": "Bitcoin Core has had fee estimation logic for a long time (`estimatefee` RPC was added in 2014, replaced with `estimatesmartfee` in 2015).\n\nThe Bitcoin Core wallet automatically uses this internal feerate estimation logic to decide on the fees of transactions. You need to override things, or use more low-level RPCs, to not use it.\n\nThat feerate estimation logic works by looking at how quickly mempool transactions get confirmed, over longer time windows, not by looking at the current mempool composition (looking at just your own mempool may give very bad estimates if your relay policy isn't exactly what the network and miners use, which is very hard to guarantee).\n\nThis PR is about exposing mempool feerate histogram data through RPC. It's not a feerate estimator, and is entirely unrelated to the wallet. While the logic could in theory be used for feerate estimation too, that's not what this PR does, and I'm concerned that doing so would risk giving very inaccurate results when faced with diverging network policies.\n\nConceptually, however, I think it's reasonable to add something like this, as just RPC (or GUI) output. It can be informative for users, even if it can't be directly used for automatic fee estimation. Of course, that's subject to reviewer interest.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1477705117",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1478277908,
      "node_id": "IC_kwDOABII585YHLsU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1478277908",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-21T17:06:37Z",
      "updated_at": "2023-03-21T17:06:37Z",
      "author_association": "NONE",
      "body": "I am not against sipa as I understand fee estimation is difficult however `estimatesmartfee` sucks and could be improved.\r\n\r\nThere are lot of occasions when I found it to be irrelevant and just look at mempool.space or multiple explorers\r\n\r\n\r\nOne of the project that I found more useful: https://github.com/TrueLevelSA/btc-congestion-manager\r\n\r\nAnyway, this PR tries to improve how projects use mempool info and should not have been controversial at any point. \r\n\r\nRequest to all developers including maintainers to re consider their opinion.",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1478277908",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1479058400,
      "node_id": "IC_kwDOABII585YKKPg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1479058400",
      "actor": {
        "login": "nopara73",
        "id": 9156103,
        "node_id": "MDQ6VXNlcjkxNTYxMDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9156103?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nopara73",
        "html_url": "https://github.com/nopara73",
        "followers_url": "https://api.github.com/users/nopara73/followers",
        "following_url": "https://api.github.com/users/nopara73/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nopara73/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nopara73/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nopara73/subscriptions",
        "organizations_url": "https://api.github.com/users/nopara73/orgs",
        "repos_url": "https://api.github.com/users/nopara73/repos",
        "events_url": "https://api.github.com/users/nopara73/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nopara73/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-22T07:54:42Z",
      "updated_at": "2023-03-22T07:54:42Z",
      "author_association": "NONE",
      "body": "For Wasabi's purposes this output is needed purely for fee estimation, so it'd be ideal if Core would estimate fees properly. Here's how I see things:\r\n\r\n- `estimatesmartfee` estimates fees based on the **PAST**\r\n- This PR enables us to put minimums on Core's fee estimations. Eg. if Core estimates 6 hours at 10 sat/b, based on the past, but the mempool is already filled with 12 hours of 11 sat/b estimations, then what we do (currently with Knots) is that based on the mempool histogram we upgrade Core's estimations accordingly. This'd mean we're finally considering the **PRESENT**\r\n- Finally, for future work we can also aim somehow at predicting the **FUTURE** (neuro net, AI stuff?)",
      "user": {
        "login": "nopara73",
        "id": 9156103,
        "node_id": "MDQ6VXNlcjkxNTYxMDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9156103?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nopara73",
        "html_url": "https://github.com/nopara73",
        "followers_url": "https://api.github.com/users/nopara73/followers",
        "following_url": "https://api.github.com/users/nopara73/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nopara73/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nopara73/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nopara73/subscriptions",
        "organizations_url": "https://api.github.com/users/nopara73/orgs",
        "repos_url": "https://api.github.com/users/nopara73/repos",
        "events_url": "https://api.github.com/users/nopara73/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nopara73/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1479058400",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "commented",
      "id": 1479580979,
      "node_id": "IC_kwDOABII585YMJ0z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1479580979",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-22T13:36:53Z",
      "updated_at": "2023-03-22T13:36:53Z",
      "author_association": "MEMBER",
      "body": "@nopara73 I'm aware of `estimatesmartfee`'s limitations, and understand the desire for something based on current mempool composition that can react faster to current conditions. The problem is that looking your own mempool only gives a reliable result in case you're running with policies that more or less match what miners are doing, and if not, becomes easily gameable. That is the reason why `estimatesmartfee` intentionally does not use mempool composition.\r\n\r\nAs I said, I think an RPC like this is valuable for people who want additional information for fee estimation, but using it automatically without at least someone looking at the result seems dangerous to me. E.g. future softforks your node doesn't know about could permit an attacker to stuff your mempool with high-fee unminable transactions.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1479580979",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8816906978,
      "node_id": "MEE_lADOABII584xeHwozwAAAAINh1Li",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8816906978",
      "actor": {
        "login": "nopara73",
        "id": 9156103,
        "node_id": "MDQ6VXNlcjkxNTYxMDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9156103?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nopara73",
        "html_url": "https://github.com/nopara73",
        "followers_url": "https://api.github.com/users/nopara73/followers",
        "following_url": "https://api.github.com/users/nopara73/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nopara73/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nopara73/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nopara73/subscriptions",
        "organizations_url": "https://api.github.com/users/nopara73/orgs",
        "repos_url": "https://api.github.com/users/nopara73/repos",
        "events_url": "https://api.github.com/users/nopara73/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nopara73/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-22T13:36:54Z"
    },
    {
      "event": "subscribed",
      "id": 8816906996,
      "node_id": "SE_lADOABII584xeHwozwAAAAINh1L0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8816906996",
      "actor": {
        "login": "nopara73",
        "id": 9156103,
        "node_id": "MDQ6VXNlcjkxNTYxMDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9156103?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nopara73",
        "html_url": "https://github.com/nopara73",
        "followers_url": "https://api.github.com/users/nopara73/followers",
        "following_url": "https://api.github.com/users/nopara73/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nopara73/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nopara73/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nopara73/subscriptions",
        "organizations_url": "https://api.github.com/users/nopara73/orgs",
        "repos_url": "https://api.github.com/users/nopara73/repos",
        "events_url": "https://api.github.com/users/nopara73/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nopara73/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-22T13:36:54Z"
    },
    {
      "event": "commented",
      "id": 1479660108,
      "node_id": "IC_kwDOABII585YMdJM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1479660108",
      "actor": {
        "login": "prusnak",
        "id": 42201,
        "node_id": "MDQ6VXNlcjQyMjAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/42201?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/prusnak",
        "html_url": "https://github.com/prusnak",
        "followers_url": "https://api.github.com/users/prusnak/followers",
        "following_url": "https://api.github.com/users/prusnak/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/prusnak/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/prusnak/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/prusnak/subscriptions",
        "organizations_url": "https://api.github.com/users/prusnak/orgs",
        "repos_url": "https://api.github.com/users/prusnak/repos",
        "events_url": "https://api.github.com/users/prusnak/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/prusnak/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-22T14:25:27Z",
      "updated_at": "2023-03-22T14:25:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "@sipa By not providing sort-of accurate estimations from the current mempool, we force people to rely on third-party estimators, which is arguably much worse than having an independent estimation which works most of the time, although it may be games under certain specific conditions. I think that \"perfect is enemy of good\" rule applies here perfectly.",
      "user": {
        "login": "prusnak",
        "id": 42201,
        "node_id": "MDQ6VXNlcjQyMjAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/42201?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/prusnak",
        "html_url": "https://github.com/prusnak",
        "followers_url": "https://api.github.com/users/prusnak/followers",
        "following_url": "https://api.github.com/users/prusnak/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/prusnak/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/prusnak/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/prusnak/subscriptions",
        "organizations_url": "https://api.github.com/users/prusnak/orgs",
        "repos_url": "https://api.github.com/users/prusnak/repos",
        "events_url": "https://api.github.com/users/prusnak/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/prusnak/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1479660108",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8817471891,
      "node_id": "MEE_lADOABII584xeHwozwAAAAINj_GT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8817471891",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-22T14:25:27Z"
    },
    {
      "event": "subscribed",
      "id": 8817471914,
      "node_id": "SE_lADOABII584xeHwozwAAAAINj_Gq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8817471914",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-22T14:25:27Z"
    },
    {
      "event": "commented",
      "id": 1489662232,
      "node_id": "IC_kwDOABII585YynEY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1489662232",
      "actor": {
        "login": "nopara73",
        "id": 9156103,
        "node_id": "MDQ6VXNlcjkxNTYxMDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9156103?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nopara73",
        "html_url": "https://github.com/nopara73",
        "followers_url": "https://api.github.com/users/nopara73/followers",
        "following_url": "https://api.github.com/users/nopara73/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nopara73/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nopara73/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nopara73/subscriptions",
        "organizations_url": "https://api.github.com/users/nopara73/orgs",
        "repos_url": "https://api.github.com/users/nopara73/repos",
        "events_url": "https://api.github.com/users/nopara73/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nopara73/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T04:10:34Z",
      "updated_at": "2023-03-30T04:10:34Z",
      "author_association": "NONE",
      "body": "@sipa sorry for the late reply, at first I was like \"yes, that makes perfect sense,\" however an argument came to my mind - this morning during shower :) - in favor of it, so I'd like to share that.\r\n\r\nCan't we assume miners are seeking the highest fee transactions at all times? In other words: maximize their income from fees. If we could, then adjusting `estimatesmartfee` results based on the possibility of block acceptance of the current mempool state of the node does not seem gameable to me, because by extension we could assume that the highest fee transactions we have are precisely the ones that the miners seek.\r\n\r\nNow I may argue against this with \"it is not guaranteed that the miners have the highest fee txs that my node does as well.\"\r\n\r\nTo this, first I'd say: we can guarantee they want to have them and isn't that enough?\r\nThen I'd turn this around and look at it from an attacker's point of view: the way to game this would be to create transactions those have high fees, get to the targeted node, but don't get to the miners. And now I'd point out the attacker cannot guarantee his high fee transactions don't get to the miners, especially with `fullrbf` around. This makes the attack super expensive, since in order to make the node think the fees are very high, the attacker has to create many blocks of transactions and guarantee that only the targeted node will get to know of these transactions.\r\n\r\nIn summary, unless I am missing the point and you're referring to another kind of game/attack here that does not involve the attacker creating blocks of high fee transactions, we can be reassured the attack is too expensive to be worth trying.",
      "user": {
        "login": "nopara73",
        "id": 9156103,
        "node_id": "MDQ6VXNlcjkxNTYxMDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9156103?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nopara73",
        "html_url": "https://github.com/nopara73",
        "followers_url": "https://api.github.com/users/nopara73/followers",
        "following_url": "https://api.github.com/users/nopara73/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nopara73/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nopara73/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nopara73/subscriptions",
        "organizations_url": "https://api.github.com/users/nopara73/orgs",
        "repos_url": "https://api.github.com/users/nopara73/repos",
        "events_url": "https://api.github.com/users/nopara73/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nopara73/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-1489662232",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21422"
    },
    {
      "event": "mentioned",
      "id": 8882915299,
      "node_id": "MEE_lADOABII584xeHwozwAAAAIRdofj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8882915299",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T04:10:34Z"
    },
    {
      "event": "subscribed",
      "id": 8882915304,
      "node_id": "SE_lADOABII584xeHwozwAAAAIRdofo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8882915304",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T04:10:34Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598258602",
      "pull_request_review_id": 617005701,
      "id": 598258602,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI1ODYwMg==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Use a named cast (and can be const)",
      "created_at": "2021-03-21T10:45:32Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598258602",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598258602"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1518,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598258707",
      "pull_request_review_id": 617005701,
      "id": 598258707,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI1ODcwNw==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; i--) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 48,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n            for (int i = limits.size() - 1; i >= 0; --i) {\r\n```",
      "created_at": "2021-03-21T10:46:21Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598258707",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598258707"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598258754",
      "pull_request_review_id": 617005701,
      "id": 598258754,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI1ODc1NA==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; i--) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    count[i]++;",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n                    ++count[i];\r\n```",
      "created_at": "2021-03-21T10:46:47Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598258754",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598258754"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1535,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598259105",
      "pull_request_review_id": 617005701,
      "id": 598259105,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI1OTEwNQ==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Are `size`, `asize` and `dsize` guaranteed to be non-zero? Can they be `const`?",
      "created_at": "2021-03-21T10:49:09Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598259105",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598259105"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598259294",
      "pull_request_review_id": 617005701,
      "id": 598259294,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI1OTI5NA==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; i--) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    count[i]++;\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        CAmount total_fees = 0; // Track total amount of available fees in mempool\n+        UniValue ranges(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); i++) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 60,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        for (size_t i = 0; i < limits.size(); ++i) {\r\n```",
      "created_at": "2021-03-21T10:50:32Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598259294",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598259294"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1544,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598259362",
      "pull_request_review_id": 617005701,
      "id": 598259362,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI1OTM2Mg==",
      "diff_hunk": "@@ -1520,15 +1586,43 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transaction with feerates equal or greater than this value\"},\n+                                    {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transaction with feerates less than than this value\"},\n+                                }},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool\"},\n+                            }},\n                     }},\n                 RPCExamples{\n                     HelpExampleCli(\"getmempoolinfo\", \"\")\n             + HelpExampleRpc(\"getmempoolinfo\", \"\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureMemPool(request.context));\n+    MempoolHistogramFeeLimits feelimits;\n+    std::optional<MempoolHistogramFeeLimits> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+        for (unsigned int i = 0; i < feelimits_univalue.size(); i++) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 129,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        for (unsigned int i = 0; i < feelimits_univalue.size(); ++i) {\r\n```",
      "created_at": "2021-03-21T10:51:28Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598259362",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598259362"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1614,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598259414",
      "pull_request_review_id": 617005701,
      "id": 598259414,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI1OTQxNA==",
      "diff_hunk": "@@ -1520,15 +1586,43 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transaction with feerates equal or greater than this value\"},\n+                                    {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transaction with feerates less than than this value\"},\n+                                }},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool\"},\n+                            }},\n                     }},\n                 RPCExamples{\n                     HelpExampleCli(\"getmempoolinfo\", \"\")\n             + HelpExampleRpc(\"getmempoolinfo\", \"\")",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 119,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Can you add an example?",
      "created_at": "2021-03-21T10:52:04Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598259414",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598259414"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1605,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598260229",
      "pull_request_review_id": 617005701,
      "id": 598260229,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI2MDIyOQ==",
      "diff_hunk": "@@ -0,0 +1,50 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+from decimal import Decimal",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 14,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The decimal stdlib import should be before the framework imports per PEP8, separated by a blank line ",
      "created_at": "2021-03-21T10:58:31Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598260229",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598260229"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598260474",
      "pull_request_review_id": 617005701,
      "id": 598260474,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI2MDQ3NA==",
      "diff_hunk": "@@ -225,6 +225,7 @@\n     'feature_nulldummy.py --descriptors',\n     'mempool_accept.py',\n     'mempool_expiry.py',\n+    'mempool_fee_histogram.py',",
      "path": "test/functional/test_runner.py",
      "position": 4,
      "original_position": 4,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The new test file has incorrect permissions:\r\n```\r\n-rwxr-xr-x 1   5133 Mar 17 15:30 mempool_expiry.py*\r\n-rw-r--r-- 1   1716 Mar 21 11:56 mempool_fee_histogram.py\r\n-rwxr-xr-x 1   3494 Mar  1 11:53 mempool_limit.py*\r\n```\r\nI had to run `sudo chmod 755 test/functional/mempool_fee_histogram.py` to be able to call the test directly, e.g. with `test/functional/mempool_fee_histogram.py`",
      "created_at": "2021-03-21T11:00:31Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598260474",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598260474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 269,
      "original_line": 269,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598261128",
      "pull_request_review_id": 617007432,
      "id": 598261128,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODI2MTEyOA==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; i--) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    count[i]++;\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        CAmount total_fees = 0; // Track total amount of available fees in mempool\n+        UniValue ranges(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); i++) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"sizes\", sizes[i]);\n+            info_sub.pushKV(\"count\", count[i]);\n+            info_sub.pushKV(\"fees\", fees[i]);\n+            info_sub.pushKV(\"from_feerate\", limits[i].first);\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to_feerate\", \"Max\"); // TODO.\n+            } else {\n+                info_sub.pushKV(\"to_feerate\", limits[i + 1].first);\n+            }\n+\n+            total_fees += fees[i];\n+            ranges.pushKV(limits[i].first, info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"ranges\", ranges);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    // {\"with_fee_histogram\", RPCArg::Type::BOOL, /* default */ \"false\", \"True for including the fee histogram in the response\"},\n+                    {\"fee_histogram\", RPCArg::Type::STR, /* default */ \"false\", \"Provide fee limits in format: '1,2,3,5,200,1000'\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 93,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is the argument a string or a JSON array? (if an array, I think there needs to be another line that specifies the element type, e.g. number, string, or amount, probably the latter).",
      "created_at": "2021-03-21T11:06:03Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598261128",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598261128"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1576,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598342760",
      "pull_request_review_id": 617065184,
      "id": 598342760,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODM0Mjc2MA==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@jonatack This is a part of the original PR I need to research more.\r\n\r\nDo you possibly have a tip where to learn how to properly compute `feeperbyte` value for a transaction? Or possibly who would know that? \r\n\r\nAnyway, I'm slowly skimming Bitcoin Core codebase so maybe I'll be lucky :-)",
      "created_at": "2021-03-21T21:46:28Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598342760",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598342760"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598472515",
      "pull_request_review_id": 617206365,
      "id": 598472515,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODQ3MjUxNQ==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; i--) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 48,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598258707,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Addressed, thanks!",
      "created_at": "2021-03-22T07:20:55Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598472515",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598472515"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598472588",
      "pull_request_review_id": 617206471,
      "id": 598472588,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODQ3MjU4OA==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; i--) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    count[i]++;",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598258754,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Addressed, thanks!",
      "created_at": "2021-03-22T07:21:09Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598472588",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598472588"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1535,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598472646",
      "pull_request_review_id": 617206522,
      "id": 598472646,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODQ3MjY0Ng==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; i--) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    count[i]++;\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        CAmount total_fees = 0; // Track total amount of available fees in mempool\n+        UniValue ranges(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); i++) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 60,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259294,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Addressed, thanks!",
      "created_at": "2021-03-22T07:21:16Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598472646",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598472646"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1544,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598472692",
      "pull_request_review_id": 617206566,
      "id": 598472692,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODQ3MjY5Mg==",
      "diff_hunk": "@@ -1520,15 +1586,43 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transaction with feerates equal or greater than this value\"},\n+                                    {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transaction with feerates less than than this value\"},\n+                                }},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool\"},\n+                            }},\n                     }},\n                 RPCExamples{\n                     HelpExampleCli(\"getmempoolinfo\", \"\")\n             + HelpExampleRpc(\"getmempoolinfo\", \"\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureMemPool(request.context));\n+    MempoolHistogramFeeLimits feelimits;\n+    std::optional<MempoolHistogramFeeLimits> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+        for (unsigned int i = 0; i < feelimits_univalue.size(); i++) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 129,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259362,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Addressed, thanks!",
      "created_at": "2021-03-22T07:21:21Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598472692",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598472692"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1614,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598473434",
      "pull_request_review_id": 617207546,
      "id": 598473434,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODQ3MzQzNA==",
      "diff_hunk": "@@ -0,0 +1,50 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+from decimal import Decimal",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 14,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598260229,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Hopefully, it's correct now. ",
      "created_at": "2021-03-22T07:23:09Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598473434",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598473434"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598473687",
      "pull_request_review_id": 617207865,
      "id": 598473687,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODQ3MzY4Nw==",
      "diff_hunk": "@@ -225,6 +225,7 @@\n     'feature_nulldummy.py --descriptors',\n     'mempool_accept.py',\n     'mempool_expiry.py',\n+    'mempool_fee_histogram.py',",
      "path": "test/functional/test_runner.py",
      "position": 4,
      "original_position": 4,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598260474,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I fixed this. Thanks!",
      "created_at": "2021-03-22T07:23:44Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r598473687",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598473687"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 269,
      "original_line": 269,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599793002",
      "pull_request_review_id": 618888213,
      "id": 599793002,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTc5MzAwMg==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; i--) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    count[i]++;\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        CAmount total_fees = 0; // Track total amount of available fees in mempool\n+        UniValue ranges(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); i++) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"sizes\", sizes[i]);\n+            info_sub.pushKV(\"count\", count[i]);\n+            info_sub.pushKV(\"fees\", fees[i]);\n+            info_sub.pushKV(\"from_feerate\", limits[i].first);\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to_feerate\", \"Max\"); // TODO.\n+            } else {\n+                info_sub.pushKV(\"to_feerate\", limits[i + 1].first);\n+            }\n+\n+            total_fees += fees[i];\n+            ranges.pushKV(limits[i].first, info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"ranges\", ranges);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    // {\"with_fee_histogram\", RPCArg::Type::BOOL, /* default */ \"false\", \"True for including the fee histogram in the response\"},\n+                    {\"fee_histogram\", RPCArg::Type::STR, /* default */ \"false\", \"Provide fee limits in format: '1,2,3,5,200,1000'\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 93,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598261128,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The argument is a JSON array of amounts (fees). I have fixed it.",
      "created_at": "2021-03-23T17:38:39Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599793002",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599793002"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1576,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599832829",
      "pull_request_review_id": 618938369,
      "id": 599832829,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTgzMjgyOQ==",
      "diff_hunk": "@@ -1520,15 +1586,43 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transaction with feerates equal or greater than this value\"},\n+                                    {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transaction with feerates less than than this value\"},\n+                                }},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool\"},\n+                            }},\n                     }},\n                 RPCExamples{\n                     HelpExampleCli(\"getmempoolinfo\", \"\")\n             + HelpExampleRpc(\"getmempoolinfo\", \"\")",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 119,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259414,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I added an example.",
      "created_at": "2021-03-23T18:31:07Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599832829",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599832829"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1605,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599863046",
      "pull_request_review_id": 618977549,
      "id": 599863046,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg2MzA0Ng==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "For computing a fee rate per byte, have a look in `src/policy/feerate.{h, cpp}`. Here's a proposed diff (using the current code) to do explicit casts rather than implicit conversions and narrowing. The size denominators are calling `GetTxSize()`, which should be non-zero, but you can `CHECK_NONFATAL` on these. That said, you may be right that it can be done properly/better, as you asked, by using the `CFeeRate` ctors.\r\n\r\n<details><summary>diff</summary><p>\r\n\r\n```diff\r\n         for (const CTxMemPoolEntry& e : pool.mapTx) {\r\n-            const int size = (int)e.GetTxSize();\r\n-            CAmount fee = e.GetFee();\r\n-            uint64_t asize = e.GetSizeWithAncestors();\r\n-            CAmount afees = e.GetModFeesWithAncestors();\r\n-            uint64_t dsize = e.GetSizeWithDescendants();\r\n-            CAmount dfees = e.GetModFeesWithDescendants();\r\n-\r\n-            CAmount fpb = fee / size; // fee per byte\r\n-            CAmount afpb = afees / asize; // fee per byte including ancestors\r\n-            CAmount dfpb = dfees / dsize; // fee per byte including descendants\r\n-            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\r\n-            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\r\n+            const CAmount fee{e.GetFee()};\r\n+            const CAmount afees{e.GetModFeesWithAncestors()};\r\n+            const CAmount dfees{e.GetModFeesWithDescendants()};\r\n+\r\n+            const int64_t size{static_cast<int64_t>(e.GetTxSize())};\r\n+            const int64_t asize{static_cast<int64_t>(e.GetSizeWithAncestors())};\r\n+            const int64_t dsize{static_cast<int64_t>(e.GetSizeWithDescendants())};\r\n+\r\n+            CHECK_NONFATAL(size > 0);\r\n+            CHECK_NONFATAL(asize > 0);\r\n+            CHECK_NONFATAL(dsize > 0);\r\n+            CHECK_NONFATAL(asize + dsize - size > 0);\r\n+\r\n+            CAmount fpb{fee / size};     // fee per byte\r\n+            CAmount afpb{afees / asize}; // fee per byte including ancestors\r\n+            CAmount dfpb{dfees / dsize}; // fee per byte including descendants\r\n+            CAmount tfpb{(afees + dfees - fee) / (asize + dsize - size)};\r\n+            CAmount feeperbyte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\r\n```\r\n</p></details>\r\n",
      "created_at": "2021-03-23T19:16:45Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599863046",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599863046"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599864037",
      "pull_request_review_id": 618978887,
      "id": 599864037,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg2NDAzNw==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "(note, `CAmount` is `int64_t`, see `src/amount.h`)",
      "created_at": "2021-03-23T19:18:20Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599864037",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599864037"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599868315",
      "pull_request_review_id": 618984524,
      "id": 599868315,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg2ODMxNQ==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; i--) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    count[i]++;\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        CAmount total_fees = 0; // Track total amount of available fees in mempool\n+        UniValue ranges(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); i++) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"sizes\", sizes[i]);\n+            info_sub.pushKV(\"count\", count[i]);\n+            info_sub.pushKV(\"fees\", fees[i]);\n+            info_sub.pushKV(\"from_feerate\", limits[i].first);\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to_feerate\", \"Max\"); // TODO.\n+            } else {\n+                info_sub.pushKV(\"to_feerate\", limits[i + 1].first);\n+            }\n+\n+            total_fees += fees[i];\n+            ranges.pushKV(limits[i].first, info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"ranges\", ranges);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    // {\"with_fee_histogram\", RPCArg::Type::BOOL, /* default */ \"false\", \"True for including the fee histogram in the response\"},\n+                    {\"fee_histogram\", RPCArg::Type::STR, /* default */ \"false\", \"Provide fee limits in format: '1,2,3,5,200,1000'\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 93,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598261128,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> The argument is a JSON array of amounts (fees). I have fixed it.\r\n\r\nYes, seems better now\r\n```\r\nArguments:\r\n1. fee_histogram    (json array, optional) Fee amounts\r\n     [\r\n       fee,         (numeric or string, required) A fee amount\r\n       ...\r\n     ]\r\n```",
      "created_at": "2021-03-23T19:25:16Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599868315",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599868315"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1576,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599873660",
      "pull_request_review_id": 618991407,
      "id": 599873660,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg3MzY2MA==",
      "diff_hunk": "@@ -1520,15 +1586,43 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transaction with feerates equal or greater than this value\"},\n+                                    {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transaction with feerates less than than this value\"},\n+                                }},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool\"},\n+                            }},\n                     }},\n                 RPCExamples{\n                     HelpExampleCli(\"getmempoolinfo\", \"\")\n             + HelpExampleRpc(\"getmempoolinfo\", \"\")",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 119,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259414,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "New examples look good, thanks.\r\n```\r\n> bitcoin-cli getmempoolinfo \r\n> bitcoin-cli getmempoolinfo [\"0.00000001\",\"0.00000010\",\"0.00000100\",\"0.00000200\",\"0.00000400\",\"0.00000800\"]\r\n> curl --user myusername --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"getmempoolinfo\", \"params\": []}' -H 'content-type: text/plain;' http://127.0.0.1:8332/\r\n> curl --user myusername --data-binary '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"getmempoolinfo\", \"params\": [[\"0.00000001\",\"0.00000010\",\"0.00000100\",\"0.00000200\",\"0.00000400\",\"0.00000800\"]]}' -H 'content-type: text/plain;' http://127.0.0.1:8332/\r\n```\r\n",
      "created_at": "2021-03-23T19:33:41Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599873660",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599873660"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1605,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599875604",
      "pull_request_review_id": 618993997,
      "id": 599875604,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg3NTYwNA==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 109,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Looks like the help is missing the \"ranges\" JSON object, returned by the output, that encompasses the feerate groups (tested on signet):\r\n\r\nhelp\r\n```\r\n\"fee_histogram\" : {        (json object)\r\n    \"<feerate-group>\" : {    (json object) Object per feerate group\r\n      \"sizes\" : n,           (numeric) Cumulated size of all transactions in feerate group\r\n      \"count\" : n,           (numeric) Amount of transactions in feerate group\r\n      \"fees\" : n,            (numeric) Cumulated fee of all transactions in feerate group\r\n      \"from_feerate\" : n,    (numeric) Group contains transaction with feerates equal or greater than this value\r\n      \"to_feerate\" : n       (numeric) Group contains transaction with feerates less than than this value\r\n    },\r\n```\r\nactual output\r\n```\r\n  \"fee_histogram\": {\r\n    \"ranges\": {\r\n      \"0.00000001\": {\r\n        \"sizes\": 0,\r\n        \"count\": 0,\r\n        \"fees\": 0,\r\n        \"from_feerate\": \"0.00000001\",\r\n        \"to_feerate\": \"0.0000001\"\r\n      },\r\n      ...\r\n```\r\n",
      "created_at": "2021-03-23T19:36:53Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599875604",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599875604"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1595,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599877072",
      "pull_request_review_id": 618995866,
      "id": 599877072,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg3NzA3Mg==",
      "diff_hunk": "@@ -1520,15 +1586,43 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transaction with feerates equal or greater than this value\"},\n+                                    {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transaction with feerates less than than this value\"},\n+                                }},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool\"},\n+                            }},\n                     }},\n                 RPCExamples{\n                     HelpExampleCli(\"getmempoolinfo\", \"\")\n             + HelpExampleRpc(\"getmempoolinfo\", \"\")",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 119,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259414,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Great!",
      "created_at": "2021-03-23T19:39:12Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599877072",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599877072"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1605,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599877546",
      "pull_request_review_id": 618996495,
      "id": 599877546,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg3NzU0Ng==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks. Will have a look!",
      "created_at": "2021-03-23T19:40:01Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599877546",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599877546"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599877954",
      "pull_request_review_id": 618997026,
      "id": 599877954,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg3Nzk1NA==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 109,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": 599875604,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I see. Will fix. Thank you",
      "created_at": "2021-03-23T19:40:40Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599877954",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599877954"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1595,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599880561",
      "pull_request_review_id": 619000071,
      "id": 599880561,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg4MDU2MQ==",
      "diff_hunk": "@@ -1501,14 +1502,82 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; --i) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        CAmount total_fees = 0; // Track total amount of available fees in mempool\n+        UniValue ranges(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"sizes\", sizes[i]);\n+            info_sub.pushKV(\"count\", count[i]);\n+            info_sub.pushKV(\"fees\", fees[i]);\n+            info_sub.pushKV(\"from_feerate\", limits[i].first);\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to_feerate\", \"Max\"); // TODO.\n+            } else {\n+                info_sub.pushKV(\"to_feerate\", limits[i + 1].first);\n+            }\n+\n+            total_fees += fees[i];\n+            ranges.pushKV(limits[i].first, info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"ranges\", ranges);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee amounts\",\n+                        {\n+                            {\"fee\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A fee amount\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 94,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "IIUC these should be feerates, not fees\r\n```suggestion\r\n                            {\"fee_rate\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"Fee rate to group the fees by\"},\r\n```",
      "created_at": "2021-03-23T19:44:07Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599880561",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599880561"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1577,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599884912",
      "pull_request_review_id": 619005710,
      "id": 599884912,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg4NDkxMg==",
      "diff_hunk": "@@ -1501,14 +1502,82 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; --i) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        CAmount total_fees = 0; // Track total amount of available fees in mempool\n+        UniValue ranges(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"sizes\", sizes[i]);\n+            info_sub.pushKV(\"count\", count[i]);\n+            info_sub.pushKV(\"fees\", fees[i]);\n+            info_sub.pushKV(\"from_feerate\", limits[i].first);\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to_feerate\", \"Max\"); // TODO.\n+            } else {\n+                info_sub.pushKV(\"to_feerate\", limits[i + 1].first);\n+            }\n+\n+            total_fees += fees[i];\n+            ranges.pushKV(limits[i].first, info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"ranges\", ranges);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee amounts\",",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 92,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If I understand correctly, this should be something like \"Fee statistics grouped by feerate ranges\"",
      "created_at": "2021-03-23T19:50:43Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599884912",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599884912"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1575,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599886221",
      "pull_request_review_id": 619007089,
      "id": 599886221,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg4NjIyMQ==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 111,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n                                    {RPCResult::Type::NUM, \"size\", \"Cumulated size of all transactions in feerate group\"},\r\n```",
      "created_at": "2021-03-23T19:52:15Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599886221",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599886221"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1597,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599888505",
      "pull_request_review_id": 619010167,
      "id": 599888505,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg4ODUwNQ==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 113,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Probably both should be \"fees\" in this sentence, like in line 1603.",
      "created_at": "2021-03-23T19:56:13Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599888505",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599888505"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1599,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599889272",
      "pull_request_review_id": 619011160,
      "id": 599889272,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTg4OTI3Mg==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transaction with feerates equal or greater than this value\"},\n+                                    {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transaction with feerates less than than this value\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 115,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "s/transaction/transactions/ in both lines 1600 and 1601\r\n\r\ns/than than/than/",
      "created_at": "2021-03-23T19:57:21Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r599889272",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599889272"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1601,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210241",
      "pull_request_review_id": 619369988,
      "id": 600210241,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDIxMDI0MQ==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah, my comment didn't make it through the internet:\r\n\r\nIt would be good to use feerate values in sat/vB for both the user input and the output here, as we are slowly moving from BTC/kvB to sat/vB fee rate units, per user demand.\r\n\r\nCurrently, you can construct a feerate from a sat/vB amount with `CFeeRate{amount, COIN}`. I proposed `CFeeRate::FromSatB` and `FromBtcKb` named constructors in #20790, #20391, #20546 but none of the three are/were merged.",
      "created_at": "2021-03-24T06:42:11Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r600210241",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210241"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210767",
      "pull_request_review_id": 619370649,
      "id": 600210767,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDIxMDc2Nw==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transaction with feerates equal or greater than this value\"},\n+                                    {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transaction with feerates less than than this value\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 115,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": 599889272,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, thanks!",
      "created_at": "2021-03-24T06:43:29Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r600210767",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210767"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1601,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210809",
      "pull_request_review_id": 619370683,
      "id": 600210809,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDIxMDgwOQ==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                    {RPCResult::Type::NUM, \"fees\", \"Cumulated fee of all transactions in feerate group\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 113,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": 599888505,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, thanks!",
      "created_at": "2021-03-24T06:43:34Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r600210809",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210809"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1599,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210842",
      "pull_request_review_id": 619370727,
      "id": 600210842,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDIxMDg0Mg==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                {\n+                                    {RPCResult::Type::NUM, \"sizes\", \"Cumulated size of all transactions in feerate group\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 111,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": 599886221,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, thanks!",
      "created_at": "2021-03-24T06:43:39Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r600210842",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210842"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1597,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210927",
      "pull_request_review_id": 619370843,
      "id": 600210927,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDIxMDkyNw==",
      "diff_hunk": "@@ -1501,14 +1502,82 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants\n+            CAmount tfpb = (afees + dfees - fee) / (asize + dsize - size);\n+            CAmount feeperbyte = std::max(std::min(dfpb, tfpb), std::min(fpb, afpb));\n+\n+            // Distribute feerates into feelimits\n+            for (int i = limits.size() - 1; i >= 0; --i) {\n+                if (feeperbyte >= limits[i].second) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        CAmount total_fees = 0; // Track total amount of available fees in mempool\n+        UniValue ranges(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"sizes\", sizes[i]);\n+            info_sub.pushKV(\"count\", count[i]);\n+            info_sub.pushKV(\"fees\", fees[i]);\n+            info_sub.pushKV(\"from_feerate\", limits[i].first);\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to_feerate\", \"Max\"); // TODO.\n+            } else {\n+                info_sub.pushKV(\"to_feerate\", limits[i + 1].first);\n+            }\n+\n+            total_fees += fees[i];\n+            ranges.pushKV(limits[i].first, info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"ranges\", ranges);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee amounts\",",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 92,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": 599884912,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, thanks!",
      "created_at": "2021-03-24T06:43:53Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r600210927",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600210927"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1575,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600211868",
      "pull_request_review_id": 619372049,
      "id": 600211868,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDIxMTg2OA==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Originally, fee rates were in sats but then I found https://github.com/bitcoin/bitcoin/pull/12240 which made me think that sats -> BTC is preferred. ",
      "created_at": "2021-03-24T06:46:19Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r600211868",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600211868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600213131",
      "pull_request_review_id": 619373626,
      "id": 600213131,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDIxMzEzMQ==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "So I will switch it back to use sats. Thanks for the `CFeeRate{amount, COIN}` tip!",
      "created_at": "2021-03-24T06:49:29Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r600213131",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600213131"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600213464",
      "pull_request_review_id": 619374017,
      "id": 600213464,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDIxMzQ2NA==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 109,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": 599875604,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It should be fixed now. Even though I still think `ranges` is not a good word. `groups`?",
      "created_at": "2021-03-24T06:50:17Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r600213464",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600213464"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1595,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600784015",
      "pull_request_review_id": 620130983,
      "id": 600784015,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDc4NDAxNQ==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@jonatack Do I understand correctly that `CAmount fpb = fee / size` is equivalent with `CAmount fpb = CFeeRate(fee, size).GetFee(1)`? Is that what you propose to use?\r\n",
      "created_at": "2021-03-24T18:57:58Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r600784015",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600784015"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601617528",
      "pull_request_review_id": 621285483,
      "id": 601617528,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTYxNzUyOA==",
      "diff_hunk": "@@ -1501,14 +1502,88 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const CAmount afees{e.GetModFeesWithAncestors()};\n+            const CAmount dfees{e.GetModFeesWithDescendants()};\n+\n+            const int64_t size{static_cast<int64_t>(e.GetTxSize())};\n+            const int64_t asize{static_cast<int64_t>(e.GetSizeWithAncestors())};\n+            const int64_t dsize{static_cast<int64_t>(e.GetSizeWithDescendants())};\n+\n+            CHECK_NONFATAL(size > 0);\n+            CHECK_NONFATAL(asize > 0);\n+            CHECK_NONFATAL(dsize > 0);\n+            CHECK_NONFATAL(asize + dsize - size > 0);\n+\n+            CAmount fpb{fee / size};     // fee per byte\n+            CAmount afpb{afees / asize}; // fee per byte including ancestors\n+            CAmount dfpb{dfees / dsize}; // fee per byte including descendants\n+            CAmount tfpb{(afees + dfees - fee) / (asize + dsize - size)};\n+            CAmount feeperbyte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "fb0824ce3c7b9d1b5432da38321ba5b06e74c908",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "naming style nit, per developer-notes.md \r\n```suggestion\r\n            CAmount fee_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\r\n```",
      "created_at": "2021-03-25T15:53:20Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r601617528",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601617528"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1535,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601666661",
      "pull_request_review_id": 621285483,
      "id": 601666661,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTY2NjY2MQ==",
      "diff_hunk": "@@ -1520,15 +1595,42 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"ranges\", \"Feerate groups\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulated size of all transactions in feerate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulated fees of all transactions in feerate group (in satoshis)\"},\n+                                        {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transactions with feerates equal or greater than this value (in satoshis)\"},\n+                                        {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transactions with feerates less than this value (in satoshis)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in satoshis)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"([1, 10, 100, 200, 400, 800])\") +",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 132,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "fb0824ce3c7b9d1b5432da38321ba5b06e74c908",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "missing quotes in the first example, I think, and perhaps use example fee rates that return more interesting results\r\n```diff\r\n-                    HelpExampleCli(\"getmempoolinfo\", R\"([1, 10, 100, 200, 400, 800])\") +\r\n+                    HelpExampleCli(\"getmempoolinfo\", R\"('[1, 5, 10, 25, 50, 100]')\") +\r\n                     HelpExampleRpc(\"getmempoolinfo\", \"\") +\r\n-                    HelpExampleRpc(\"getmempoolinfo\", R\"([1, 10, 100, 200, 400, 800])\")\r\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([1, 5, 10, 25, 50, 100])\")\r\n```\r\n",
      "created_at": "2021-03-25T16:49:15Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r601666661",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601666661"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1616,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601711097",
      "pull_request_review_id": 621285483,
      "id": 601711097,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTcxMTA5Nw==",
      "diff_hunk": "@@ -1520,15 +1595,42 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"ranges\", \"Feerate groups\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulated size of all transactions in feerate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulated fees of all transactions in feerate group (in satoshis)\"},\n+                                        {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transactions with feerates equal or greater than this value (in satoshis)\"},\n+                                        {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transactions with feerates less than this value (in satoshis)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in satoshis)\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 125,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "fb0824ce3c7b9d1b5432da38321ba5b06e74c908",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This field seems to be the same as the `total_fee` field above in the same output (except that it is now in sat/vB instead of BTC/kvB)?",
      "created_at": "2021-03-25T17:44:17Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r601711097",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601711097"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1611,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601729062",
      "pull_request_review_id": 621434271,
      "id": 601729062,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTcyOTA2Mg==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You can verify this with, for example\r\n```cpp\r\n            assert(fpb == CFeeRate(fee, size).GetFee(1));\r\n            assert(afpb == CFeeRate(afees, asize).GetFee(1));\r\n            assert(dfpb == CFeeRate(dfees, dsize).GetFee(1));\r\n            assert(tfpb == CFeeRate(afees + dfees - fee, asize + dsize - size).GetFee(1));\r\n```\r\n(I left this as a hint in the suggestions in https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-621285483, but please remove it and decide what you think is best)",
      "created_at": "2021-03-25T18:07:44Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r601729062",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601729062"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601730401",
      "pull_request_review_id": 621435975,
      "id": 601730401,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTczMDQwMQ==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 109,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": 599875604,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "maybe `fee rate groups`",
      "created_at": "2021-03-25T18:09:32Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r601730401",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601730401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1595,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602114346",
      "pull_request_review_id": 621906152,
      "id": 602114346,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjExNDM0Ng==",
      "diff_hunk": "@@ -1501,14 +1502,88 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const CAmount afees{e.GetModFeesWithAncestors()};\n+            const CAmount dfees{e.GetModFeesWithDescendants()};\n+\n+            const int64_t size{static_cast<int64_t>(e.GetTxSize())};\n+            const int64_t asize{static_cast<int64_t>(e.GetSizeWithAncestors())};\n+            const int64_t dsize{static_cast<int64_t>(e.GetSizeWithDescendants())};\n+\n+            CHECK_NONFATAL(size > 0);\n+            CHECK_NONFATAL(asize > 0);\n+            CHECK_NONFATAL(dsize > 0);\n+            CHECK_NONFATAL(asize + dsize - size > 0);\n+\n+            CAmount fpb{fee / size};     // fee per byte\n+            CAmount afpb{afees / asize}; // fee per byte including ancestors\n+            CAmount dfpb{dfees / dsize}; // fee per byte including descendants\n+            CAmount tfpb{(afees + dfees - fee) / (asize + dsize - size)};\n+            CAmount feeperbyte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "fb0824ce3c7b9d1b5432da38321ba5b06e74c908",
      "in_reply_to_id": 601617528,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks! Applied.",
      "created_at": "2021-03-26T08:59:39Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602114346",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602114346"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1535,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602115185",
      "pull_request_review_id": 621907309,
      "id": 602115185,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjExNTE4NQ==",
      "diff_hunk": "@@ -1520,15 +1595,42 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"ranges\", \"Feerate groups\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulated size of all transactions in feerate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulated fees of all transactions in feerate group (in satoshis)\"},\n+                                        {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transactions with feerates equal or greater than this value (in satoshis)\"},\n+                                        {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transactions with feerates less than this value (in satoshis)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in satoshis)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"([1, 10, 100, 200, 400, 800])\") +",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 132,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "fb0824ce3c7b9d1b5432da38321ba5b06e74c908",
      "in_reply_to_id": 601666661,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You are right. I have used the values from the first chart on http://bitcoin-mempool.info website and those are actually the same as the values in the [original PR](https://github.com/bitcoin/bitcoin/pull/15836/files#diff-decae4be02fb8a47ab4557fe74a9cb853bdfa3ec0fa1b515c0a1e5de91f4ad0bR1497).",
      "created_at": "2021-03-26T09:00:58Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602115185",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602115185"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1616,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602115899",
      "pull_request_review_id": 621908331,
      "id": 602115899,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjExNTg5OQ==",
      "diff_hunk": "@@ -1520,15 +1595,42 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"ranges\", \"Feerate groups\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulated size of all transactions in feerate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Amount of transactions in feerate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulated fees of all transactions in feerate group (in satoshis)\"},\n+                                        {RPCResult::Type::NUM, \"from_feerate\", \"Group contains transactions with feerates equal or greater than this value (in satoshis)\"},\n+                                        {RPCResult::Type::NUM, \"to_feerate\", \"Group contains transactions with feerates less than this value (in satoshis)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in satoshis)\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 125,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "fb0824ce3c7b9d1b5432da38321ba5b06e74c908",
      "in_reply_to_id": 601711097,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No. In short, it holds that `fee_histogram.total_fees <= total_fee`. More precisely, the `total_fees` (i.e. the histogram JSON property) here is a sum of `fees` JSON properties from fee rate groups (i.e. `ranges`). For example, `./bitcoin-cli getmempoolinfo \"[0]\"` should show the difference but not on testnet because people mostly do not pay any fees there (🙄).\r\n\r\nHowever, I'm somewhat hesitant whether `total_fees` is useful or not. One can certainly compute it as it is a simple sum of already provided data. So it feels like I should remove it so that Bitcoin Core provides raw data and let customer applications do complex things based on the raw data. Of course, this is very subjective. I'm not sure. I'm neutral on this.",
      "created_at": "2021-03-26T09:02:14Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602115899",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602115899"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1611,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602116946",
      "pull_request_review_id": 621909832,
      "id": 602116946,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjExNjk0Ng==",
      "diff_hunk": "@@ -1501,14 +1502,79 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeLimits& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<uint64_t> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            int size = (int)e.GetTxSize();\n+            CAmount fee = e.GetFee();\n+            uint64_t asize = e.GetSizeWithAncestors();\n+            CAmount afees = e.GetModFeesWithAncestors();\n+            uint64_t dsize = e.GetSizeWithDescendants();\n+            CAmount dfees = e.GetModFeesWithDescendants();\n+\n+            CAmount fpb = fee / size; // fee per byte\n+            CAmount afpb = afees / asize; // fee per byte including ancestors\n+            CAmount dfpb = dfees / dsize; // fee per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "81cd4bb4822ed236fd561c8686f464abb3b1492a",
      "in_reply_to_id": 598259105,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks! I like `CFeeRate` better as then I don't add new divisions myself. The asserts work for me okay.",
      "created_at": "2021-03-26T09:04:03Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602116946",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602116946"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1527,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602117386",
      "pull_request_review_id": 621910527,
      "id": 602117386,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjExNzM4Ng==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 109,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": 599875604,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I have changed it to `fee_rate_groups`. I think it looks nicer now. What do you think?",
      "created_at": "2021-03-26T09:04:50Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602117386",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602117386"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1595,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602616548",
      "pull_request_review_id": 622572094,
      "id": 602616548,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjYxNjU0OA==",
      "diff_hunk": "@@ -1501,34 +1501,140 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const CAmount afees{e.GetModFeesWithAncestors()};\n+            const CAmount dfees{e.GetModFeesWithDescendants()};\n+\n+            const int64_t size{static_cast<int64_t>(e.GetTxSize())};\n+            const int64_t asize{static_cast<int64_t>(e.GetSizeWithAncestors())};\n+            const int64_t dsize{static_cast<int64_t>(e.GetSizeWithDescendants())};\n+\n+            CHECK_NONFATAL(size > 0);\n+            CHECK_NONFATAL(asize > 0);\n+            CHECK_NONFATAL(dsize > 0);\n+            CHECK_NONFATAL(asize + dsize - size > 0);",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "ccb043c8099f7a4cadd85274221b67dda0731caf",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Drive-by comment: now that you're constructing the fee rates with the `CFeeRate` ctor, there is no longer a need for these greater than zero checks. Will re-review the rest.",
      "created_at": "2021-03-26T22:34:00Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602616548",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602616548"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1528,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602617365",
      "pull_request_review_id": 622573036,
      "id": 602617365,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjYxNzM2NQ==",
      "diff_hunk": "@@ -1520,15 +1589,41 @@ static RPCHelpMan getmempoolinfo()\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"<feerate-group>\", \"Object per feerate group\",",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 109,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3d923f4de9a58b5c4cc8365d3d6d9ae94d036ac9",
      "in_reply_to_id": 599875604,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "LGTM",
      "created_at": "2021-03-26T22:36:47Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602617365",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602617365"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1595,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602706785",
      "pull_request_review_id": 622641995,
      "id": 602706785,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjcwNjc4NQ==",
      "diff_hunk": "@@ -1501,34 +1501,140 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const CAmount afees{e.GetModFeesWithAncestors()};\n+            const CAmount dfees{e.GetModFeesWithDescendants()};\n+\n+            const int64_t size{static_cast<int64_t>(e.GetTxSize())};\n+            const int64_t asize{static_cast<int64_t>(e.GetSizeWithAncestors())};\n+            const int64_t dsize{static_cast<int64_t>(e.GetSizeWithDescendants())};\n+\n+            CHECK_NONFATAL(size > 0);\n+            CHECK_NONFATAL(asize > 0);\n+            CHECK_NONFATAL(dsize > 0);\n+            CHECK_NONFATAL(asize + dsize - size > 0);",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "ccb043c8099f7a4cadd85274221b67dda0731caf",
      "in_reply_to_id": 602616548,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, good point. Thank you",
      "created_at": "2021-03-27T11:25:05Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602706785",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602706785"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1528,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602889335",
      "pull_request_review_id": 622754580,
      "id": 602889335,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjg4OTMzNQ==",
      "diff_hunk": "@@ -1501,34 +1501,135 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const CAmount afees{e.GetModFeesWithAncestors()};\n+            const CAmount dfees{e.GetModFeesWithDescendants()};\n+\n+            const int64_t size{static_cast<int64_t>(e.GetTxSize())};\n+            const int64_t asize{static_cast<int64_t>(e.GetSizeWithAncestors())};\n+            const int64_t dsize{static_cast<int64_t>(e.GetSizeWithDescendants())};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "7b6da9fa33c94553436721d39634b53b706a1e72",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "A couple of missing headers and a suggested (tested) update now that we are using the `CFeeRate{CAmount, size_t}` ctor to construct the fee rates:\r\n\r\n<details><summary>diff</summary><p>\r\n\r\n```diff\r\ndiff --git a/src/rest.cpp b/src/rest.cpp\r\nindex 809daa0ef8..400972c092 100644\r\n--- a/src/rest.cpp\r\n+++ b/src/rest.cpp\r\n@@ -26,6 +26,8 @@\r\n \r\n #include <univalue.h>\r\n \r\n+#include <optional>\r\n+\r\n static const size_t MAX_GETUTXOS_OUTPOINTS = 15; //allow a max of 15 outpoints to be queried at once\r\ndiff --git a/src/rpc/blockchain.cpp b/src/rpc/blockchain.cpp\r\nindex d4035c3d0a..5e44990b57 100644\r\n--- a/src/rpc/blockchain.cpp\r\n+++ b/src/rpc/blockchain.cpp\r\n@@ -45,6 +45,7 @@\r\n #include <condition_variable>\r\n #include <memory>\r\n #include <mutex>\r\n+#include <optional>\r\n \r\n struct CUpdatedBlock\r\n {\r\n@@ -1503,7 +1504,7 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool, const std::optional<MempoolHi\r\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\r\n \r\n     if (feeLimits) {\r\n-        const MempoolHistogramFeeRates& limits = feeLimits.value();\r\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\r\n \r\n         /* Keep histogram per...\r\n          * ... cumulated tx sizes\r\n@@ -1514,23 +1515,18 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool, const std::optional<MempoolHi\r\n         std::vector<CAmount> fees(limits.size(), 0);\r\n \r\n         for (const CTxMemPoolEntry& e : pool.mapTx) {\r\n-            const CAmount fee{e.GetFee()};\r\n-            const CAmount afees{e.GetModFeesWithAncestors()};\r\n-            const CAmount dfees{e.GetModFeesWithDescendants()};\r\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\r\n+            const size_t size{e.GetTxSize()}, asize{e.GetSizeWithAncestors()}, dsize{e.GetSizeWithDescendants()};\r\n \r\n-            const int64_t size{static_cast<int64_t>(e.GetTxSize())};\r\n-            const int64_t asize{static_cast<int64_t>(e.GetSizeWithAncestors())};\r\n-            const int64_t dsize{static_cast<int64_t>(e.GetSizeWithDescendants())};\r\n-\r\n-            const CAmount fpb{CFeeRate(fee, size).GetFee(1)};     // fee per byte\r\n-            const CAmount afpb{CFeeRate(afees, asize).GetFee(1)}; // fee per byte including ancestors\r\n-            const CAmount dfpb{CFeeRate(dfees, dsize).GetFee(1)}; // fee per byte including descendants\r\n-            const CAmount tfpb{CFeeRate(afees + dfees - fee, asize + dsize - size).GetFee(1)};\r\n-            const CAmount fee_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\r\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // fee rate per byte\r\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // fee rate per byte including ancestors\r\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // fee rate per byte including descendants\r\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\r\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\r\n \r\n             // Distribute fee rates into fee limits\r\n             for (int i = limits.size() - 1; i >= 0; --i) {\r\n-                if (fee_per_byte >= limits[i]) {\r\n+                if (fee_rate_per_byte >= limits[i]) {\r\n                     sizes[i] += size;\r\n                     ++count[i];\r\n                     fees[i] += fee;\r\n```\r\n</p></details>\r\n",
      "created_at": "2021-03-28T14:55:54Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602889335",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602889335"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1523,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602890855",
      "pull_request_review_id": 622754580,
      "id": 602890855,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjg5MDg1NQ==",
      "diff_hunk": "@@ -55,6 +55,11 @@ def assert_greater_than(thing1, thing2):\n         raise AssertionError(\"%s <= %s\" % (str(thing1), str(thing2)))\n \n \n+def assert_no_key(k, d):\n+    if k in d:\n+        raise AssertionError(\"%s in %s\" % (str(k), str(d)))",
      "path": "test/functional/test_framework/util.py",
      "position": null,
      "original_position": 6,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "7b6da9fa33c94553436721d39634b53b706a1e72",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "suggestion\r\n```diff\r\n-def assert_no_key(k, d):\r\n-    if k in d:\r\n-        raise AssertionError(\"%s in %s\" % (str(k), str(d)))\r\n+def assert_no_key(key, dictionary):\r\n+    if key in dictionary:\r\n+        raise AssertionError(f\"Key '{key}' not expected to be found in {dictionary}\")\r\n```\r\n\r\nwhich uses Python f-strings per current practice and would improve the error message from, for example\r\n\r\n```\r\n    raise AssertionError(\"%s in %s\" % (str(k), str(d)))\r\nAssertionError: size in {'loaded': True, 'size': 1, 'bytes': 219, 'usage': 1072, 'total_fee': Decimal('0.00004380'), 'maxmempool': 300000000, 'mempoolminfee': Decimal('0.00001000'), 'minrelaytxfee': Decimal('0.00001000'), 'unbroadcastcount': 1}\r\n```\r\nto\r\n```\r\n    raise AssertionError(f\"Key '{key}' not expected to be found in {dictionary}\")\r\nAssertionError: Key 'size' not expected to be found in {'loaded': True, 'size': 1, 'bytes': 219, 'usage': 1072, 'total_fee': Decimal('0.00004380'), 'maxmempool': 300000000, 'mempoolminfee': Decimal('0.00001000'), 'minrelaytxfee': Decimal('0.00001000'), 'unbroadcastcount': 1}\r\n```\r\n",
      "created_at": "2021-03-28T15:09:12Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602890855",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602890855"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602892365",
      "pull_request_review_id": 622756564,
      "id": 602892365,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjg5MjM2NQ==",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+\n+        node.sendtoaddress(node.getnewaddress(), 1)\n+\n+        info = node.getmempoolinfo()\n+        assert_no_key('fee_histogram', info)\n+\n+        info = node.getmempoolinfo([100, 200, 300, 400, 500])",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 30,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "7b6da9fa33c94553436721d39634b53b706a1e72",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Oh, and can add logging:\r\n\r\n```diff\r\ndiff --git a/test/functional/mempool_fee_histogram.py b/test/functional/mempool_fee_histogram.py\r\nindex 01fd7825b3..3edd31447b 100755\r\n--- a/test/functional/mempool_fee_histogram.py\r\n+++ b/test/functional/mempool_fee_histogram.py\r\n@@ -21,12 +21,12 @@ class MempoolFeeHistogramTest(BitcoinTestFramework):\r\n \r\n     def run_test(self):\r\n         node = self.nodes[0]\r\n-\r\n         node.sendtoaddress(node.getnewaddress(), 1)\r\n \r\n-        info = node.getmempoolinfo()\r\n-        assert_no_key('fee_histogram', info)\r\n+        self.log.info(\"Test getmempoolinfo does not return fee histogram by default\")\r\n+        assert_no_key('fee_histogram', node.getmempoolinfo())\r\n \r\n+        self.log.info(\"Test getmempoolinfo returns fee histogram if fee rate array is passed\")\r\n         info = node.getmempoolinfo([100, 200, 300, 400, 500])\r\n```\r\n",
      "created_at": "2021-03-28T15:23:08Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r602892365",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602892365"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603037933",
      "pull_request_review_id": 622894767,
      "id": 603037933,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzAzNzkzMw==",
      "diff_hunk": "@@ -1501,34 +1501,135 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits = feeLimits.value();\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const CAmount afees{e.GetModFeesWithAncestors()};\n+            const CAmount dfees{e.GetModFeesWithDescendants()};\n+\n+            const int64_t size{static_cast<int64_t>(e.GetTxSize())};\n+            const int64_t asize{static_cast<int64_t>(e.GetSizeWithAncestors())};\n+            const int64_t dsize{static_cast<int64_t>(e.GetSizeWithDescendants())};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "7b6da9fa33c94553436721d39634b53b706a1e72",
      "in_reply_to_id": 602889335,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thank you for the valuable feedback! Addressed.\r\n\r\nShould I add `#include <optional>` to `blockchain.h` too? Did you notice those missing `#include <optional>` or is there a tool that would warn me in the future?",
      "created_at": "2021-03-29T06:21:58Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r603037933",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603037933"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1523,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603038570",
      "pull_request_review_id": 622895590,
      "id": 603038570,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzAzODU3MA==",
      "diff_hunk": "@@ -55,6 +55,11 @@ def assert_greater_than(thing1, thing2):\n         raise AssertionError(\"%s <= %s\" % (str(thing1), str(thing2)))\n \n \n+def assert_no_key(k, d):\n+    if k in d:\n+        raise AssertionError(\"%s in %s\" % (str(k), str(d)))",
      "path": "test/functional/test_framework/util.py",
      "position": null,
      "original_position": 6,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "7b6da9fa33c94553436721d39634b53b706a1e72",
      "in_reply_to_id": 602890855,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nice, I didn't know about these f-string. Thanks.",
      "created_at": "2021-03-29T06:23:49Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r603038570",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603038570"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603038896",
      "pull_request_review_id": 622896003,
      "id": 603038896,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzAzODg5Ng==",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+\n+        node.sendtoaddress(node.getnewaddress(), 1)\n+\n+        info = node.getmempoolinfo()\n+        assert_no_key('fee_histogram', info)\n+\n+        info = node.getmempoolinfo([100, 200, 300, 400, 500])",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 30,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "7b6da9fa33c94553436721d39634b53b706a1e72",
      "in_reply_to_id": 602892365,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thank you, fixed!",
      "created_at": "2021-03-29T06:24:39Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r603038896",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603038896"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604793435",
      "pull_request_review_id": 625150489,
      "id": 604793435,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDc5MzQzNQ==",
      "diff_hunk": "@@ -1503,34 +1504,130 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const size_t size{e.GetTxSize()}, asize{e.GetSizeWithAncestors()}, dsize{e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // fee rate per byte including descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 41,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3b2db54fbd3a40ef44a1af28d046f920ef2c9620",
      "in_reply_to_id": null,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@jonatack I still struggle with this as I'm not sure whether this is correct or not. It is in the original PR but:\r\n\r\n* Is this how it should be done?\r\n* Is there a better way?\r\n* Is it a copy of some existing code?\r\n\r\nIt's very important and I don't really know the answer now. So I put it here even for my own reference.",
      "created_at": "2021-03-31T10:50:06Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r604793435",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604793435"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 1523,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1671,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611171247",
      "pull_request_review_id": 633000042,
      "id": 611171247,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTE3MTI0Nw==",
      "diff_hunk": "@@ -1503,34 +1504,130 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const size_t size{e.GetTxSize()}, asize{e.GetSizeWithAncestors()}, dsize{e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // fee rate per byte including descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (int i = limits.size() - 1; i >= 0; --i) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        CAmount total_fees = 0; // Track total amount of available fees in mempool\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", \"max\"); // TODO.",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3b2db54fbd3a40ef44a1af28d046f920ef2c9620",
      "in_reply_to_id": null,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think we have the following choices here:\r\n\r\n1. Make it: \"to\": null\r\n2. Represent range with arrays: [1, 2], [2, 3], [3]\r\n3. Remove \"to\"\r\n4. Remove both \"from\" & \"to\"\r\n\r\nI would go with the option 1 or 3.",
      "created_at": "2021-04-11T11:08:38Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r611171247",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611171247"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1550,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611438651",
      "pull_request_review_id": 633282993,
      "id": 611438651,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTQzODY1MQ==",
      "diff_hunk": "@@ -1503,34 +1504,130 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const size_t size{e.GetTxSize()}, asize{e.GetSizeWithAncestors()}, dsize{e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // fee rate per byte including descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 41,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "3b2db54fbd3a40ef44a1af28d046f920ef2c9620",
      "in_reply_to_id": 604793435,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is useful #12118 to understand how txs are sorted in mempool.",
      "created_at": "2021-04-12T08:44:39Z",
      "updated_at": "2021-04-18T11:12:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r611438651",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611438651"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 1523,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1671,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/644739703",
      "pull_request_review_id": 675206546,
      "id": 644739703,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NDczOTcwMw==",
      "diff_hunk": "@@ -1545,34 +1546,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const size_t size{e.GetTxSize()}, asize{e.GetSizeWithAncestors()}, dsize{e.GetSizeWithDescendants()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "ce1bf409274a1156eb5644e468b3951cbb6e7c1e",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "tx size is limited to uint32_t on all platforms on master\r\n\r\n```suggestion\r\n            const uint32_t size{e.GetTxSize()}, asize{e.GetSizeWithAncestors()}, dsize{e.GetSizeWithDescendants()};\r\n```",
      "created_at": "2021-06-03T12:13:26Z",
      "updated_at": "2021-06-03T12:13:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r644739703",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/644739703"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1563,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/645025479",
      "pull_request_review_id": 675594028,
      "id": 645025479,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NTAyNTQ3OQ==",
      "diff_hunk": "@@ -1545,34 +1546,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const size_t size{e.GetTxSize()}, asize{e.GetSizeWithAncestors()}, dsize{e.GetSizeWithDescendants()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "ce1bf409274a1156eb5644e468b3951cbb6e7c1e",
      "in_reply_to_id": 644739703,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thank you, I have tried to address that to avoid subsequent narrowing warnings.\r\n\r\nEdit: Any guidance on how to fix this correctly would be greatly appreaciated. ",
      "created_at": "2021-06-03T18:13:30Z",
      "updated_at": "2021-06-03T20:43:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r645025479",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/645025479"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1563,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654597871",
      "pull_request_review_id": 687628439,
      "id": 654597871,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDU5Nzg3MQ==",
      "diff_hunk": "@@ -1646,34 +1647,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why are you downgrading these to `uint32_t`?",
      "created_at": "2021-06-18T17:55:40Z",
      "updated_at": "2021-06-19T21:46:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654597871",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654597871"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1663,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654600168",
      "pull_request_review_id": 687628439,
      "id": 654600168,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDYwMDE2OA==",
      "diff_hunk": "@@ -1646,34 +1647,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (int i = limits.size() - 1; i >= 0; --i) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 46,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should probably check for overflow explicitly if you use `int` here.\r\n\r\nOr something like:\r\n```suggestion\r\n            for (size_t i = limits.size(); i-- > 0; ) {\r\n```",
      "created_at": "2021-06-18T18:00:24Z",
      "updated_at": "2021-06-19T21:46:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654600168",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654600168"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1675,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654842428",
      "pull_request_review_id": 687628439,
      "id": 654842428,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDg0MjQyOA==",
      "diff_hunk": "@@ -149,6 +149,7 @@ static const CRPCConvertParam vRPCConvertParams[] =\n     { \"pruneblockchain\", 0, \"height\" },\n     { \"keypoolrefill\", 0, \"newsize\" },\n     { \"getrawmempool\", 0, \"verbose\" },\n+    { \"getmempoolinfo\", 0, \"fee_histogram\" },",
      "path": "src/rpc/client.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This shouldn't interrupt `getrawmempool`...",
      "created_at": "2021-06-19T21:32:02Z",
      "updated_at": "2021-06-19T21:46:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654842428",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654842428"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 176,
      "original_line": 176,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654842629",
      "pull_request_review_id": 687628439,
      "id": 654842629,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDg0MjYyOQ==",
      "diff_hunk": "@@ -0,0 +1,117 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        node.generate(102)\n+\n+        # We have two utxos and we do this:\n+        #\n+        # coinbase-tx-101 <- tx1 (5 sat/vB) <- tx2 (14 sat/vB) <----\\\n+        # coinbase-tx-102 <--------------------------------------- tx3 (6 sat/vB)\n+\n+        self.log.info(\"Test getmempoolinfo does not return fee histogram by default\")\n+        assert_no_key('fee_histogram', node.getmempoolinfo())\n+\n+        self.log.info(\"Test getmempoolinfo returns empty fee histogram when mempool is empty\")\n+        info = node.getmempoolinfo([1, 2, 3])\n+        (non_empty_groups, empty_groups, total_fees) = self.histogram_stats(info['fee_histogram'])\n+        assert_equal(0, non_empty_groups)\n+        assert_equal(3, empty_groups)\n+        assert_equal(0, total_fees)\n+\n+        self.log.info(\"Test that we have two spendable utxos and lock the second one\")\n+        utxos = node.listunspent()\n+        assert_equal(2, len(utxos))\n+        node.lockunspent(False, [{\"txid\": utxos[1][\"txid\"], \"vout\": utxos[1][\"vout\"]}])\n+\n+        self.log.info(\"Send tx1 transaction with 5 sat/vB fee rate\")\n+        node.sendtoaddress(address=node.getnewaddress(), amount=Decimal(\"50.0\"), fee_rate=5, subtractfeefromamount=True)\n+\n+        self.log.info(\"Test fee rate histogram when mempool contains 1 transaction (tx1: 5 sat/vB)\")\n+        info = node.getmempoolinfo([1, 3, 5, 10])\n+        (non_empty_groups, empty_groups, total_fees) = self.histogram_stats(info['fee_histogram'])\n+        assert_equal(1, non_empty_groups)\n+        assert_equal(3, empty_groups)\n+        assert_equal(1, info['fee_histogram']['fee_rate_groups']['5']['count'])\n+        assert_equal(total_fees, info['fee_histogram']['total_fees'])\n+\n+        self.log.info(\"Send tx2 transaction with 14 sat/vB fee rate (spends tx1 utxo)\")\n+        node.sendtoaddress(address=node.getnewaddress(), amount=Decimal(\"25.0\"), fee_rate=14)\n+\n+        self.log.info(\"Test fee rate histogram when mempool contains 2 transactions (tx1: 5 sat/vB, tx2: 14 sat/vB)\")\n+        info = node.getmempoolinfo([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15])\n+\n+        # Both tx1 and tx2 are supposed to be reported in 8 sat/vB fee rate group\n+        (non_empty_groups, empty_groups, total_fees) = self.histogram_stats(info['fee_histogram'])\n+        assert_equal(1, non_empty_groups)\n+        assert_equal(14, empty_groups)\n+        assert_equal(2, info['fee_histogram']['fee_rate_groups']['8']['count'])\n+        assert_equal(total_fees, info['fee_histogram']['total_fees'])\n+\n+        # Unlock the second UTXO which we locked\n+        node.lockunspent(True, [{\"txid\": utxos[1][\"txid\"], \"vout\": utxos[1][\"vout\"]}])\n+\n+        self.log.info(\"Send tx3 transaction with 6 sat/vB fee rate (spends all available utxos)\")\n+        node.sendtoaddress(address=node.getnewaddress(), amount=Decimal(\"99.9\"), fee_rate=6)\n+\n+        self.log.info(\"Test fee rate histogram when mempool contains 3 transactions (tx1: 5 sat/vB, tx2: 14 sat/vB, tx3: 6 sat/vB)\")\n+        info = node.getmempoolinfo([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15])\n+\n+        # Verify that each of 6, 7 and 8 sat/vB fee rate groups contain one transaction\n+        (non_empty_groups, empty_groups, total_fees) = self.histogram_stats(info['fee_histogram'])\n+        assert_equal(3, non_empty_groups)\n+        assert_equal(12, empty_groups)\n+        assert_equal(1, info['fee_histogram']['fee_rate_groups']['6']['count'])\n+        assert_equal(1, info['fee_histogram']['fee_rate_groups']['7']['count'])\n+        assert_equal(1, info['fee_histogram']['fee_rate_groups']['8']['count'])\n+        assert_equal(total_fees, info['fee_histogram']['total_fees'])\n+\n+\n+    def histogram_stats(self, histogram):\n+        total_fees = 0\n+        empty_count = 0\n+        non_empty_count = 0\n+\n+        for key, bin in histogram['fee_rate_groups'].items():",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": 146,
      "original_position": 97,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is `bin` reserved in Python?",
      "created_at": "2021-06-19T21:34:33Z",
      "updated_at": "2021-06-19T21:46:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654842629",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654842629"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 146,
      "original_line": 146,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654844704",
      "pull_request_review_id": 687852918,
      "id": 654844704,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDg0NDcwNA==",
      "diff_hunk": "@@ -41,8 +41,10 @@ void RPCNotifyBlockChange(const CBlockIndex*);\n /** Block description to JSON */\n UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails = false) LOCKS_EXCLUDED(cs_main);\n \n+typedef std::vector<CAmount> MempoolHistogramFeeRates;\n+\n /** Mempool information to JSON */\n-UniValue MempoolInfoToJSON(const CTxMemPool& pool);\n+UniValue MempoolInfoToJSON(const CTxMemPool& pool, const std::optional<MempoolHistogramFeeRates> feeLimits);",
      "path": "src/rpc/blockchain.h",
      "position": null,
      "original_position": 8,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Need to `#include <optional>` in this header",
      "created_at": "2021-06-19T21:57:35Z",
      "updated_at": "2021-06-19T21:57:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654844704",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654844704"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 48,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654894740",
      "pull_request_review_id": 687878515,
      "id": 654894740,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDg5NDc0MA==",
      "diff_hunk": "@@ -0,0 +1,117 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        node.generate(102)\n+\n+        # We have two utxos and we do this:\n+        #\n+        # coinbase-tx-101 <- tx1 (5 sat/vB) <- tx2 (14 sat/vB) <----\\\n+        # coinbase-tx-102 <--------------------------------------- tx3 (6 sat/vB)\n+\n+        self.log.info(\"Test getmempoolinfo does not return fee histogram by default\")\n+        assert_no_key('fee_histogram', node.getmempoolinfo())\n+\n+        self.log.info(\"Test getmempoolinfo returns empty fee histogram when mempool is empty\")\n+        info = node.getmempoolinfo([1, 2, 3])\n+        (non_empty_groups, empty_groups, total_fees) = self.histogram_stats(info['fee_histogram'])\n+        assert_equal(0, non_empty_groups)\n+        assert_equal(3, empty_groups)\n+        assert_equal(0, total_fees)\n+\n+        self.log.info(\"Test that we have two spendable utxos and lock the second one\")\n+        utxos = node.listunspent()\n+        assert_equal(2, len(utxos))\n+        node.lockunspent(False, [{\"txid\": utxos[1][\"txid\"], \"vout\": utxos[1][\"vout\"]}])\n+\n+        self.log.info(\"Send tx1 transaction with 5 sat/vB fee rate\")\n+        node.sendtoaddress(address=node.getnewaddress(), amount=Decimal(\"50.0\"), fee_rate=5, subtractfeefromamount=True)\n+\n+        self.log.info(\"Test fee rate histogram when mempool contains 1 transaction (tx1: 5 sat/vB)\")\n+        info = node.getmempoolinfo([1, 3, 5, 10])\n+        (non_empty_groups, empty_groups, total_fees) = self.histogram_stats(info['fee_histogram'])\n+        assert_equal(1, non_empty_groups)\n+        assert_equal(3, empty_groups)\n+        assert_equal(1, info['fee_histogram']['fee_rate_groups']['5']['count'])\n+        assert_equal(total_fees, info['fee_histogram']['total_fees'])\n+\n+        self.log.info(\"Send tx2 transaction with 14 sat/vB fee rate (spends tx1 utxo)\")\n+        node.sendtoaddress(address=node.getnewaddress(), amount=Decimal(\"25.0\"), fee_rate=14)\n+\n+        self.log.info(\"Test fee rate histogram when mempool contains 2 transactions (tx1: 5 sat/vB, tx2: 14 sat/vB)\")\n+        info = node.getmempoolinfo([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15])\n+\n+        # Both tx1 and tx2 are supposed to be reported in 8 sat/vB fee rate group\n+        (non_empty_groups, empty_groups, total_fees) = self.histogram_stats(info['fee_histogram'])\n+        assert_equal(1, non_empty_groups)\n+        assert_equal(14, empty_groups)\n+        assert_equal(2, info['fee_histogram']['fee_rate_groups']['8']['count'])\n+        assert_equal(total_fees, info['fee_histogram']['total_fees'])\n+\n+        # Unlock the second UTXO which we locked\n+        node.lockunspent(True, [{\"txid\": utxos[1][\"txid\"], \"vout\": utxos[1][\"vout\"]}])\n+\n+        self.log.info(\"Send tx3 transaction with 6 sat/vB fee rate (spends all available utxos)\")\n+        node.sendtoaddress(address=node.getnewaddress(), amount=Decimal(\"99.9\"), fee_rate=6)\n+\n+        self.log.info(\"Test fee rate histogram when mempool contains 3 transactions (tx1: 5 sat/vB, tx2: 14 sat/vB, tx3: 6 sat/vB)\")\n+        info = node.getmempoolinfo([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15])\n+\n+        # Verify that each of 6, 7 and 8 sat/vB fee rate groups contain one transaction\n+        (non_empty_groups, empty_groups, total_fees) = self.histogram_stats(info['fee_histogram'])\n+        assert_equal(3, non_empty_groups)\n+        assert_equal(12, empty_groups)\n+        assert_equal(1, info['fee_histogram']['fee_rate_groups']['6']['count'])\n+        assert_equal(1, info['fee_histogram']['fee_rate_groups']['7']['count'])\n+        assert_equal(1, info['fee_histogram']['fee_rate_groups']['8']['count'])\n+        assert_equal(total_fees, info['fee_histogram']['total_fees'])\n+\n+\n+    def histogram_stats(self, histogram):\n+        total_fees = 0\n+        empty_count = 0\n+        non_empty_count = 0\n+\n+        for key, bin in histogram['fee_rate_groups'].items():",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": 146,
      "original_position": 97,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": 654842629,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It is not according to https://docs.python.org/3/reference/lexical_analysis.html#keywords",
      "created_at": "2021-06-20T07:58:12Z",
      "updated_at": "2021-06-20T07:58:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654894740",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654894740"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 146,
      "original_line": 146,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654899586",
      "pull_request_review_id": 687881868,
      "id": 654899586,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDg5OTU4Ng==",
      "diff_hunk": "@@ -149,6 +149,7 @@ static const CRPCConvertParam vRPCConvertParams[] =\n     { \"pruneblockchain\", 0, \"height\" },\n     { \"keypoolrefill\", 0, \"newsize\" },\n     { \"getrawmempool\", 0, \"verbose\" },\n+    { \"getmempoolinfo\", 0, \"fee_histogram\" },",
      "path": "src/rpc/client.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": 654842428,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, thank you.",
      "created_at": "2021-06-20T08:38:38Z",
      "updated_at": "2021-06-20T08:38:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654899586",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654899586"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 176,
      "original_line": 176,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654899601",
      "pull_request_review_id": 687881892,
      "id": 654899601,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDg5OTYwMQ==",
      "diff_hunk": "@@ -41,8 +41,10 @@ void RPCNotifyBlockChange(const CBlockIndex*);\n /** Block description to JSON */\n UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails = false) LOCKS_EXCLUDED(cs_main);\n \n+typedef std::vector<CAmount> MempoolHistogramFeeRates;\n+\n /** Mempool information to JSON */\n-UniValue MempoolInfoToJSON(const CTxMemPool& pool);\n+UniValue MempoolInfoToJSON(const CTxMemPool& pool, const std::optional<MempoolHistogramFeeRates> feeLimits);",
      "path": "src/rpc/blockchain.h",
      "position": null,
      "original_position": 8,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": 654844704,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, thank you.",
      "created_at": "2021-06-20T08:38:47Z",
      "updated_at": "2021-06-20T08:38:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654899601",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654899601"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 48,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654900143",
      "pull_request_review_id": 687882257,
      "id": 654900143,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDkwMDE0Mw==",
      "diff_hunk": "@@ -1646,34 +1647,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (int i = limits.size() - 1; i >= 0; --i) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 46,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": 654600168,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I have applied your suggestion. It is certainly not straightforward though.",
      "created_at": "2021-06-20T08:42:30Z",
      "updated_at": "2021-06-20T08:42:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654900143",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654900143"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1675,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654901418",
      "pull_request_review_id": 687883093,
      "id": 654901418,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NDkwMTQxOA==",
      "diff_hunk": "@@ -1646,34 +1647,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": 654597871,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Your question is probably related to Marco's comment here: https://github.com/bitcoin/bitcoin/pull/21422#discussion_r644739703. And as I said there, any guidance on this would be greatly appreciated.\r\n\r\nEdit: I have rebased this PR so that this PR builds on *tx size is limited to uint32_t on all platforms on master*",
      "created_at": "2021-06-20T08:52:35Z",
      "updated_at": "2021-06-20T08:55:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r654901418",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/654901418"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1663,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687916086",
      "pull_request_review_id": 728853354,
      "id": 687916086,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4NzkxNjA4Ng==",
      "diff_hunk": "@@ -29,6 +29,8 @@\n \n #include <univalue.h>\n \n+#include <optional>",
      "path": "src/rest.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "36f5e224f5f555ed68d373f0c1ee739ff6d4bf46",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This should be above, after &lt;any&gt;",
      "created_at": "2021-08-12T16:46:38Z",
      "updated_at": "2021-08-12T16:46:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r687916086",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687916086"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687939272",
      "pull_request_review_id": 728883855,
      "id": 687939272,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4NzkzOTI3Mg==",
      "diff_hunk": "@@ -1545,34 +1546,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const size_t size{e.GetTxSize()}, asize{e.GetSizeWithAncestors()}, dsize{e.GetSizeWithDescendants()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "ce1bf409274a1156eb5644e468b3951cbb6e7c1e",
      "in_reply_to_id": 644739703,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Putting such an assumption here is unnecessarily bug-prone for no benefit. All the functions involved return 64-bit types, so should not be truncated. Furthermore, GetSizeWith* may very well include multiple transactions. `size_t` is the right type here IMO.",
      "created_at": "2021-08-12T17:18:58Z",
      "updated_at": "2021-08-12T17:18:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r687939272",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687939272"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1563,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688278205",
      "pull_request_review_id": 729304206,
      "id": 688278205,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODI3ODIwNQ==",
      "diff_hunk": "@@ -29,6 +29,8 @@\n \n #include <univalue.h>\n \n+#include <optional>",
      "path": "src/rest.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "36f5e224f5f555ed68d373f0c1ee739ff6d4bf46",
      "in_reply_to_id": 687916086,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, thank you.",
      "created_at": "2021-08-13T06:36:12Z",
      "updated_at": "2021-08-13T06:36:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r688278205",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688278205"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689293178",
      "pull_request_review_id": 730396365,
      "id": 689293178,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTI5MzE3OA==",
      "diff_hunk": "@@ -1545,34 +1546,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const size_t size{e.GetTxSize()}, asize{e.GetSizeWithAncestors()}, dsize{e.GetSizeWithDescendants()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "ce1bf409274a1156eb5644e468b3951cbb6e7c1e",
      "in_reply_to_id": 644739703,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Putting such an assumption here is unnecessarily bug-prone for no benefit.\r\n\r\nThen #21848 should be reverted first. Otherwise using size_t here is compiled down to the same code anyway.",
      "created_at": "2021-08-16T07:20:51Z",
      "updated_at": "2021-08-16T07:20:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r689293178",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689293178"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1563,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754233659",
      "pull_request_review_id": 812481523,
      "id": 754233659,
      "node_id": "PRRC_kwDOABII584s9LE7",
      "diff_hunk": "@@ -41,8 +42,10 @@ void RPCNotifyBlockChange(const CBlockIndex*);\n /** Block description to JSON */\n UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails = false) LOCKS_EXCLUDED(cs_main);\n \n+typedef std::vector<CAmount> MempoolHistogramFeeRates;",
      "path": "src/rpc/blockchain.h",
      "position": null,
      "original_position": 12,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: I guess  `CAmount` works here, but the values actually represent a feerate (∈ N*) and not an [`/** Amount in satoshis (Can be negative) */`](https://github.com/bitcoin/bitcoin/blob/95d19f8c1a40a7531d2bb00febd245d127293a64/src/consensus/amount.h#L11).\r\n\r\nMaybe?\r\n ```suggestion\r\ntypedef std::vector<uint64_t> MempoolHistogramFeeRates;\r\n```\r\n\r\nFeel free to ignore this though.",
      "created_at": "2021-11-22T12:37:55Z",
      "updated_at": "2021-11-22T16:50:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754233659",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754233659"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754275234",
      "pull_request_review_id": 812481523,
      "id": 754275234,
      "node_id": "PRRC_kwDOABII584s9VOi",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 105,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think `/kvB` was mistakenly added here and should be dropped. `total_fee` is not a feerate. Do you know if this was meant to be added somewhere else?",
      "created_at": "2021-11-22T13:24:58Z",
      "updated_at": "2021-11-22T16:50:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754275234",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754275234"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1731,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754286176",
      "pull_request_review_id": 812542880,
      "id": 754286176,
      "node_id": "PRRC_kwDOABII584s9X5g",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid number of parameters\");\n+        }\n+\n+        for (size_t i = 0; i < feelimits_univalue.size(); ++i) {\n+            int64_t value = feelimits_univalue[i].get_int64();\n+\n+            if (value < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Non-negative values are expected\");\n+            } else if (i > 0 && feelimits.back() >= value) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 152,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What's the reason for this `i > 0` here?",
      "created_at": "2021-11-22T13:37:15Z",
      "updated_at": "2021-11-22T13:37:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754286176",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754286176"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1767,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754337592",
      "pull_request_review_id": 812615823,
      "id": 754337592,
      "node_id": "PRRC_kwDOABII584s9kc4",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid number of parameters\");\n+        }\n+\n+        for (size_t i = 0; i < feelimits_univalue.size(); ++i) {\n+            int64_t value = feelimits_univalue[i].get_int64();\n+\n+            if (value < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Non-negative values are expected\");\n+            } else if (i > 0 && feelimits.back() >= value) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 152,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754286176,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "So you take one value at a time and compare it with the previous one to make sure that the sequence is an increasing one. For `i == 0`, you don't have any previous value to compare with.",
      "created_at": "2021-11-22T14:37:28Z",
      "updated_at": "2021-11-22T14:37:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754337592",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754337592"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1767,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754361619",
      "pull_request_review_id": 812481523,
      "id": 754361619,
      "node_id": "PRRC_kwDOABII584s9qUT",
      "diff_hunk": "@@ -0,0 +1,117 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        node.generate(102)\n+\n+        # We have two utxos and we do this:\n+        #\n+        # coinbase-tx-101 <- tx1 (5 sat/vB) <- tx2 (14 sat/vB) <----\\\n+        # coinbase-tx-102 <--------------------------------------- tx3 (6 sat/vB)",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 32,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "These are the coinbase transactions for block 1 and block 2 not block 101 and block 102. The coinbase utxos for block 101 and block 102 aren't mature. However, I don't think it's important that the UTXOs are Coinbase UTXOs.\r\n\r\nI found the ASCII art to be harder/took longer to understand than e.g. a comment like:\r\n\r\n```\r\n We have two UTXOs (utxo_1 and utxo_2) and create three changeless transactions:\r\n - tx1 (5 sat/vB): spending utxo_1\r\n - tx2 (14 sat/vB): spending output from tx1\r\n - tx3 (6 sat/vB): spending utxo_2 and the output from tx2 \r\n```",
      "created_at": "2021-11-22T15:02:19Z",
      "updated_at": "2021-11-22T16:50:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754361619",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754361619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 29,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754375897",
      "pull_request_review_id": 812481523,
      "id": 754375897,
      "node_id": "PRRC_kwDOABII584s9tzZ",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 143,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is there a reason to limit this to specifically 30? \r\n\r\nIf there is, I think it should be a constant and it should be tested. \r\n\r\nIf not, I could image someone might want to use this with `[1, 2, 3, ..., 9999, 10000]` (or even more).",
      "created_at": "2021-11-22T15:17:04Z",
      "updated_at": "2021-11-22T16:50:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754375897",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754375897"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1758,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754423967",
      "pull_request_review_id": 812481523,
      "id": 754423967,
      "node_id": "PRRC_kwDOABII584s95if",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 117,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: could add\r\n```suggestion\r\n                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\r\n```",
      "created_at": "2021-11-22T16:06:41Z",
      "updated_at": "2021-11-22T16:50:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754423967",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754423967"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1742,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754425604",
      "pull_request_review_id": 812481523,
      "id": 754425604,
      "node_id": "PRRC_kwDOABII584s958E",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 123,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`total_fees` is not a feerate.\r\n```suggestion\r\n                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \")\"},\r\n```",
      "created_at": "2021-11-22T16:08:26Z",
      "updated_at": "2021-11-22T16:50:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754425604",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754425604"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754427248",
      "pull_request_review_id": 812738675,
      "id": 754427248,
      "node_id": "PRRC_kwDOABII584s96Vw",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid number of parameters\");\n+        }\n+\n+        for (size_t i = 0; i < feelimits_univalue.size(); ++i) {\n+            int64_t value = feelimits_univalue[i].get_int64();\n+\n+            if (value < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Non-negative values are expected\");\n+            } else if (i > 0 && feelimits.back() >= value) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 152,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754286176,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Perfect. Thank you.",
      "created_at": "2021-11-22T16:10:16Z",
      "updated_at": "2021-11-22T16:10:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754427248",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754427248"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1767,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754435154",
      "pull_request_review_id": 812749707,
      "id": 754435154,
      "node_id": "PRRC_kwDOABII584s98RS",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid number of parameters\");\n+        }\n+\n+        for (size_t i = 0; i < feelimits_univalue.size(); ++i) {\n+            int64_t value = feelimits_univalue[i].get_int64();\n+\n+            if (value < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Non-negative values are expected\");\n+            } else if (i > 0 && feelimits.back() >= value) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Strictly increasing values are expected\");\n+            }\n+\n+            feelimits.push_back(value);\n+        }\n+        feelimits_opt = std::optional<MempoolHistogramFeeRates>(feelimits);",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 158,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Using `std::move(feelimits)` will avoid a vector copy. Same with the `MempoolInfoToJSON` call below.",
      "created_at": "2021-11-22T16:19:21Z",
      "updated_at": "2021-11-22T16:30:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754435154",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754435154"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1780,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754436963",
      "pull_request_review_id": 812749707,
      "id": 754436963,
      "node_id": "PRRC_kwDOABII584s98tj",
      "diff_hunk": "@@ -1646,34 +1647,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": 654597871,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why not use uint64_t for everything? `GetSizeWithAncestors()` returns a uint64_t too.",
      "created_at": "2021-11-22T16:21:23Z",
      "updated_at": "2021-11-22T16:30:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754436963",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754436963"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1663,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754438676",
      "pull_request_review_id": 812749707,
      "id": 754438676,
      "node_id": "PRRC_kwDOABII584s99IU",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think using ancestor feerates here is going to distort the result, because multiple transactions can have shared ancestors. Using descendant feerates is even more questionable to me, as they don't matter for transaction selection in blocks at all.\r\n\r\nImagine a situation with 3 transactions (example due to @Xekyo): one parent at 1 sat/vbyte, with two children each at 7 sat/vbyte, with all transactions the same size. The current code will classify the parent at 5 sat/vbyte, and the children each at 4 sat/vbyte. That's not accurate; e.g. the (weight-weighted) average of the reported feerates is 4.33, while the real average is 5, so this doesn't reflect the actual state of the mempool. It also doesn't correspond to the decisions actually made by miners, which with the current CPFP code would consider first a package of 1 parent + 1 child at 4 sat/vbyte, and then another child at 7 sat/vbyte.\r\n\r\nMy suggestion would be either:\r\n* (1) use only transaction feerates directly (no ancestors/descendants), and have a result that ignores CPFP-like mechanics. \r\n* (2) invoke the mining code to actually build a giant \"block\" from the entire mempool (ignoring weight limits), and have it report the feerates of its included packages (which are similar to what you'd get with ancestor fees/sizes, but is guaranteed not to count any transaction twice).",
      "created_at": "2021-11-22T16:23:10Z",
      "updated_at": "2021-11-22T18:37:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754438676",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754438676"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1667,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754449922",
      "pull_request_review_id": 812481523,
      "id": 754449922,
      "node_id": "PRRC_kwDOABII584s9_4C",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: my definition of feerate is `fee per size`. This doesn't really work with `fee rate per byte` as it would be a `fee per size per size`? Also not sure about variable names like `afpb` and `dfpb`. Why not just spell it out as e.g. `ancestor_feerate` and `descendant_feerate`?\r\n\r\n\r\n(I'm assuming `tfpb` means `total_feerate`?)\r\n\r\n```suggestion\r\n            const CAmount fee{e.GetFee()}, ancestor_fees{e.GetModFeesWithAncestors()}, descendant_fees{e.GetModFeesWithDescendants()};\r\n            const uint32_t size{(uint32_t)e.GetTxSize()}, ancestor_size{(uint32_t)e.GetSizeWithAncestors()}, descendant_size{(uint32_t)e.GetSizeWithDescendants()};\r\n\r\n            const CAmount feerate{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\r\n            const CAmount ancestor_feerate{CFeeRate{ancestor_fees, ancestor_size}.GetFee(1)}; // Fee rate per byte including ancestors\r\n            const CAmount descendant_feerate{CFeeRate{descendant_fees, descendant_size}.GetFee(1)}; // Fee rate per byte including descendants\r\n\r\n            // Fee rate per byte including ancestors & descendants\r\n            const CAmount total_feerate{CFeeRate{ancestor_fees + descendant_fees - fee, ancestor_size + descendant_size - size}.GetFee(1)};\r\n            const CAmount feerate{std::max(std::min(descendant_feerate, total_feerate), std::min(feerate, ancestor_feerate))};\r\n```",
      "created_at": "2021-11-22T16:35:24Z",
      "updated_at": "2021-11-22T16:50:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754449922",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754449922"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 1662,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1671,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754451768",
      "pull_request_review_id": 812481523,
      "id": 754451768,
      "node_id": "PRRC_kwDOABII584s-AU4",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Can you explain these two lines?\r\n\r\n```C++\r\n1670    const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\r\n1671    const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\r\n```",
      "created_at": "2021-11-22T16:37:32Z",
      "updated_at": "2021-11-22T16:50:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754451768",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754451768"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 1670,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1671,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754535552",
      "pull_request_review_id": 812885610,
      "id": 754535552,
      "node_id": "PRRC_kwDOABII584s-UyA",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 119,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": null,
      "user": {
        "login": "Xekyo",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Xekyo",
        "html_url": "https://github.com/Xekyo",
        "followers_url": "https://api.github.com/users/Xekyo/followers",
        "following_url": "https://api.github.com/users/Xekyo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Xekyo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Xekyo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Xekyo/subscriptions",
        "organizations_url": "https://api.github.com/users/Xekyo/orgs",
        "repos_url": "https://api.github.com/users/Xekyo/repos",
        "events_url": "https://api.github.com/users/Xekyo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Xekyo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This also sounds like a fee not a feerate, i.e. should not have a `/vB`.",
      "created_at": "2021-11-22T18:28:14Z",
      "updated_at": "2021-11-22T18:45:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754535552",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754535552"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754541557",
      "pull_request_review_id": 812885610,
      "id": 754541557,
      "node_id": "PRRC_kwDOABII584s-WP1",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754451768,
      "user": {
        "login": "Xekyo",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Xekyo",
        "html_url": "https://github.com/Xekyo",
        "followers_url": "https://api.github.com/users/Xekyo/followers",
        "following_url": "https://api.github.com/users/Xekyo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Xekyo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Xekyo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Xekyo/subscriptions",
        "organizations_url": "https://api.github.com/users/Xekyo/orgs",
        "repos_url": "https://api.github.com/users/Xekyo/repos",
        "events_url": "https://api.github.com/users/Xekyo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Xekyo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm confused by these as well.\r\n\r\nThis breaks down when there are multiple descendants or ancestors in various scenarios (all txs assumed to be same size). \r\n\r\nIf you e.g. had a parent transaction paying 5 sat/vB that had a child paying 1 sat/vB, the child would be irrelevant for the parent's effective feerate and vice versa. If you however have a parent paying 3 sat/vB, and two children where one pays 5 sat/vB and one pays 1 sat/vB. The one with the 5 sat/vB would form a CPFP situation with the parent, while the other child would be effectively unrelated: since the parent's feerate is larger than the child's, the ancestor will be included before the child independently. Only children pay for parents, parents don't pay for children in this case. ;)\r\n\r\nBeyond that, many transactions will have overlapping ancestries or descendants, which means that the bucketing across the complete graph of related transactions would often count related txs multiple times, e.g. where a parent paying 3 sat/vB has two children paying 4 sat/vB and 7 sat/vB, only the latter will form a CPFP and the parent will already be included when the child with 4 sat/vB is up for transaction selection.",
      "created_at": "2021-11-22T18:37:23Z",
      "updated_at": "2021-11-22T18:45:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754541557",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754541557"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 1670,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1671,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754603944",
      "pull_request_review_id": 812977683,
      "id": 754603944,
      "node_id": "PRRC_kwDOABII584s-leo",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754438676,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> I think using ancestor feerates here is going to distort the result, because multiple transactions can have shared ancestors. Using descendant feerates is even more questionable to me, as they don't matter for transaction selection in blocks at all.\r\n\r\nSo I have adopted #15836 and did some modifications but I left L1665-L1667 as they were in the original PR because I was not sure why it was implemented that way. My attempts to contact the original author were unsuccessful for me to understand the motivation. Anyway, I knew back then that I didn't have a good explanation for the lines ... evidently rightly so. I should have added a comment warning about this though, that's my mistake, sorry for that.\r\n\r\nThank you for the analysis and the suggestions. I'll try to address the issue.",
      "created_at": "2021-11-22T20:15:25Z",
      "updated_at": "2021-11-22T20:15:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754603944",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754603944"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1667,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754606100",
      "pull_request_review_id": 812980597,
      "id": 754606100,
      "node_id": "PRRC_kwDOABII584s-mAU",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754451768,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I can only say this: https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754603944 and that I will try to fix it.",
      "created_at": "2021-11-22T20:19:07Z",
      "updated_at": "2021-11-22T20:19:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754606100",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754606100"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 1670,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1671,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754644262",
      "pull_request_review_id": 813031121,
      "id": 754644262,
      "node_id": "PRRC_kwDOABII584s-vUm",
      "diff_hunk": "@@ -1630,7 +1631,7 @@ static RPCHelpMan getchaintips()\n     };\n }\n \n-UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n+UniValue MempoolInfoToJSON(const CTxMemPool& pool, const std::optional<MempoolHistogramFeeRates> feeLimits)",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`feeLimits` seems like a confusing name for this - maybe change to e.g. `histogramFloors`?",
      "created_at": "2021-11-22T21:22:26Z",
      "updated_at": "2021-11-23T15:10:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754644262",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754644262"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1634,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754688921",
      "pull_request_review_id": 813031121,
      "id": 754688921,
      "node_id": "PRRC_kwDOABII584s-6OZ",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 137,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`feeLimits` also a confusing name here (see comment above)",
      "created_at": "2021-11-22T22:42:08Z",
      "updated_at": "2021-11-23T15:10:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754688921",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754688921"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1752,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754859474",
      "pull_request_review_id": 813301588,
      "id": 754859474,
      "node_id": "PRRC_kwDOABII584s_j3S",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 105,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754275234,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think it was originally suggested here: https://github.com/bitcoin/bitcoin/pull/21422#pullrequestreview-621285483 but you are right. I will drop it. Thank you.",
      "created_at": "2021-11-23T07:41:20Z",
      "updated_at": "2021-11-23T07:41:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754859474",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754859474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1731,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754862170",
      "pull_request_review_id": 813305199,
      "id": 754862170,
      "node_id": "PRRC_kwDOABII584s_kha",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 117,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754423967,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks",
      "created_at": "2021-11-23T07:46:38Z",
      "updated_at": "2021-11-23T07:46:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754862170",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754862170"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1742,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754863243",
      "pull_request_review_id": 813306554,
      "id": 754863243,
      "node_id": "PRRC_kwDOABII584s_kyL",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 123,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754425604,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, thank you.\r\n\r\n(https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754859474)",
      "created_at": "2021-11-23T07:48:36Z",
      "updated_at": "2021-11-23T07:48:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754863243",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754863243"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754864922",
      "pull_request_review_id": 813308852,
      "id": 754864922,
      "node_id": "PRRC_kwDOABII584s_lMa",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 119,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754535552,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, thanks.",
      "created_at": "2021-11-23T07:51:53Z",
      "updated_at": "2021-11-23T07:51:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754864922",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754864922"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754867510",
      "pull_request_review_id": 813312386,
      "id": 754867510,
      "node_id": "PRRC_kwDOABII584s_l02",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 143,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754375897,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The idea behind the limit was that I didn't want to let it be unbounded (`MempoolInfoToJSON` acquires `pool.cs` lock). If this is not a concern, I can remove the check or I can increase it substantially. \r\n\r\nI'm not sure what option is better really.",
      "created_at": "2021-11-23T07:56:37Z",
      "updated_at": "2021-11-23T07:56:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754867510",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754867510"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1758,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754906415",
      "pull_request_review_id": 813364663,
      "id": 754906415,
      "node_id": "PRRC_kwDOABII584s_vUv",
      "diff_hunk": "@@ -0,0 +1,117 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        node.generate(102)\n+\n+        # We have two utxos and we do this:\n+        #\n+        # coinbase-tx-101 <- tx1 (5 sat/vB) <- tx2 (14 sat/vB) <----\\\n+        # coinbase-tx-102 <--------------------------------------- tx3 (6 sat/vB)",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 32,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754361619,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The text is more clear. Thanks.\r\n\r\n(A *nicer* diagram would be even more clear ... :))",
      "created_at": "2021-11-23T08:55:02Z",
      "updated_at": "2021-11-23T08:55:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754906415",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754906415"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 29,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755026497",
      "pull_request_review_id": 813526690,
      "id": 755026497,
      "node_id": "PRRC_kwDOABII584tAMpB",
      "diff_hunk": "@@ -0,0 +1,119 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        node.generate(COINBASE_MATURITY + 2)",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 28,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "47b5c3e03a71bb4c51e4948effec2a12943a7071",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Test is failing here. `TypeError: generatetoaddress() missing 1 required keyword-only argument: 'invalid_call'`. I think there is something wrong with the implementation of this function in `test_node` and I don't see any other test calling `generate` from node, I will take a look on it. But I think you can use `generatetoaddress` from `test_framework`. ",
      "created_at": "2021-11-23T11:19:12Z",
      "updated_at": "2021-11-23T11:19:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755026497",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755026497"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755055504",
      "pull_request_review_id": 813565730,
      "id": 755055504,
      "node_id": "PRRC_kwDOABII584tATuQ",
      "diff_hunk": "@@ -0,0 +1,119 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        node.generate(COINBASE_MATURITY + 2)",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 28,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "47b5c3e03a71bb4c51e4948effec2a12943a7071",
      "in_reply_to_id": 755026497,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, that's also a reason why I converted the PR to a draft. I have done as much as I could today. I will continue tomorrow.\r\n\r\nedit: Any help is certainly welcome. :)\r\n\r\nedit 2: It might be so that master branch has merged a PR that modifies this. I vaguely remember that I have seen a PR like that. If so, then rebase + fixing the call would do the trick probably.",
      "created_at": "2021-11-23T12:00:11Z",
      "updated_at": "2021-11-23T12:08:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755055504",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755055504"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755222173",
      "pull_request_review_id": 813031121,
      "id": 755222173,
      "node_id": "PRRC_kwDOABII584tA8ad",
      "diff_hunk": "@@ -56,6 +56,11 @@ def assert_greater_than(thing1, thing2):\n         raise AssertionError(\"%s <= %s\" % (str(thing1), str(thing2)))\n \n \n+def assert_no_key(key, dictionary):",
      "path": "test/functional/test_framework/util.py",
      "position": null,
      "original_position": 4,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "47b5c3e03a71bb4c51e4948effec2a12943a7071",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is this necessary? Can't just write `assert(key not in dict)` inline?",
      "created_at": "2021-11-23T15:09:01Z",
      "updated_at": "2021-11-23T15:10:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755222173",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755222173"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755402684",
      "pull_request_review_id": 814038308,
      "id": 755402684,
      "node_id": "PRRC_kwDOABII584tBoe8",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754438676,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@kiminuo Just in case it needs to be said: no need to apologize for trying to improve things. The final state of the code is everyone's responsibility; developers and reviewers.",
      "created_at": "2021-11-23T18:27:26Z",
      "updated_at": "2021-11-23T19:58:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755402684",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755402684"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1667,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755458122",
      "pull_request_review_id": 814113307,
      "id": 755458122,
      "node_id": "PRRC_kwDOABII584tB2BK",
      "diff_hunk": "@@ -56,6 +56,11 @@ def assert_greater_than(thing1, thing2):\n         raise AssertionError(\"%s <= %s\" % (str(thing1), str(thing2)))\n \n \n+def assert_no_key(key, dictionary):",
      "path": "test/functional/test_framework/util.py",
      "position": null,
      "original_position": 4,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "47b5c3e03a71bb4c51e4948effec2a12943a7071",
      "in_reply_to_id": 755222173,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It is not. Good idea. Thanks.",
      "created_at": "2021-11-23T19:52:44Z",
      "updated_at": "2021-11-23T19:52:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755458122",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755458122"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755459841",
      "pull_request_review_id": 814115591,
      "id": 755459841,
      "node_id": "PRRC_kwDOABII584tB2cB",
      "diff_hunk": "@@ -1630,7 +1631,7 @@ static RPCHelpMan getchaintips()\n     };\n }\n \n-UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n+UniValue MempoolInfoToJSON(const CTxMemPool& pool, const std::optional<MempoolHistogramFeeRates> feeLimits)",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754644262,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, makes sense.",
      "created_at": "2021-11-23T19:55:27Z",
      "updated_at": "2021-11-23T19:55:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755459841",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755459841"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1634,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755462169",
      "pull_request_review_id": 814118761,
      "id": 755462169,
      "node_id": "PRRC_kwDOABII584tB3AZ",
      "diff_hunk": "@@ -0,0 +1,119 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        node.generate(COINBASE_MATURITY + 2)",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 28,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "47b5c3e03a71bb4c51e4948effec2a12943a7071",
      "in_reply_to_id": 755026497,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Rebased because of #23300.",
      "created_at": "2021-11-23T19:59:12Z",
      "updated_at": "2021-11-23T19:59:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755462169",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755462169"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755473318",
      "pull_request_review_id": 814134213,
      "id": 755473318,
      "node_id": "PRRC_kwDOABII584tB5um",
      "diff_hunk": "@@ -41,8 +42,10 @@ void RPCNotifyBlockChange(const CBlockIndex*);\n /** Block description to JSON */\n UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails = false) LOCKS_EXCLUDED(cs_main);\n \n+typedef std::vector<CAmount> MempoolHistogramFeeRates;",
      "path": "src/rpc/blockchain.h",
      "position": null,
      "original_position": 12,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754233659,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It is more complicated because of this line:\r\n\r\n```cpp\r\nconst CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)}; // Fee rate per byte\r\n```\r\n\r\n(https://github.com/bitcoin/bitcoin/pull/21422/files#diff-decae4be02fb8a47ab4557fe74a9cb853bdfa3ec0fa1b515c0a1e5de91f4ad0bR1688)\r\n\r\nI think your suggestion seems reasonable but then I don't really know whether there are some edge cases I don't know about.",
      "created_at": "2021-11-23T20:17:31Z",
      "updated_at": "2021-11-23T20:17:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755473318",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755473318"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755839122",
      "pull_request_review_id": 814614751,
      "id": 755839122,
      "node_id": "PRRC_kwDOABII584tDTCS",
      "diff_hunk": "@@ -1646,34 +1647,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "9d16921553bae5d9a333b08ddbe53596e69d4ed8",
      "in_reply_to_id": 654597871,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Now we have:\r\n\r\n```cpp\r\nconst CAmount fee{e.GetFee()};\r\nconst uint32_t size{(uint32_t)e.GetTxSize()};\r\nconst CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)};\r\n```\r\n\r\n`CFeeRate` has the following constructor: `CFeeRate::CFeeRate(const CAmount& nFeePaid, uint32_t num_bytes)`. If `size` is casted to `uint64_t`, then I will get a warning unless I do some other casting.\r\n\r\nAny suggestion how to improve this?",
      "created_at": "2021-11-24T09:16:21Z",
      "updated_at": "2021-11-24T09:17:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755839122",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755839122"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1663,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755889258",
      "pull_request_review_id": 814682640,
      "id": 755889258,
      "node_id": "PRRC_kwDOABII584tDfRq",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754438676,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@sipa\r\n\r\n> * (1) use only transaction feerates directly (no ancestors/descendants), and have a result that ignores CPFP-like mechanics.\r\n\r\nI have picked (1) approach for now because: I can modify the PR in reasonable time and then it can serve as some sort of baseline. So we can still decide later whether the approach is the best. \r\n\r\nAnyway, there are still questions: \r\n\r\n* Is (2) much better than (1) or not? \r\n* Is there room for having both (1) and (2) possibly?\r\n* (2) seems hard-ish to implement. If that is true, one concern here is whether the additional complexity is worth it. I don't know.\r\n\r\nbtw: I was interested how https://jochen-hoenicke.de/queue/#BTC,24h,fee works and it seems that #15836 was actually heavily inspired by: https://github.com/jhoenicke/mempool/blob/31d8dcb896ebc8139d3e60c3f275b94811293777/mempool_sql.py#L44-L49.",
      "created_at": "2021-11-24T10:14:50Z",
      "updated_at": "2021-11-24T10:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755889258",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755889258"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1667,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755891888",
      "pull_request_review_id": 814686295,
      "id": 755891888,
      "node_id": "PRRC_kwDOABII584tDf6w",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754449922,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> nit: my definition of feerate is `fee per size`. This doesn't really work with `fee rate per byte` as it would be a `fee per size per size`?\r\n\r\nYeah, I have the same definition of fee rate as \"fee per size\".\r\n\r\nI've been trying to align with Sipa's [approach (1)](https://github.com/bitcoin/bitcoin/pull/21422#discussion_r754438676) for now.",
      "created_at": "2021-11-24T10:18:03Z",
      "updated_at": "2021-11-24T10:18:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755891888",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755891888"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 1662,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1671,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755892709",
      "pull_request_review_id": 814687356,
      "id": 755892709,
      "node_id": "PRRC_kwDOABII584tDgHl",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 143,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754375897,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@0xB10C Would it make more sense to have a limit or having no limit? I'm not sure what is preferrable.",
      "created_at": "2021-11-24T10:19:00Z",
      "updated_at": "2021-11-24T10:19:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755892709",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755892709"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1758,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755893412",
      "pull_request_review_id": 814688273,
      "id": 755893412,
      "node_id": "PRRC_kwDOABII584tDgSk",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid number of parameters\");\n+        }\n+\n+        for (size_t i = 0; i < feelimits_univalue.size(); ++i) {\n+            int64_t value = feelimits_univalue[i].get_int64();\n+\n+            if (value < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Non-negative values are expected\");\n+            } else if (i > 0 && feelimits.back() >= value) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Strictly increasing values are expected\");\n+            }\n+\n+            feelimits.push_back(value);\n+        }\n+        feelimits_opt = std::optional<MempoolHistogramFeeRates>(feelimits);",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 158,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754435154,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Hopefully addressed. Thanks.",
      "created_at": "2021-11-24T10:19:53Z",
      "updated_at": "2021-11-24T10:19:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755893412",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755893412"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1780,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755945405",
      "pull_request_review_id": 814745709,
      "id": 755945405,
      "node_id": "PRRC_kwDOABII584tDs-9",
      "diff_hunk": "@@ -0,0 +1,119 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+    assert_no_key,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        node.generate(COINBASE_MATURITY + 2)",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 28,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "47b5c3e03a71bb4c51e4948effec2a12943a7071",
      "in_reply_to_id": 755026497,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Great. #23300 solves it! ",
      "created_at": "2021-11-24T11:09:38Z",
      "updated_at": "2021-11-24T11:09:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r755945405",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755945405"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/756256802",
      "pull_request_review_id": 815157984,
      "id": 756256802,
      "node_id": "PRRC_kwDOABII584tE5Ai",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754438676,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It really depends on the use case for the histogram. If people are trying to make decisions on what fee to use, it's probably better to under-estimate the fee rate of a given transaction (by applying a CPFP logic excessively) than over-estimate it (by ignoring CPFP, etc). Are there other use cases that would be impacted?",
      "created_at": "2021-11-24T16:42:01Z",
      "updated_at": "2021-11-24T16:42:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r756256802",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/756256802"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1667,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/756257689",
      "pull_request_review_id": 815159116,
      "id": 756257689,
      "node_id": "PRRC_kwDOABII584tE5OZ",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754438676,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> * Is (2) much better than (1) or not?\r\n\r\nIt depends on how much CPFP is going on of course in the mempool overall. I think (2) is \"perfect\" in the sense that it exactly answers the question how much vbytes are competing at every feerate level for block space, according to Bitcoin Core's own block building algorithm. But I think (1) is probably a good first approximation.\r\n\r\n> * Is there room for having both (1) and (2) possibly?\r\n\r\nI don't think so. We should just use the best algorithm we have, and I think (2) is strictly better, but obviously a lot more work.\r\n\r\n> * (2) seems hard-ish to implement. If that is true, one concern here is whether the additional complexity is worth it. I don't know.\r\n\r\nIt's certainly more code changes. I'm not sure whether it's worth it, but that discussion can be left to a future improvement too.\r\n\r\nRe: johoe's site using that formula... interesting find. This earlier version of the code has a bit more comments: https://github.com/jhoenicke/mempool/blob/548698d6d255a2e1b7d6f1981403d3de55c2182a/mempool-sql.pl#L30L38. I see where it's coming from now, but I can't imagine that it doesn't add as many inaccuracies as that it improves (see examples above).",
      "created_at": "2021-11-24T16:43:01Z",
      "updated_at": "2021-11-24T16:43:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r756257689",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/756257689"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1667,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/756670249",
      "pull_request_review_id": 815688559,
      "id": 756670249,
      "node_id": "PRRC_kwDOABII584tGd8p",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "6466eb65ad18599c314125d7b62cc317d865f6f7",
      "in_reply_to_id": 754438676,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@luke-jr \r\n\r\n> It really depends on the use case for the histogram. If people are trying to make decisions on what fee to use, it's probably better to under-estimate the fee rate of a given transaction (by applying a CPFP logic excessively) than over-estimate it (by ignoring CPFP, etc).\r\n\r\nFrom practicality point of view, I agree. But I would still like to follow [this plan](https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-978941401) as it converges to the best possible solution.\r\n\r\n@sipa \r\n\r\n> Re: johoe's site using that formula... interesting find. This earlier version of the code has a bit more comments: https://github.com/jhoenicke/mempool/blob/548698d6d255a2e1b7d6f1981403d3de55c2182a/mempool-sql.pl#L30L38. I see where it's coming from now, \r\n\r\nAh, that's good to know. \r\n\r\n> but I can't imagine that it doesn't add as many inaccuracies as that it improves (see examples above).\r\n\r\nWithout thinking about it too deeply, my guess is that one can come up with pathological mempool state cases to force it report bad values. If it behaves ok-ish for real-world mempools, I don't really know. Anyway, https://github.com/bitcoin/bitcoin/pull/21422#issuecomment-978941401 makes sense to me (the worst alternative there is basically that people disagree and then we would chase approach (2) immediately).",
      "created_at": "2021-11-25T08:34:36Z",
      "updated_at": "2021-11-25T08:34:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r756670249",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/756670249"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1667,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757035495",
      "pull_request_review_id": 816182352,
      "id": 757035495,
      "node_id": "PRRC_kwDOABII584tH3Hn",
      "diff_hunk": "@@ -41,8 +42,10 @@ void RPCNotifyBlockChange(const CBlockIndex*);\n /** Block description to JSON */\n UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails = false) LOCKS_EXCLUDED(cs_main);\n \n+typedef std::vector<CAmount> MempoolHistogramFeeRates;",
      "path": "src/rpc/blockchain.h",
      "position": null,
      "original_position": 12,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754233659,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agree, yes. I've tried changing this and it gave me a bunch of warnings. I'd say ignore this comment unless someone else finds this to be problematic.",
      "created_at": "2021-11-25T16:45:00Z",
      "updated_at": "2021-11-25T16:45:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r757035495",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757035495"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757040403",
      "pull_request_review_id": 816188627,
      "id": 757040403,
      "node_id": "PRRC_kwDOABII584tH4UT",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 143,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754375897,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point on the lock.. Can we benchmark the time the RPC takes with 10, 100. 1000, 10000 histogram bins? I think if it scales linear O(n) and somewhere between 10ms or so, then it's fine to have no limit. Users selecting a million bins should expect that this could take a bit longer than only 10 bins.\r\n\r\nI'll see if I can test that.",
      "created_at": "2021-11-25T16:53:16Z",
      "updated_at": "2021-11-25T16:53:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r757040403",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757040403"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1758,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757108924",
      "pull_request_review_id": 816274742,
      "id": 757108924,
      "node_id": "PRRC_kwDOABII584tIJC8",
      "diff_hunk": "@@ -41,8 +42,10 @@ void RPCNotifyBlockChange(const CBlockIndex*);\n /** Block description to JSON */\n UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails = false) LOCKS_EXCLUDED(cs_main);\n \n+typedef std::vector<CAmount> MempoolHistogramFeeRates;",
      "path": "src/rpc/blockchain.h",
      "position": null,
      "original_position": 12,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754233659,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ok!",
      "created_at": "2021-11-25T20:02:39Z",
      "updated_at": "2021-11-25T20:02:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r757108924",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757108924"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114611",
      "pull_request_review_id": 816281698,
      "id": 757114611,
      "node_id": "PRRC_kwDOABII584tIKbz",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 143,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754375897,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/21422/files#diff-decae4be02fb8a47ab4557fe74a9cb853bdfa3ec0fa1b515c0a1e5de91f4ad0bR1685-R1699 takes `O(#mempoolTxs * #bins)` \r\n\r\nLooking at https://jochen-hoenicke.de/queue/#BTC,1y,count, to have some sense about numbers, it can be something like: 20_000 * 10_000 = 200_000_000 that should be computed in a less than a second.\r\n\r\nIf you can test it, it would be great. Thinking about it, maybe it's easy just to modify the test we have to add a lot of transactions and just measure the time. So it should be relatively easy I guess.",
      "created_at": "2021-11-25T20:22:49Z",
      "updated_at": "2021-11-25T20:22:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r757114611",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114611"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1758,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/796604866",
      "pull_request_review_id": 869142320,
      "id": 796604866,
      "node_id": "PRRC_kwDOABII584veznC",
      "diff_hunk": "@@ -1665,18 +1666,78 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"usage\", (int64_t)pool.DynamicMemoryUsage());\n     ret.pushKV(\"total_fee\", ValueFromAmount(pool.GetTotalFee()));\n     size_t maxmempool = gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000;\n-    ret.pushKV(\"maxmempool\", (int64_t) maxmempool);\n+    ret.pushKV(\"maxmempool\", (int64_t)maxmempool);\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (histogram_floors) {\n+        const MempoolHistogramFeeRates& floors{histogram_floors.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(floors.size(), 0);\n+        std::vector<uint64_t> count(floors.size(), 0);\n+        std::vector<CAmount> fees(floors.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 40,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "2d2bae70ab56ae15a21768ecf642f2747687aa97",
      "in_reply_to_id": null,
      "user": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "please remove this c-style cast\r\n```\r\nconst uint32_t size{uint32_t(e.GetTxSize())};\r\n```",
      "created_at": "2022-02-01T13:40:22Z",
      "updated_at": "2022-02-01T13:40:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r796604866",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/796604866"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1687,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/797441817",
      "pull_request_review_id": 870313865,
      "id": 797441817,
      "node_id": "PRRC_kwDOABII584vh_8Z",
      "diff_hunk": "@@ -1665,18 +1666,78 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"usage\", (int64_t)pool.DynamicMemoryUsage());\n     ret.pushKV(\"total_fee\", ValueFromAmount(pool.GetTotalFee()));\n     size_t maxmempool = gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000;\n-    ret.pushKV(\"maxmempool\", (int64_t) maxmempool);\n+    ret.pushKV(\"maxmempool\", (int64_t)maxmempool);\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (histogram_floors) {\n+        const MempoolHistogramFeeRates& floors{histogram_floors.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(floors.size(), 0);\n+        std::vector<uint64_t> count(floors.size(), 0);\n+        std::vector<CAmount> fees(floors.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()};",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 40,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "2d2bae70ab56ae15a21768ecf642f2747687aa97",
      "in_reply_to_id": 796604866,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thank you. I have just changed it.\r\n\r\nNote: #23962 might affect this code later on.\r\n\r\nedit: Rebased. Hopefully, it will fix the mac test error.",
      "created_at": "2022-02-02T10:01:18Z",
      "updated_at": "2022-02-02T12:34:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r797441817",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/797441817"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1687,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831531202",
      "pull_request_review_id": 916341762,
      "id": 831531202,
      "node_id": "PRRC_kwDOABII584xkCjC",
      "diff_hunk": "@@ -386,39 +389,139 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"bytes\", (int64_t)pool.GetTotalTxSize());\n     ret.pushKV(\"usage\", (int64_t)pool.DynamicMemoryUsage());\n     ret.pushKV(\"total_fee\", ValueFromAmount(pool.GetTotalFee()));\n-    int64_t maxmempool{gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000};\n-    ret.pushKV(\"maxmempool\", maxmempool);\n+    size_t maxmempool = gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000;\n+    ret.pushKV(\"maxmempool\", (int64_t)maxmempool);",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 33,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "84418b05c310c58cfac21e7b7d8fece2cea91eff",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This makes no sense? Why?",
      "created_at": "2022-03-21T20:49:57Z",
      "updated_at": "2022-03-21T20:49:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r831531202",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831531202"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 392,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831548356",
      "pull_request_review_id": 916365174,
      "id": 831548356,
      "node_id": "PRRC_kwDOABII584xkGvE",
      "diff_hunk": "@@ -386,39 +389,139 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"bytes\", (int64_t)pool.GetTotalTxSize());\n     ret.pushKV(\"usage\", (int64_t)pool.DynamicMemoryUsage());\n     ret.pushKV(\"total_fee\", ValueFromAmount(pool.GetTotalFee()));\n-    int64_t maxmempool{gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000};\n-    ret.pushKV(\"maxmempool\", maxmempool);\n+    size_t maxmempool = gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000;\n+    ret.pushKV(\"maxmempool\", (int64_t)maxmempool);\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (histogram_floors) {\n+        const MempoolHistogramFeeRates& floors{histogram_floors.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(floors.size(), 0);\n+        std::vector<uint64_t> count(floors.size(), 0);\n+        std::vector<CAmount> fees(floors.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const uint32_t size{uint32_t(e.GetTxSize())};\n+            const CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)};\n+\n+            // Distribute fee rates\n+            for (size_t i = floors.size(); i-- > 0;) {\n+                if (fee_rate >= floors[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < floors.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", floors.at(i));\n+\n+            if (i == floors.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", floors[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(floors.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n-RPCHelpMan getmempoolinfo()\n+static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n-        \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-        {},\n-        RPCResult{\n-            RPCResult::Type::OBJ, \"\", \"\",\n-            {\n-                {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n-                {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n-                {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n-                {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritisetransaction\"},\n-                {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n-                {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n-                {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n-            }},\n-        RPCExamples{\n-            HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n-        },\n+                \"\\nReturns details on the active state of the TX memory pool.\\n\",",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 117,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "84418b05c310c58cfac21e7b7d8fece2cea91eff",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You're unfixing the indentation here... bad rebase?",
      "created_at": "2022-03-21T21:14:38Z",
      "updated_at": "2022-03-21T21:14:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r831548356",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831548356"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 457,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831613310",
      "pull_request_review_id": 916449201,
      "id": 831613310,
      "node_id": "PRRC_kwDOABII584xkWl-",
      "diff_hunk": "@@ -386,39 +389,139 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"bytes\", (int64_t)pool.GetTotalTxSize());\n     ret.pushKV(\"usage\", (int64_t)pool.DynamicMemoryUsage());\n     ret.pushKV(\"total_fee\", ValueFromAmount(pool.GetTotalFee()));\n-    int64_t maxmempool{gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000};\n-    ret.pushKV(\"maxmempool\", maxmempool);\n+    size_t maxmempool = gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000;\n+    ret.pushKV(\"maxmempool\", (int64_t)maxmempool);\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (histogram_floors) {\n+        const MempoolHistogramFeeRates& floors{histogram_floors.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(floors.size(), 0);\n+        std::vector<uint64_t> count(floors.size(), 0);\n+        std::vector<CAmount> fees(floors.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const uint32_t size{uint32_t(e.GetTxSize())};\n+            const CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)};\n+\n+            // Distribute fee rates\n+            for (size_t i = floors.size(); i-- > 0;) {\n+                if (fee_rate >= floors[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < floors.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", floors.at(i));\n+\n+            if (i == floors.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", floors[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(floors.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n-RPCHelpMan getmempoolinfo()\n+static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n-        \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-        {},\n-        RPCResult{\n-            RPCResult::Type::OBJ, \"\", \"\",\n-            {\n-                {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n-                {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n-                {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n-                {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritisetransaction\"},\n-                {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n-                {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n-                {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n-            }},\n-        RPCExamples{\n-            HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n-        },\n+                \"\\nReturns details on the active state of the TX memory pool.\\n\",",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 117,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "84418b05c310c58cfac21e7b7d8fece2cea91eff",
      "in_reply_to_id": 831548356,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks, I have fixed it hopefully.",
      "created_at": "2022-03-21T23:08:23Z",
      "updated_at": "2022-03-21T23:08:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r831613310",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831613310"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 457,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831613512",
      "pull_request_review_id": 916449429,
      "id": 831613512,
      "node_id": "PRRC_kwDOABII584xkWpI",
      "diff_hunk": "@@ -386,39 +389,139 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"bytes\", (int64_t)pool.GetTotalTxSize());\n     ret.pushKV(\"usage\", (int64_t)pool.DynamicMemoryUsage());\n     ret.pushKV(\"total_fee\", ValueFromAmount(pool.GetTotalFee()));\n-    int64_t maxmempool{gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000};\n-    ret.pushKV(\"maxmempool\", maxmempool);\n+    size_t maxmempool = gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000;\n+    ret.pushKV(\"maxmempool\", (int64_t)maxmempool);",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 33,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "84418b05c310c58cfac21e7b7d8fece2cea91eff",
      "in_reply_to_id": 831531202,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Bad rebase :-| ",
      "created_at": "2022-03-21T23:08:46Z",
      "updated_at": "2022-03-21T23:08:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r831613512",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831613512"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": 392,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831651393",
      "pull_request_review_id": 916525878,
      "id": 831651393,
      "node_id": "PRRC_kwDOABII584xkf5B",
      "diff_hunk": "@@ -386,39 +389,139 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"bytes\", (int64_t)pool.GetTotalTxSize());\n     ret.pushKV(\"usage\", (int64_t)pool.DynamicMemoryUsage());\n     ret.pushKV(\"total_fee\", ValueFromAmount(pool.GetTotalFee()));\n-    int64_t maxmempool{gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000};\n-    ret.pushKV(\"maxmempool\", maxmempool);\n+    size_t maxmempool = gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000;\n+    ret.pushKV(\"maxmempool\", (int64_t)maxmempool);\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (histogram_floors) {\n+        const MempoolHistogramFeeRates& floors{histogram_floors.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(floors.size(), 0);\n+        std::vector<uint64_t> count(floors.size(), 0);\n+        std::vector<CAmount> fees(floors.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const uint32_t size{uint32_t(e.GetTxSize())};\n+            const CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)};\n+\n+            // Distribute fee rates\n+            for (size_t i = floors.size(); i-- > 0;) {\n+                if (fee_rate >= floors[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < floors.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", floors.at(i));\n+\n+            if (i == floors.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", floors[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(floors.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n-RPCHelpMan getmempoolinfo()\n+static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n-        \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-        {},\n-        RPCResult{\n-            RPCResult::Type::OBJ, \"\", \"\",\n-            {\n-                {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n-                {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n-                {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n-                {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritisetransaction\"},\n-                {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n-                {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n-                {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n-            }},\n-        RPCExamples{\n-            HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n-        },\n+                \"\\nReturns details on the active state of the TX memory pool.\\n\",",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 117,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "84418b05c310c58cfac21e7b7d8fece2cea91eff",
      "in_reply_to_id": 831548356,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nope",
      "created_at": "2022-03-22T00:20:05Z",
      "updated_at": "2022-03-22T00:20:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r831651393",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831651393"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 457,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832275223",
      "pull_request_review_id": 917375397,
      "id": 832275223,
      "node_id": "PRRC_kwDOABII584xm4MX",
      "diff_hunk": "@@ -386,39 +389,139 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"bytes\", (int64_t)pool.GetTotalTxSize());\n     ret.pushKV(\"usage\", (int64_t)pool.DynamicMemoryUsage());\n     ret.pushKV(\"total_fee\", ValueFromAmount(pool.GetTotalFee()));\n-    int64_t maxmempool{gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000};\n-    ret.pushKV(\"maxmempool\", maxmempool);\n+    size_t maxmempool = gArgs.GetIntArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000;\n+    ret.pushKV(\"maxmempool\", (int64_t)maxmempool);\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (histogram_floors) {\n+        const MempoolHistogramFeeRates& floors{histogram_floors.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(floors.size(), 0);\n+        std::vector<uint64_t> count(floors.size(), 0);\n+        std::vector<CAmount> fees(floors.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const uint32_t size{uint32_t(e.GetTxSize())};\n+            const CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)};\n+\n+            // Distribute fee rates\n+            for (size_t i = floors.size(); i-- > 0;) {\n+                if (fee_rate >= floors[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < floors.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", floors.at(i));\n+\n+            if (i == floors.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", floors[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(floors.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n-RPCHelpMan getmempoolinfo()\n+static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n-        \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-        {},\n-        RPCResult{\n-            RPCResult::Type::OBJ, \"\", \"\",\n-            {\n-                {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n-                {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n-                {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n-                {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritisetransaction\"},\n-                {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n-                {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n-                {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n-            }},\n-        RPCExamples{\n-            HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n-        },\n+                \"\\nReturns details on the active state of the TX memory pool.\\n\",",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 117,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "84418b05c310c58cfac21e7b7d8fece2cea91eff",
      "in_reply_to_id": 831548356,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Looks resolved. 288c4524fa0458a819664ccd568fb8e34e06cc7a -> 4af229650fe appears to be a clean rebase.",
      "created_at": "2022-03-22T14:41:51Z",
      "updated_at": "2022-03-22T14:41:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r832275223",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832275223"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 457,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/861390850",
      "pull_request_review_id": 957154737,
      "id": 861390850,
      "node_id": "PRRC_kwDOABII584zV8gC",
      "diff_hunk": "@@ -621,15 +684,55 @@ static RPCHelpMan getmempoolinfo()\n                 {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                 {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                 {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                {RPCResult::Type::OBJ, \"fee_histogram\", /*optional=*/true, \"\",\n+                    {\n+                        {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                            {\n+                                {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\n+                                {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \")\"},\n+                                {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                {RPCResult::Type::ANY, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 118,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "1de334c5f704f15d098f72f329f5a73e37b7898d",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is incorrect. It's NUM, just optional (null is identical to omitted).\r\n",
      "created_at": "2022-04-29T00:03:53Z",
      "updated_at": "2022-04-29T00:03:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r861390850",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/861390850"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 698,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/861488019",
      "pull_request_review_id": 957288847,
      "id": 861488019,
      "node_id": "PRRC_kwDOABII584zWUOT",
      "diff_hunk": "@@ -621,15 +684,55 @@ static RPCHelpMan getmempoolinfo()\n                 {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                 {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                 {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                {RPCResult::Type::OBJ, \"fee_histogram\", /*optional=*/true, \"\",\n+                    {\n+                        {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                            {\n+                                {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\n+                                {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \")\"},\n+                                {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                {RPCResult::Type::ANY, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 118,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "1de334c5f704f15d098f72f329f5a73e37b7898d",
      "in_reply_to_id": 861390850,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I know it's incorrect. I just can't see to make it work to make `RPCResult::MatchesType` happy. I have actually tried that NUM+optional but `RPCResult::MatchesType` reported an error. \r\n\r\nIf you know correct solution, can you share it here?\r\n\r\nPS: I should probably have a deeper look how `RPCResult::MatchesType`  handles NUMs.",
      "created_at": "2022-04-29T06:24:23Z",
      "updated_at": "2022-04-29T06:24:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r861488019",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/861488019"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 698,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862106906",
      "pull_request_review_id": 958187313,
      "id": 862106906,
      "node_id": "PRRC_kwDOABII584zYrUa",
      "diff_hunk": "@@ -621,15 +684,55 @@ static RPCHelpMan getmempoolinfo()\n                 {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                 {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                 {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                {RPCResult::Type::OBJ, \"fee_histogram\", /*optional=*/true, \"\",\n+                    {\n+                        {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                            {\n+                                {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\n+                                {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \")\"},\n+                                {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                {RPCResult::Type::ANY, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 118,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "1de334c5f704f15d098f72f329f5a73e37b7898d",
      "in_reply_to_id": 861390850,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's entirely possible the MatchesType is buggy, in which case fixing it is the correct solution.",
      "created_at": "2022-04-29T20:00:26Z",
      "updated_at": "2022-04-29T20:00:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r862106906",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862106906"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 698,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862311528",
      "pull_request_review_id": 958457905,
      "id": 862311528,
      "node_id": "PRRC_kwDOABII584zZdRo",
      "diff_hunk": "@@ -621,15 +684,55 @@ static RPCHelpMan getmempoolinfo()\n                 {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                 {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                 {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                {RPCResult::Type::OBJ, \"fee_histogram\", /*optional=*/true, \"\",\n+                    {\n+                        {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                            {\n+                                {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\n+                                {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \")\"},\n+                                {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                {RPCResult::Type::ANY, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 118,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "1de334c5f704f15d098f72f329f5a73e37b7898d",
      "in_reply_to_id": 861390850,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> null is identical to omitted\r\n\r\nThat's not true. In python it will throw a key-error.\r\n\r\nMaybe just not return `to` at all ever?",
      "created_at": "2022-04-30T06:31:31Z",
      "updated_at": "2022-04-30T06:31:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r862311528",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862311528"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 698,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/894623520",
      "pull_request_review_id": 1002926323,
      "id": 894623520,
      "node_id": "PRRC_kwDOABII5841Ut8g",
      "diff_hunk": "@@ -621,15 +684,55 @@ static RPCHelpMan getmempoolinfo()\n                 {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                 {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                 {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                {RPCResult::Type::OBJ, \"fee_histogram\", /*optional=*/true, \"\",\n+                    {\n+                        {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                            {\n+                                {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\n+                                {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \")\"},\n+                                {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                {RPCResult::Type::ANY, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 118,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "1de334c5f704f15d098f72f329f5a73e37b7898d",
      "in_reply_to_id": 861390850,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The original PR returned max-int64 for the final range FWIW",
      "created_at": "2022-06-10T14:58:39Z",
      "updated_at": "2022-06-10T14:58:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r894623520",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/894623520"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 698,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/917358611",
      "pull_request_review_id": 1033605896,
      "id": 917358611,
      "node_id": "PRRC_kwDOABII5842rcgT",
      "diff_hunk": "@@ -621,15 +684,55 @@ static RPCHelpMan getmempoolinfo()\n                 {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                 {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                 {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                {RPCResult::Type::OBJ, \"fee_histogram\", /*optional=*/true, \"\",\n+                    {\n+                        {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                            {\n+                                {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\n+                                {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \")\"},\n+                                {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                {RPCResult::Type::ANY, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 118,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "1de334c5f704f15d098f72f329f5a73e37b7898d",
      "in_reply_to_id": 861390850,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I removed `to` as suggested. It feels right to me.\r\n\r\n[CI failure](https://github.com/bitcoin/bitcoin/pull/21422/checks?check_run_id=7264641865) looks unrelated to me ... or not?",
      "created_at": "2022-07-10T08:17:19Z",
      "updated_at": "2022-07-10T08:19:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r917358611",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/917358611"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 698,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1059616551",
      "pull_request_review_id": 1233344975,
      "id": 1059616551,
      "node_id": "PRRC_kwDOABII584_KHcn",
      "diff_hunk": "@@ -621,15 +684,55 @@ static RPCHelpMan getmempoolinfo()\n                 {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                 {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                 {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                {RPCResult::Type::OBJ, \"fee_histogram\", /*optional=*/true, \"\",\n+                    {\n+                        {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                            {\n+                                {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\n+                                {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \")\"},\n+                                {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                {RPCResult::Type::ANY, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 118,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "1de334c5f704f15d098f72f329f5a73e37b7898d",
      "in_reply_to_id": 861390850,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "CI is green now.",
      "created_at": "2022-12-31T09:26:17Z",
      "updated_at": "2022-12-31T09:26:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1059616551",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1059616551"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 698,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083822684",
      "pull_request_review_id": 1265252459,
      "id": 1083822684,
      "node_id": "PRRC_kwDOABII585AmdJc",
      "diff_hunk": "@@ -692,14 +745,53 @@ static RPCHelpMan getmempoolinfo()\n                 {RPCResult::Type::NUM, \"incrementalrelayfee\", \"minimum fee rate increment for mempool limiting or replacement in \" + CURRENCY_UNIT + \"/kvB\"},\n                 {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n                 {RPCResult::Type::BOOL, \"fullrbf\", \"True if the mempool accepts RBF without replaceability signaling inspection\"},\n+                {RPCResult::Type::OBJ, \"fee_histogram\", /*optional=*/true, \"\",\n+                    {\n+                        {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                            {\n+                                {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\n+                                {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \")\"},\n+                                {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }}}},\n+                        {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \")\"},\n+                    }},\n             }},\n         RPCExamples{\n-            HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+            HelpExampleCli(\"getmempoolinfo\", \"\") +\n+            HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+            HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+            HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n         },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates histogram_floors;\n+    std::optional<MempoolHistogramFeeRates> histogram_floors_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue histogram_floors_univalue = request.params[0].get_array();\n+\n+        if (histogram_floors_univalue.size() == 0 || histogram_floors_univalue.size() > 30) {",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 128,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "32d872a2a58c79ff79049553c97cb78a7314bd8e",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        if (histogram_floors_univalue.empty() || histogram_floors_univalue.size() > 30) {\r\n```",
      "created_at": "2023-01-23T09:34:22Z",
      "updated_at": "2023-01-23T10:00:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1083822684",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083822684"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 776,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083823401",
      "pull_request_review_id": 1265252459,
      "id": 1083823401,
      "node_id": "PRRC_kwDOABII585AmdUp",
      "diff_hunk": "@@ -25,6 +26,8 @@\n \n using kernel::DumpMempool;\n \n+#include <optional>",
      "path": "src/rpc/mempool.cpp",
      "position": 12,
      "original_position": 12,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "32d872a2a58c79ff79049553c97cb78a7314bd8e",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Move this include above the `using`.",
      "created_at": "2023-01-23T09:35:07Z",
      "updated_at": "2023-01-23T10:00:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1083823401",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083823401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 28,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083846863",
      "pull_request_review_id": 1265252459,
      "id": 1083846863,
      "node_id": "PRRC_kwDOABII585AmjDP",
      "diff_hunk": "@@ -670,14 +673,64 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"incrementalrelayfee\", ValueFromAmount(pool.m_incremental_relay_feerate.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n     ret.pushKV(\"fullrbf\", pool.m_full_rbf);\n+\n+    if (histogram_floors) {\n+        const MempoolHistogramFeeRates& floors{histogram_floors.value()};\n+\n+        std::vector<uint64_t> sizes(floors.size(), 0);\n+        std::vector<uint64_t> count(floors.size(), 0);\n+        std::vector<CAmount> fees(floors.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const uint32_t size{uint32_t(e.GetTxSize())};\n+            const CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)};\n+\n+            // Distribute fee rates\n+            for (size_t i = floors.size(); i-- > 0;) {\n+                if (fee_rate >= floors[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }",
      "path": "src/rpc/mempool.cpp",
      "position": 50,
      "original_position": 51,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "32d872a2a58c79ff79049553c97cb78a7314bd8e",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "32d872a2a58c79ff79049553c97cb78a7314bd8e: Could use std::algorithm.\r\n```suggestion\r\n            auto it = std::upper_bound(floors.begin(), floors.end(), fee_rate);\r\n            if (it != floors.begin()) {\r\n                size_t i = std::distance(floors.begin(), it - 1);\r\n                sizes[i] += size;\r\n                ++count[i];\r\n                fees[i] += fee;\r\n            }\r\n```",
      "created_at": "2023-01-23T09:57:44Z",
      "updated_at": "2023-01-23T10:00:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1083846863",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083846863"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": 704,
      "original_start_line": 690,
      "start_side": "RIGHT",
      "line": 711,
      "original_line": 711,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083849554",
      "pull_request_review_id": 1265252459,
      "id": 1083849554,
      "node_id": "PRRC_kwDOABII585AmjtS",
      "diff_hunk": "@@ -0,0 +1,118 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser)\n+\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        self.generate(self.nodes[0], COINBASE_MATURITY + 2, sync_fun=self.no_op)\n+\n+        # We have two UTXOs (utxo_1 and utxo_2) and we create three changeless transactions:\n+        # - tx1 (5 sat/vB): spending utxo_1\n+        # - tx2 (14 sat/vB): spending output from tx1\n+        # - tx3 (6 sat/vB): spending utxo_2 and the output from tx2\n+\n+        self.log.info(\"Test getmempoolinfo does not return fee histogram by default\")\n+        assert(\"fee_histogram\" not in node.getmempoolinfo())",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 38,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "56512a06800781cde7bc63fe386ba7301db6f40a",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> missing whitespace after keyword\r\n```suggestion\r\n        assert (\"fee_histogram\" not in node.getmempoolinfo())\r\n```\r\n\r\n",
      "created_at": "2023-01-23T10:00:20Z",
      "updated_at": "2023-01-23T10:00:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1083849554",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083849554"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 38,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084575156",
      "pull_request_review_id": 1266362691,
      "id": 1084575156,
      "node_id": "PRRC_kwDOABII585ApU20",
      "diff_hunk": "@@ -0,0 +1,118 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser)\n+\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        self.generate(self.nodes[0], COINBASE_MATURITY + 2, sync_fun=self.no_op)\n+\n+        # We have two UTXOs (utxo_1 and utxo_2) and we create three changeless transactions:\n+        # - tx1 (5 sat/vB): spending utxo_1\n+        # - tx2 (14 sat/vB): spending output from tx1\n+        # - tx3 (6 sat/vB): spending utxo_2 and the output from tx2\n+\n+        self.log.info(\"Test getmempoolinfo does not return fee histogram by default\")\n+        assert(\"fee_histogram\" not in node.getmempoolinfo())",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 38,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "56512a06800781cde7bc63fe386ba7301db6f40a",
      "in_reply_to_id": 1083849554,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thank you. \r\n\r\nbtw: It would be nice to have a lint warning about this. If it was not added since my last push.",
      "created_at": "2023-01-23T21:26:21Z",
      "updated_at": "2023-01-23T21:26:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1084575156",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084575156"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 38,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084575440",
      "pull_request_review_id": 1266363090,
      "id": 1084575440,
      "node_id": "PRRC_kwDOABII585ApU7Q",
      "diff_hunk": "@@ -25,6 +26,8 @@\n \n using kernel::DumpMempool;\n \n+#include <optional>",
      "path": "src/rpc/mempool.cpp",
      "position": 12,
      "original_position": 12,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "32d872a2a58c79ff79049553c97cb78a7314bd8e",
      "in_reply_to_id": 1083823401,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks. Changed.",
      "created_at": "2023-01-23T21:26:34Z",
      "updated_at": "2023-01-23T21:26:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1084575440",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084575440"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 28,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084575697",
      "pull_request_review_id": 1266363496,
      "id": 1084575697,
      "node_id": "PRRC_kwDOABII585ApU_R",
      "diff_hunk": "@@ -692,14 +745,53 @@ static RPCHelpMan getmempoolinfo()\n                 {RPCResult::Type::NUM, \"incrementalrelayfee\", \"minimum fee rate increment for mempool limiting or replacement in \" + CURRENCY_UNIT + \"/kvB\"},\n                 {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n                 {RPCResult::Type::BOOL, \"fullrbf\", \"True if the mempool accepts RBF without replaceability signaling inspection\"},\n+                {RPCResult::Type::OBJ, \"fee_histogram\", /*optional=*/true, \"\",\n+                    {\n+                        {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                            {\n+                                {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group (in vBytes)\"},\n+                                {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \")\"},\n+                                {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }}}},\n+                        {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \")\"},\n+                    }},\n             }},\n         RPCExamples{\n-            HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+            HelpExampleCli(\"getmempoolinfo\", \"\") +\n+            HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+            HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+            HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n         },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates histogram_floors;\n+    std::optional<MempoolHistogramFeeRates> histogram_floors_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue histogram_floors_univalue = request.params[0].get_array();\n+\n+        if (histogram_floors_univalue.size() == 0 || histogram_floors_univalue.size() > 30) {",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 128,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "32d872a2a58c79ff79049553c97cb78a7314bd8e",
      "in_reply_to_id": 1083822684,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changed. Thanks.",
      "created_at": "2023-01-23T21:26:48Z",
      "updated_at": "2023-01-23T21:26:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1084575697",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084575697"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 776,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084580976",
      "pull_request_review_id": 1266371624,
      "id": 1084580976,
      "node_id": "PRRC_kwDOABII585ApWRw",
      "diff_hunk": "@@ -670,14 +673,64 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"incrementalrelayfee\", ValueFromAmount(pool.m_incremental_relay_feerate.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n     ret.pushKV(\"fullrbf\", pool.m_full_rbf);\n+\n+    if (histogram_floors) {\n+        const MempoolHistogramFeeRates& floors{histogram_floors.value()};\n+\n+        std::vector<uint64_t> sizes(floors.size(), 0);\n+        std::vector<uint64_t> count(floors.size(), 0);\n+        std::vector<CAmount> fees(floors.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()};\n+            const uint32_t size{uint32_t(e.GetTxSize())};\n+            const CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)};\n+\n+            // Distribute fee rates\n+            for (size_t i = floors.size(); i-- > 0;) {\n+                if (fee_rate >= floors[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }",
      "path": "src/rpc/mempool.cpp",
      "position": 50,
      "original_position": 51,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "32d872a2a58c79ff79049553c97cb78a7314bd8e",
      "in_reply_to_id": 1083846863,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "[Reading](https://en.cppreference.com/w/cpp/algorithm/upper_bound) about `std::upper_bound`, it looks to me that one should compare with `floors.end()` and not `floors.begin()`. \r\n\r\nAlso that `it - 1` makes me a bit concerned because the current code allows works with `i = 0`.\r\n\r\nAnyway, I'm not too good with these idiomatic C++ code changes, so I might be completely wrong.",
      "created_at": "2023-01-23T21:31:04Z",
      "updated_at": "2023-01-23T21:31:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1084580976",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084580976"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": 704,
      "original_start_line": 690,
      "start_side": "RIGHT",
      "line": 711,
      "original_line": 711,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084586794",
      "pull_request_review_id": 1266381990,
      "id": 1084586794,
      "node_id": "PRRC_kwDOABII585ApXsq",
      "diff_hunk": "@@ -0,0 +1,118 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test mempool fee histogram.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_greater_than_or_equal,\n+)\n+\n+class MempoolFeeHistogramTest(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser)\n+\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        self.generate(self.nodes[0], COINBASE_MATURITY + 2, sync_fun=self.no_op)\n+\n+        # We have two UTXOs (utxo_1 and utxo_2) and we create three changeless transactions:\n+        # - tx1 (5 sat/vB): spending utxo_1\n+        # - tx2 (14 sat/vB): spending output from tx1\n+        # - tx3 (6 sat/vB): spending utxo_2 and the output from tx2\n+\n+        self.log.info(\"Test getmempoolinfo does not return fee histogram by default\")\n+        assert(\"fee_histogram\" not in node.getmempoolinfo())",
      "path": "test/functional/mempool_fee_histogram.py",
      "position": null,
      "original_position": 38,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "56512a06800781cde7bc63fe386ba7301db6f40a",
      "in_reply_to_id": 1083849554,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> btw: It would be nice to have a lint warning about this. If it was not added since my last push.\r\n\r\nThere was, the lint job failed with this error. I just copy-pasted it.",
      "created_at": "2023-01-23T21:36:26Z",
      "updated_at": "2023-01-23T21:36:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1084586794",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084586794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 38,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1125568212",
      "pull_request_review_id": 1325132341,
      "id": 1125568212,
      "node_id": "PRRC_kwDOABII585DFs7U",
      "diff_hunk": "@@ -1645,34 +1646,141 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"mempoolminfee\", ValueFromAmount(std::max(pool.GetMinFee(maxmempool), ::minRelayTxFee).GetFeePerK()));\n     ret.pushKV(\"minrelaytxfee\", ValueFromAmount(::minRelayTxFee.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n+\n+    if (feeLimits) {\n+        const MempoolHistogramFeeRates& limits{feeLimits.value()};\n+\n+        /* Keep histogram per...\n+         * ... cumulated tx sizes\n+         * ... txns (count)\n+         * ... cumulated fees */\n+        std::vector<uint64_t> sizes(limits.size(), 0);\n+        std::vector<uint64_t> count(limits.size(), 0);\n+        std::vector<CAmount> fees(limits.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {\n+            const CAmount fee{e.GetFee()}, afees{e.GetModFeesWithAncestors()}, dfees{e.GetModFeesWithDescendants()};\n+            const uint32_t size{(uint32_t)e.GetTxSize()}, asize{(uint32_t)e.GetSizeWithAncestors()}, dsize{(uint32_t)e.GetSizeWithDescendants()};\n+\n+            const CAmount fpb{CFeeRate{fee, size}.GetFee(1)};     // Fee rate per byte\n+            const CAmount afpb{CFeeRate{afees, asize}.GetFee(1)}; // Fee rate per byte including ancestors\n+            const CAmount dfpb{CFeeRate{dfees, dsize}.GetFee(1)}; // Fee rate per byte including descendants\n+\n+            // Fee rate per byte including ancestors & descendants\n+            const CAmount tfpb{CFeeRate{afees + dfees - fee, asize + dsize - size}.GetFee(1)};\n+            const CAmount fee_rate_per_byte{std::max(std::min(dfpb, tfpb), std::min(fpb, afpb))};\n+\n+            // Distribute fee rates into fee limits\n+            for (size_t i = limits.size(); i-- > 0; ) {\n+                if (fee_rate_per_byte >= limits[i]) {\n+                    sizes[i] += size;\n+                    ++count[i];\n+                    fees[i] += fee;\n+                    break;\n+                }\n+            }\n+        }\n+\n+        // Track total amount of available fees in fee rate groups\n+        CAmount total_fees = 0;\n+        UniValue groups(UniValue::VOBJ);\n+        for (size_t i = 0; i < limits.size(); ++i) {\n+            UniValue info_sub(UniValue::VOBJ);\n+            info_sub.pushKV(\"size\", sizes.at(i));\n+            info_sub.pushKV(\"count\", count.at(i));\n+            info_sub.pushKV(\"fees\", fees.at(i));\n+            info_sub.pushKV(\"from\", limits.at(i));\n+\n+            if (i == limits.size() - 1) {\n+                info_sub.pushKV(\"to\", NullUniValue);\n+            } else {\n+                info_sub.pushKV(\"to\", limits[i + 1] - 1);\n+            }\n+\n+            total_fees += fees.at(i);\n+            groups.pushKV(ToString(limits.at(i)), info_sub);\n+        }\n+\n+        UniValue info(UniValue::VOBJ);\n+        info.pushKV(\"fee_rate_groups\", groups);\n+        info.pushKV(\"total_fees\", total_fees);\n+        ret.pushKV(\"fee_histogram\", info);\n+    }\n+\n     return ret;\n }\n \n static RPCHelpMan getmempoolinfo()\n {\n     return RPCHelpMan{\"getmempoolinfo\",\n                 \"\\nReturns details on the active state of the TX memory pool.\\n\",\n-                {},\n+                {\n+                    {\"fee_histogram\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Fee statistics grouped by fee rate ranges\",\n+                        {\n+                            {\"fee_rate\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Fee rate (in \" + CURRENCY_ATOM + \"/vB) to group the fees by\"},\n+                        },\n+                    },\n+                },\n                 RPCResult{\n                     RPCResult::Type::OBJ, \"\", \"\",\n                     {\n                         {RPCResult::Type::BOOL, \"loaded\", \"True if the mempool is fully loaded\"},\n                         {RPCResult::Type::NUM, \"size\", \"Current tx count\"},\n                         {RPCResult::Type::NUM, \"bytes\", \"Sum of all virtual transaction sizes as defined in BIP 141. Differs from actual serialized size because witness data is discounted\"},\n                         {RPCResult::Type::NUM, \"usage\", \"Total memory usage for the mempool\"},\n-                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \", ignoring modified fees through prioritizetransaction\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"total_fee\", \"Total fees for the mempool in \" + CURRENCY_UNIT + \"/kvB, ignoring modified fees through prioritizetransaction\"},\n                         {RPCResult::Type::NUM, \"maxmempool\", \"Maximum memory usage for the mempool\"},\n                         {RPCResult::Type::STR_AMOUNT, \"mempoolminfee\", \"Minimum fee rate in \" + CURRENCY_UNIT + \"/kvB for tx to be accepted. Is the maximum of minrelaytxfee and minimum mempool fee\"},\n                         {RPCResult::Type::STR_AMOUNT, \"minrelaytxfee\", \"Current minimum relay fee for transactions\"},\n-                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"}\n+                        {RPCResult::Type::NUM, \"unbroadcastcount\", \"Current number of transactions that haven't passed initial broadcast yet\"},\n+                        {RPCResult::Type::OBJ, \"fee_histogram\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ_DYN, \"fee_rate_groups\", \"\",\n+                                {\n+                                    {RPCResult::Type::OBJ, \"<fee_rate_group>\", \"Fee rate group named by its lower bound (in \" + CURRENCY_ATOM + \"/vB), identical to the \\\"from\\\" field below\",\n+                                    {\n+                                        {RPCResult::Type::NUM, \"size\", \"Cumulative size of all transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"count\", \"Number of transactions in the fee rate group\"},\n+                                        {RPCResult::Type::NUM, \"fees\", \"Cumulative fees of all transactions in the fee rate group (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"from\", \"Group contains transactions with fee rates equal or greater than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                        {RPCResult::Type::NUM, \"to\", \"Group contains transactions with fee rates equal or less than this value (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                                    }}}},\n+                                {RPCResult::Type::NUM, \"total_fees\", \"Total available fees in mempool (in \" + CURRENCY_ATOM + \"/vB)\"},\n+                            }},\n                     }},\n                 RPCExamples{\n-                    HelpExampleCli(\"getmempoolinfo\", \"\")\n-            + HelpExampleRpc(\"getmempoolinfo\", \"\")\n+                    HelpExampleCli(\"getmempoolinfo\", \"\") +\n+                    HelpExampleCli(\"getmempoolinfo\", R\"(\"[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200]\")\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", \"\") +\n+                    HelpExampleRpc(\"getmempoolinfo\", R\"([0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 25, 30, 40, 50, 60, 70, 80, 100, 120, 140, 170, 200])\")\n                 },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    return MempoolInfoToJSON(EnsureAnyMemPool(request.context));\n+    MempoolHistogramFeeRates feelimits;\n+    std::optional<MempoolHistogramFeeRates> feelimits_opt = std::nullopt;\n+\n+    if (!request.params[0].isNull()) {\n+        const UniValue feelimits_univalue = request.params[0].get_array();\n+\n+        if (feelimits_univalue.size() == 0 || feelimits_univalue.size() > 30) {",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 143,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "f2ca3d35ee999e0be309a65c4f69865824e27a4b",
      "in_reply_to_id": 754375897,
      "user": {
        "login": "kiminuo",
        "id": 58662979,
        "node_id": "MDQ6VXNlcjU4NjYyOTc5",
        "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kiminuo",
        "html_url": "https://github.com/kiminuo",
        "followers_url": "https://api.github.com/users/kiminuo/followers",
        "following_url": "https://api.github.com/users/kiminuo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kiminuo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kiminuo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
        "organizations_url": "https://api.github.com/users/kiminuo/orgs",
        "repos_url": "https://api.github.com/users/kiminuo/repos",
        "events_url": "https://api.github.com/users/kiminuo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kiminuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@0xB10C I modified \r\n\r\n```cpp\r\nfor (const CTxMemPoolEntry& e : pool.mapTx) {\r\n    const CAmount fee{e.GetFee()};\r\n    const uint32_t size{uint32_t(e.GetTxSize())};\r\n    const CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)};\r\n\r\n    // Distribute fee rates\r\n    for (size_t i = floors.size(); i-- > 0;) {\r\n        if (fee_rate >= floors[i]) {\r\n            sizes[i] += size;\r\n            ++count[i];\r\n            fees[i] += fee;\r\n            break;\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nto \r\n\r\n```cpp\r\nstd::vector<int> test_fees;\r\nstd::vector<uint32_t> test_sizes;\r\n\r\nFastRandomContext rand;\r\n\r\nconst int test_iterations = 1000;\r\nconst int test_mempool_tx_size = 30000;\r\n\r\nfor (int r = 0; r < test_iterations * test_mempool_tx_size; r++) {\r\n    test_fees.push_back(rand.randrange(100)); // 0 - 100\r\n    test_sizes.push_back(rand.randrange(400) + 200); // 200 - 600\r\n}\r\n\r\nconst auto before =  std::chrono::system_clock::now();\r\n\r\nfor (int t = 0; t < test_iterations; t++) {\r\n    for (int r = 0; r < test_mempool_tx_size; r++) {\r\n        const CAmount fee = test_fees[t * test_mempool_tx_size + r];\r\n        const uint32_t size = test_sizes[t * test_mempool_tx_size + r];\r\n        const CAmount fee_rate{CFeeRate{fee, size}.GetFee(1)};\r\n\r\n        // Distribute fee rates\r\n        for (size_t i = floors.size(); i-- > 0;) {\r\n            if (fee_rate >= floors[i]) {\r\n                sizes[i] += size;\r\n                ++count[i];\r\n                fees[i] += fee;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nconst std::chrono::duration<double, std::milli> duration = std::chrono::system_clock::now() - before;\r\nstd::cout << \"It took \" << duration.count() << \"ms\" << std::endl; // divide by the test_iterations number (ie 1000)\r\n```\r\n\r\nSo that I can measure this code a bit. It's pretty ugly code and it's certainly not scientific but the goal is just to have some sense how fast/slow it is. I take it that even if I were off by the factor of 10, it's still good enough for these particular measurements.\r\n\r\nSo on my machine, I measured these numbers:\r\n\r\n* 1000 bins ~14 ms\r\n* 10000 bins ~ 97 ms\r\n* (not too sure if there is a limit how many bins one can pass actually as I would guess that there is a limit on how long an RPC input can be)\r\n\r\nThat is to say that the artificial limitation to 30 bins is too strict. And I'm removing that restriction because for \"normal\" use-cases it looks like the restriction is just an unnecessary impediment. \r\n\r\nWDYT?",
      "created_at": "2023-03-04T22:34:28Z",
      "updated_at": "2023-03-04T22:34:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1125568212",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1125568212"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1758,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1133744544",
      "pull_request_review_id": 1336717945,
      "id": 1133744544,
      "node_id": "PRRC_kwDOABII585Dk5Gg",
      "diff_hunk": "@@ -685,14 +687,64 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool)\n     ret.pushKV(\"incrementalrelayfee\", ValueFromAmount(pool.m_incremental_relay_feerate.GetFeePerK()));\n     ret.pushKV(\"unbroadcastcount\", uint64_t{pool.GetUnbroadcastTxs().size()});\n     ret.pushKV(\"fullrbf\", pool.m_full_rbf);\n+\n+    if (histogram_floors) {\n+        const MempoolHistogramFeeRates& floors{histogram_floors.value()};\n+\n+        std::vector<uint64_t> sizes(floors.size(), 0);\n+        std::vector<uint64_t> count(floors.size(), 0);\n+        std::vector<CAmount> fees(floors.size(), 0);\n+\n+        for (const CTxMemPoolEntry& e : pool.mapTx) {",
      "path": "src/rpc/mempool.cpp",
      "position": 37,
      "original_position": 37,
      "commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "original_commit_id": "c5e53d0d21ff166ee9ab21f043d839aa112fcf96",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fyi you can get the same information for each transaction by calling `infoAll()`. I think it's not great practice for outside callers to reach into `mapTx`",
      "created_at": "2023-03-13T10:46:19Z",
      "updated_at": "2023-03-13T11:31:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21422#discussion_r1133744544",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1133744544"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21422"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 698,
      "original_line": 698,
      "side": "RIGHT"
    }
  ]
}