{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646",
    "id": 1148653518,
    "node_id": "PR_kwDOABII585Edw_O",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/26646",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/26646.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/26646.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/264f9ef17f650035882d24083fb419845942a3ac",
    "number": 26646,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "validation, bugfix: provide more info in *MempoolAcceptResult",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This PR fixes a bug and improves the mempool accept interface to return information more predictably.\r\n\r\nBug: In package validation, we first try the transactions individually (see doc/policy/packages.md for more explanation) and, if they all failed for missing inputs and policy-related (i.e. fee) reasons, we'll try package validation. Otherwise, we'll just \"quit early\" since, for example, if a transaction had an invalid signature, adding a child will not help make it valid. Currently, when we quit early, we're not setting the `package_state` to be invalid, so the caller might think it succeeded. Also, we're returning no results - it makes more sense to return the individual transaction failure. Thanks instagibbs for catching https://github.com/bitcoin/bitcoin/pull/25038#discussion_r1013293248!\r\n\r\nAlso, make the package results interface generally more useful/predictable:\r\n- Always return the feerate at which a transaction was considered for `CheckFeeRate` in `MempoolAcceptResult::m_effective_feerate` when it was successful. This can replace the current `PackageMempoolAcceptResult::m_package_feerate`, which only sometimes exists.\r\n- Always provide an entry for every transaction in `PackageMempoolAcceptResult::m_tx_results` when the error is `PCKG_TX`.",
    "labels": [
      {
        "id": 64585,
        "node_id": "MDU6TGFiZWw2NDU4NQ==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
        "name": "Bug",
        "color": "FBBAAB",
        "default": false
      },
      {
        "id": 118379652,
        "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
        "name": "Validation",
        "color": "6060aa",
        "default": false
      }
    ],
    "created_at": "2022-12-06T10:43:42Z",
    "updated_at": "2023-01-11T13:26:26Z",
    "closed_at": "2023-01-11T13:26:18Z",
    "mergeable_state": "unknown",
    "merged_at": "2023-01-11T13:26:18Z",
    "merge_commit_sha": "26002570ab600bc653433693b7492b85965ccbce",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "glozow:package-single-tx-result",
      "ref": "package-single-tx-result",
      "sha": "264f9ef17f650035882d24083fb419845942a3ac",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 244262754,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNDQyNjI3NTQ=",
        "name": "bitcoin",
        "full_name": "glozow/bitcoin",
        "owner": {
          "login": "glozow",
          "id": 25183001,
          "node_id": "MDQ6VXNlcjI1MTgzMDAx",
          "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/glozow",
          "html_url": "https://github.com/glozow",
          "followers_url": "https://api.github.com/users/glozow/followers",
          "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
          "organizations_url": "https://api.github.com/users/glozow/orgs",
          "repos_url": "https://api.github.com/users/glozow/repos",
          "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/glozow/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/glozow/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/glozow/bitcoin",
        "archive_url": "https://api.github.com/repos/glozow/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/glozow/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/glozow/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/glozow/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/glozow/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/glozow/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/glozow/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/glozow/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/glozow/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/glozow/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/glozow/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/glozow/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/glozow/bitcoin/events",
        "forks_url": "https://api.github.com/repos/glozow/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/glozow/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/glozow/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/glozow/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/glozow/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/glozow/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/glozow/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/glozow/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/glozow/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/glozow/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/glozow/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/glozow/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/glozow/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/glozow/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/glozow/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/glozow/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:glozow/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/glozow/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/glozow/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/glozow/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/glozow/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/glozow/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/glozow/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/glozow/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/glozow/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/glozow/bitcoin/hooks",
        "svn_url": "https://github.com/glozow/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 7,
        "watchers_count": 7,
        "size": 225090,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-02T10:00:34Z",
        "created_at": "2020-03-02T02:31:56Z",
        "updated_at": "2022-01-07T17:55:23Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "0e81d119e09dba13dddb42506855ba8eba761238",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34325,
        "stargazers_count": 69818,
        "watchers_count": 69818,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T07:15:46Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T06:49:43Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 266,
    "deletions": 123,
    "changed_files": 8,
    "commits": 10,
    "review_comments": 68,
    "comments": 8
  },
  "events": [
    {
      "event": "labeled",
      "id": 7965099631,
      "node_id": "LE_lADOABII585YJIt8zwAAAAHawcZv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7965099631",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-06T10:43:42Z",
      "label": {
        "name": "Bug",
        "color": "FBBAAB"
      }
    },
    {
      "event": "labeled",
      "id": 7965099634,
      "node_id": "LE_lADOABII585YJIt8zwAAAAHawcZy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7965099634",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-06T10:43:42Z",
      "label": {
        "name": "Validation",
        "color": "6060aa"
      }
    },
    {
      "event": "commented",
      "id": 1339126268,
      "node_id": "IC_kwDOABII585P0XH8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1339126268",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-06T10:43:45Z",
      "updated_at": "2023-01-11T07:36:21Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [instagibbs](https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1377439712), [achow101](https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1377986578), [naumenkogs](https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1378344587) |\n| Approach ACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1223169114) |\n| Stale ACK | [vincenzopalazzo](https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1223340153) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26711](https://github.com/bitcoin/bitcoin/pull/26711) ([WIP] validate package transactions with their in-package ancestor sets by glozow)\n* [#25429](https://github.com/bitcoin/bitcoin/pull/25429) (refactor: Avoid UniValue copies by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1339126268",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646"
    },
    {
      "event": "reviewed",
      "id": 1206854880,
      "node_id": "PRR_kwDOABII585H7yTg",
      "url": null,
      "actor": null,
      "commit_id": "139e0e10d96a53231b8c5179def33627aed48d3e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Liking the new interfaces significantly more so far, just naming qualms for now",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1206854880",
      "submitted_at": "2022-12-06T16:13:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7977342771,
      "node_id": "HRFPE_lADOABII585YJIt8zwAAAAHbfJcz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7977342771",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-07T12:34:24Z"
    },
    {
      "event": "reviewed",
      "id": 1208518372,
      "node_id": "PRR_kwDOABII585ICIbk",
      "url": null,
      "actor": null,
      "commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK c5ca0755273597cf1d0f1d10b6b914b13a8bb37f naming nit left aside",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1208518372",
      "submitted_at": "2022-12-07T14:34:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "review_requested",
      "id": 7978561560,
      "node_id": "RRE_lADOABII585YJIt8zwAAAAHbjzAY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7978561560",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-07T14:43:02Z",
      "requested_reviewer": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 1210815392,
      "node_id": "PRR_kwDOABII585IK5Og",
      "url": null,
      "actor": null,
      "commit_id": "70d1af27cfcc9db68d7f26fa15eb7ee9510bbde1",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1210815392",
      "submitted_at": "2022-12-08T21:37:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "reviewed",
      "id": 1213662405,
      "node_id": "PRR_kwDOABII585IVwTF",
      "url": null,
      "actor": null,
      "commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK - fixes the bug as specified and imo makes the interface more clear\r\n\r\nA few more general comments:\r\n- commit message in b00bebbb84af10042ee623116118207b95194a02 I think should be \"remove PackageMempoolAccept**Result**::m_package_feerate\" instead of \"remove PackageMempoolAccept::m_package_feerate\"\r\n- requires a release notes file highlighting the RPC changes\r\n- the docstring of assert_equal_package_results (rpc_packages.py) still mentions package feerate which I think is now out of date\r\n- nit: a72354186f9328d3f56bdd4a41959ff56a774653 could be split in two commits: one for rename, and one for the actual change",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1213662405",
      "submitted_at": "2022-12-12T18:01:29Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8036815221,
      "node_id": "HRFPE_lADOABII585YJIt8zwAAAAHfCBF1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8036815221",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-14T12:40:06Z"
    },
    {
      "event": "reviewed",
      "id": 1217631020,
      "node_id": "PRR_kwDOABII585Ik5Ms",
      "url": null,
      "actor": null,
      "commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "reACK https://github.com/bitcoin/bitcoin/pull/26646/commits/0d383a65ee01eb58c011c4c056523b9a0f20d96f\r\n\r\nDoc changes, and the returning of wtxids considered for the package feerate being the major changes.",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1217631020",
      "submitted_at": "2022-12-14T15:12:32Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "reviewed",
      "id": 1221892702,
      "node_id": "PRR_kwDOABII585I1Jpe",
      "url": null,
      "actor": null,
      "commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "user": {
        "login": "vincenzopalazzo",
        "id": 17150045,
        "node_id": "MDQ6VXNlcjE3MTUwMDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/17150045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vincenzopalazzo",
        "html_url": "https://github.com/vincenzopalazzo",
        "followers_url": "https://api.github.com/users/vincenzopalazzo/followers",
        "following_url": "https://api.github.com/users/vincenzopalazzo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vincenzopalazzo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vincenzopalazzo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vincenzopalazzo/subscriptions",
        "organizations_url": "https://api.github.com/users/vincenzopalazzo/orgs",
        "repos_url": "https://api.github.com/users/vincenzopalazzo/repos",
        "events_url": "https://api.github.com/users/vincenzopalazzo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vincenzopalazzo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1221892702",
      "submitted_at": "2022-12-17T20:35:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "reviewed",
      "id": 1221893543,
      "node_id": "PRR_kwDOABII585I1J2n",
      "url": null,
      "actor": null,
      "commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "user": {
        "login": "vincenzopalazzo",
        "id": 17150045,
        "node_id": "MDQ6VXNlcjE3MTUwMDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/17150045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vincenzopalazzo",
        "html_url": "https://github.com/vincenzopalazzo",
        "followers_url": "https://api.github.com/users/vincenzopalazzo/followers",
        "following_url": "https://api.github.com/users/vincenzopalazzo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vincenzopalazzo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vincenzopalazzo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vincenzopalazzo/subscriptions",
        "organizations_url": "https://api.github.com/users/vincenzopalazzo/orgs",
        "repos_url": "https://api.github.com/users/vincenzopalazzo/repos",
        "events_url": "https://api.github.com/users/vincenzopalazzo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vincenzopalazzo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1221893543",
      "submitted_at": "2022-12-17T20:46:51Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "reviewed",
      "id": 1221893908,
      "node_id": "PRR_kwDOABII585I1J8U",
      "url": null,
      "actor": null,
      "commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "ACK https://github.com/bitcoin/bitcoin/pull/26646/commits/0d383a65ee01eb58c011c4c056523b9a0f20d96f\r\n\r\nMy comments are just comments that included just some considerations where I do not have an answer on why it is done, I do not want to appear like an annoying person :)",
      "user": {
        "login": "vincenzopalazzo",
        "id": 17150045,
        "node_id": "MDQ6VXNlcjE3MTUwMDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/17150045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vincenzopalazzo",
        "html_url": "https://github.com/vincenzopalazzo",
        "followers_url": "https://api.github.com/users/vincenzopalazzo/followers",
        "following_url": "https://api.github.com/users/vincenzopalazzo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vincenzopalazzo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vincenzopalazzo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vincenzopalazzo/subscriptions",
        "organizations_url": "https://api.github.com/users/vincenzopalazzo/orgs",
        "repos_url": "https://api.github.com/users/vincenzopalazzo/repos",
        "events_url": "https://api.github.com/users/vincenzopalazzo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vincenzopalazzo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1221893908",
      "submitted_at": "2022-12-17T20:52:22Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8071137876,
      "node_id": "HRFPE_lADOABII585YJIt8zwAAAAHhE8pU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8071137876",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-19T16:37:13Z"
    },
    {
      "event": "reviewed",
      "id": 1223340153,
      "node_id": "PRR_kwDOABII585I6rB5",
      "url": null,
      "actor": null,
      "commit_id": "48f81f2b5e4052717989a30db942c378d369215b",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "reACK https://github.com/bitcoin/bitcoin/pull/26646/commits/48f81f2b5e4052717989a30db942c378d369215b",
      "user": {
        "login": "vincenzopalazzo",
        "id": 17150045,
        "node_id": "MDQ6VXNlcjE3MTUwMDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/17150045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vincenzopalazzo",
        "html_url": "https://github.com/vincenzopalazzo",
        "followers_url": "https://api.github.com/users/vincenzopalazzo/followers",
        "following_url": "https://api.github.com/users/vincenzopalazzo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vincenzopalazzo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vincenzopalazzo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vincenzopalazzo/subscriptions",
        "organizations_url": "https://api.github.com/users/vincenzopalazzo/orgs",
        "repos_url": "https://api.github.com/users/vincenzopalazzo/repos",
        "events_url": "https://api.github.com/users/vincenzopalazzo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vincenzopalazzo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1223340153",
      "submitted_at": "2022-12-19T18:24:45Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "commented",
      "id": 1358069056,
      "node_id": "IC_kwDOABII585Q8n1A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1358069056",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-19T18:26:15Z",
      "updated_at": "2022-12-19T18:26:15Z",
      "author_association": "MEMBER",
      "body": "ACK https://github.com/bitcoin/bitcoin/pull/26646/commits/48f81f2b5e4052717989a30db942c378d369215b\r\n\r\nchanges are:\r\nremoving redundant nonfatal check\r\ngiving it->second a variable for ease of reading\r\nstatic case of m_vsize to uint32_t\r\ndoc and suggested variable renamings",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1358069056",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646"
    },
    {
      "event": "review_requested",
      "id": 8076062877,
      "node_id": "RRE_lADOABII585YJIt8zwAAAAHhXvCd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8076062877",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-20T08:22:19Z",
      "requested_reviewer": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 1223169114,
      "node_id": "PRR_kwDOABII585I6BRa",
      "url": null,
      "actor": null,
      "commit_id": "48f81f2b5e4052717989a30db942c378d369215b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Approach ACK 48f81f2b5 - not feeling super comfortable yet with my review so want to mull it over a bit more.\r\n\r\nMostly a few nits, and also I think `effective-feerate` being optional in the RPC [isn't ideal](https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046013886) (but I can move past it). Additionally, I think the last 3 comments from [my previous review](https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1213662405) haven't been addressed yet? The missing RPC docs/release notes is probably the most important one there.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1223169114",
      "submitted_at": "2022-12-20T22:46:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "commented",
      "id": 1361111056,
      "node_id": "IC_kwDOABII585RIOgQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1361111056",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-21T10:06:39Z",
      "updated_at": "2022-12-21T10:06:39Z",
      "author_association": "MEMBER",
      "body": "ACK 48f81f2b5e4052717989a30db942c378d369215b\r\n\r\nI don't have a big picture about package relay yet, but these changes are good on their own.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1361111056",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646"
    },
    {
      "event": "reviewed",
      "id": 1236418570,
      "node_id": "PRR_kwDOABII585JskAK",
      "url": null,
      "actor": null,
      "commit_id": "48f81f2b5e4052717989a30db942c378d369215b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1236418570",
      "submitted_at": "2023-01-04T20:12:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJlMmU0ZDk0ZTU5NTEwZTBhOTg0MDgzMTNmZWIyN2U5NzMyMWIxNmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/be2e4d94e59510e0a98408313feb27e97321b16e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/be2e4d94e59510e0a98408313feb27e97321b16e",
      "tree": {
        "sha": "804faa65a691be3ac3aa97fb47171499fbfc7f85",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/804faa65a691be3ac3aa97fb47171499fbfc7f85"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/196a43eddb96ca087ad81c5beb86ffe67ab7bcf3",
          "sha": "196a43eddb96ca087ad81c5beb86ffe67ab7bcf3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/196a43eddb96ca087ad81c5beb86ffe67ab7bcf3"
        }
      ],
      "message": "[validation] when quitting early in AcceptPackage, set package_state and tx result\n\nBug: not setting package_state means package_state.IsValid() == true and\nthe caller does not know that this failed.\n\nWe won't be validating this transaction again, so it makes sense to return this\nfailure to the caller.\n\nRename package_state to package_state_quit_early to make it more clear\nwhat this variable is used for and what its scope is.\n\nCo-authored-by: Greg Sanders <gsanders87@gmail.com>",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-06T17:37:01Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-11-03T15:01:17Z"
      },
      "sha": "be2e4d94e59510e0a98408313feb27e97321b16e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVkMzViNGE3ZGVlOTVhZTcwYmZkY2JlNzliYzM5ZmU0ODg2NDFiMjM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5d35b4a7dee95ae70bfdcbe79bc39fe488641b23",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5d35b4a7dee95ae70bfdcbe79bc39fe488641b23",
      "tree": {
        "sha": "7ca319ef2f2889fa4ca10315f25f9bf1b4ea9fae",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7ca319ef2f2889fa4ca10315f25f9bf1b4ea9fae"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/be2e4d94e59510e0a98408313feb27e97321b16e",
          "sha": "be2e4d94e59510e0a98408313feb27e97321b16e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/be2e4d94e59510e0a98408313feb27e97321b16e"
        }
      ],
      "message": "[test] package validation quits early due to non-policy, non-missing-inputs failure",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-06T17:37:01Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-12-05T14:32:35Z"
      },
      "sha": "5d35b4a7dee95ae70bfdcbe79bc39fe488641b23"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE2MDU4ODYzODBlNGQzZmYyZTEyMzY3MzlmYjgwMGZhMDczMjJjNDk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1605886380e4d3ff2e1236739fb800fa07322c49",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1605886380e4d3ff2e1236739fb800fa07322c49",
      "tree": {
        "sha": "a60e99ed1d2b0a4fab7a6ebade2b0127e3e3a45e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a60e99ed1d2b0a4fab7a6ebade2b0127e3e3a45e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5d35b4a7dee95ae70bfdcbe79bc39fe488641b23",
          "sha": "5d35b4a7dee95ae70bfdcbe79bc39fe488641b23",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5d35b4a7dee95ae70bfdcbe79bc39fe488641b23"
        }
      ],
      "message": "[validation] return effective feerate from mempool validation",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-06T17:37:01Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-09-28T10:23:55Z"
      },
      "sha": "1605886380e4d3ff2e1236739fb800fa07322c49"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8171210151,
      "node_id": "HRFPE_lADOABII585YJIt8zwAAAAHnCsWn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8171210151",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-06T17:55:26Z"
    },
    {
      "event": "commented",
      "id": 1373959707,
      "node_id": "IC_kwDOABII585R5PYb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1373959707",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-06T17:57:50Z",
      "updated_at": "2023-01-06T17:57:50Z",
      "author_association": "MEMBER",
      "body": "Sorry for missing a few of your review comments @stickies-v!\r\n\r\n> * requires a release notes file highlighting the RPC changes\r\n\r\nAdded for testmempoolaccept, submitpackage is regtest-only.\r\n\r\n> * the docstring of assert_equal_package_results (rpc_packages.py) still mentions package feerate which I think is now out of date\r\n\r\nThis refers to the \"package feerate\" concept [documented here](https://github.com/bitcoin/bitcoin/blob/09f32cffa6c3e8b2d77281a5983ffe8f482a5945/doc/policy/packages.md#package-fees-and-feerate), rather than the RPC result \"package-feerate\". So left as is, sorry for that being a bit confusing.\r\n\r\n\r\n> * nit: [a723541](https://github.com/bitcoin/bitcoin/commit/a72354186f9328d3f56bdd4a41959ff56a774653) could be split in two commits: one for rename, and one for the actual change\r\n\r\nDone\r\n",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1373959707",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646"
    },
    {
      "event": "mentioned",
      "id": 8171223978,
      "node_id": "MEE_lADOABII585YJIt8zwAAAAHnCvuq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8171223978",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-06T17:57:50Z"
    },
    {
      "event": "subscribed",
      "id": 8171223981,
      "node_id": "SE_lADOABII585YJIt8zwAAAAHnCvut",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8171223981",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-06T17:57:50Z"
    },
    {
      "event": "commented",
      "id": 1375213884,
      "node_id": "IC_kwDOABII585R-Bk8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1375213884",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T07:42:16Z",
      "updated_at": "2023-01-09T07:42:16Z",
      "author_association": "MEMBER",
      "body": "reACK ada89cb",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1375213884",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646"
    },
    {
      "event": "review_requested",
      "id": 8180000535,
      "node_id": "RRE_lADOABII585YJIt8zwAAAAHnkOcX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8180000535",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T09:58:20Z",
      "requested_reviewer": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 1240590839,
      "node_id": "PRR_kwDOABII585J8en3",
      "url": null,
      "actor": null,
      "commit_id": "ada89cbd4249fad5eaedfa0a173dfc911f188084",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "reACK ada89cbd4249fad5eaedfa0a173dfc911f188084",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1240590839",
      "submitted_at": "2023-01-09T14:39:33Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "reviewed",
      "id": 1241105052,
      "node_id": "PRR_kwDOABII585J-cKc",
      "url": null,
      "actor": null,
      "commit_id": "ada89cbd4249fad5eaedfa0a173dfc911f188084",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "A few not-necessarily blocking comments, but would like to get some rationale for some decisions.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1241105052",
      "submitted_at": "2023-01-09T20:40:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ2YzdiNzhlZjI5MjRhZjcyZjY3N2NlMmE3NDcyYzI0NDcxNDFlMTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d6c7b78ef2924af72f677ce2a7472c2447141e18",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d6c7b78ef2924af72f677ce2a7472c2447141e18",
      "tree": {
        "sha": "86ca2e26e1eb0332979dc76b26431af85f7bab3a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/86ca2e26e1eb0332979dc76b26431af85f7bab3a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1605886380e4d3ff2e1236739fb800fa07322c49",
          "sha": "1605886380e4d3ff2e1236739fb800fa07322c49",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1605886380e4d3ff2e1236739fb800fa07322c49"
        }
      ],
      "message": "[validation] return wtxids of other transactions whose fees were used",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-10T10:36:57Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-12-09T13:13:49Z"
      },
      "sha": "d6c7b78ef2924af72f677ce2a7472c2447141e18"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE2OTFlYWE4MThmN2E3YjIyOTA3Zjc1NjQ5MGI4NDJkODBhOWEyMWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1691eaa818f7a7b22907f756490b842d80a9a21d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1691eaa818f7a7b22907f756490b842d80a9a21d",
      "tree": {
        "sha": "13c1c1eb75c8d1a3d432e5f35070796e0cde528c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/13c1c1eb75c8d1a3d432e5f35070796e0cde528c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d6c7b78ef2924af72f677ce2a7472c2447141e18",
          "sha": "d6c7b78ef2924af72f677ce2a7472c2447141e18",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d6c7b78ef2924af72f677ce2a7472c2447141e18"
        }
      ],
      "message": "[rpc] return effective-feerate in testmempoolaccept and submitpackage",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-10T11:06:10Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-09-28T13:07:56Z"
      },
      "sha": "1691eaa818f7a7b22907f756490b842d80a9a21d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYwMWJhYzg4Y2I5NTQwNGU3ZDM4YWM2MzQ4ZDk1OWMwZTA2YmQ5MjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/601bac88cb95404e7d38ac6348d959c0e06bd922",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/601bac88cb95404e7d38ac6348d959c0e06bd922",
      "tree": {
        "sha": "a09a4eb8113f024cc6bb7330efdeeb87f3ad4f1c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a09a4eb8113f024cc6bb7330efdeeb87f3ad4f1c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1691eaa818f7a7b22907f756490b842d80a9a21d",
          "sha": "1691eaa818f7a7b22907f756490b842d80a9a21d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1691eaa818f7a7b22907f756490b842d80a9a21d"
        }
      ],
      "message": "[rpc] return effective-includes in testmempoolaccept and submitpackage",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-10T11:07:38Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-09-28T13:07:56Z"
      },
      "sha": "601bac88cb95404e7d38ac6348d959c0e06bd922"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVlYWIzOTdiOTg0MGRlNWE0NzI5YmVhNzIzNzk0YjUyOWU1ZmNiYjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5eab397b9840de5a4729bea723794b529e5fcbb4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5eab397b9840de5a4729bea723794b529e5fcbb4",
      "tree": {
        "sha": "6a4d084470ab5b1d74fc1d15ed8e4d08e85e341c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6a4d084470ab5b1d74fc1d15ed8e4d08e85e341c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/601bac88cb95404e7d38ac6348d959c0e06bd922",
          "sha": "601bac88cb95404e7d38ac6348d959c0e06bd922",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/601bac88cb95404e7d38ac6348d959c0e06bd922"
        }
      ],
      "message": "[validation] remove PackageMempoolAcceptResult::m_package_feerate\n\nThis value creates an extremely confusing interface as its existence is\ndependent upon implementation details (whether something was submitted\non its own, etc). MempoolAcceptResult::m_effective_feerate is much more\nhelpful, as it always exists for submitted transactions.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-10T11:09:03Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-09-28T13:31:20Z"
      },
      "sha": "5eab397b9840de5a4729bea723794b529e5fcbb4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRhNDg0YmM3MzhlY2E0NzkzNmEzMWEyZTVhZDY2MzQxN2UxOWYzMTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/da484bc738eca47936a31a2e5ad663417e19f311",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/da484bc738eca47936a31a2e5ad663417e19f311",
      "tree": {
        "sha": "5b99be6ec23171e83fd879571072073931af34a9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5b99be6ec23171e83fd879571072073931af34a9"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5eab397b9840de5a4729bea723794b529e5fcbb4",
          "sha": "5eab397b9840de5a4729bea723794b529e5fcbb4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5eab397b9840de5a4729bea723794b529e5fcbb4"
        }
      ],
      "message": "[doc] release note effective-feerate and effective-includes RPC results\n\nNo release note for submitpackage because it is regtest-only.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-10T11:09:03Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-12-23T14:07:33Z"
      },
      "sha": "da484bc738eca47936a31a2e5ad663417e19f311"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRhZTgxZTAxZTg2OThlMDRhZmIwZGI0ZDE0NDI2NTljM2I0OGZjZjU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dae81e01e8698e04afb0db4d1442659c3b48fcf5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/dae81e01e8698e04afb0db4d1442659c3b48fcf5",
      "tree": {
        "sha": "0b3696f21385b56542090dcdc330a068e8d0d431",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0b3696f21385b56542090dcdc330a068e8d0d431"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/da484bc738eca47936a31a2e5ad663417e19f311",
          "sha": "da484bc738eca47936a31a2e5ad663417e19f311",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/da484bc738eca47936a31a2e5ad663417e19f311"
        }
      ],
      "message": "[refactor] rename variables in AcceptPackage for clarity",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-10T11:09:03Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-06T17:45:45Z"
      },
      "sha": "dae81e01e8698e04afb0db4d1442659c3b48fcf5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI2NGY5ZWYxN2Y2NTAwMzU4ODJkMjQwODNmYjQxOTg0NTk0MmEzYWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/264f9ef17f650035882d24083fb419845942a3ac",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/264f9ef17f650035882d24083fb419845942a3ac",
      "tree": {
        "sha": "78f76a57a788fc96da0cd91ed072e8bb04acc338",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/78f76a57a788fc96da0cd91ed072e8bb04acc338"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 78f76a57a788fc96da0cd91ed072e8bb04acc338\nparent dae81e01e8698e04afb0db4d1442659c3b48fcf5\nauthor glozow <gloriajzhao@gmail.com> 1670252152 +0000\ncommitter glozow <gloriajzhao@gmail.com> 1673349050 +0000\n\n[validation] return MempoolAcceptResult for every tx on PCKG_TX failure\n\nThis makes the interface more predictable and useful. The caller\nunderstands one or more transactions failed, and can learn what happened\nwith each transaction. We already have this information, so we might as\nwell return it.\n\nIt doesn't make sense to do this for other PackageValidationResult\nvalues because:\n- PCKG_RESULT_UNSET: this means everything succeeded, so the individual\n  failures are no longer accurate.\n- PCKG_MEMPOOL_ERROR: something went wrong with the mempool logic;\n  transaction failures might not be meaningful.\n- PCKG_POLICY: this means something was wrong with the package as a\n  whole. The caller should use the PackageValidationState to find the\n  error, rather than looking at individual MempoolAcceptResults.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8Z9f8rBYnsNBIgBFugP02+DGP7QFAmO9R7oACgkQugP02+DG\nP7RjaA//TrHvcRpI/yHKrPnmlV9dMnYYqHeYT1NxzsLn0UupXeT9oGxYlPiYXDyG\nfJHDzp6RHEwXYsMVA6PvRpi8rKTrGmUwkvHAZFyVZeC0OR6yp/eOihND2Lf7fnL+\n/Wh0SNFxaQmmiy1jKSSj6f3nvUJZHNufHBo3iwBQFX25PHy05AvVhIVQMyZHqvlv\nd4c0m/JR0/zMov+2xTcOM9/NMpKzcL0xxnv8mqcwO4No4ImYT8UQzsSSMWg3N4p6\n6SrZVdhYo/+rOpmMtWMO/wPf1z4EsNJbCvbH3DYYgTpOYs/3QnBFTpuqMIE01gPk\nXlo55Q+rDCxeylvl11SIsncsBSQWvnNGzCfU7eLZgQxTO8ejRGL/TNBVP79voltJ\nyEbq6IbIcBKAeJM2tM24rYLH7XpBKlD3C5HrmE3JYYBfXnd2ArW7k9wRrZOhszkr\nwUs52LPkpiVAg1YFj6CpJrlzE2x1H2Rs3M5JZ3J2R7rqTSaU7/5ud0xbrUvsWywD\nIADSn6vGl38uuN9aYULcGYNr5h2B4KPs4n15yLpAiDmEZh8Pah0Q3FBetgt2aqha\n230NussqQDlLhF9mZk0czhUcIZteySDbC/a0qmB4YAYm5NRC585Z+sAfK73Y6gTN\nu+RXj2N4+rGWoJPr2xaf2KkdKRzj5PhQPa9EUVPdeibPaklUJW0=\n=uTGv\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dae81e01e8698e04afb0db4d1442659c3b48fcf5",
          "sha": "dae81e01e8698e04afb0db4d1442659c3b48fcf5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/dae81e01e8698e04afb0db4d1442659c3b48fcf5"
        }
      ],
      "message": "[validation] return MempoolAcceptResult for every tx on PCKG_TX failure\n\nThis makes the interface more predictable and useful. The caller\nunderstands one or more transactions failed, and can learn what happened\nwith each transaction. We already have this information, so we might as\nwell return it.\n\nIt doesn't make sense to do this for other PackageValidationResult\nvalues because:\n- PCKG_RESULT_UNSET: this means everything succeeded, so the individual\n  failures are no longer accurate.\n- PCKG_MEMPOOL_ERROR: something went wrong with the mempool logic;\n  transaction failures might not be meaningful.\n- PCKG_POLICY: this means something was wrong with the package as a\n  whole. The caller should use the PackageValidationState to find the\n  error, rather than looking at individual MempoolAcceptResults.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2023-01-10T11:10:50Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-12-05T14:55:52Z"
      },
      "sha": "264f9ef17f650035882d24083fb419845942a3ac"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8190798746,
      "node_id": "HRFPE_lADOABII585YJIt8zwAAAAHoNaua",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8190798746",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-10T11:11:21Z"
    },
    {
      "event": "reviewed",
      "id": 1241939908,
      "node_id": "PRR_kwDOABII585KBn_E",
      "url": null,
      "actor": null,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Thanks @achow101, agree with your comments, addressed.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1241939908",
      "submitted_at": "2023-01-10T11:20:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "commented",
      "id": 1377439712,
      "node_id": "IC_kwDOABII585SGg_g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1377439712",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-10T15:24:54Z",
      "updated_at": "2023-01-10T15:24:54Z",
      "author_association": "MEMBER",
      "body": "reACK https://github.com/bitcoin/bitcoin/pull/26646/commits/264f9ef17f650035882d24083fb419845942a3ac\r\n",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1377439712",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646"
    },
    {
      "event": "reviewed",
      "id": 1242419177,
      "node_id": "PRR_kwDOABII585KDc_p",
      "url": null,
      "actor": null,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "micro nit",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#pullrequestreview-1242419177",
      "submitted_at": "2023-01-10T15:25:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
    },
    {
      "event": "commented",
      "id": 1377986578,
      "node_id": "IC_kwDOABII585SImgS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1377986578",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-10T22:37:21Z",
      "updated_at": "2023-01-10T22:37:21Z",
      "author_association": "MEMBER",
      "body": "ACK 264f9ef17f650035882d24083fb419845942a3ac",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1377986578",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646"
    },
    {
      "event": "commented",
      "id": 1378344587,
      "node_id": "IC_kwDOABII585SJ96L",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1378344587",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-11T07:36:17Z",
      "updated_at": "2023-01-11T07:36:17Z",
      "author_association": "MEMBER",
      "body": "reACK 264f9ef17f650035882d24083fb419845942a3ac",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#issuecomment-1378344587",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26646"
    },
    {
      "event": "merged",
      "id": 8201689834,
      "node_id": "ME_lADOABII585YJIt8zwAAAAHo29rq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8201689834",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "26002570ab600bc653433693b7492b85965ccbce",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/26002570ab600bc653433693b7492b85965ccbce",
      "created_at": "2023-01-11T13:26:18Z"
    },
    {
      "event": "closed",
      "id": 8201689906,
      "node_id": "CE_lADOABII585YJIt8zwAAAAHo29sy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8201689906",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-11T13:26:18Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 8201691044,
      "node_id": "HRDE_lADOABII585YJIt8zwAAAAHo29-k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8201691044",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-11T13:26:26Z"
    },
    {
      "event": "referenced",
      "id": 8202941754,
      "node_id": "REFE_lADOABII585YJIt8zwAAAAHo7vU6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8202941754",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "f5d8392ffe25829a68d48ab35fe08eacd691babd",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/f5d8392ffe25829a68d48ab35fe08eacd691babd",
      "created_at": "2023-01-11T15:37:23Z"
    },
    {
      "event": "referenced",
      "id": 8209640633,
      "node_id": "REFE_lADOABII585YJIt8zwAAAAHpVSy5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8209640633",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "bd74004532676ee040fd57a68debd830b6599adc",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd74004532676ee040fd57a68debd830b6599adc",
      "created_at": "2023-01-12T09:59:02Z"
    },
    {
      "event": "referenced",
      "id": 8216117036,
      "node_id": "REFE_lADOABII585YJIt8zwAAAAHpt_8s",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8216117036",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a2e2fda9b51b87e5b81470fc8ca0513ce06f355b",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/a2e2fda9b51b87e5b81470fc8ca0513ce06f355b",
      "created_at": "2023-01-12T23:38:31Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1041150868",
      "pull_request_review_id": 1206854880,
      "id": 1041150868,
      "node_id": "PRRC_kwDOABII584-DrOU",
      "diff_hunk": "@@ -1343,6 +1344,11 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n     // the new transactions. This ensures we don't double-count transaction counts and sizes when\n     // checking ancestor/descendant limits, or double-count transaction fees for fee-related policy.\n     ATMPArgs single_args = ATMPArgs::SingleInPackageAccept(args);\n+    // Results from individual validation. \"Mutable\" because if a transaction fails by itself but\n+    // succeeds later (i.e. when evaluated with a fee-bumping child), the result changes (though not\n+    // reflected in this map). If a transaction fails more than once, we want to return the first\n+    // result, when it was considered on its own. So changes will only be from invalid -> valid.\n+    std::map<uint256, MempoolAcceptResult> individual_results_mutable;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "139e0e10d96a53231b8c5179def33627aed48d3e",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "call this \"nonfinal\" or something seems clearer to me than mutable ",
      "created_at": "2022-12-06T15:52:18Z",
      "updated_at": "2022-12-06T16:13:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1041150868",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1041150868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1352,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1041170332",
      "pull_request_review_id": 1206854880,
      "id": 1041170332,
      "node_id": "PRRC_kwDOABII584-Dv-c",
      "diff_hunk": "@@ -1380,6 +1380,8 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c1cd5e340e277d30cf80b5a4c183db0c7b94ca1d",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "at 139e0e10d96a53231b8c5179def33627aed48d3e commenting out this line doesn't seem to fail any tests, but it does for this particular commit.",
      "created_at": "2022-12-06T16:08:56Z",
      "updated_at": "2022-12-06T16:13:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1041170332",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1041170332"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1383,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1041174515",
      "pull_request_review_id": 1206854880,
      "id": 1041174515,
      "node_id": "PRRC_kwDOABII584-Dw_z",
      "diff_hunk": "@@ -1390,24 +1396,40 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // some of them may still be valid.\n                 quit_early = true;\n                 package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n-                results.emplace(wtxid, single_res);\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n+                package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n                 txns_new.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n     if (quit_early || txns_new.empty()) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "139e0e10d96a53231b8c5179def33627aed48d3e",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ever slightly so meta, but I think `txns_new` should instead be called `package_eval_txns` or something, since there are other new transactions that have been not included in this set, due to being accepted individually. ",
      "created_at": "2022-12-06T16:12:24Z",
      "updated_at": "2022-12-06T16:13:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1041174515",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1041174515"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1409,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1041477981",
      "pull_request_review_id": 1207353140,
      "id": 1041477981,
      "node_id": "PRRC_kwDOABII584-E7Fd",
      "diff_hunk": "@@ -1380,6 +1380,8 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c1cd5e340e277d30cf80b5a4c183db0c7b94ca1d",
      "in_reply_to_id": 1041170332,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I see what you mean yeah. Will tweak the test.",
      "created_at": "2022-12-06T21:28:34Z",
      "updated_at": "2022-12-06T21:28:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1041477981",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1041477981"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1383,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1042150573",
      "pull_request_review_id": 1208338420,
      "id": 1042150573,
      "node_id": "PRRC_kwDOABII584-HfSt",
      "diff_hunk": "@@ -1380,6 +1380,8 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c1cd5e340e277d30cf80b5a4c183db0c7b94ca1d",
      "in_reply_to_id": 1041170332,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah, the problem was the same line exists in the non-quit-early case as well. Deleted that as it's incorrect - if we're not quitting early then `package_state` won't be used. The non-quit-early case shouldn't be modifying package_state. Also added a comment/rename to make this more clear.\r\n\r\nThis also has the effect of making the test fail if you comment out this line on the last commit.",
      "created_at": "2022-12-07T12:35:32Z",
      "updated_at": "2022-12-07T12:38:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1042150573",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1042150573"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1383,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1042151123",
      "pull_request_review_id": 1208338420,
      "id": 1042151123,
      "node_id": "PRRC_kwDOABII584-HfbT",
      "diff_hunk": "@@ -1343,6 +1344,11 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n     // the new transactions. This ensures we don't double-count transaction counts and sizes when\n     // checking ancestor/descendant limits, or double-count transaction fees for fee-related policy.\n     ATMPArgs single_args = ATMPArgs::SingleInPackageAccept(args);\n+    // Results from individual validation. \"Mutable\" because if a transaction fails by itself but\n+    // succeeds later (i.e. when evaluated with a fee-bumping child), the result changes (though not\n+    // reflected in this map). If a transaction fails more than once, we want to return the first\n+    // result, when it was considered on its own. So changes will only be from invalid -> valid.\n+    std::map<uint256, MempoolAcceptResult> individual_results_mutable;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "139e0e10d96a53231b8c5179def33627aed48d3e",
      "in_reply_to_id": 1041150868,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "renamed to individual_results_nonfinal",
      "created_at": "2022-12-07T12:36:04Z",
      "updated_at": "2022-12-07T12:38:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1042151123",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1042151123"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1352,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1042153215",
      "pull_request_review_id": 1208338420,
      "id": 1042153215,
      "node_id": "PRRC_kwDOABII584-Hf7_",
      "diff_hunk": "@@ -1390,24 +1396,40 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // some of them may still be valid.\n                 quit_early = true;\n                 package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n-                results.emplace(wtxid, single_res);\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n+                package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n                 txns_new.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n     if (quit_early || txns_new.empty()) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "139e0e10d96a53231b8c5179def33627aed48d3e",
      "in_reply_to_id": 1041174515,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "renamed, no problem. 3line diff",
      "created_at": "2022-12-07T12:37:50Z",
      "updated_at": "2022-12-07T12:38:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1042153215",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1042153215"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1409,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1042272401",
      "pull_request_review_id": 1208518372,
      "id": 1042272401,
      "node_id": "PRRC_kwDOABII584-H9CR",
      "diff_hunk": "@@ -1343,6 +1344,11 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n     // the new transactions. This ensures we don't double-count transaction counts and sizes when\n     // checking ancestor/descendant limits, or double-count transaction fees for fee-related policy.\n     ATMPArgs single_args = ATMPArgs::SingleInPackageAccept(args);\n+    // Results from individual validation. \"Mutable\" because if a transaction fails by itself but\n+    // succeeds later (i.e. when evaluated with a fee-bumping child), the result changes (though not\n+    // reflected in this map). If a transaction fails more than once, we want to return the first\n+    // result, when it was considered on its own. So changes will only be from invalid -> valid.\n+    std::map<uint256, MempoolAcceptResult> individual_results_mutable;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "139e0e10d96a53231b8c5179def33627aed48d3e",
      "in_reply_to_id": 1041150868,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "name is still the same as before",
      "created_at": "2022-12-07T14:27:12Z",
      "updated_at": "2022-12-07T14:34:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1042272401",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1042272401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1352,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1043849641",
      "pull_request_review_id": 1210815392,
      "id": 1043849641,
      "node_id": "PRRC_kwDOABII584-N-Gp",
      "diff_hunk": "@@ -582,6 +582,11 @@ class MemPoolAccept\n         /** Total virtual size of all transactions being replaced. */\n         size_t m_conflicting_size{0};\n \n+        /** If we're doing package validation (i.e. m_package_feerates=true), the \"effective\"\n+         * package feerate of this transaction, which may include fee and vsize of its ancestors\n+         * and/or descendants. */\n+        CFeeRate m_package_feerate{0};",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "70d1af27cfcc9db68d7f26fa15eb7ee9510bbde1",
      "in_reply_to_id": null,
      "user": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm wondering how well-defined this value is. Am I right in thinking that the calculation here is \"sum(fees_of_package_transactions)/sum(size_of_package_transactions)\"?\r\n\r\nWhat happens in this case: we have 3 transactions A -> B, C, where C is a child of both A and B.\r\n\r\nA has a low feerate and cannot make it in to the mempool by itself.  (A+B) has a high enough feerate for acceptance, but we receive for validation (A+B+C) instead.  B cannot make it in by itself, since it would be missing a parent, and we never try A+B, right?  So the package feerate for C would reflect the fees and feerate of B (which could be higher than C's own feerate, I think?).\r\n\r\nDo we require that C pay a higher feerate than any of its parents when doing package acceptance?  If not, then I'm not sure this value will always make sense, ie the package feerate of a transaction with no children ought never be greater than its own feerate.",
      "created_at": "2022-12-08T21:37:58Z",
      "updated_at": "2022-12-08T21:37:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1043849641",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1043849641"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 589,
      "original_line": 589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1043854324",
      "pull_request_review_id": 1210822120,
      "id": 1043854324,
      "node_id": "PRRC_kwDOABII584-N_P0",
      "diff_hunk": "@@ -582,6 +582,11 @@ class MemPoolAccept\n         /** Total virtual size of all transactions being replaced. */\n         size_t m_conflicting_size{0};\n \n+        /** If we're doing package validation (i.e. m_package_feerates=true), the \"effective\"\n+         * package feerate of this transaction, which may include fee and vsize of its ancestors\n+         * and/or descendants. */\n+        CFeeRate m_package_feerate{0};",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "70d1af27cfcc9db68d7f26fa15eb7ee9510bbde1",
      "in_reply_to_id": 1043849641,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Does this comment equally apply to package submission in master?",
      "created_at": "2022-12-08T21:44:52Z",
      "updated_at": "2022-12-08T21:44:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1043854324",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1043854324"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 589,
      "original_line": 589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1043876437",
      "pull_request_review_id": 1210854166,
      "id": 1043876437,
      "node_id": "PRRC_kwDOABII584-OEpV",
      "diff_hunk": "@@ -582,6 +582,11 @@ class MemPoolAccept\n         /** Total virtual size of all transactions being replaced. */\n         size_t m_conflicting_size{0};\n \n+        /** If we're doing package validation (i.e. m_package_feerates=true), the \"effective\"\n+         * package feerate of this transaction, which may include fee and vsize of its ancestors\n+         * and/or descendants. */\n+        CFeeRate m_package_feerate{0};",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "70d1af27cfcc9db68d7f26fa15eb7ee9510bbde1",
      "in_reply_to_id": 1043849641,
      "user": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think so, but I was about to write a test using the example above, except where C is 0-fee, and see if it makes it in...",
      "created_at": "2022-12-08T22:17:41Z",
      "updated_at": "2022-12-08T22:17:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1043876437",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1043876437"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 589,
      "original_line": 589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1044346662",
      "pull_request_review_id": 1211507173,
      "id": 1044346662,
      "node_id": "PRRC_kwDOABII584-P3cm",
      "diff_hunk": "@@ -582,6 +582,11 @@ class MemPoolAccept\n         /** Total virtual size of all transactions being replaced. */\n         size_t m_conflicting_size{0};\n \n+        /** If we're doing package validation (i.e. m_package_feerates=true), the \"effective\"\n+         * package feerate of this transaction, which may include fee and vsize of its ancestors\n+         * and/or descendants. */\n+        CFeeRate m_package_feerate{0};",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "70d1af27cfcc9db68d7f26fa15eb7ee9510bbde1",
      "in_reply_to_id": 1043849641,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, master does not currently handle this case because we're currently doing A, B, C individually, so we'd get 1 \"too low fee\" and 2 \"missing inputs,\" and then reject all of them. When I first tried to implement for 1-child-with-parents, I had incorrectly assumed this was okay and the code made it in before I realized - my apologies for that. The intention is definitely to fix it.\r\n\r\nRequiring C pay a higher feerate than its parents is ok in the child-with-parents scenario but not generic ancestor package scenario (imagine low fee grandparent, lower fee parent, high fee child). I think we've discussed \"for each tx in topological order, calculate its in-package ancestor set that hasn't made it in yet, and submit that as a package\" - I have drafted this [here](https://github.com/glozow/bitcoin/commit/ef4e4936ab692d87dc0d5d55ac61e13940565947).\r\n\r\nBtw this test case is implemented [here](https://github.com/glozow/bitcoin/commit/6659757cd547e4c3f6b62ef80cbc8cdda4b301b9) (it should fail on master as you expect).",
      "created_at": "2022-12-09T11:12:22Z",
      "updated_at": "2022-12-09T11:12:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1044346662",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1044346662"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 589,
      "original_line": 589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1044552718",
      "pull_request_review_id": 1211811542,
      "id": 1044552718,
      "node_id": "PRRC_kwDOABII584-QpwO",
      "diff_hunk": "@@ -582,6 +582,11 @@ class MemPoolAccept\n         /** Total virtual size of all transactions being replaced. */\n         size_t m_conflicting_size{0};\n \n+        /** If we're doing package validation (i.e. m_package_feerates=true), the \"effective\"\n+         * package feerate of this transaction, which may include fee and vsize of its ancestors\n+         * and/or descendants. */\n+        CFeeRate m_package_feerate{0};",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "70d1af27cfcc9db68d7f26fa15eb7ee9510bbde1",
      "in_reply_to_id": 1043849641,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Can confirm the patch fails as expected: the entire triangle package makes it in the mempool ",
      "created_at": "2022-12-09T15:12:27Z",
      "updated_at": "2022-12-09T15:12:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1044552718",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1044552718"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 589,
      "original_line": 589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045879297",
      "pull_request_review_id": 1213662405,
      "id": 1045879297,
      "node_id": "PRRC_kwDOABII584-VtoB",
      "diff_hunk": "@@ -275,7 +274,30 @@ BOOST_FIXTURE_TEST_CASE(package_submission_tests, TestChain100Setup)\n         BOOST_CHECK_EQUAL(result_3gen_submit.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n         BOOST_CHECK_EQUAL(result_3gen_submit.m_state.GetRejectReason(), \"package-not-child-with-parents\");\n         BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n-        BOOST_CHECK(result_3gen_submit.m_package_feerate == std::nullopt);\n+    }\n+\n+    // Parent and child package where transactions are invalid for reasons other than fee and\n+    // missing inputs, so the package validation isn't expected to happen.\n+    {\n+        CScriptWitness bad_witness;\n+        bad_witness.stack.push_back(std::vector<unsigned char>(1));\n+        CMutableTransaction mtx_parent_invalid = mtx_parent;",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: list initialization (and in a few more places down below)\r\n```suggestion\r\n        CMutableTransaction mtx_parent_invalid{mtx_parent};\r\n```",
      "created_at": "2022-12-12T14:14:50Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1045879297",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045879297"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045968527",
      "pull_request_review_id": 1213662405,
      "id": 1045968527,
      "node_id": "PRRC_kwDOABII584-WDaP",
      "diff_hunk": "@@ -1176,16 +1182,17 @@ MempoolAcceptResult MemPoolAccept::AcceptSingleTransaction(const CTransactionRef\n \n     if (!ConsensusScriptChecks(args, ws)) return MempoolAcceptResult::Failure(ws.m_state);\n \n+    const CFeeRate effective_feerate(ws.m_modified_fees, ws.m_vsize);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit\r\n```suggestion\r\n    const CFeeRate effective_feerate{ws.m_modified_fees, ws.m_vsize};\r\n```",
      "created_at": "2022-12-12T15:24:23Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1045968527",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045968527"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1189,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046011831",
      "pull_request_review_id": 1213662405,
      "id": 1046011831,
      "node_id": "PRRC_kwDOABII584-WN-3",
      "diff_hunk": "@@ -124,6 +124,7 @@ static RPCHelpMan testmempoolaccept()\n                     {RPCResult::Type::OBJ, \"fees\", /*optional=*/true, \"Transaction fees (only present if 'allowed' is true)\",\n                     {\n                         {RPCResult::Type::STR_AMOUNT, \"base\", \"transaction fee in \" + CURRENCY_UNIT},\n+                        {RPCResult::Type::STR_AMOUNT, \"effective-feerate\", /*optional=*/true, \"if something other than base feerate was used, the effective feerate in \" + CURRENCY_UNIT + \" per KvB. For example, the package feerate and/or feerate with modified fees from prioritisetransaction.\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: since this is a member of \"fees\", I think \"effective-rate\" can be a less verbose alternative (and also consistent with \"base\")\r\n```suggestion\r\n                        {RPCResult::Type::STR_AMOUNT, \"effective-rate\", /*optional=*/true, \"if something other than base feerate was used, the effective feerate in \" + CURRENCY_UNIT + \" per KvB. For example, the package feerate and/or feerate with modified fees from prioritisetransaction.\"},\r\n```",
      "created_at": "2022-12-12T15:54:58Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046011831",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046011831"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 127,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046013886",
      "pull_request_review_id": 1213662405,
      "id": 1046013886,
      "node_id": "PRRC_kwDOABII584-WOe-",
      "diff_hunk": "@@ -124,6 +124,7 @@ static RPCHelpMan testmempoolaccept()\n                     {RPCResult::Type::OBJ, \"fees\", /*optional=*/true, \"Transaction fees (only present if 'allowed' is true)\",\n                     {\n                         {RPCResult::Type::STR_AMOUNT, \"base\", \"transaction fee in \" + CURRENCY_UNIT},\n+                        {RPCResult::Type::STR_AMOUNT, \"effective-feerate\", /*optional=*/true, \"if something other than base feerate was used, the effective feerate in \" + CURRENCY_UNIT + \" per KvB. For example, the package feerate and/or feerate with modified fees from prioritisetransaction.\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046011831,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Have you considered always including this field? Besides the minimal data overhead, I don't see a reason to not always include it. Simplifies the logic for both server and client?",
      "created_at": "2022-12-12T15:56:21Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046013886",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046013886"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 127,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046025065",
      "pull_request_review_id": 1213662405,
      "id": 1046025065,
      "node_id": "PRRC_kwDOABII584-WRNp",
      "diff_hunk": "@@ -298,27 +298,19 @@ def test_submit_child_with_parents(self, num_parents, partial_submit):\n         submitpackage_result = node.submitpackage(package=[tx[\"hex\"] for tx in package_txns])\n \n         # Check that each result is present, with the correct size and fees\n-        for package_txn in package_txns:\n-            tx = package_txn[\"tx\"]\n+        for i in range(num_parents + 1):",
      "path": "test/functional/rpc_packages.py",
      "position": null,
      "original_position": 6,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "imo this is less readable than the previous `for package_txn in package_txns:`\r\n\r\n(I think the rest of the changes in this loop are an improvement)",
      "created_at": "2022-12-12T16:04:45Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046025065",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046025065"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 301,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046062544",
      "pull_request_review_id": 1213662405,
      "id": 1046062544,
      "node_id": "PRRC_kwDOABII584-WaXQ",
      "diff_hunk": "@@ -1343,6 +1344,11 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n     // the new transactions. This ensures we don't double-count transaction counts and sizes when\n     // checking ancestor/descendant limits, or double-count transaction fees for fee-related policy.\n     ATMPArgs single_args = ATMPArgs::SingleInPackageAccept(args);\n+    // Results from individual validation. \"Mutable\" because if a transaction fails by itself but\n+    // succeeds later (i.e. when evaluated with a fee-bumping child), the result changes (though not\n+    // reflected in this map). If a transaction fails more than once, we want to return the first\n+    // result, when it was considered on its own. So changes will only be from invalid -> valid.\n+    std::map<uint256, MempoolAcceptResult> individual_results_mutable;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "139e0e10d96a53231b8c5179def33627aed48d3e",
      "in_reply_to_id": 1041150868,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "alternative suggestion: \"preliminary\", but happy with \"nonfinal\" too.",
      "created_at": "2022-12-12T16:31:55Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046062544",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046062544"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1352,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046084540",
      "pull_request_review_id": 1213662405,
      "id": 1046084540,
      "node_id": "PRRC_kwDOABII584-Wfu8",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            Assume(results.find(wtxid) == results.end());\n+            results.emplace(wtxid, mempoolaccept_res);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 170,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Additional lookup can be avoided:\r\n```suggestion\r\n            Assume(results.emplace(wtxid, mempoolaccept_res).second);\r\n```",
      "created_at": "2022-12-12T16:47:16Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046084540",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046084540"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": 1411,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1412,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046117647",
      "pull_request_review_id": 1213662405,
      "id": 1046117647,
      "node_id": "PRRC_kwDOABII584-Wn0P",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            Assume(results.find(wtxid) == results.end());\n+            results.emplace(wtxid, mempoolaccept_res);\n+        }\n         // No package feerate when no package validation was done.\n-        return PackageMempoolAcceptResult(package_state, std::move(results));\n+        return PackageMempoolAcceptResult(package_state_quit_early, std::move(results));\n     }\n-    // Validate the (deduplicated) transactions as a package.\n-    auto submission_result = AcceptMultipleTransactions(txns_new, args);\n+    // Validate the (deduplicated) transactions as a package. Note that submission_result has its\n+    // own PackageValidationState; package_state is unused past this point.\n+    auto submission_result = AcceptMultipleTransactions(txns_package_eval, args);\n     // Include already-in-mempool transaction results in the final result.\n     for (const auto& [wtxid, mempoolaccept_res] : results) {\n+        Assume(submission_result.m_tx_results.find(wtxid) == submission_result.m_tx_results.end());\n         submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n     }\n-    if (submission_result.m_state.IsValid()) assert(submission_result.m_package_feerate.has_value());\n+    if (submission_result.m_state.GetResult() == PackageValidationResult::PCKG_TX) {\n+        // Package validation failed because one or more transactions failed.\n+        // Include individual previous failure reasons if they aren't provided.\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            if (submission_result.m_tx_results.find(wtxid) == submission_result.m_tx_results.end()) {\n+                submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n+            }\n+        }",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 194,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "std::map::insert [doesn't overwrite](https://en.cppreference.com/w/cpp/container/map/insert) if key already exists, so since we're not using rvalue refs I think this can be simplified without performance degradation:\r\n```suggestion\r\n        // insert doesn't overwrite existing keys\r\n        submission_result.m_tx_results.insert(individual_results_mutable.begin(), individual_results_mutable.end());\r\n```\r\n",
      "created_at": "2022-12-12T17:11:26Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046117647",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046117647"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": 1428,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1432,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046149577",
      "pull_request_review_id": 1213662405,
      "id": 1046149577,
      "node_id": "PRRC_kwDOABII584-WvnJ",
      "diff_hunk": "@@ -1390,24 +1396,40 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // some of them may still be valid.\n                 quit_early = true;\n                 package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n-                results.emplace(wtxid, single_res);\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n+                package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n                 txns_new.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n     if (quit_early || txns_new.empty()) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "139e0e10d96a53231b8c5179def33627aed48d3e",
      "in_reply_to_id": 1041174515,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sorry to bikeshed, but `txns_package_eval` is hard to understand imo. Would `txns_to_evaluate` (or `package_txns_to_evaluate`, but I think it's too verbose) work?",
      "created_at": "2022-12-12T17:35:32Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046149577",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046149577"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1409,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046155242",
      "pull_request_review_id": 1213662405,
      "id": 1046155242,
      "node_id": "PRRC_kwDOABII584-Ww_q",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            Assume(results.find(wtxid) == results.end());\n+            results.emplace(wtxid, mempoolaccept_res);\n+        }\n         // No package feerate when no package validation was done.\n-        return PackageMempoolAcceptResult(package_state, std::move(results));\n+        return PackageMempoolAcceptResult(package_state_quit_early, std::move(results));\n     }\n-    // Validate the (deduplicated) transactions as a package.\n-    auto submission_result = AcceptMultipleTransactions(txns_new, args);\n+    // Validate the (deduplicated) transactions as a package. Note that submission_result has its\n+    // own PackageValidationState; package_state is unused past this point.\n+    auto submission_result = AcceptMultipleTransactions(txns_package_eval, args);\n     // Include already-in-mempool transaction results in the final result.\n     for (const auto& [wtxid, mempoolaccept_res] : results) {\n+        Assume(submission_result.m_tx_results.find(wtxid) == submission_result.m_tx_results.end());\n         submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n     }\n-    if (submission_result.m_state.IsValid()) assert(submission_result.m_package_feerate.has_value());\n+    if (submission_result.m_state.GetResult() == PackageValidationResult::PCKG_TX) {\n+        // Package validation failed because one or more transactions failed.\n+        // Include individual previous failure reasons if they aren't provided.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 189,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: could make \"previous\" more explicit\r\n```suggestion\r\n        // Include individual failure reasons if not already provided by `AcceptSingleTransaction()`.\r\n```",
      "created_at": "2022-12-12T17:39:42Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046155242",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046155242"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1427,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046158930",
      "pull_request_review_id": 1213662405,
      "id": 1046158930,
      "node_id": "PRRC_kwDOABII584-Wx5S",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 165,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Not specific to this PR, but I think this docstring is out of date? In addition to entire package already being submitted, this block also handles the case of package containing invalid txns. Perhaps good to update now?",
      "created_at": "2022-12-12T17:42:23Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046158930",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046158930"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1408,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046160777",
      "pull_request_review_id": 1213662405,
      "id": 1046160777,
      "node_id": "PRRC_kwDOABII584-WyWJ",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            Assume(results.find(wtxid) == results.end());\n+            results.emplace(wtxid, mempoolaccept_res);\n+        }\n         // No package feerate when no package validation was done.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 172,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This comment can now be removed I think",
      "created_at": "2022-12-12T17:43:35Z",
      "updated_at": "2022-12-12T18:01:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1046160777",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046160777"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1414,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047045461",
      "pull_request_review_id": 1215300420,
      "id": 1047045461,
      "node_id": "PRRC_kwDOABII584-aKVV",
      "diff_hunk": "@@ -124,6 +124,7 @@ static RPCHelpMan testmempoolaccept()\n                     {RPCResult::Type::OBJ, \"fees\", /*optional=*/true, \"Transaction fees (only present if 'allowed' is true)\",\n                     {\n                         {RPCResult::Type::STR_AMOUNT, \"base\", \"transaction fee in \" + CURRENCY_UNIT},\n+                        {RPCResult::Type::STR_AMOUNT, \"effective-feerate\", /*optional=*/true, \"if something other than base feerate was used, the effective feerate in \" + CURRENCY_UNIT + \" per KvB. For example, the package feerate and/or feerate with modified fees from prioritisetransaction.\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046011831,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Have you considered always including this field?\r\n\r\nWe don't always know it. We could have quit validation before looking up inputs, e.g. because `CheckTransaction()` failed. It's also possible we couldn't find the inputs at all.",
      "created_at": "2022-12-13T11:37:24Z",
      "updated_at": "2022-12-13T11:37:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1047045461",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047045461"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 127,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048389293",
      "pull_request_review_id": 1217340370,
      "id": 1048389293,
      "node_id": "PRRC_kwDOABII584-fSat",
      "diff_hunk": "@@ -1176,16 +1182,17 @@ MempoolAcceptResult MemPoolAccept::AcceptSingleTransaction(const CTransactionRef\n \n     if (!ConsensusScriptChecks(args, ws)) return MempoolAcceptResult::Failure(ws.m_state);\n \n+    const CFeeRate effective_feerate(ws.m_modified_fees, ws.m_vsize);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1045968527,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In the case of virtual sizes and `CFeeRate`, we do a narrowing conversion (the `CFeeRate` ctor takes a `uint32_t`, while we use `int64_t` for `Workspace::m_vsize`), so the compiler complains. This is exactly what braced initialization is good for imo, but we should really fix them. This is an annoying thing about CFeeRate in general since we use various types for vsize around the codebase. I'd probably save this for a \"unify types used to represent virtual size\" PR.",
      "created_at": "2022-12-14T12:06:17Z",
      "updated_at": "2022-12-16T11:29:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1048389293",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048389293"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1189,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417283",
      "pull_request_review_id": 1217340370,
      "id": 1048417283,
      "node_id": "PRRC_kwDOABII584-fZQD",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 165,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046158930,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Updated",
      "created_at": "2022-12-14T12:37:31Z",
      "updated_at": "2022-12-16T11:29:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1048417283",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417283"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1408,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417365",
      "pull_request_review_id": 1217340370,
      "id": 1048417365,
      "node_id": "PRRC_kwDOABII584-fZRV",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            Assume(results.find(wtxid) == results.end());\n+            results.emplace(wtxid, mempoolaccept_res);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 170,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046084540,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks, taken",
      "created_at": "2022-12-14T12:37:36Z",
      "updated_at": "2022-12-16T11:29:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1048417365",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417365"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": 1411,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1412,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417433",
      "pull_request_review_id": 1217340370,
      "id": 1048417433,
      "node_id": "PRRC_kwDOABII584-fZSZ",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            Assume(results.find(wtxid) == results.end());\n+            results.emplace(wtxid, mempoolaccept_res);\n+        }\n         // No package feerate when no package validation was done.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 172,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046160777,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Removed, thanks",
      "created_at": "2022-12-14T12:37:41Z",
      "updated_at": "2022-12-16T11:29:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1048417433",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417433"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1414,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417615",
      "pull_request_review_id": 1217340370,
      "id": 1048417615,
      "node_id": "PRRC_kwDOABII584-fZVP",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            Assume(results.find(wtxid) == results.end());\n+            results.emplace(wtxid, mempoolaccept_res);\n+        }\n         // No package feerate when no package validation was done.\n-        return PackageMempoolAcceptResult(package_state, std::move(results));\n+        return PackageMempoolAcceptResult(package_state_quit_early, std::move(results));\n     }\n-    // Validate the (deduplicated) transactions as a package.\n-    auto submission_result = AcceptMultipleTransactions(txns_new, args);\n+    // Validate the (deduplicated) transactions as a package. Note that submission_result has its\n+    // own PackageValidationState; package_state is unused past this point.\n+    auto submission_result = AcceptMultipleTransactions(txns_package_eval, args);\n     // Include already-in-mempool transaction results in the final result.\n     for (const auto& [wtxid, mempoolaccept_res] : results) {\n+        Assume(submission_result.m_tx_results.find(wtxid) == submission_result.m_tx_results.end());\n         submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n     }\n-    if (submission_result.m_state.IsValid()) assert(submission_result.m_package_feerate.has_value());\n+    if (submission_result.m_state.GetResult() == PackageValidationResult::PCKG_TX) {\n+        // Package validation failed because one or more transactions failed.\n+        // Include individual previous failure reasons if they aren't provided.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 189,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046155242,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Clarified this comment",
      "created_at": "2022-12-14T12:37:53Z",
      "updated_at": "2022-12-16T11:29:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1048417615",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417615"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1427,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417780",
      "pull_request_review_id": 1217340370,
      "id": 1048417780,
      "node_id": "PRRC_kwDOABII584-fZX0",
      "diff_hunk": "@@ -1380,24 +1396,42 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_mutable.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_mutable.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            Assume(results.find(wtxid) == results.end());\n+            results.emplace(wtxid, mempoolaccept_res);\n+        }\n         // No package feerate when no package validation was done.\n-        return PackageMempoolAcceptResult(package_state, std::move(results));\n+        return PackageMempoolAcceptResult(package_state_quit_early, std::move(results));\n     }\n-    // Validate the (deduplicated) transactions as a package.\n-    auto submission_result = AcceptMultipleTransactions(txns_new, args);\n+    // Validate the (deduplicated) transactions as a package. Note that submission_result has its\n+    // own PackageValidationState; package_state is unused past this point.\n+    auto submission_result = AcceptMultipleTransactions(txns_package_eval, args);\n     // Include already-in-mempool transaction results in the final result.\n     for (const auto& [wtxid, mempoolaccept_res] : results) {\n+        Assume(submission_result.m_tx_results.find(wtxid) == submission_result.m_tx_results.end());\n         submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n     }\n-    if (submission_result.m_state.IsValid()) assert(submission_result.m_package_feerate.has_value());\n+    if (submission_result.m_state.GetResult() == PackageValidationResult::PCKG_TX) {\n+        // Package validation failed because one or more transactions failed.\n+        // Include individual previous failure reasons if they aren't provided.\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_mutable) {\n+            if (submission_result.m_tx_results.find(wtxid) == submission_result.m_tx_results.end()) {\n+                submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n+            }\n+        }",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 194,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046117647,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah thanks, taken",
      "created_at": "2022-12-14T12:38:01Z",
      "updated_at": "2022-12-16T11:29:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1048417780",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417780"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": 1428,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1432,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417910",
      "pull_request_review_id": 1217340370,
      "id": 1048417910,
      "node_id": "PRRC_kwDOABII584-fZZ2",
      "diff_hunk": "@@ -298,27 +298,19 @@ def test_submit_child_with_parents(self, num_parents, partial_submit):\n         submitpackage_result = node.submitpackage(package=[tx[\"hex\"] for tx in package_txns])\n \n         # Check that each result is present, with the correct size and fees\n-        for package_txn in package_txns:\n-            tx = package_txn[\"tx\"]\n+        for i in range(num_parents + 1):",
      "path": "test/functional/rpc_packages.py",
      "position": null,
      "original_position": 6,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046025065,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changed back",
      "created_at": "2022-12-14T12:38:09Z",
      "updated_at": "2022-12-16T11:29:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1048417910",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048417910"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 301,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048583003",
      "pull_request_review_id": 1217631020,
      "id": 1048583003,
      "node_id": "PRRC_kwDOABII584-gBtb",
      "diff_hunk": "@@ -1316,14 +1338,15 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n          return unconfirmed_parent_txids.count(input.prevout.hash) > 0 || m_view.HaveCoin(input.prevout);\n     };\n     if (!std::all_of(child->vin.cbegin(), child->vin.cend(), package_or_confirmed)) {\n-        package_state.Invalid(PackageValidationResult::PCKG_POLICY, \"package-not-child-with-unconfirmed-parents\");\n-        return PackageMempoolAcceptResult(package_state, {});\n+        package_state_quit_early.Invalid(PackageValidationResult::PCKG_POLICY, \"package-not-child-with-unconfirmed-parents\");\n+        return PackageMempoolAcceptResult(package_state_quit_early, {});\n     }\n     // Protect against bugs where we pull more inputs from disk that miss being added to\n     // coins_to_uncache. The backend will be connected again when needed in PreChecks.\n     m_view.SetBackend(m_dummy);\n \n     LOCK(m_pool.cs);\n+    // Stores final results that will not change.\n     std::map<const uint256, const MempoolAcceptResult> results;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 148,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "rename to `results_final` to be self documenting later?",
      "created_at": "2022-12-14T15:02:59Z",
      "updated_at": "2022-12-14T15:12:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1048583003",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048583003"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1350,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048588103",
      "pull_request_review_id": 1217631020,
      "id": 1048588103,
      "node_id": "PRRC_kwDOABII584-gC9H",
      "diff_hunk": "@@ -1380,24 +1408,38 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_nonfinal.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_nonfinal.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n-    // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n-        // No package feerate when no package validation was done.\n-        return PackageMempoolAcceptResult(package_state, std::move(results));\n+    // Quit early because package validation won't change the result or the entire package has\n+    // already been submitted.\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_nonfinal) {\n+            Assume(results.emplace(wtxid, mempoolaccept_res).second);\n+        }\n+        return PackageMempoolAcceptResult(package_state_quit_early, std::move(results));\n     }\n-    // Validate the (deduplicated) transactions as a package.\n-    auto submission_result = AcceptMultipleTransactions(txns_new, args);\n+    // Validate the (deduplicated) transactions as a package. Note that submission_result has its\n+    // own PackageValidationState; package_state is unused past this point.\n+    auto submission_result = AcceptMultipleTransactions(txns_package_eval, args);\n     // Include already-in-mempool transaction results in the final result.\n     for (const auto& [wtxid, mempoolaccept_res] : results) {\n-        submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n+        Assume(submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res).second);",
      "path": "src/validation.cpp",
      "position": 238,
      "original_position": 200,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could also assert that `m_result_type != MempoolAcceptResult::ResultType::INVALID` to catch possible regressions",
      "created_at": "2022-12-14T15:07:22Z",
      "updated_at": "2022-12-14T15:12:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1048588103",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1048588103"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1440,
      "original_line": 1440,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1050643251",
      "pull_request_review_id": 1217340370,
      "id": 1050643251,
      "node_id": "PRRC_kwDOABII584-n4sz",
      "diff_hunk": "@@ -582,6 +582,11 @@ class MemPoolAccept\n         /** Total virtual size of all transactions being replaced. */\n         size_t m_conflicting_size{0};\n \n+        /** If we're doing package validation (i.e. m_package_feerates=true), the \"effective\"\n+         * package feerate of this transaction, which may include fee and vsize of its ancestors\n+         * and/or descendants. */\n+        CFeeRate m_package_feerate{0};",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "70d1af27cfcc9db68d7f26fa15eb7ee9510bbde1",
      "in_reply_to_id": 1043849641,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Re: \"I'm wondering how well-defined this value is.\" Last push adds the wtxids of which transactions are included in the feerate, to both `MempoolAcceptResult` and the testmempoolaccept/submitpackage RPCs.\r\n\r\nRe: the problem where we don't always end up with the right transactions, might be better for another PR. I've opened #26711 to do this.",
      "created_at": "2022-12-16T11:28:09Z",
      "updated_at": "2022-12-16T11:29:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1050643251",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1050643251"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 589,
      "original_line": 589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1050643723",
      "pull_request_review_id": 1217340370,
      "id": 1050643723,
      "node_id": "PRRC_kwDOABII584-n40L",
      "diff_hunk": "@@ -275,7 +274,30 @@ BOOST_FIXTURE_TEST_CASE(package_submission_tests, TestChain100Setup)\n         BOOST_CHECK_EQUAL(result_3gen_submit.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n         BOOST_CHECK_EQUAL(result_3gen_submit.m_state.GetRejectReason(), \"package-not-child-with-parents\");\n         BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n-        BOOST_CHECK(result_3gen_submit.m_package_feerate == std::nullopt);\n+    }\n+\n+    // Parent and child package where transactions are invalid for reasons other than fee and\n+    // missing inputs, so the package validation isn't expected to happen.\n+    {\n+        CScriptWitness bad_witness;\n+        bad_witness.stack.push_back(std::vector<unsigned char>(1));\n+        CMutableTransaction mtx_parent_invalid = mtx_parent;",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1045879297,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-12-16T11:28:38Z",
      "updated_at": "2022-12-16T11:29:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1050643723",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1050643723"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1050705548",
      "pull_request_review_id": 1220770357,
      "id": 1050705548,
      "node_id": "PRRC_kwDOABII584-oH6M",
      "diff_hunk": "@@ -1176,16 +1182,17 @@ MempoolAcceptResult MemPoolAccept::AcceptSingleTransaction(const CTransactionRef\n \n     if (!ConsensusScriptChecks(args, ws)) return MempoolAcceptResult::Failure(ws.m_state);\n \n+    const CFeeRate effective_feerate(ws.m_modified_fees, ws.m_vsize);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1045968527,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Aha, good point, can't just go blindly nitting to do list initialization everywhere. However, would it then be a good starting point to just make the conversion explicit instead?\r\n```suggestion\r\n    const CFeeRate effective_feerate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\r\n```",
      "created_at": "2022-12-16T12:21:07Z",
      "updated_at": "2022-12-16T12:21:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1050705548",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1050705548"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1189,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1051480487",
      "pull_request_review_id": 1221892702,
      "id": 1051480487,
      "node_id": "PRRC_kwDOABII584-rFGn",
      "diff_hunk": "@@ -215,6 +219,15 @@ static RPCHelpMan testmempoolaccept()\n                         result_inner.pushKV(\"vsize\", virtual_size);\n                         UniValue fees(UniValue::VOBJ);\n                         fees.pushKV(\"base\", ValueFromAmount(fee));\n+                        CHECK_NONFATAL(tx_result.m_result_type == MempoolAcceptResult::ResultType::VALID);",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "in_reply_to_id": null,
      "user": {
        "login": "vincenzopalazzo",
        "id": 17150045,
        "node_id": "MDQ6VXNlcjE3MTUwMDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/17150045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vincenzopalazzo",
        "html_url": "https://github.com/vincenzopalazzo",
        "followers_url": "https://api.github.com/users/vincenzopalazzo/followers",
        "following_url": "https://api.github.com/users/vincenzopalazzo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vincenzopalazzo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vincenzopalazzo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vincenzopalazzo/subscriptions",
        "organizations_url": "https://api.github.com/users/vincenzopalazzo/orgs",
        "repos_url": "https://api.github.com/users/vincenzopalazzo/repos",
        "events_url": "https://api.github.com/users/vincenzopalazzo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vincenzopalazzo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n```\r\n\r\nThis check looks redundant? are you in an if with the condition `tx_result.m_result_type == MempoolAcceptResult::ResultType::VALID` and `tx_result` is never modified so this confused me while I was reading the code.\r\n\r\nI'm missing anything that makes this observation a dum observation?",
      "created_at": "2022-12-17T20:35:08Z",
      "updated_at": "2022-12-17T20:35:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1051480487",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1051480487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 222,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1051481458",
      "pull_request_review_id": 1221893543,
      "id": 1051481458,
      "node_id": "PRRC_kwDOABII584-rFVy",
      "diff_hunk": "@@ -864,6 +880,15 @@ static RPCHelpMan submitpackage()\n                     result_inner.pushKV(\"vsize\", int64_t{it->second.m_vsize.value()});\n                     UniValue fees(UniValue::VOBJ);\n                     fees.pushKV(\"base\", ValueFromAmount(it->second.m_base_fees.value()));\n+                    if (it->second.m_result_type == MempoolAcceptResult::ResultType::VALID &&",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 46,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "in_reply_to_id": null,
      "user": {
        "login": "vincenzopalazzo",
        "id": 17150045,
        "node_id": "MDQ6VXNlcjE3MTUwMDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/17150045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vincenzopalazzo",
        "html_url": "https://github.com/vincenzopalazzo",
        "followers_url": "https://api.github.com/users/vincenzopalazzo/followers",
        "following_url": "https://api.github.com/users/vincenzopalazzo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vincenzopalazzo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vincenzopalazzo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vincenzopalazzo/subscriptions",
        "organizations_url": "https://api.github.com/users/vincenzopalazzo/orgs",
        "repos_url": "https://api.github.com/users/vincenzopalazzo/repos",
        "events_url": "https://api.github.com/users/vincenzopalazzo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vincenzopalazzo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n                    if (tx_resultm_result_type == MempoolAcceptResult::ResultType::VALID &&\r\n```\r\nThis is a very side comment that does not point to be an annoying comment, just It is just a side note also because I noted that you use this in `testmempoolaccept`, I think it is just a historical reason?\r\n\r\n```diff\r\ndiff --git a/src/rpc/mempool.cpp b/src/rpc/mempool.cpp\r\nindex 6f08ac5e4..bc30b9a20 100644\r\n--- a/src/rpc/mempool.cpp\r\n+++ b/src/rpc/mempool.cpp\r\n@@ -871,27 +871,28 @@ static RPCHelpMan submitpackage()\r\n                 auto it = package_result.m_tx_results.find(tx->GetWitnessHash());\r\n                 CHECK_NONFATAL(it != package_result.m_tx_results.end());\r\n                 UniValue result_inner{UniValue::VOBJ};\r\n+                const auto& tx_result = it->second;\r\n                 result_inner.pushKV(\"txid\", tx->GetHash().GetHex());\r\n-                if (it->second.m_result_type == MempoolAcceptResult::ResultType::DIFFERENT_WITNESS) {\r\n-                    result_inner.pushKV(\"other-wtxid\", it->second.m_other_wtxid.value().GetHex());\r\n+                if (tx_result.m_result_type == MempoolAcceptResult::ResultType::DIFFERENT_WITNESS) {\r\n+                    result_inner.pushKV(\"other-wtxid\", tx_result.m_other_wtxid.value().GetHex());\r\n                 }\r\n-                if (it->second.m_result_type == MempoolAcceptResult::ResultType::VALID ||\r\n-                    it->second.m_result_type == MempoolAcceptResult::ResultType::MEMPOOL_ENTRY) {\r\n-                    result_inner.pushKV(\"vsize\", int64_t{it->second.m_vsize.value()});\r\n+                if (tx_result.m_result_type == MempoolAcceptResult::ResultType::VALID ||\r\n+                    tx_result.m_result_type == MempoolAcceptResult::ResultType::MEMPOOL_ENTRY) {\r\n+                    result_inner.pushKV(\"vsize\", int64_t{tx_result.m_vsize.value()});\r\n                     UniValue fees(UniValue::VOBJ);\r\n-                    fees.pushKV(\"base\", ValueFromAmount(it->second.m_base_fees.value()));\r\n-                    if (it->second.m_result_type == MempoolAcceptResult::ResultType::VALID &&\r\n-                        it->second.m_effective_feerate.value().GetFee(it->second.m_vsize.value()) != it->second.m_base_fees.value()) {\r\n-                        fees.pushKV(\"effective-feerate\", ValueFromAmount(it->second.m_effective_feerate.value().GetFeePerK()));\r\n+                    fees.pushKV(\"base\", ValueFromAmount(tx_result.m_base_fees.value()));\r\n+                    if (tx_result.m_result_type == MempoolAcceptResult::ResultType::VALID &&\r\n+                        tx_result.m_effective_feerate.value().GetFee(tx_result.m_vsize.value()) != tx_result.m_base_fees.value()) {\r\n+                        fees.pushKV(\"effective-feerate\", ValueFromAmount(tx_result.m_effective_feerate.value().GetFeePerK()));\r\n                         UniValue effective_includes_res(UniValue::VARR);\r\n-                        for (const auto& wtxid : it->second.m_wtxids_fee_calculations.value()) {\r\n+                        for (const auto& wtxid : tx_result.m_wtxids_fee_calculations.value()) {\r\n                             effective_includes_res.push_back(wtxid.ToString());\r\n                         }\r\n                         fees.pushKV(\"effective-includes\", effective_includes_res);\r\n                     }\r\n                     result_inner.pushKV(\"fees\", fees);\r\n-                    if (it->second.m_replaced_transactions.has_value()) {\r\n-                        for (const auto& ptx : it->second.m_replaced_transactions.value()) {\r\n+                    if (tx_result.m_replaced_transactions.has_value()) {\r\n+                        for (const auto& ptx : tx_result.m_replaced_transactions.value()) {\r\n                             replaced_txids.insert(ptx->GetHash());\r\n                         }\r\n                     }\r\n```",
      "created_at": "2022-12-17T20:46:51Z",
      "updated_at": "2022-12-17T20:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1051481458",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1051481458"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 883,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052373434",
      "pull_request_review_id": 1223142154,
      "id": 1052373434,
      "node_id": "PRRC_kwDOABII584-ufG6",
      "diff_hunk": "@@ -215,6 +219,15 @@ static RPCHelpMan testmempoolaccept()\n                         result_inner.pushKV(\"vsize\", virtual_size);\n                         UniValue fees(UniValue::VOBJ);\n                         fees.pushKV(\"base\", ValueFromAmount(fee));\n+                        CHECK_NONFATAL(tx_result.m_result_type == MempoolAcceptResult::ResultType::VALID);",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "in_reply_to_id": 1051480487,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point, this is redundant!",
      "created_at": "2022-12-19T15:57:08Z",
      "updated_at": "2022-12-19T16:51:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1052373434",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052373434"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 222,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052385178",
      "pull_request_review_id": 1223142154,
      "id": 1052385178,
      "node_id": "PRRC_kwDOABII584-uh-a",
      "diff_hunk": "@@ -1380,24 +1408,38 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n                 // future.  Continue individually validating the rest of the transactions, because\n                 // some of them may still be valid.\n                 quit_early = true;\n+                package_state_quit_early.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n+                individual_results_nonfinal.emplace(wtxid, single_res);\n             } else {\n-                txns_new.push_back(tx);\n+                individual_results_nonfinal.emplace(wtxid, single_res);\n+                txns_package_eval.push_back(tx);\n             }\n         }\n     }\n \n-    // Nothing to do if the entire package has already been submitted.\n-    if (quit_early || txns_new.empty()) {\n-        // No package feerate when no package validation was done.\n-        return PackageMempoolAcceptResult(package_state, std::move(results));\n+    // Quit early because package validation won't change the result or the entire package has\n+    // already been submitted.\n+    if (quit_early || txns_package_eval.empty()) {\n+        for (const auto& [wtxid, mempoolaccept_res] : individual_results_nonfinal) {\n+            Assume(results.emplace(wtxid, mempoolaccept_res).second);\n+        }\n+        return PackageMempoolAcceptResult(package_state_quit_early, std::move(results));\n     }\n-    // Validate the (deduplicated) transactions as a package.\n-    auto submission_result = AcceptMultipleTransactions(txns_new, args);\n+    // Validate the (deduplicated) transactions as a package. Note that submission_result has its\n+    // own PackageValidationState; package_state is unused past this point.\n+    auto submission_result = AcceptMultipleTransactions(txns_package_eval, args);\n     // Include already-in-mempool transaction results in the final result.\n     for (const auto& [wtxid, mempoolaccept_res] : results) {\n-        submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n+        Assume(submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res).second);",
      "path": "src/validation.cpp",
      "position": 238,
      "original_position": 200,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "in_reply_to_id": 1048588103,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good idea, added this + an Assume that the individual_results_nonfinal are all `ResultType::INVALID` above.",
      "created_at": "2022-12-19T16:08:28Z",
      "updated_at": "2022-12-19T16:51:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1052385178",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052385178"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1440,
      "original_line": 1440,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052388157",
      "pull_request_review_id": 1223142154,
      "id": 1052388157,
      "node_id": "PRRC_kwDOABII584-uis9",
      "diff_hunk": "@@ -1316,14 +1338,15 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n          return unconfirmed_parent_txids.count(input.prevout.hash) > 0 || m_view.HaveCoin(input.prevout);\n     };\n     if (!std::all_of(child->vin.cbegin(), child->vin.cend(), package_or_confirmed)) {\n-        package_state.Invalid(PackageValidationResult::PCKG_POLICY, \"package-not-child-with-unconfirmed-parents\");\n-        return PackageMempoolAcceptResult(package_state, {});\n+        package_state_quit_early.Invalid(PackageValidationResult::PCKG_POLICY, \"package-not-child-with-unconfirmed-parents\");\n+        return PackageMempoolAcceptResult(package_state_quit_early, {});\n     }\n     // Protect against bugs where we pull more inputs from disk that miss being added to\n     // coins_to_uncache. The backend will be connected again when needed in PreChecks.\n     m_view.SetBackend(m_dummy);\n \n     LOCK(m_pool.cs);\n+    // Stores final results that will not change.\n     std::map<const uint256, const MempoolAcceptResult> results;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 148,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "in_reply_to_id": 1048583003,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2022-12-19T16:11:32Z",
      "updated_at": "2022-12-19T16:51:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1052388157",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052388157"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1350,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052391894",
      "pull_request_review_id": 1223169114,
      "id": 1052391894,
      "node_id": "PRRC_kwDOABII584-ujnW",
      "diff_hunk": "@@ -1143,12 +1148,17 @@ bool MemPoolAccept::SubmitPackage(const ATMPArgs& args, std::vector<Workspace>&\n     // make sure we haven't exceeded max mempool size.\n     LimitMempoolSize(m_pool, m_active_chainstate.CoinsTip());\n \n+    std::vector<uint256> all_package_wtxids;\n+    std::transform(workspaces.cbegin(), workspaces.cend(), std::back_inserter(all_package_wtxids),\n+                   [](const auto& ws) { return ws.m_ptx->GetWitnessHash(); });\n     // Find the wtxids of the transactions that made it into the mempool. Allow partial submission,\n     // but don't report success unless they all made it into the mempool.\n     for (Workspace& ws : workspaces) {\n+        const auto effective_feerate = args.m_package_feerates ? ws.m_package_feerate : CFeeRate(ws.m_modified_fees, ws.m_vsize);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: I think this can be moved inside the if loop?",
      "created_at": "2022-12-19T16:15:21Z",
      "updated_at": "2022-12-20T22:46:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1052391894",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052391894"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1157,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052399683",
      "pull_request_review_id": 1223142154,
      "id": 1052399683,
      "node_id": "PRRC_kwDOABII584-ulhD",
      "diff_hunk": "@@ -1176,16 +1182,17 @@ MempoolAcceptResult MemPoolAccept::AcceptSingleTransaction(const CTransactionRef\n \n     if (!ConsensusScriptChecks(args, ws)) return MempoolAcceptResult::Failure(ws.m_state);\n \n+    const CFeeRate effective_feerate(ws.m_modified_fees, ws.m_vsize);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1045968527,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "applied across the effective feerate commit",
      "created_at": "2022-12-19T16:23:08Z",
      "updated_at": "2022-12-19T16:51:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1052399683",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052399683"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1189,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052427664",
      "pull_request_review_id": 1223221091,
      "id": 1052427664,
      "node_id": "PRRC_kwDOABII584-usWQ",
      "diff_hunk": "@@ -864,6 +880,15 @@ static RPCHelpMan submitpackage()\n                     result_inner.pushKV(\"vsize\", int64_t{it->second.m_vsize.value()});\n                     UniValue fees(UniValue::VOBJ);\n                     fees.pushKV(\"base\", ValueFromAmount(it->second.m_base_fees.value()));\n+                    if (it->second.m_result_type == MempoolAcceptResult::ResultType::VALID &&",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 46,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d383a65ee01eb58c011c4c056523b9a0f20d96f",
      "in_reply_to_id": 1051481458,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Applied this change to the lines touched in this PR",
      "created_at": "2022-12-19T16:52:15Z",
      "updated_at": "2022-12-19T16:52:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1052427664",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052427664"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 883,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052558352",
      "pull_request_review_id": 1223169114,
      "id": 1052558352,
      "node_id": "PRRC_kwDOABII584-vMQQ",
      "diff_hunk": "@@ -1143,12 +1148,18 @@ bool MemPoolAccept::SubmitPackage(const ATMPArgs& args, std::vector<Workspace>&\n     // make sure we haven't exceeded max mempool size.\n     LimitMempoolSize(m_pool, m_active_chainstate.CoinsTip());\n \n+    std::vector<uint256> all_package_wtxids;",
      "path": "src/validation.cpp",
      "position": 16,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "48f81f2b5e4052717989a30db942c378d369215b",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: could preallocate memory of `workspaces.size()`",
      "created_at": "2022-12-19T19:25:54Z",
      "updated_at": "2022-12-20T22:46:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1052558352",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1052558352"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1152,
      "original_line": 1152,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1053798286",
      "pull_request_review_id": 1223169114,
      "id": 1053798286,
      "node_id": "PRRC_kwDOABII584-z6-O",
      "diff_hunk": "@@ -1232,59 +1247,68 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n     if (args.m_package_feerates &&\n         !CheckFeeRate(m_total_vsize, m_total_modified_fees, placeholder_state)) {\n         package_state.Invalid(PackageValidationResult::PCKG_POLICY, \"package-fee-too-low\");\n-        return PackageMempoolAcceptResult(package_state, package_feerate, {});\n+        return PackageMempoolAcceptResult(package_state, {});\n     }\n \n     // Apply package mempool ancestor/descendant limits. Skip if there is only one transaction,\n     // because it's unnecessary. Also, CPFP carve out can increase the limit for individual\n     // transactions, but this exemption is not extended to packages in CheckPackageLimits().\n     std::string err_string;\n     if (txns.size() > 1 && !PackageMempoolChecks(txns, package_state)) {\n-        return PackageMempoolAcceptResult(package_state, package_feerate, std::move(results));\n+        return PackageMempoolAcceptResult(package_state, std::move(results));\n     }\n \n     for (Workspace& ws : workspaces) {\n+        ws.m_package_feerate = package_feerate;\n         if (!PolicyScriptChecks(args, ws)) {\n             // Exit early to avoid doing pointless work. Update the failed tx result; the rest are unfinished.\n             package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n             results.emplace(ws.m_ptx->GetWitnessHash(), MempoolAcceptResult::Failure(ws.m_state));\n-            return PackageMempoolAcceptResult(package_state, package_feerate, std::move(results));\n+            return PackageMempoolAcceptResult(package_state, std::move(results));\n         }\n         if (args.m_test_accept) {\n+            const auto effective_feerate = args.m_package_feerates ? ws.m_package_feerate :\n+                CFeeRate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\n             // When test_accept=true, transactions that pass PolicyScriptChecks are valid because there are\n             // no further mempool checks (passing PolicyScriptChecks implies passing ConsensusScriptChecks).\n+            // Note that when test_accept=true, package feerate is not used, so we only include the\n+            // 1 transaction's wtxid in MempoolAcceptResult::wtxids_fee_calculations. This should be\n+            // updated if that changes.\n+            Assume(!args.m_package_feerates);\n+            const std::vector<uint256> single_wtxid({ws.m_ptx->GetWitnessHash()});",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 90,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "48f81f2b5e4052717989a30db942c378d369215b",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit\r\n```suggestion\r\n            const std::vector<uint256> single_wtxid{ws.m_ptx->GetWitnessHash()};\r\n```",
      "created_at": "2022-12-20T22:12:11Z",
      "updated_at": "2022-12-20T22:46:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1053798286",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1053798286"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1278,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1053798401",
      "pull_request_review_id": 1223169114,
      "id": 1053798401,
      "node_id": "PRRC_kwDOABII584-z7AB",
      "diff_hunk": "@@ -1176,16 +1187,20 @@ MempoolAcceptResult MemPoolAccept::AcceptSingleTransaction(const CTransactionRef\n \n     if (!ConsensusScriptChecks(args, ws)) return MempoolAcceptResult::Failure(ws.m_state);\n \n+    const CFeeRate effective_feerate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\n+    const std::vector<uint256> single_wtxid({ws.m_ptx->GetWitnessHash()});",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "48f81f2b5e4052717989a30db942c378d369215b",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit\r\n```suggestion\r\n    const std::vector<uint256> single_wtxid{ws.m_ptx->GetWitnessHash()};\r\n```",
      "created_at": "2022-12-20T22:12:22Z",
      "updated_at": "2022-12-20T22:46:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1053798401",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1053798401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1191,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1053805893",
      "pull_request_review_id": 1223169114,
      "id": 1053805893,
      "node_id": "PRRC_kwDOABII584-z81F",
      "diff_hunk": "@@ -124,6 +124,7 @@ static RPCHelpMan testmempoolaccept()\n                     {RPCResult::Type::OBJ, \"fees\", /*optional=*/true, \"Transaction fees (only present if 'allowed' is true)\",\n                     {\n                         {RPCResult::Type::STR_AMOUNT, \"base\", \"transaction fee in \" + CURRENCY_UNIT},\n+                        {RPCResult::Type::STR_AMOUNT, \"effective-feerate\", /*optional=*/true, \"if something other than base feerate was used, the effective feerate in \" + CURRENCY_UNIT + \" per KvB. For example, the package feerate and/or feerate with modified fees from prioritisetransaction.\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046011831,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "But I think we always know it when `allowed=true`? For `fees`, the docs already state that \"(only present if 'allowed' is true)\".  So I think, consistent with `base` (which isn't optional), we can always (when `allowed=true`) return `effective-feerate`. This makes for a more consistent API imo.\r\n\r\nI suppose this also comes down to personal preference, so I'm okay leaving it as is too if you/others prefer.",
      "created_at": "2022-12-20T22:23:25Z",
      "updated_at": "2022-12-20T22:46:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1053805893",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1053805893"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 127,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1054220529",
      "pull_request_review_id": 1225830034,
      "id": 1054220529,
      "node_id": "PRRC_kwDOABII584-1iDx",
      "diff_hunk": "@@ -582,6 +582,11 @@ class MemPoolAccept\n         /** Total virtual size of all transactions being replaced. */\n         size_t m_conflicting_size{0};\n \n+        /** If we're doing package validation (i.e. m_package_feerates=true), the \"effective\"\n+         * package feerate of this transaction, which may include fee and vsize of its ancestors\n+         * and/or descendants. */\n+        CFeeRate m_package_feerate{0};",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "70d1af27cfcc9db68d7f26fa15eb7ee9510bbde1",
      "in_reply_to_id": 1043849641,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@sdaftuar comfortable with resolving for this PR?",
      "created_at": "2022-12-21T10:22:16Z",
      "updated_at": "2022-12-21T10:22:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1054220529",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1054220529"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 589,
      "original_line": 589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061843308",
      "pull_request_review_id": 1236418570,
      "id": 1061843308,
      "node_id": "PRRC_kwDOABII584_SnFs",
      "diff_hunk": "@@ -1148,14 +1148,18 @@ bool MemPoolAccept::SubmitPackage(const ATMPArgs& args, std::vector<Workspace>&\n     // make sure we haven't exceeded max mempool size.\n     LimitMempoolSize(m_pool, m_active_chainstate.CoinsTip());\n \n+    std::vector<uint256> all_package_wtxids;\n+    std::transform(workspaces.cbegin(), workspaces.cend(), std::back_inserter(all_package_wtxids),\n+                   [](const auto& ws) { return ws.m_ptx->GetWitnessHash(); });\n     // Find the wtxids of the transactions that made it into the mempool. Allow partial submission,\n     // but don't report success unless they all made it into the mempool.\n     for (Workspace& ws : workspaces) {\n         const auto effective_feerate = args.m_package_feerates ? ws.m_package_feerate :\n             CFeeRate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\n         if (m_pool.exists(GenTxid::Wtxid(ws.m_ptx->GetWitnessHash()))) {\n             results.emplace(ws.m_ptx->GetWitnessHash(),\n-                MempoolAcceptResult::Success(std::move(ws.m_replaced_transactions), ws.m_vsize, ws.m_base_fees, effective_feerate));\n+                MempoolAcceptResult::Success(std::move(ws.m_replaced_transactions), ws.m_vsize,\n+                                             ws.m_base_fees, effective_feerate, all_package_wtxids));",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d17b04977d6882e8dba6cf6c192a825a446f4ae",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 0d17b04977d6882e8dba6cf6c192a825a446f4ae \"[validation] return wtxids of other transactions whose fees were used\"\r\n\r\nMy understanding is that `effective_feerate` is computed using all of the package's txs when `args.m_package_feerates == true`, but only the workspace's single tx when that parameter is `false`. So I think it is incorrect to give `all_package_wtxids` in the latter case?",
      "created_at": "2023-01-04T20:07:31Z",
      "updated_at": "2023-01-04T20:12:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1061843308",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061843308"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1162,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062383829",
      "pull_request_review_id": 1237249918,
      "id": 1062383829,
      "node_id": "PRRC_kwDOABII584_UrDV",
      "diff_hunk": "@@ -1148,14 +1148,18 @@ bool MemPoolAccept::SubmitPackage(const ATMPArgs& args, std::vector<Workspace>&\n     // make sure we haven't exceeded max mempool size.\n     LimitMempoolSize(m_pool, m_active_chainstate.CoinsTip());\n \n+    std::vector<uint256> all_package_wtxids;\n+    std::transform(workspaces.cbegin(), workspaces.cend(), std::back_inserter(all_package_wtxids),\n+                   [](const auto& ws) { return ws.m_ptx->GetWitnessHash(); });\n     // Find the wtxids of the transactions that made it into the mempool. Allow partial submission,\n     // but don't report success unless they all made it into the mempool.\n     for (Workspace& ws : workspaces) {\n         const auto effective_feerate = args.m_package_feerates ? ws.m_package_feerate :\n             CFeeRate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\n         if (m_pool.exists(GenTxid::Wtxid(ws.m_ptx->GetWitnessHash()))) {\n             results.emplace(ws.m_ptx->GetWitnessHash(),\n-                MempoolAcceptResult::Success(std::move(ws.m_replaced_transactions), ws.m_vsize, ws.m_base_fees, effective_feerate));\n+                MempoolAcceptResult::Success(std::move(ws.m_replaced_transactions), ws.m_vsize,\n+                                             ws.m_base_fees, effective_feerate, all_package_wtxids));",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d17b04977d6882e8dba6cf6c192a825a446f4ae",
      "in_reply_to_id": 1061843308,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "We include `MempoolAcceptResult::m_effective_feerate` and `m_wtxids_fee_calculations` whenever the transaction is successful i.e. `ResultType::VALID`. I think it's still meaningful for single transactions, as it can include modified fees from prioritisetransaction. Alternatively we could return a separate result for modified fees.\r\n\r\n> My understanding is that effective_feerate is computed using all of the package's txs when args.m_package_feerates == true, but only the workspace's single tx when that parameter is false. \r\n\r\nThis is not 100% accurate - it's all of the transactions within `AcceptMultipleTransactions`, but that's not equivalent to the entire package. During a package validation (see `AcceptPackage`) we may split up a package into multiple groups for fee calculations (i.e. right now transactions can be submitted individually and with #26711 various subgroups). The hope here is for the caller to know exactly which transactions were included in the \"package feerate\" for a transaction.",
      "created_at": "2023-01-05T11:39:28Z",
      "updated_at": "2023-01-05T11:39:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1062383829",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062383829"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1162,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062690420",
      "pull_request_review_id": 1237727438,
      "id": 1062690420,
      "node_id": "PRRC_kwDOABII584_V150",
      "diff_hunk": "@@ -1148,14 +1148,18 @@ bool MemPoolAccept::SubmitPackage(const ATMPArgs& args, std::vector<Workspace>&\n     // make sure we haven't exceeded max mempool size.\n     LimitMempoolSize(m_pool, m_active_chainstate.CoinsTip());\n \n+    std::vector<uint256> all_package_wtxids;\n+    std::transform(workspaces.cbegin(), workspaces.cend(), std::back_inserter(all_package_wtxids),\n+                   [](const auto& ws) { return ws.m_ptx->GetWitnessHash(); });\n     // Find the wtxids of the transactions that made it into the mempool. Allow partial submission,\n     // but don't report success unless they all made it into the mempool.\n     for (Workspace& ws : workspaces) {\n         const auto effective_feerate = args.m_package_feerates ? ws.m_package_feerate :\n             CFeeRate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\n         if (m_pool.exists(GenTxid::Wtxid(ws.m_ptx->GetWitnessHash()))) {\n             results.emplace(ws.m_ptx->GetWitnessHash(),\n-                MempoolAcceptResult::Success(std::move(ws.m_replaced_transactions), ws.m_vsize, ws.m_base_fees, effective_feerate));\n+                MempoolAcceptResult::Success(std::move(ws.m_replaced_transactions), ws.m_vsize,\n+                                             ws.m_base_fees, effective_feerate, all_package_wtxids));",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d17b04977d6882e8dba6cf6c192a825a446f4ae",
      "in_reply_to_id": 1061843308,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Right, what I mean is that there is a mismatch between `m_effective_feerate` and `m_wtxid_fee_calculations` depending on `args.m_package_feerates`. When that parameter is true, we would correctly report `m_effective_feerate` as the package feerate and `m_wtxids_fee_calculations` as all of the wtxids in the workspaces. But when it is false, `m_effective_feerate` is the modified feerate of just the single transaction in the workspace, whereas `m_wtxid_fee_calculations` is still all of the wtxids in all of the workspaces. That is what I think is incorrect. It should be the workspace's single wtxid, rather than all of them.\r\n\r\nIt looks like the only paths to get to this code are either `args.m_package_feerates = true` or there's a single transaction. So it doesn't really matter, just feels a bit wrong.",
      "created_at": "2023-01-05T16:57:05Z",
      "updated_at": "2023-01-05T17:09:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1062690420",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062690420"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1162,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1063656033",
      "pull_request_review_id": 1239187485,
      "id": 1063656033,
      "node_id": "PRRC_kwDOABII584_Zhph",
      "diff_hunk": "@@ -1148,14 +1148,18 @@ bool MemPoolAccept::SubmitPackage(const ATMPArgs& args, std::vector<Workspace>&\n     // make sure we haven't exceeded max mempool size.\n     LimitMempoolSize(m_pool, m_active_chainstate.CoinsTip());\n \n+    std::vector<uint256> all_package_wtxids;\n+    std::transform(workspaces.cbegin(), workspaces.cend(), std::back_inserter(all_package_wtxids),\n+                   [](const auto& ws) { return ws.m_ptx->GetWitnessHash(); });\n     // Find the wtxids of the transactions that made it into the mempool. Allow partial submission,\n     // but don't report success unless they all made it into the mempool.\n     for (Workspace& ws : workspaces) {\n         const auto effective_feerate = args.m_package_feerates ? ws.m_package_feerate :\n             CFeeRate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\n         if (m_pool.exists(GenTxid::Wtxid(ws.m_ptx->GetWitnessHash()))) {\n             results.emplace(ws.m_ptx->GetWitnessHash(),\n-                MempoolAcceptResult::Success(std::move(ws.m_replaced_transactions), ws.m_vsize, ws.m_base_fees, effective_feerate));\n+                MempoolAcceptResult::Success(std::move(ws.m_replaced_transactions), ws.m_vsize,\n+                                             ws.m_base_fees, effective_feerate, all_package_wtxids));",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "0d17b04977d6882e8dba6cf6c192a825a446f4ae",
      "in_reply_to_id": 1061843308,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ohh I see, yeah that's a bit weird. Changed now.\r\n",
      "created_at": "2023-01-06T17:57:33Z",
      "updated_at": "2023-01-06T17:57:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1063656033",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1063656033"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1162,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1063656364",
      "pull_request_review_id": 1239188614,
      "id": 1063656364,
      "node_id": "PRRC_kwDOABII584_Zhus",
      "diff_hunk": "@@ -1232,59 +1247,68 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n     if (args.m_package_feerates &&\n         !CheckFeeRate(m_total_vsize, m_total_modified_fees, placeholder_state)) {\n         package_state.Invalid(PackageValidationResult::PCKG_POLICY, \"package-fee-too-low\");\n-        return PackageMempoolAcceptResult(package_state, package_feerate, {});\n+        return PackageMempoolAcceptResult(package_state, {});\n     }\n \n     // Apply package mempool ancestor/descendant limits. Skip if there is only one transaction,\n     // because it's unnecessary. Also, CPFP carve out can increase the limit for individual\n     // transactions, but this exemption is not extended to packages in CheckPackageLimits().\n     std::string err_string;\n     if (txns.size() > 1 && !PackageMempoolChecks(txns, package_state)) {\n-        return PackageMempoolAcceptResult(package_state, package_feerate, std::move(results));\n+        return PackageMempoolAcceptResult(package_state, std::move(results));\n     }\n \n     for (Workspace& ws : workspaces) {\n+        ws.m_package_feerate = package_feerate;\n         if (!PolicyScriptChecks(args, ws)) {\n             // Exit early to avoid doing pointless work. Update the failed tx result; the rest are unfinished.\n             package_state.Invalid(PackageValidationResult::PCKG_TX, \"transaction failed\");\n             results.emplace(ws.m_ptx->GetWitnessHash(), MempoolAcceptResult::Failure(ws.m_state));\n-            return PackageMempoolAcceptResult(package_state, package_feerate, std::move(results));\n+            return PackageMempoolAcceptResult(package_state, std::move(results));\n         }\n         if (args.m_test_accept) {\n+            const auto effective_feerate = args.m_package_feerates ? ws.m_package_feerate :\n+                CFeeRate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\n             // When test_accept=true, transactions that pass PolicyScriptChecks are valid because there are\n             // no further mempool checks (passing PolicyScriptChecks implies passing ConsensusScriptChecks).\n+            // Note that when test_accept=true, package feerate is not used, so we only include the\n+            // 1 transaction's wtxid in MempoolAcceptResult::wtxids_fee_calculations. This should be\n+            // updated if that changes.\n+            Assume(!args.m_package_feerates);\n+            const std::vector<uint256> single_wtxid({ws.m_ptx->GetWitnessHash()});",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 90,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "48f81f2b5e4052717989a30db942c378d369215b",
      "in_reply_to_id": 1053798286,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-01-06T17:58:05Z",
      "updated_at": "2023-01-06T17:58:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1063656364",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1063656364"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1278,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1063656625",
      "pull_request_review_id": 1239189547,
      "id": 1063656625,
      "node_id": "PRRC_kwDOABII584_Zhyx",
      "diff_hunk": "@@ -124,6 +124,7 @@ static RPCHelpMan testmempoolaccept()\n                     {RPCResult::Type::OBJ, \"fees\", /*optional=*/true, \"Transaction fees (only present if 'allowed' is true)\",\n                     {\n                         {RPCResult::Type::STR_AMOUNT, \"base\", \"transaction fee in \" + CURRENCY_UNIT},\n+                        {RPCResult::Type::STR_AMOUNT, \"effective-feerate\", /*optional=*/true, \"if something other than base feerate was used, the effective feerate in \" + CURRENCY_UNIT + \" per KvB. For example, the package feerate and/or feerate with modified fees from prioritisetransaction.\"},",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "c5ca0755273597cf1d0f1d10b6b914b13a8bb37f",
      "in_reply_to_id": 1046011831,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changed to non-optional now",
      "created_at": "2023-01-06T17:58:29Z",
      "updated_at": "2023-01-06T17:58:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1063656625",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1063656625"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 127,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064706389",
      "pull_request_review_id": 1240590839,
      "id": 1064706389,
      "node_id": "PRRC_kwDOABII584_diFV",
      "diff_hunk": "@@ -1143,12 +1148,18 @@ bool MemPoolAccept::SubmitPackage(const ATMPArgs& args, std::vector<Workspace>&\n     // make sure we haven't exceeded max mempool size.\n     LimitMempoolSize(m_pool, m_active_chainstate.CoinsTip());\n \n+    std::vector<uint256> all_package_wtxids;",
      "path": "src/validation.cpp",
      "position": 16,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "48f81f2b5e4052717989a30db942c378d369215b",
      "in_reply_to_id": 1052558352,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "note this was accomplished on line below",
      "created_at": "2023-01-09T14:34:23Z",
      "updated_at": "2023-01-09T14:39:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1064706389",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064706389"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1152,
      "original_line": 1152,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065044063",
      "pull_request_review_id": 1241105052,
      "id": 1065044063,
      "node_id": "PRRC_kwDOABII584_e0hf",
      "diff_hunk": "@@ -1265,9 +1275,14 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n                 CFeeRate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\n             // When test_accept=true, transactions that pass PolicyScriptChecks are valid because there are\n             // no further mempool checks (passing PolicyScriptChecks implies passing ConsensusScriptChecks).\n+            // Note that when test_accept=true, package feerate is not used, so we only include the\n+            // 1 transaction's wtxid in MempoolAcceptResult::wtxids_fee_calculations. This should be\n+            // updated if that changes.\n+            Assume(!args.m_package_feerates);\n+            const std::vector<uint256> single_wtxid{ws.m_ptx->GetWitnessHash()};",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "92d789b090a166ea6deebbfcbf2c1069fa8cc693",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 92d789b090a166ea6deebbfcbf2c1069fa8cc693 \"[validation] return wtxids of other transactions whose fees were used\"\r\n\r\nSince the previous commit adds the calculation for `effective_feerate` here depending on `m_package_feerates`, I would expect that the calculation for the involved wtxids would do that as well. Or the previous commit could add this `Assume` and just do the single tx feerate calculation. The behavior for setting the effective feerate and the involved txids should be unified to avoid bugs.",
      "created_at": "2023-01-09T19:47:49Z",
      "updated_at": "2023-01-09T20:40:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1065044063",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065044063"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": 1281,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1282,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065054572",
      "pull_request_review_id": 1241105052,
      "id": 1065054572,
      "node_id": "PRRC_kwDOABII584_e3Fs",
      "diff_hunk": "@@ -302,14 +302,12 @@ def test_submit_child_with_parents(self, num_parents, partial_submit):\n         for package_txn in package_txns:\n             tx = package_txn[\"tx\"]\n             assert tx.getwtxid() in submitpackage_result[\"tx-results\"]\n-            tx_result = submitpackage_result[\"tx-results\"][tx.getwtxid()]\n-            assert_equal(tx_result, {\n-                \"txid\": package_txn[\"txid\"],\n-                \"vsize\": tx.get_vsize(),\n-                \"fees\": {\n-                    \"base\": DEFAULT_FEE,\n-                }\n-            })\n+            wtxid = tx.getwtxid()\n+            assert wtxid in submitpackage_result[\"tx-results\"]\n+            tx_result = submitpackage_result[\"tx-results\"][wtxid]\n+            assert_equal(tx_result[\"txid\"], tx.rehash())\n+            assert_equal(tx_result[\"vsize\"], tx.get_vsize())\n+            assert_equal(tx_result[\"fees\"][\"base\"], DEFAULT_FEE)",
      "path": "test/functional/rpc_packages.py",
      "position": 59,
      "original_position": 17,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "57b56b7ce9ebef646d3fe3e706bf994c17864f3c",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 57b56b7ce9ebef646d3fe3e706bf994c17864f3c \"[rpc] return effective-feerate in testmempoolaccept and submitpackage\"\r\n\r\nThis change doesn't seem to be meaningful? The test passes either way.",
      "created_at": "2023-01-09T19:58:07Z",
      "updated_at": "2023-01-09T20:40:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1065054572",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065054572"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": 305,
      "original_start_line": 305,
      "start_side": "LEFT",
      "line": 316,
      "original_line": 316,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065066507",
      "pull_request_review_id": 1241105052,
      "id": 1065066507,
      "node_id": "PRRC_kwDOABII584_e6AL",
      "diff_hunk": "@@ -217,6 +218,9 @@ static RPCHelpMan testmempoolaccept()\n                         result_inner.pushKV(\"vsize\", virtual_size);\n                         UniValue fees(UniValue::VOBJ);\n                         fees.pushKV(\"base\", ValueFromAmount(fee));\n+                        if (fee != tx_result.m_effective_feerate.value().GetFee(virtual_size)) {",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "57b56b7ce9ebef646d3fe3e706bf994c17864f3c",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 57b56b7ce9ebef646d3fe3e706bf994c17864f3c \"[rpc] return effective-feerate in testmempoolaccept and submitpackage\"\r\n\r\nFor here and in `submitpackage`, it's not clear to me why `effective-feerate` and `effective-includes` should be guarded by whether it is different from the base fees. The presence (or lack thereof) of this field indicates whether this transaction was validated as part of the package, but that is also more explicitly represented by `effective-includes`. I don't think it's harmful to provide this information for all transactions.",
      "created_at": "2023-01-09T20:14:16Z",
      "updated_at": "2023-01-09T20:40:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1065066507",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065066507"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065613898",
      "pull_request_review_id": 1241939908,
      "id": 1065613898,
      "node_id": "PRRC_kwDOABII584_g_pK",
      "diff_hunk": "@@ -217,6 +218,9 @@ static RPCHelpMan testmempoolaccept()\n                         result_inner.pushKV(\"vsize\", virtual_size);\n                         UniValue fees(UniValue::VOBJ);\n                         fees.pushKV(\"base\", ValueFromAmount(fee));\n+                        if (fee != tx_result.m_effective_feerate.value().GetFee(virtual_size)) {",
      "path": "src/rpc/mempool.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "57b56b7ce9ebef646d3fe3e706bf994c17864f3c",
      "in_reply_to_id": 1065066507,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah thanks, I think I agree. For submitpackage we should continue to gate on whether the tx was in the mempool already - in that case we wouldn't know whether package feerate was used so I wouldn't want to report a potentially inaccurate feerate. Added a comment about this as well. Since testmempoolaccept doesn't allow already-in-mempool transactions, it should always have this for successful transactions.\r\n\r\nBase != effective is no longer a gate. Edited the `optional` bool for these results to reflect the status.\r\nSome tests needed to be changed (just dropping the `effective-*` results there because they aren't relevant in those tests and comparing feerates isn't handled properly in `assert_equal`).",
      "created_at": "2023-01-10T10:40:41Z",
      "updated_at": "2023-01-10T11:20:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1065613898",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065613898"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065618245",
      "pull_request_review_id": 1241939908,
      "id": 1065618245,
      "node_id": "PRRC_kwDOABII584_hAtF",
      "diff_hunk": "@@ -302,14 +302,12 @@ def test_submit_child_with_parents(self, num_parents, partial_submit):\n         for package_txn in package_txns:\n             tx = package_txn[\"tx\"]\n             assert tx.getwtxid() in submitpackage_result[\"tx-results\"]\n-            tx_result = submitpackage_result[\"tx-results\"][tx.getwtxid()]\n-            assert_equal(tx_result, {\n-                \"txid\": package_txn[\"txid\"],\n-                \"vsize\": tx.get_vsize(),\n-                \"fees\": {\n-                    \"base\": DEFAULT_FEE,\n-                }\n-            })\n+            wtxid = tx.getwtxid()\n+            assert wtxid in submitpackage_result[\"tx-results\"]\n+            tx_result = submitpackage_result[\"tx-results\"][wtxid]\n+            assert_equal(tx_result[\"txid\"], tx.rehash())\n+            assert_equal(tx_result[\"vsize\"], tx.get_vsize())\n+            assert_equal(tx_result[\"fees\"][\"base\"], DEFAULT_FEE)",
      "path": "test/functional/rpc_packages.py",
      "position": 59,
      "original_position": 17,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "57b56b7ce9ebef646d3fe3e706bf994c17864f3c",
      "in_reply_to_id": 1065054572,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ended up keeping it in latest push, as the result now includes optional fields and a feerate so we need to use `assert_fee_amount`",
      "created_at": "2023-01-10T10:44:57Z",
      "updated_at": "2023-01-10T11:20:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1065618245",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065618245"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": 305,
      "original_start_line": 305,
      "start_side": "LEFT",
      "line": 316,
      "original_line": 316,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065619534",
      "pull_request_review_id": 1241939908,
      "id": 1065619534,
      "node_id": "PRRC_kwDOABII584_hBBO",
      "diff_hunk": "@@ -1265,9 +1275,14 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n                 CFeeRate{ws.m_modified_fees, static_cast<uint32_t>(ws.m_vsize)};\n             // When test_accept=true, transactions that pass PolicyScriptChecks are valid because there are\n             // no further mempool checks (passing PolicyScriptChecks implies passing ConsensusScriptChecks).\n+            // Note that when test_accept=true, package feerate is not used, so we only include the\n+            // 1 transaction's wtxid in MempoolAcceptResult::wtxids_fee_calculations. This should be\n+            // updated if that changes.\n+            Assume(!args.m_package_feerates);\n+            const std::vector<uint256> single_wtxid{ws.m_ptx->GetWitnessHash()};",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "92d789b090a166ea6deebbfcbf2c1069fa8cc693",
      "in_reply_to_id": 1065044063,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agree this is more bug-preventative. The downside is we end up constructing `all_wtxids` without using it when doing a test package mempool accept, but seems alright.",
      "created_at": "2023-01-10T10:46:14Z",
      "updated_at": "2023-01-10T11:20:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1065619534",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065619534"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": 1281,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1282,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065917384",
      "pull_request_review_id": 1242419177,
      "id": 1065917384,
      "node_id": "PRRC_kwDOABII584_iJvI",
      "diff_hunk": "@@ -864,6 +878,17 @@ static RPCHelpMan submitpackage()\n                     result_inner.pushKV(\"vsize\", int64_t{it->second.m_vsize.value()});\n                     UniValue fees(UniValue::VOBJ);\n                     fees.pushKV(\"base\", ValueFromAmount(it->second.m_base_fees.value()));\n+                    if (tx_result.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                        // Effective feerate is not provided for MEMPOOL_ENTRY transactions even",
      "path": "src/rpc/mempool.cpp",
      "position": 52,
      "original_position": 52,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n                        // Effective feerate is not provided for MEMPOOL_ENTRY(already-in-mempool) transactions even\r\n```",
      "created_at": "2023-01-10T15:22:57Z",
      "updated_at": "2023-01-10T15:25:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1065917384",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1065917384"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 882,
      "original_line": 882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066966428",
      "pull_request_review_id": 1243869471,
      "id": 1066966428,
      "node_id": "PRRC_kwDOABII584_mJ2c",
      "diff_hunk": "@@ -1343,6 +1344,11 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n     // the new transactions. This ensures we don't double-count transaction counts and sizes when\n     // checking ancestor/descendant limits, or double-count transaction fees for fee-related policy.\n     ATMPArgs single_args = ATMPArgs::SingleInPackageAccept(args);\n+    // Results from individual validation. \"Mutable\" because if a transaction fails by itself but\n+    // succeeds later (i.e. when evaluated with a fee-bumping child), the result changes (though not\n+    // reflected in this map). If a transaction fails more than once, we want to return the first\n+    // result, when it was considered on its own. So changes will only be from invalid -> valid.\n+    std::map<uint256, MempoolAcceptResult> individual_results_mutable;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "264f9ef17f650035882d24083fb419845942a3ac",
      "original_commit_id": "139e0e10d96a53231b8c5179def33627aed48d3e",
      "in_reply_to_id": 1041150868,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't like \"preliminary\" as much as it's not guaranteed there's another round :shrug:",
      "created_at": "2023-01-11T13:03:42Z",
      "updated_at": "2023-01-11T13:03:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26646#discussion_r1066966428",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066966428"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26646"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1352,
      "side": "RIGHT"
    }
  ]
}