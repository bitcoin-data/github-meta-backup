{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26732",
    "id": 1172779825,
    "node_id": "PR_kwDOABII585F5zMx",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/26732",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/26732.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/26732.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26732/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26732/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/d7e41b63cdb612946266ec570465824b3b81491a",
    "number": 26732,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet: tx creation, don't select outputs from txes that are being replaced",
    "user": {
      "login": "furszy",
      "id": 5377650,
      "node_id": "MDQ6VXNlcjUzNzc2NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/furszy",
      "html_url": "https://github.com/furszy",
      "followers_url": "https://api.github.com/users/furszy/followers",
      "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
      "organizations_url": "https://api.github.com/users/furszy/orgs",
      "repos_url": "https://api.github.com/users/furszy/repos",
      "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/furszy/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Adding test coverage and the needed checks for two scenarios\r\nwhere the wallet create invalid transactions.\r\n\r\n\r\n#### First Scenario, Do Not Use Outputs From the Tx Being Replaced\r\n\r\nWhen the wallet creates/fund a replacement transaction, it should\r\nnot fund the new transaction with outputs belonging to the tx\r\nbeing replaced.\r\n\r\nReason:\r\nOnce replaced, those outputs are no longer going to exist, there\r\nby the created/funded transaction will be invalid.\r\n\r\n#### Second Scenario, Do Not Create BIP125 Rule 2 Invalid Txes\r\n\r\nPrevent adding new unconfirmed outputs to the transaction being\r\ncreated/funded If any preset input was already spent by a mempool\r\ntransaction.\r\n\r\nNote:\r\nBoth scenarios can can be verified cherry-picking the tests commits\r\non master. They will fail.",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2022-12-20T20:51:17Z",
    "updated_at": "2023-05-01T19:56:48Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merge_commit_sha": "ad7179470aef3400f34139535eeb074eaa13ab32",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "furszy:2022_wallet_do_not_select_utxo_from_the_tx_being_replaced",
      "ref": "2022_wallet_do_not_select_utxo_from_the_tx_being_replaced",
      "sha": "d7e41b63cdb612946266ec570465824b3b81491a",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 143624913,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDM2MjQ5MTM=",
        "name": "bitcoin-core",
        "full_name": "furszy/bitcoin-core",
        "owner": {
          "login": "furszy",
          "id": 5377650,
          "node_id": "MDQ6VXNlcjUzNzc2NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/furszy",
          "html_url": "https://github.com/furszy",
          "followers_url": "https://api.github.com/users/furszy/followers",
          "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
          "organizations_url": "https://api.github.com/users/furszy/orgs",
          "repos_url": "https://api.github.com/users/furszy/repos",
          "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/furszy/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/furszy/bitcoin-core",
        "description": "Bitcoin-Core",
        "fork": true,
        "url": "https://api.github.com/repos/furszy/bitcoin-core",
        "archive_url": "https://api.github.com/repos/furszy/bitcoin-core/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/furszy/bitcoin-core/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/furszy/bitcoin-core/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/furszy/bitcoin-core/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/furszy/bitcoin-core/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/furszy/bitcoin-core/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/furszy/bitcoin-core/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/furszy/bitcoin-core/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/furszy/bitcoin-core/contributors",
        "deployments_url": "https://api.github.com/repos/furszy/bitcoin-core/deployments",
        "downloads_url": "https://api.github.com/repos/furszy/bitcoin-core/downloads",
        "events_url": "https://api.github.com/repos/furszy/bitcoin-core/events",
        "forks_url": "https://api.github.com/repos/furszy/bitcoin-core/forks",
        "git_commits_url": "https://api.github.com/repos/furszy/bitcoin-core/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/furszy/bitcoin-core/git/tags%7B/sha%7D",
        "git_url": "git://github.com/furszy/bitcoin-core.git",
        "issue_comment_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/furszy/bitcoin-core/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/furszy/bitcoin-core/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/furszy/bitcoin-core/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/furszy/bitcoin-core/languages",
        "merges_url": "https://api.github.com/repos/furszy/bitcoin-core/merges",
        "milestones_url": "https://api.github.com/repos/furszy/bitcoin-core/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/furszy/bitcoin-core/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/furszy/bitcoin-core/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/furszy/bitcoin-core/releases%7B/id%7D",
        "ssh_url": "git@github.com:furszy/bitcoin-core.git",
        "stargazers_url": "https://api.github.com/repos/furszy/bitcoin-core/stargazers",
        "statuses_url": "https://api.github.com/repos/furszy/bitcoin-core/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/furszy/bitcoin-core/subscribers",
        "subscription_url": "https://api.github.com/repos/furszy/bitcoin-core/subscription",
        "tags_url": "https://api.github.com/repos/furszy/bitcoin-core/tags",
        "teams_url": "https://api.github.com/repos/furszy/bitcoin-core/teams",
        "trees_url": "https://api.github.com/repos/furszy/bitcoin-core/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/furszy/bitcoin-core.git",
        "hooks_url": "https://api.github.com/repos/furszy/bitcoin-core/hooks",
        "svn_url": "https://github.com/furszy/bitcoin-core",
        "homepage": "",
        "language": "C++",
        "forks_count": 2,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 380259,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T20:18:24Z",
        "created_at": "2018-08-05T15:28:43Z",
        "updated_at": "2023-02-27T18:01:49Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "f3bc1a72825fe2b51f4bc20e004cef464f05b965",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34325,
        "stargazers_count": 69818,
        "watchers_count": 69818,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T07:15:46Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T06:49:43Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26732"
      }
    },
    "author_association": "MEMBER",
    "draft": true,
    "additions": 144,
    "deletions": 14,
    "changed_files": 6,
    "commits": 5,
    "review_comments": 2,
    "comments": 8
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk3ZDJiZDQ5NzkzZTliNjZmZTg0ODMwZDliNGI2YjM1Y2QzODZiZDM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/97d2bd49793e9b66fe84830d9b4b6b35cd386bd3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/97d2bd49793e9b66fe84830d9b4b6b35cd386bd3",
      "tree": {
        "sha": "5eb933729fffea489e17cd6dca249491bea5bfd5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5eb933729fffea489e17cd6dca249491bea5bfd5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5eb933729fffea489e17cd6dca249491bea5bfd5\nparent dcdfd72861c09a7945b9facc3726177a2d06fa64\nauthor furszy <matiasfurszyfer@protonmail.com> 1671545832 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1671569222 -0300\n\nwallet: don't select outputs from txes that are being replaced\n\nWhen the wallet creates/fund a replacement transaction (spending\none or more inputs of one or many existent transactions), it should\nnot fund the new transaction with outputs belonging to the txes\nbeing replaced.\n\nReason:\nOnce replaced, those outputs are no longer going to exist, there\nby the created/funded transaction will be invalid.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmOiH0YACgkQXdI8zGhq\npiNUNg/+N1XnjXA60dr+5afEY9EDVUr5VF6wzL79xI9AXIvMttAG8EQAKBZFRwt3\nidWoi8khKcTuON22Z4GyFTwP2sjPP88biSeApxeP65auSernizXLK7uP1NLN4Dl7\n11CnoQ7RqaKITatt1F3j0PnHfSIwkiGGFA1WN8oLljC5gS+Su4XwQeQvpJUcu/mp\nr3FK2Lf/ceqlFGvqEgtdu7BuLDOMGfrMtj16Pf6N5mZdG5dXAYWnxQ5x4iaHE7Ys\n8caeQUXDwRS0mMleN8EonFK+5NpJHoJXjINlGHccagHdHgN8Rfp8AHq+URItu1KA\nt4ABP3gQ9C9XsoMlEp2vJjPIn1Jub+MFQEhc0iQLoa6D4k8wnATap9D9hW2RqQP8\nAuD6ICp6imBX9IqeTFAz2+uWuyb24lLwgURUFkzbcRQMpwopCjSOAcT7vMyvzP5l\nQzW0lpnUNOx7ofJBKa79jfG2D7CWR98u0M/xU39hF7B2xoxqF5hNRaY5RFvewTg3\ny2OZEFLn4LuBs5DQpDR8wdt2qmW5lhbMg3IHie0q4lkUPswOD6tDJ1yJlZgoERZw\nqPm0ICAuhlY3K9hUjxbYih785lj1nKuAckXVdV6HsjMgu/d64kTbVs1RgwqRp3AD\n56rzWusCR80ez6kB9CSFcyECaO7uQhEzxffJWf3jLCiyqDxE82w=\n=zml7\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dcdfd72861c09a7945b9facc3726177a2d06fa64",
          "sha": "dcdfd72861c09a7945b9facc3726177a2d06fa64",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/dcdfd72861c09a7945b9facc3726177a2d06fa64"
        }
      ],
      "message": "wallet: don't select outputs from txes that are being replaced\n\nWhen the wallet creates/fund a replacement transaction (spending\none or more inputs of one or many existent transactions), it should\nnot fund the new transaction with outputs belonging to the txes\nbeing replaced.\n\nReason:\nOnce replaced, those outputs are no longer going to exist, there\nby the created/funded transaction will be invalid.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-20T20:47:02Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-20T14:17:12Z"
      },
      "sha": "97d2bd49793e9b66fe84830d9b4b6b35cd386bd3"
    },
    {
      "event": "commented",
      "id": 1360216493,
      "node_id": "IC_kwDOABII585RE0Gt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1360216493",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-20T20:51:20Z",
      "updated_at": "2023-05-01T19:56:48Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [glozow](https://github.com/bitcoin/bitcoin/pull/26732#pullrequestreview-1408042454) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26756](https://github.com/bitcoin/bitcoin/pull/26756) (wallet: Replace `GetBalance()` logic with `AvailableCoins()` by w0xlt)\n* [#26485](https://github.com/bitcoin/bitcoin/pull/26485) (RPC: Accept options as named-only parameters by ryanofsky)\n* [#26129](https://github.com/bitcoin/bitcoin/pull/26129) (wallet, refactor: FundTransaction(): return out-params as `util::Result` structure by theStack)\n* [#25375](https://github.com/bitcoin/bitcoin/pull/25375) (rpc: add minconf/maxconf options to sendall and fund transaction calls by ishaanam)\n* [#25273](https://github.com/bitcoin/bitcoin/pull/25273) (wallet: Pass through transaction locktime and preset input sequences and scripts to CreateTransaction by achow101)\n* [#21283](https://github.com/bitcoin/bitcoin/pull/21283) (Implement BIP 370 PSBTv2 by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#issuecomment-1360216493",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732"
    },
    {
      "event": "labeled",
      "id": 8081742671,
      "node_id": "LE_lADOABII585ZuGGUzwAAAAHhtZtP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8081742671",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-20T20:51:21Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "subscribed",
      "id": 8082217052,
      "node_id": "SE_lADOABII585ZuGGUzwAAAAHhvNhc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8082217052",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-20T22:15:02Z"
    },
    {
      "event": "commented",
      "id": 1360409588,
      "node_id": "IC_kwDOABII585RFjP0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1360409588",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-20T22:44:14Z",
      "updated_at": "2022-12-20T22:44:14Z",
      "author_association": "MEMBER",
      "body": "To be clear, this is if you make a replacement manually, not with `bumpfee`. `bumpfee` avoids this problem by setting a minimum confirmations in the coin control object. IIRC BIP 125 disallows adding new unconfirmed inputs too.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#issuecomment-1360409588",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732"
    },
    {
      "event": "commented",
      "id": 1361375464,
      "node_id": "IC_kwDOABII585RJPDo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1361375464",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-21T14:23:22Z",
      "updated_at": "2022-12-21T14:24:04Z",
      "author_association": "MEMBER",
      "body": "> To be clear, this is if you make a replacement manually, not with `bumpfee`. `bumpfee` avoids this problem by setting a minimum confirmations in the coin control object.\r\n\r\nYes, could happen if you manually pre-select an input from an unconfirmed transaction and provides it to any RPC command that creates or fund a transaction (e.g. `send()`). Not an issue for `bumpfee` as it skips unconfirmed UTXOs.\r\n\r\n> IIRC BIP 125 disallows adding new unconfirmed inputs too.\r\n\r\nYou mean, grouping inputs from different unconfirmed transactions into a single replacement tx?\r\n(in other words, a single tx that replaces many unconfirmed txes).\r\n\r\nSo far, what the test proves is that the wallet, during the transaction creation process, can automatically select outputs from the unconfirmed transaction that is being replaced to use them as inputs. Which shouldn't happen as those coins will no longer exist once the tx gets replaced.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#issuecomment-1361375464",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732"
    },
    {
      "event": "commented",
      "id": 1361581365,
      "node_id": "IC_kwDOABII585RKBU1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1361581365",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-21T16:06:48Z",
      "updated_at": "2022-12-21T16:06:48Z",
      "author_association": "MEMBER",
      "body": "> You mean, grouping inputs from different unconfirmed transactions into a single replacement tx?\r\n> (in other words, a single tx that replaces many unconfirmed txes).\r\n\r\nUnconfirmed inputs that were in the original transactions being replaced are fine. It's adding new unconfirmed inputs that is not allowed.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#issuecomment-1361581365",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRiN2E1NmViOTI2MDhhNWQyNjkzYWJjM2ZmOGE1NmRhOWY3NDA1NzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b7a56eb92608a5d2693abc3ff8a56da9f740575",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4b7a56eb92608a5d2693abc3ff8a56da9f740575",
      "tree": {
        "sha": "439201482836a3dfdf766ff692f8bedd9536fd48",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/439201482836a3dfdf766ff692f8bedd9536fd48"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 439201482836a3dfdf766ff692f8bedd9536fd48\nparent 97d2bd49793e9b66fe84830d9b4b6b35cd386bd3\nauthor furszy <matiasfurszyfer@protonmail.com> 1671565786 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1671661772 -0300\n\ntest: wallet, add coverage for replacement tx coin selection\n\nThe wallet tx creation process should not select any output\nbelonging to the transaction that is being replaced.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmOjiMwACgkQXdI8zGhq\npiMIIQ/+NUCLtEKVCI35SPEWdlUMmhE9un9OxnQJSAeXzrQkJgmmE7SX6k6r0Qnd\nyWWJlQhkFlr4MJwqTHbHeC2ZqsFp1BOPQmdDGtkOY+Vvh+7aBgx2+LG5N5k69msU\nD7craX/Mzt6XtKyaIeW42D4SEeoKG6aCmx2PqngNrY5Oa9ltcT9N8u1RqFrWVBuk\nj+nKzKoF7BtAqd4kOqc1em0slwJIK18/a8BBHnNxRA7QLXWyUDfqKFb/0sLDRYDw\nGje4u7aDcfT27HLCXiTuPX8VlDud1oUI+uya6U0SUhCepz+0nVo89xrME8AHNgd/\n0utmU2bhZSH9L64EE3kcpuS9Wi8Ls1cVNvj+GNyYynRTK04Bgo5du5bdFP3hTtG+\n5qqNuOhBE35+VdrGqJWWyaUeDZcHBQHgaYd60y9Ez3ZiOI6Jn+BCMGKR5ywpP4wz\n9MCZeqCJNvYhsdX0cmbFvmm3oE2PdWF8KFnIvAbRPABWX6c/sS8ks/+Rz1ACi2dd\n79GDD6qYrB+3G5d67U9VvYsoGjxuaxtuDbFbyKr4Jt6578cy7jc54jrmyiTfkqn+\njem9MJ+Pt6AnXEmgsLzeXnyj3f3I8i5i2PtCP1v9HqOWbs2/ZQ/Q1GXqR5u5J1Je\nIcv+YPoIJBB8kVGR+ifXgNVnj5TNlWwoMGf0MPtRmKpoEA8uZhk=\n=kkvB\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/97d2bd49793e9b66fe84830d9b4b6b35cd386bd3",
          "sha": "97d2bd49793e9b66fe84830d9b4b6b35cd386bd3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/97d2bd49793e9b66fe84830d9b4b6b35cd386bd3"
        }
      ],
      "message": "test: wallet, add coverage for replacement tx coin selection\n\nThe wallet tx creation process should not select any output\nbelonging to the transaction that is being replaced.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-21T22:29:32Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-20T19:49:46Z"
      },
      "sha": "4b7a56eb92608a5d2693abc3ff8a56da9f740575"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8091042036,
      "node_id": "HRFPE_lADOABII585ZuGGUzwAAAAHiQ4D0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8091042036",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-21T22:42:36Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8096064788,
      "node_id": "HRFPE_lADOABII585ZuGGUzwAAAAHikCUU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8096064788",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-22T13:58:10Z"
    },
    {
      "event": "commented",
      "id": 1362890022,
      "node_id": "IC_kwDOABII585RPA0m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1362890022",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-22T14:15:33Z",
      "updated_at": "2022-12-22T14:23:42Z",
      "author_association": "MEMBER",
      "body": "> > You mean, grouping inputs from different unconfirmed transactions into a single replacement tx?\r\n> > (in other words, a single tx that replaces many unconfirmed txes).\r\n> \r\n> Unconfirmed inputs that were in the original transactions being replaced are fine. It's adding new unconfirmed inputs that is not allowed.\r\n\r\nGood to know. Thanks, it's BIP125 rule 2.\r\n\r\nThe wallet can create invalid transactions due not be contemplating that neither.\r\nSame as with the other case, could happen on any of the \"send*\" and \"fund*\" RPC commands, when the user preselects an output that is being used as input for another unconfirmed transaction.\r\n\r\nSo, added test coverage and internal checks for it as well.\r\n\r\nSummary:\r\nNow this PR adds support and test coverage for two different scenarios where the wallet creates invalid transactions.\r\n\r\n1) If is creating a replacement tx; in the available coins fetching process, the wallet need to skip the outputs that corresponds to the transaction being replaced (those coins are no longer going to exist once it's replaced, there by they are not \"available\").\r\n\r\n2) Prevent adding new unconfirmed outputs to the transaction being created/funded If any preset input was already spent by a mempool transaction. (BIP125 rule 2).",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#issuecomment-1362890022",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8098671985,
      "node_id": "HRFPE_lADOABII585ZuGGUzwAAAAHit-1x",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8098671985",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-22T19:47:53Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJhY2M0YzdhNzRlYjMwNTVlOTJkZmVmMTMxZWJlYjIxZDc4NWM5NmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bacc4c7a74eb3055e92dfef131ebeb21d785c96c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/bacc4c7a74eb3055e92dfef131ebeb21d785c96c",
      "tree": {
        "sha": "3d30f2e4aee683e5d0f89967dc165b282463b902",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3d30f2e4aee683e5d0f89967dc165b282463b902"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 3d30f2e4aee683e5d0f89967dc165b282463b902\nparent 4b7a56eb92608a5d2693abc3ff8a56da9f740575\nauthor furszy <matiasfurszyfer@protonmail.com> 1671737817 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1671738877 -0300\n\ninterfaces: add isSpentInMempool method\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmOktf0ACgkQXdI8zGhq\npiMochAAwSmL4kFLp2NryHT79wsOxyaHhseFmANzByRQI4wLpENmyU3JT1di5C0x\n2Q9bugLm2wIlt9Hj7gYMMBVAes0e7MZvdLj6k9joCx8cB80IgTqz3vJTwowGj8bS\nhPnYX1aWd7WKZse20WdjMUpQ18wb7ICVZoSTvHUaaVWiHnv66M34BE2rpt8DBSy9\nTGp0s7vzb7MNwjkXb+5pSZCKSIOS8bhGIfNvsNlRrVhKzoaVNbuoXsC1RE57K8rl\no93OfvunjZ+BQhd7k6BkxXkNG0MweWyMtL3dv1rXx9affLlnAyQ9e1QHFTNYwDch\npne8/KUCICdGKT9/tc1CcmAWMiJZbDE8JdJMmynbkFi62RfGovR/tPxf6UA4iIO7\nmFpHpN4r2Sux0X6I/m0fMyiEebY6idudzzprwJ4nKxEKhn7Z6K+rPiuwqu8pXlGS\n99CK97rw7eDeZc36lPOpxm++SX04548xRwZZfz/eMQdmciyTPEqhzyYL2oKAvxim\nBtmsYCasz40+TcbIjTFlEhUX5g65pBpt66N+PyKaYqGwMLR9lUAVNtGakOdWuocQ\nVFK2g4HMOvLOUz7Anmfm5nr1de+Dn4iOJxCT0b4hlw9/+ZZEbZCnmB3pAMjSdb/T\nLEJOzeAZpqySkeZjQe7g6Rg4MrRanZXhfEwtSwO4JVMcozvhl5w=\n=qReH\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b7a56eb92608a5d2693abc3ff8a56da9f740575",
          "sha": "4b7a56eb92608a5d2693abc3ff8a56da9f740575",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4b7a56eb92608a5d2693abc3ff8a56da9f740575"
        }
      ],
      "message": "interfaces: add isSpentInMempool method",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-22T19:54:37Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-22T19:36:57Z"
      },
      "sha": "bacc4c7a74eb3055e92dfef131ebeb21d785c96c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVhOGI0ZGY4Nzk4YTJjNGY5YjIzMDkwZTg3NTM5NWI1MjdiODgwNzk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5a8b4df8798a2c4f9b23090e875395b527b88079",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5a8b4df8798a2c4f9b23090e875395b527b88079",
      "tree": {
        "sha": "5e85be9fd421d89f263c866636fa3daab9716547",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5e85be9fd421d89f263c866636fa3daab9716547"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5e85be9fd421d89f263c866636fa3daab9716547\nparent bacc4c7a74eb3055e92dfef131ebeb21d785c96c\nauthor furszy <matiasfurszyfer@protonmail.com> 1671661133 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1671738877 -0300\n\nwallet: create/fund replacement tx, disallow unconfirmed UTXOs selection\n\nEnsuring that we don't add any new unconfirmed UTXOs to the replacement\ntransaction (satisfying BIP125 rule 2).\n\nnote:\nneeded to slightly adapt the 'test_add_inputs_default_value' functional\ntest case because it was creating a replacement tx and adding new\nunconfirmed inputs without noticing it (we are testing a totally\ndifferent things there).\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmOktf0ACgkQXdI8zGhq\npiOhfg//dF+VgWdGXEfElrcxOUnEw9BQGB/LQluTsQBJWxa6/b9Ctn6b/ZKq58AR\nWgVOwYtvay2Tg9UBuRjdgJgzNp3dlpeeu8kToKW5AsV6pD/YN7wUScBylgvw5Qt6\n6aFiwByPFkO5+9swFGAm7Iwf5bjA8UyCRlnnVIowvqe1esb2YMRdrq+EQTjLzIZ4\nHsscZ9Vhy63IPqKreXP/Tzc0B7zDRYkRBDKfObi+XXJ39BI2q1/sfkEOqYU1nlWz\nL4CKV1x8A0FZD7hVQ0J3Q2QhzpZNDa8SPAiNveMYTDBZXWmW2X1jWGZ48Mq9pjap\nWypqjgASznuTrHaCp1usMZZm6/KN5mWPuSQcC91baYQ2joXn4FC89cdql/hSm4jL\nO0CqQTR+XGQ3jX9S0VycYGgcY3D7bNHqi/6iPAQxSusmIlVcodpBlji9QbGeQvvE\nTAZpbUdfvVaygnkI9Bb4FyB6DA31L6q2qh5qY4ocFEeVzrXnbQe6ipnPEZJVFee+\n8zuc8/XhBe+Aebt987LuIMARY8BUzoy+3lE8BUgeoskluhwck+HNBPRiMZzaEu0c\n4iPzeN3nn+4YkB0GzNJGqLQzMANtg9L4CfOCGE8Ttf/gTMbr+PdM8WJqMK6Vie/3\n5UvMnVVsIuxxKG9Tw7H7R5fzcs40zXGDom+rjluFvq69Xcusdyw=\n=oz5z\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bacc4c7a74eb3055e92dfef131ebeb21d785c96c",
          "sha": "bacc4c7a74eb3055e92dfef131ebeb21d785c96c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/bacc4c7a74eb3055e92dfef131ebeb21d785c96c"
        }
      ],
      "message": "wallet: create/fund replacement tx, disallow unconfirmed UTXOs selection\n\nEnsuring that we don't add any new unconfirmed UTXOs to the replacement\ntransaction (satisfying BIP125 rule 2).\n\nnote:\nneeded to slightly adapt the 'test_add_inputs_default_value' functional\ntest case because it was creating a replacement tx and adding new\nunconfirmed inputs without noticing it (we are testing a totally\ndifferent things there).",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-22T19:54:37Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-21T22:18:53Z"
      },
      "sha": "5a8b4df8798a2c4f9b23090e875395b527b88079"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ3ZTQxYjYzY2RiNjEyOTQ2MjY2ZWM1NzA0NjU4MjRiM2I4MTQ5MWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d7e41b63cdb612946266ec570465824b3b81491a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d7e41b63cdb612946266ec570465824b3b81491a",
      "tree": {
        "sha": "8611510a36001e1750ee352ec6ad9ab2e123671b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8611510a36001e1750ee352ec6ad9ab2e123671b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 8611510a36001e1750ee352ec6ad9ab2e123671b\nparent 5a8b4df8798a2c4f9b23090e875395b527b88079\nauthor furszy <matiasfurszyfer@protonmail.com> 1671659729 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1671738877 -0300\n\ntest: verify wallet not creating, BIP125 rule 2 wise, invalid txes\n\nthe wallet should skip unconfirmed outputs when it is\ncreating/funding a replacement tx\n\nPer BIP125 rule 2, the replacement tx must only have unconfirmed\ninputs from the original transaction that is being replaced.\nCannot contain new unconfirmed inputs.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmOktf0ACgkQXdI8zGhq\npiNfwhAAlC83CE6nbZVBmky5wOHm2Lz9tD9E/c7noVnnI34zRoPXstVBxSr6z/7w\neT5yS5B46Z/pSe7+SSB0onssHJt39f/BWjUSJ5UeazgaKq5jkN02ChPhrDVSnaYK\njJTnm977Buj9VPQ7YdBgivsepm7zLZZO17luEIeE2wZVchGnSWLl1J5JKGpbn6cP\nQ5jXLGRwHPcbeV/7PxpUlewNm2e8aE90jg6HEU/Kwjt7yrJ8fARgeL6BsRf/qRBq\nUB0TojsFz2HO0dR7XECVrrF83d4lqmJK2OYCTyOwLdSMmoUQYftZ5B9cGHqGBGig\ndgra05Sya2XxsGy3xSPJiWruijdvgGewTCUmfnKgvkAsduxekEyTpZy7CX1cwe67\nmSF+XqfaQVZlH5v9bTGqFrGjb48wDo1hkQoS9/mMuhWL2r26I8TwahLyLmkEpIR0\noFChD+ypUgozU2yNm8bRO5UQmPj4CvlQDXDN8sMFZiheh38GV4VJ4vu6+ZViNtzU\n20rs43soXb5huJutiKrDKBO3by3SjPOxNqqe1Ttvr71EeIcHAnQIgKAUJmPV5xmr\nkW1mzcn7gRJbB/2gR/WzxrbRNEtNHkzO31AB6tB0UsSHBIyMiokz9SAMnRHZy7H4\nIhCDBcM+/qn9TZGguqXUco2+bruP5ayV+Yb6y0NUVymdtaHk3oE=\n=/jWQ\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5a8b4df8798a2c4f9b23090e875395b527b88079",
          "sha": "5a8b4df8798a2c4f9b23090e875395b527b88079",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5a8b4df8798a2c4f9b23090e875395b527b88079"
        }
      ],
      "message": "test: verify wallet not creating, BIP125 rule 2 wise, invalid txes\n\nthe wallet should skip unconfirmed outputs when it is\ncreating/funding a replacement tx\n\nPer BIP125 rule 2, the replacement tx must only have unconfirmed\ninputs from the original transaction that is being replaced.\nCannot contain new unconfirmed inputs.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-22T19:54:37Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2022-12-21T21:55:29Z"
      },
      "sha": "d7e41b63cdb612946266ec570465824b3b81491a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8098716099,
      "node_id": "HRFPE_lADOABII585ZuGGUzwAAAAHiuJnD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8098716099",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-22T19:54:52Z"
    },
    {
      "event": "reviewed",
      "id": 1228977316,
      "node_id": "PRR_kwDOABII585JQLSk",
      "url": null,
      "actor": null,
      "commit_id": "d7e41b63cdb612946266ec570465824b3b81491a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "> So far, what the test proves is that the wallet, during the transaction creation process, can automatically select outputs from the unconfirmed transaction that is being replaced to use them as inputs. Which shouldn't happen as those coins will no longer exist once the tx gets replaced.\r\n\r\nIndeed this sounds like a bug that should be fixed.\r\nWould it be better to stop + warn the user that they have selected an input that is already spent by something in this mempool, and, if this is intentional, they should use `bumpfee` RPC instead? Otherwise you end up implementing RBF checks in 2 places?",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#pullrequestreview-1228977316",
      "submitted_at": "2022-12-23T13:46:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26732"
    },
    {
      "event": "commented",
      "id": 1365455854,
      "node_id": "IC_kwDOABII585RYzPu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1365455854",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-26T21:01:26Z",
      "updated_at": "2022-12-30T12:30:47Z",
      "author_association": "MEMBER",
      "body": "> > So far, what the test proves is that the wallet, during the transaction creation process, can automatically select outputs from the unconfirmed transaction that is being replaced to use them as inputs. Which shouldn't happen as those coins will no longer exist once the tx gets replaced.\r\n> \r\n> Indeed this sounds like a bug that should be fixed. Would it be better to stop + warn the user that they have selected an input that is already spent by something in this mempool, and, if this is intentional, they should use `bumpfee` RPC instead? Otherwise you end up implementing RBF checks in 2 places?\r\n\r\nThat is a good point and topic.\r\n\r\nAnother point of view would be to understand `bumpfee` as the `sendtoaddress` of the replacement transaction creation commands: the simplest and most straightforward way to create a replacement transaction, where regular users provide few inputs and the command just work. Without almost any possible customization etc.\r\n\r\nThen, under this rationale, instead of blocking replacement txes from happening in lower level commands like `fundrawtransaction`, `walletcreatefundedpsbt` etc, it might be good to unify code (not duplicate the checks, which would be ugly for sure) and enable the same RBF validations on other processes too.\r\nOnly performing RBF checks if the crafted/funded transaction has at least one already spent input somewhere else (which only could happens if the user manually preset the input/s).\r\n\r\nWhich, based on a brief walk-through the bumpfee process, might not be that bad as we are duplicating some code that is already inside the general fundtransaction function.\r\n\r\nThen, for advanced users, this view might be more adequate as otherwise we would need to add more customization options inside `bumpfee` so it provides almost the same functionality as the other lower level commands (e.g. be able to bump a tx that have at least one input that does not belong to the wallet, be able to add new confirmed inputs manually, modify an output value, provide an input weight manually, among other \"not standard for bump txes\" flows that advanced users might want to do).\r\n\r\n---------\r\n\r\nStill.. have to say that this comes from an out loud thinking.. atm, I don't have a strong preference over any approach:\r\n The blocking approach is reasonable as it would make our life easier for the time being but then, if users start requesting tx customizations, we will end up adding lot of stuff into `bumpfee` that is already somewhere else. Which will force us to unify code anyway.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#issuecomment-1365455854",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732"
    },
    {
      "event": "labeled",
      "id": 8240659313,
      "node_id": "LE_lADOABII585ZuGGUzwAAAAHrLntx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8240659313",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T23:35:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1384672669,
      "node_id": "IC_kwDOABII585SiG2d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384672669",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-16T23:35:48Z",
      "updated_at": "2023-01-16T23:35:48Z",
      "author_association": "MEMBER",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#issuecomment-1384672669",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732"
    },
    {
      "event": "commented",
      "id": 1510018227,
      "node_id": "IC_kwDOABII585aAQyz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1510018227",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-16T01:42:59Z",
      "updated_at": "2023-04-16T01:42:59Z",
      "author_association": "MEMBER",
      "body": "<!--13523179cfe9479db18ec6c5d236f789-->\nThere hasn't been much activity lately and the patch still needs rebase. What is the status here?\n\n* Is it still relevant? ➡️ Please solve the conflicts to make it ready for review and to ensure the CI passes.\n* Is it no longer relevant? ➡️ Please close.\n* Did the author lose interest or time to work on this? ➡️ Please close it and mark it 'Up for grabs' with the label, so that it can be picked up in the future.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#issuecomment-1510018227",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26732"
    },
    {
      "event": "review_requested",
      "id": 9093989132,
      "node_id": "RRE_lADOABII585ZuGGUzwAAAAIeC0MM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9093989132",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-25T15:45:14Z",
      "requested_reviewer": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 9093990840,
      "node_id": "RRE_lADOABII585ZuGGUzwAAAAIeC0m4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9093990840",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-25T15:45:24Z",
      "requested_reviewer": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "convert_to_draft",
      "id": 9093991863,
      "node_id": "CTDE_lADOABII585ZuGGUzwAAAAIeC023",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9093991863",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-25T15:45:30Z"
    },
    {
      "event": "reviewed",
      "id": 1408042454,
      "node_id": "PRR_kwDOABII585T7QXW",
      "url": null,
      "actor": null,
      "commit_id": "d7e41b63cdb612946266ec570465824b3b81491a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK, apologies for the late re-review\r\n\r\nJust to recap the whiteboarding session we had offline, I think what we want is to add a `SanitizeCoinControl` function that can be used early on across both bumpfee and fundraw RPCs:\r\n\r\n1. If any of the selected inputs is already spent in mempool, `is_replacement=true` and keep track of which inputs are being spent again.\r\n2. If the selected inputs includes UTXOs spent and created by the same transaction (i.e. selected output from a tx that is being replaced), return error \"invalid input selection\"\r\n3. If `is_replacement=true`, automatically set `min_depth=1`\r\n4. If `is_replacement` and any of the selected inputs is `<min_depth` but not part of the replaced tx, return error \"invalid input selection\" (i.e. selected an additional unconfirmed output in an RBF)\r\n\r\nThe transactions should fail regardless, but this gives the user a helpful \"invalid input selection\" to let them know that they have manually selected some inputs that don't make sense.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#pullrequestreview-1408042454",
      "submitted_at": "2023-05-01T19:56:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26732"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056348436",
      "pull_request_review_id": 1228977316,
      "id": 1056348436,
      "node_id": "PRRC_kwDOABII584-9pkU",
      "diff_hunk": "@@ -1134,20 +1143,34 @@ bool FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& nFeeRet,\n     }\n     wallet.chain().findCoins(coins);\n \n+    // Check if any input was already spent by another tx in the mempool\n+    bool is_replacement = false;\n     for (const CTxIn& txin : tx.vin) {\n         const auto& outPoint = txin.prevout;\n         if (wallet.IsMine(outPoint)) {\n             // The input was found in the wallet, so select as internal\n             coinControl.Select(outPoint);\n+            // Check if was spent\n+            bool in_mempool = false;\n+            if (wallet.IsSpent(outPoint, &in_mempool)) is_replacement = in_mempool;\n         } else if (coins[outPoint].out.IsNull()) {\n             error = _(\"Unable to find UTXO for external input\");\n             return false;\n         } else {\n             // The input was not in the wallet, but is in the UTXO set, so select as external\n             coinControl.SelectExternal(outPoint, coins[outPoint].out);\n+            // Check if was spent in any mempool tx\n+            if (!is_replacement) is_replacement = wallet.chain().isSpentInMempool(outPoint);\n         }\n     }\n \n+    // If this tx is a replacement, disallow unconfirmed UTXO selection by rising the\n+    // coin control min depth param. Ensuring that we don't add any new unconfirmed UTXOs\n+    // to replacement transactions (satisfying BIP125 rule 2).",
      "path": "src/wallet/spend.cpp",
      "position": 43,
      "original_position": 43,
      "commit_id": "d7e41b63cdb612946266ec570465824b3b81491a",
      "original_commit_id": "d7e41b63cdb612946266ec570465824b3b81491a",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "please do not add new mentions of BIP125 that aren't signaling-related, see https://github.com/bitcoin/bitcoin/pull/25775",
      "created_at": "2022-12-23T13:36:38Z",
      "updated_at": "2022-12-23T13:46:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26732#discussion_r1056348436",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056348436"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26732"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1169,
      "original_line": 1169,
      "side": "RIGHT"
    }
  ]
}