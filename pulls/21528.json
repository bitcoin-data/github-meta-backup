{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528",
    "id": 600412693,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NjAwNDEyNjkz",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21528",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/21528.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/21528.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/3f7250b328b8b2f5d63f323702445ac5c989b73d",
    "number": 21528,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "[p2p] Reduce addr blackholes ",
    "user": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This PR builds on the test refactors extracted into #22306 (first 5 commits). \r\n\r\nThis PR aims to reduce addr blackholes. When we receive an `addr` message that contains 10 or less addresses, we forward them to 1-2 peers. This is the main technique we use for self advertisements, so sending to peers that wouldn't relay would effectively \"blackhole\" the trickle. Although we cannot prevent this in a malicious case, we can improve it for the normal, honest cases, and reduce the overall likelihood of occurrence. Two known cases where peers would not participate in addr relay are if they have connected to you as a block-relay-only connection, or if they are a light client. \r\n\r\nThis implementation defers initialization of `m_addr_known` until it is needed, then uses its presence to decide if the peer is participating in addr relay. For outbound (not block-relay-only) peers, we initialize the filter before sending the initial self announcement when processing their `version` message. For inbound peers, we initialize the filter if/when we get an addr related message (`ADDR`, `ADDRV2`, `GETADDR`). We do NOT initialize the filter based on a `SENDADDRV2` message. \r\n\r\nTo communicate about these changes beyond bitcoin core & to (try to) ensure that no other software would be disrupted, I have: \r\n- Posted to the [mailing list](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-April/018784.html)\r\n- Researched other open source clients to confirm compatibility, opened issues in all the projects & documented in https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-809906430. Many have confirmed that this change would not be problematic.\r\n- Raised as topic during [bitcoin-core-dev meeting](https://www.erisian.com.au/bitcoin-core-dev/log-2021-03-25.html#l-954)\r\n- Raised as topic during [bitcoin p2p meeting](https://www.erisian.com.au/bitcoin-core-dev/log-2021-04-20.html#l-439)",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2021-03-25T04:18:07Z",
    "updated_at": "2022-08-18T19:52:03Z",
    "closed_at": "2021-08-03T01:48:25Z",
    "mergeable_state": "unknown",
    "merged_at": "2021-08-03T01:48:25Z",
    "merge_commit_sha": "06788c67058495b9aa4044e1512f0af53d186c7e",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "amitiuttarwar:2021-03-addr-defer2",
      "ref": "2021-03-addr-defer2",
      "sha": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 164037357,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwMzczNTc=",
        "name": "bitcoin",
        "full_name": "amitiuttarwar/bitcoin",
        "owner": {
          "login": "amitiuttarwar",
          "id": 1500952,
          "node_id": "MDQ6VXNlcjE1MDA5NTI=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/amitiuttarwar",
          "html_url": "https://github.com/amitiuttarwar",
          "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
          "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
          "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
          "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
          "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/amitiuttarwar/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/amitiuttarwar/bitcoin",
        "archive_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/events",
        "forks_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/amitiuttarwar/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:amitiuttarwar/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/amitiuttarwar/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/hooks",
        "svn_url": "https://github.com/amitiuttarwar/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 4,
        "stargazers_count": 6,
        "watchers_count": 6,
        "size": 216794,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T23:05:52Z",
        "created_at": "2019-01-04T00:31:16Z",
        "updated_at": "2021-09-05T22:29:09Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "d23570098cd161fe4d2fbedcd25f563a4ca1dbd8",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69819,
        "watchers_count": 69819,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T22:42:00Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T04:47:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 144,
    "deletions": 24,
    "changed_files": 5,
    "commits": 8,
    "review_comments": 72,
    "comments": 31
  },
  "events": [
    {
      "event": "labeled",
      "id": 4505607136,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ1MDU2MDcxMzY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4505607136",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-25T04:19:18Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "reviewed",
      "id": 620728925,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjIwNzI4OTI1",
      "url": null,
      "actor": null,
      "commit_id": "cd55b53800ec63b516bdca46bfee0d57e34e3af6",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-620728925",
      "submitted_at": "2021-03-25T05:32:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "commented",
      "id": 806477418,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwNjQ3NzQxOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/806477418",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-25T08:54:46Z",
      "updated_at": "2021-07-27T22:28:39Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21515 by naumenkogs\n* #15606 by jamesob\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-806477418",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "reviewed",
      "id": 620941721,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjIwOTQxNzIx",
      "url": null,
      "actor": null,
      "commit_id": "ea30030216e1a3456ff609bba7c4d2087940478a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK. Thanks for implementing this!\r\n\r\nYou've introduced a tiny thread safety issue by accessing `m_addr_known` from multiple threads without a lock. Y'know, this'd be much tidier if the addr data was all contained in net_processing :grin: ",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-620941721",
      "submitted_at": "2021-03-25T10:32:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "commented",
      "id": 806541067,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwNjU0MTA2Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/806541067",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-25T10:36:09Z",
      "updated_at": "2021-03-25T10:36:09Z",
      "author_association": "MEMBER",
      "body": "I think that an approach like this was first suggested by AJ in https://github.com/bitcoin/bitcoin/pull/15759#issuecomment-527012757:\r\n\r\n> I think since we AdvertiseLocal regularly to our non-block-relay peers, we could just set a flag on the peer if we've ever seen an ADDR message from them, and only choose nodes with that flag in RelayAddress?\r\n\r\nI think it's a good idea, since it stops us relaying addrs to both inbound block-relay-only peers _and_ other kinds of black holes.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-806541067",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4524229187,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUyNDIyOTE4Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4524229187",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-29T22:45:50Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4524531296,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUyNDUzMTI5Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4524531296",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T00:40:50Z"
    },
    {
      "event": "renamed",
      "id": 4524670468,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50NDUyNDY3MDQ2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4524670468",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T01:39:18Z",
      "rename": {
        "from": "[net_processing] Reduce addr blackholes ",
        "to": "[p2p] Reduce addr blackholes "
      }
    },
    {
      "event": "commented",
      "id": 809906430,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTkwNjQzMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/809906430",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T04:53:07Z",
      "updated_at": "2021-07-19T21:08:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "fixed tests & added a test. patch is ready, but leaving as a draft until I gain more confidence that this would not break any other software on the network. \r\n\r\ncompiling a list of other clients & compatibility with this patch: \r\n\r\n<table>\r\n<tr>\r\n\t<td> breadwallet\r\n\t<td> ✅\r\n\t<td> \r\n\r\nSends `getaddr` & only accepts `addr` messages afterwards ([link](https://github.com/breadwallet/breadwallet-core/blob/develop/bitcoin/BRPeer.c#L283))\r\n\r\n<tr>\r\n\t<td> btcd\r\n\t<td> \r\n\r\n✅ Confirmed by @roasbeef ([issue](https://github.com/btcsuite/btcd/issues/1709))\r\n\r\n<td> \r\n\r\nAfter connecting to a new outbound peer, sends `addr` self advertisement, and sometimes sends `getaddr`. Relevant code linked in the issue. \r\n\r\n<tr>\r\n\r\n\r\n<td> libbitcoin \r\n\r\n<td>\r\n\r\n✅ Confirmed by @evoskuil ([issue](https://github.com/libbitcoin/libbitcoin-network/issues/251))\r\n\r\n<td>\r\n\r\nWhen connecting to an outbound peer, sends a `getaddr` message. \r\n\r\n\r\n<tr> \r\n\r\n<td> bitcoin knots\r\n\r\n<td> ✅\r\n\r\n<td> \r\n\r\n\r\nSame behavior as Bitcoin Core, upon receiving a `version` message, sends a `getaddr` to outbound connections unless they are block-relay only, usually also self-advertises. ([link](https://github.com/bitcoinknots/bitcoin/blob/0.21.x-knots/src/net_processing.cpp#L2488))\r\n\r\n<tr>\r\n\r\n<td> bcoin \r\n\r\n<td> \r\n\r\n✅ Confirmed by @pinheadmz ([issue](https://github.com/bcoin-org/bcoin/issues/1012)).\r\n\r\n<td>\r\n\r\nUpon opening a connection, node will self-advertise & usually send a `getaddr` message ([link](https://github.com/bcoin-org/bcoin/blob/f1abba52eda16d3981039651d0e0407e0c7fc778/lib/net/pool.js#L1269)).\r\n\r\n<tr>\r\n\r\n<td> gocoin\r\n\r\n<td>\r\n\r\n✅ Confirmed by @piotrnar ([issue](https://github.com/piotrnar/gocoin/issues/57))\r\n\r\n<td>\r\n\r\nUpon receipt of a `version` message, node will self-advertise. Node will usually also send a `getaddr` message to peers.\r\n\r\n<tr> \r\n\r\n<td> bitcore\r\n\r\n<td>\r\n\r\n✅ Confirmed by @micahriggan ([issue](https://github.com/bitpay/bitcore/issues/3140))\r\n\r\n<td>\r\n\r\nBitcore nodes typically have dedicated bitcoin node(s) and the addresses are passed in via config.\r\n\r\n<tr>\r\n\r\n<td> bitcoinj\r\n\r\n<td>\r\n\r\n✅ ([issue](https://github.com/bitcoinj/bitcoinj/issues/2123))\r\n\r\n<td> As part of connecting to a peer, the node will send a `getaddr` message on the link. \r\n\r\n</table>",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-809906430",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "reviewed",
      "id": 624095110,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjI0MDk1MTEw",
      "url": null,
      "actor": null,
      "commit_id": "9db8ab25b0aee97cad56e98200918fdf3cf849fb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "ccdle12",
        "id": 18324680,
        "node_id": "MDQ6VXNlcjE4MzI0Njgw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18324680?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ccdle12",
        "html_url": "https://github.com/ccdle12",
        "followers_url": "https://api.github.com/users/ccdle12/followers",
        "following_url": "https://api.github.com/users/ccdle12/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ccdle12/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ccdle12/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ccdle12/subscriptions",
        "organizations_url": "https://api.github.com/users/ccdle12/orgs",
        "repos_url": "https://api.github.com/users/ccdle12/repos",
        "events_url": "https://api.github.com/users/ccdle12/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ccdle12/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-624095110",
      "submitted_at": "2021-03-30T10:27:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "reviewed",
      "id": 624095310,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjI0MDk1MzEw",
      "url": null,
      "actor": null,
      "commit_id": "8e2bcc0cb68ef2f43c22d686010fde2c2b54080a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "ccdle12",
        "id": 18324680,
        "node_id": "MDQ6VXNlcjE4MzI0Njgw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18324680?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ccdle12",
        "html_url": "https://github.com/ccdle12",
        "followers_url": "https://api.github.com/users/ccdle12/followers",
        "following_url": "https://api.github.com/users/ccdle12/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ccdle12/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ccdle12/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ccdle12/subscriptions",
        "organizations_url": "https://api.github.com/users/ccdle12/orgs",
        "repos_url": "https://api.github.com/users/ccdle12/repos",
        "events_url": "https://api.github.com/users/ccdle12/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ccdle12/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-624095310",
      "submitted_at": "2021-03-30T10:27:24Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4530372095,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDUzMDM3MjA5NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4530372095",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T21:03:37Z"
    },
    {
      "event": "reviewed",
      "id": 624713468,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjI0NzEzNDY4",
      "url": null,
      "actor": null,
      "commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK to making an effort not to send addrs to peers that will likely ignore them. By \"disrupt other software on the network,\" is the concern that some nodes who aren't immediately active in addr-related dialogue might be skipped over and not hear about addrs?\r\n\r\nAt first I was confused because I figured a lot of nodes don't care about advertising their own addr (e.g. bootstrapping, in IBD, maybe not accepting inbounds). But it seems like a node making a full relay outbound will always send its own addr and a getaddr, and should thus immediately be a candidate for getting addrs forwarded to it (is this accurate?). Was there a version of Bitcoin Core that didn't send addr stuff after getting `VERSION` from outbound?",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-624713468",
      "submitted_at": "2021-03-30T22:57:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "commented",
      "id": 810762563,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDc2MjU2Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/810762563",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-31T05:01:50Z",
      "updated_at": "2021-03-31T05:01:50Z",
      "author_association": "MEMBER",
      "body": "@glozow The concern would be other Bitcoin node implementations which don't send addr/getaddr, but do care about receiving them. I don't think that's particularly likely, but it's also hard to be sure there are none.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-810762563",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 4532011537,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDUzMjAxMTUzNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4532011537",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-31T05:01:50Z"
    },
    {
      "event": "subscribed",
      "id": 4532011539,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ1MzIwMTE1Mzk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4532011539",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-31T05:01:50Z"
    },
    {
      "event": "commented",
      "id": 811184984,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMTE4NDk4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/811184984",
      "actor": {
        "login": "ivanacostarubio",
        "id": 16559,
        "node_id": "MDQ6VXNlcjE2NTU5",
        "avatar_url": "https://avatars.githubusercontent.com/u/16559?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ivanacostarubio",
        "html_url": "https://github.com/ivanacostarubio",
        "followers_url": "https://api.github.com/users/ivanacostarubio/followers",
        "following_url": "https://api.github.com/users/ivanacostarubio/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ivanacostarubio/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ivanacostarubio/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ivanacostarubio/subscriptions",
        "organizations_url": "https://api.github.com/users/ivanacostarubio/orgs",
        "repos_url": "https://api.github.com/users/ivanacostarubio/repos",
        "events_url": "https://api.github.com/users/ivanacostarubio/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ivanacostarubio/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-31T16:06:07Z",
      "updated_at": "2021-03-31T16:06:07Z",
      "author_association": "NONE",
      "body": "Concept ACK ",
      "user": {
        "login": "ivanacostarubio",
        "id": 16559,
        "node_id": "MDQ6VXNlcjE2NTU5",
        "avatar_url": "https://avatars.githubusercontent.com/u/16559?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ivanacostarubio",
        "html_url": "https://github.com/ivanacostarubio",
        "followers_url": "https://api.github.com/users/ivanacostarubio/followers",
        "following_url": "https://api.github.com/users/ivanacostarubio/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ivanacostarubio/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ivanacostarubio/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ivanacostarubio/subscriptions",
        "organizations_url": "https://api.github.com/users/ivanacostarubio/orgs",
        "repos_url": "https://api.github.com/users/ivanacostarubio/repos",
        "events_url": "https://api.github.com/users/ivanacostarubio/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ivanacostarubio/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-811184984",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "reviewed",
      "id": 625507909,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjI1NTA3OTA5",
      "url": null,
      "actor": null,
      "commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "user": {
        "login": "GeneFerneau",
        "id": 80422284,
        "node_id": "MDQ6VXNlcjgwNDIyMjg0",
        "avatar_url": "https://avatars.githubusercontent.com/u/80422284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/GeneFerneau",
        "html_url": "https://github.com/GeneFerneau",
        "followers_url": "https://api.github.com/users/GeneFerneau/followers",
        "following_url": "https://api.github.com/users/GeneFerneau/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/GeneFerneau/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/GeneFerneau/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/GeneFerneau/subscriptions",
        "organizations_url": "https://api.github.com/users/GeneFerneau/orgs",
        "repos_url": "https://api.github.com/users/GeneFerneau/repos",
        "events_url": "https://api.github.com/users/GeneFerneau/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/GeneFerneau/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-625507909",
      "submitted_at": "2021-03-31T16:46:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "commented",
      "id": 811245866,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMTI0NTg2Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/811245866",
      "actor": {
        "login": "GeneFerneau",
        "id": 80422284,
        "node_id": "MDQ6VXNlcjgwNDIyMjg0",
        "avatar_url": "https://avatars.githubusercontent.com/u/80422284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/GeneFerneau",
        "html_url": "https://github.com/GeneFerneau",
        "followers_url": "https://api.github.com/users/GeneFerneau/followers",
        "following_url": "https://api.github.com/users/GeneFerneau/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/GeneFerneau/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/GeneFerneau/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/GeneFerneau/subscriptions",
        "organizations_url": "https://api.github.com/users/GeneFerneau/orgs",
        "repos_url": "https://api.github.com/users/GeneFerneau/repos",
        "events_url": "https://api.github.com/users/GeneFerneau/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/GeneFerneau/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-31T16:49:07Z",
      "updated_at": "2021-03-31T16:49:07Z",
      "author_association": "NONE",
      "body": "Concept ACK\r\n\r\nNeed to review surrounding code more, and run the tests. Looks good so far!",
      "user": {
        "login": "GeneFerneau",
        "id": 80422284,
        "node_id": "MDQ6VXNlcjgwNDIyMjg0",
        "avatar_url": "https://avatars.githubusercontent.com/u/80422284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/GeneFerneau",
        "html_url": "https://github.com/GeneFerneau",
        "followers_url": "https://api.github.com/users/GeneFerneau/followers",
        "following_url": "https://api.github.com/users/GeneFerneau/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/GeneFerneau/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/GeneFerneau/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/GeneFerneau/subscriptions",
        "organizations_url": "https://api.github.com/users/GeneFerneau/orgs",
        "repos_url": "https://api.github.com/users/GeneFerneau/repos",
        "events_url": "https://api.github.com/users/GeneFerneau/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/GeneFerneau/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-811245866",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 4620698196,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDYyMDY5ODE5Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4620698196",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-20T17:47:13Z"
    },
    {
      "event": "subscribed",
      "id": 4620698201,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2MjA2OTgyMDE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4620698201",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-20T17:47:13Z"
    },
    {
      "event": "mentioned",
      "id": 4620718216,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDYyMDcxODIxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4620718216",
      "actor": {
        "login": "evoskuil",
        "id": 1369335,
        "node_id": "MDQ6VXNlcjEzNjkzMzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1369335?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/evoskuil",
        "html_url": "https://github.com/evoskuil",
        "followers_url": "https://api.github.com/users/evoskuil/followers",
        "following_url": "https://api.github.com/users/evoskuil/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/evoskuil/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/evoskuil/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/evoskuil/subscriptions",
        "organizations_url": "https://api.github.com/users/evoskuil/orgs",
        "repos_url": "https://api.github.com/users/evoskuil/repos",
        "events_url": "https://api.github.com/users/evoskuil/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/evoskuil/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-20T17:51:31Z"
    },
    {
      "event": "subscribed",
      "id": 4620718219,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2MjA3MTgyMTk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4620718219",
      "actor": {
        "login": "evoskuil",
        "id": 1369335,
        "node_id": "MDQ6VXNlcjEzNjkzMzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1369335?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/evoskuil",
        "html_url": "https://github.com/evoskuil",
        "followers_url": "https://api.github.com/users/evoskuil/followers",
        "following_url": "https://api.github.com/users/evoskuil/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/evoskuil/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/evoskuil/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/evoskuil/subscriptions",
        "organizations_url": "https://api.github.com/users/evoskuil/orgs",
        "repos_url": "https://api.github.com/users/evoskuil/repos",
        "events_url": "https://api.github.com/users/evoskuil/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/evoskuil/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-20T17:51:31Z"
    },
    {
      "event": "mentioned",
      "id": 4620996726,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDYyMDk5NjcyNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4620996726",
      "actor": {
        "login": "piotrnar",
        "id": 582950,
        "node_id": "MDQ6VXNlcjU4Mjk1MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/582950?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/piotrnar",
        "html_url": "https://github.com/piotrnar",
        "followers_url": "https://api.github.com/users/piotrnar/followers",
        "following_url": "https://api.github.com/users/piotrnar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/piotrnar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/piotrnar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/piotrnar/subscriptions",
        "organizations_url": "https://api.github.com/users/piotrnar/orgs",
        "repos_url": "https://api.github.com/users/piotrnar/repos",
        "events_url": "https://api.github.com/users/piotrnar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/piotrnar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-20T18:48:12Z"
    },
    {
      "event": "subscribed",
      "id": 4620996733,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2MjA5OTY3MzM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4620996733",
      "actor": {
        "login": "piotrnar",
        "id": 582950,
        "node_id": "MDQ6VXNlcjU4Mjk1MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/582950?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/piotrnar",
        "html_url": "https://github.com/piotrnar",
        "followers_url": "https://api.github.com/users/piotrnar/followers",
        "following_url": "https://api.github.com/users/piotrnar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/piotrnar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/piotrnar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/piotrnar/subscriptions",
        "organizations_url": "https://api.github.com/users/piotrnar/orgs",
        "repos_url": "https://api.github.com/users/piotrnar/repos",
        "events_url": "https://api.github.com/users/piotrnar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/piotrnar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-20T18:48:12Z"
    },
    {
      "event": "referenced",
      "id": 4642869526,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ2NDI4Njk1MjY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4642869526",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "0a0a95b9d6f97738fc48a975f3c2bf66cca854c7",
      "commit_url": "https://api.github.com/repos/MarcoFalke/b-c/commits/0a0a95b9d6f97738fc48a975f3c2bf66cca854c7",
      "created_at": "2021-04-26T07:17:13Z"
    },
    {
      "event": "commented",
      "id": 857592679,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzU5MjY3OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/857592679",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-09T10:49:28Z",
      "updated_at": "2021-06-09T10:49:28Z",
      "author_association": "MEMBER",
      "body": "Reiterating my concept ACK on this. Reducing the number of addr black holes seems like a good win for addr gossipping across the network.\r\n\r\nThis branch needs rebase now that the addr data has been moved up into net_processing. I'd be very happy to help with that if you need a hand.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-857592679",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "commented",
      "id": 857622218,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzYyMjIxOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/857622218",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-09T11:39:24Z",
      "updated_at": "2021-06-09T11:39:24Z",
      "author_association": "MEMBER",
      "body": "> Reiterating my concept ACK on this. Reducing the number of addr black holes seems like a good win for addr gossipping across the network.\r\n\r\nI think this was somewhat pending being sure it wouldn't break bitcore (see https://github.com/bitpay/bitcore/issues/3140) which now looks like it's now resolved.",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-857622218",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 4874126996,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDg3NDEyNjk5Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4874126996",
      "actor": {
        "login": "micahriggan",
        "id": 3626473,
        "node_id": "MDQ6VXNlcjM2MjY0NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3626473?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/micahriggan",
        "html_url": "https://github.com/micahriggan",
        "followers_url": "https://api.github.com/users/micahriggan/followers",
        "following_url": "https://api.github.com/users/micahriggan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/micahriggan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/micahriggan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/micahriggan/subscriptions",
        "organizations_url": "https://api.github.com/users/micahriggan/orgs",
        "repos_url": "https://api.github.com/users/micahriggan/repos",
        "events_url": "https://api.github.com/users/micahriggan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/micahriggan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-10T20:32:41Z"
    },
    {
      "event": "subscribed",
      "id": 4874127006,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ4NzQxMjcwMDY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4874127006",
      "actor": {
        "login": "micahriggan",
        "id": 3626473,
        "node_id": "MDQ6VXNlcjM2MjY0NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3626473?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/micahriggan",
        "html_url": "https://github.com/micahriggan",
        "followers_url": "https://api.github.com/users/micahriggan/followers",
        "following_url": "https://api.github.com/users/micahriggan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/micahriggan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/micahriggan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/micahriggan/subscriptions",
        "organizations_url": "https://api.github.com/users/micahriggan/orgs",
        "repos_url": "https://api.github.com/users/micahriggan/repos",
        "events_url": "https://api.github.com/users/micahriggan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/micahriggan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-10T20:32:41Z"
    },
    {
      "event": "commented",
      "id": 859973340,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg1OTk3MzM0MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/859973340",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T00:58:26Z",
      "updated_at": "2021-06-12T00:58:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Reiterating my concept ACK on this\r\n\r\nThanks! \r\n\r\n> I think this was somewhat pending being sure it wouldn't break bitcore (see bitpay/bitcore#3140) which now looks like it's now resolved.\r\n\r\nIndeed. I'm now working to rebase & bring this PR out of draft. I've rebased locally but am working through some test failures, I hope to have this ready for review by early next week. \r\n\r\nPS: I also investigated bitcoinj & opened an issue on their repo, they also seem compatible 🎉. ",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-859973340",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4888691098,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDg4ODY5MTA5OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4888691098",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-15T01:22:25Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4888713408,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDg4ODcxMzQwOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4888713408",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-15T01:32:18Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4888749135,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDg4ODc0OTEzNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4888749135",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-15T01:48:49Z"
    },
    {
      "event": "commented",
      "id": 861114349,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTExNDM0OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861114349",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-15T02:04:45Z",
      "updated_at": "2021-06-15T02:05:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "My [research](https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-809906430) indicates that these changes would not break any clients, I've opened issues trying to confirm my understand on all the repos, and I have not heard any opposition from the mailing list or on IRC. This seems like the extent of what I can do to make sure these changes are compatible with alternative clients 😛\r\n\r\nI've also broken out the commit to \"stop sending sendaddrv2 messages to block-relay-only peers\" into #22245. \r\n\r\nSo I'm bringing this PR out of draft. I have rebased it on top of #21236 and #21707. They were both pretty involved, so I recommend reviewing from scratch. The `p2p_addr_relay.py` functional test is getting pretty big & hits a fair amount of behind-the-scenes p2p mechanisms. I tried to improve the clarity & document relevant mechanisms, but open to suggestions if anything is still unclear. ",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-861114349",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "ready_for_review",
      "id": 4888795841,
      "node_id": "MDE5OlJlYWR5Rm9yUmV2aWV3RXZlbnQ0ODg4Nzk1ODQx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4888795841",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-15T02:05:41Z"
    },
    {
      "event": "commented",
      "id": 862305024,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjMwNTAyNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862305024",
      "actor": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-16T11:35:30Z",
      "updated_at": "2021-06-16T11:35:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK. Impressively thorough investigation of impact on alternative clients :)",
      "user": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-862305024",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "commented",
      "id": 862312851,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjMxMjg1MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862312851",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-16T11:48:58Z",
      "updated_at": "2021-06-16T11:48:58Z",
      "author_association": "MEMBER",
      "body": "> For inbound peers, we initialize the filter if/when we get an addr related message (ADDR, ADDRV2, GETADDR, SENDADDRV2).\r\n\r\nSo it may happen that a light client who does not participate in address relay connects to us and sends us `getaddr` in order to learn some peers and we (mis)interpret that and start sending unrequested addresses to that peer in the hopes of further relay. Black hole again.\r\n\r\nOr a peer that does not participate in address relay replies to our `getaddr` with `addr` and we (mis)interpret that as \"the peer participates in address relay\"?\r\n\r\nDo we have any estimates of how severe the black holes problem is? I think that currently address relay works, so maybe it is not a \"big\" problem, or not a problem at all?\r\n\r\nWhat if we relay to 3 instead of 2 random peers? Has that been considered? I would not require protocol changes. Would it solve the black holes problem or diminish it to such extend that it can be ignored?",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-862312851",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "commented",
      "id": 863775060,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2Mzc3NTA2MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863775060",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T05:50:36Z",
      "updated_at": "2021-06-21T04:35:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "@vasild\r\n\r\n> So it may happen that a light client who does not participate in address relay connects to us and sends us getaddr in order to learn some peers and we (mis)interpret that and start sending unrequested addresses to that peer in the hopes of further relay. Black hole again.\r\nOr a peer that does not participate in address relay replies to our getaddr with addr and we (mis)interpret that as \"the peer participates in address relay\"?\r\n\r\nI believe this question is addressed in the OP- \"Although we cannot prevent this in a malicious case, we can improve it for the normal, honest cases, and reduce the overall likelihood of occurrence.\" \r\n\r\nIncase that is unclear, let me try to provide some additional context- the goal of this PR is not to ensure perfect accuracy of whether or not the receiving peer would forward the addresses. In fact, I don't think we could ever ensure such accuracy- even if we had a p2p message that said \"I will forward addresses you send me\", that could easily be abused by a peer who doesn't actually follow through. \r\n\r\nThe goal of this PR is to _reduce the frequency_ of sending addresses to nodes who have no interest in them & will certainly not forward those along. For example, we know that an honest node who is running the latest version of bitcoin core will have block-relay-only connections where it will drop any addresses sent over that connection.\r\n\r\n> Do we have any estimates of how severe the black holes problem is? I think that currently address relay works, so maybe it is not a \"big\" problem, or not a problem at all? \r\n\r\nWhile I do think this PR offers an improvement to address relay, the end goal is to increase the number of block-relay-only connections created by a bitcoin node (also goal of the `DISABLETX` work in #20726). Even if the number of black holes are not currently a problem, fixing them are a prerequisite to being able to increase the number of block-relay-only connections. For more context on this conversation, please see https://github.com/bitcoin/bitcoin/pull/15759#issuecomment-480868516 & the surrounding discussion. \r\n\r\n> What if we relay to 3 instead of 2 random peers? Has that been considered? I would not require protocol changes. Would it solve the black holes problem or diminish it to such extend that it can be ignored?\r\n\r\nRelaying addresses to 3 rather than 2 random peers could be possible, but I think it would require in-depth research to ensure there wouldn't be any negative bandwidth or privacy impact. One of the alternative approaches that has been considered is to mark \"potential blackholes\" and then increase redundancy if they have been selected in `RelayAddress`. A downside of that approach is it's hard to build confidence that such approach wouldn't lead to network-wide biases of certain addresses or certain peers. \r\n\r\nI agree with what @sdaftuar said in https://github.com/bitcoin/bitcoin/pull/22245#issuecomment-862839610: \r\n> I don’t think anyone believes that implicit behavior (that is undocumented in any BIP) is the right way for protocol development to proceed if starting from a clean slate — so eventually I think we’ll rewrite things.\r\n\r\nThe current state of `addr` propagation relies heavily on assumptions & is poorly understood and poorly documented. In the long term, I hope to work towards a shared set of design goals & more explicit expectations that are well documented. However, this PR is coming from the hope that we don't have to gate making progress towards increasing block-relay-only connections on a fundamental redesign of `addr` relay. ",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-863775060",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 4907853229,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkwNzg1MzIyOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4907853229",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T05:50:36Z"
    },
    {
      "event": "subscribed",
      "id": 4907853231,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MDc4NTMyMzE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4907853231",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T05:50:36Z"
    },
    {
      "event": "mentioned",
      "id": 4907853233,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkwNzg1MzIzMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4907853233",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T05:50:36Z"
    },
    {
      "event": "subscribed",
      "id": 4907853235,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MDc4NTMyMzU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4907853235",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T05:50:36Z"
    },
    {
      "event": "commented",
      "id": 863943765,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2Mzk0Mzc2NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863943765",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T10:40:28Z",
      "updated_at": "2021-06-18T10:40:28Z",
      "author_association": "MEMBER",
      "body": "If the focus is on avoiding gossip to peers that connected to us in block-only mode, then isn't the absence of `getaddr` enough to recognize that? That is, a peer who connected to us and did not send us `getaddr` must be in blocks-only mode / is a black hole? No need to involve `addr` and `addrv2`? I.e. only for inbound connections, delay initializing `Peer::m_addr_known` for until after `getaddr` is received.\r\n\r\nGiven that \"when\" and \"to whom\" to relay addresses is not mandated by any specification and is up to each peer to decide, and one may as well decide to relay only on full moon on odd months or if the peer's address ends in `7`, then deciding to skip relay to peers that did not send `getaddr` is not a protocol change.\r\n\r\nI see the assumption \"the peer did not send us `messageX` => they must be a black hole\" as flawed. More like a hack, which might be acceptable in the current situation.\r\n\r\nStill sending to some black holes is ok (we currently do). But could this PR have the adverse effect of starting to treat as black holes peers that are actually not?\r\n\r\nAs for relaying to more peers: currently we relay reachable addresses to 2 peers. So (assuming everybody relays) every node relays to two others (it spreads like a virus). And an average spread rate of <1 is required to stop an address from propagating. It means that if more than half of the peers are black holes then propagation will not work (will stop). I think we are far from 50% black holes but I could be wrong. For unreachable peers (e.g. a Tor address relayed via a peer that does not have Tor connectivity) the number is 1.5 and so, 33% or more black holes are needed to brick propagation.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-863943765",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "commented",
      "id": 864202916,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NDIwMjkxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864202916",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T18:17:25Z",
      "updated_at": "2021-06-18T18:17:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "@vasild \r\n\r\n> That is, a peer who connected to us and did not send us getaddr must be in blocks-only mode / is a black hole?\r\n\r\nThis is false. If you see the notes I've taken on alternative clients here: https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-809906430, you can see that several of them will always self-advertise, but only occasionally send getaddr messages. \r\n\r\n> Still sending to some black holes is ok (we currently do). But could this PR have the adverse effect of starting to treat as black holes peers that are actually not?\r\n\r\nYes, exactly. This is why I have taken great care to communicate these changes & research clients to ensure they would not be harmed. If we only used getaddr to indicate \"wants to participate in addr relay\", this exact adverse effect would occur. \r\n\r\n> As for relaying to more peers: currently we relay reachable addresses to 2 peers. So (assuming everybody relays) every node relays to two others (it spreads like a virus). And an average spread rate of <1 is required to stop an address from propagating. It means that if more than half of the peers are black holes then propagation will not work (will stop). I think we are far from 50% black holes but I could be wrong. For unreachable peers (e.g. a Tor address relayed via a peer that does not have Tor connectivity) the number is 1.5 and so, 33% or more black holes are needed to brick propagation.\r\n\r\nAs I said in my previous post, \"Relaying addresses to 3 rather than 2 random peers could be possible, but I think it would require in-depth research to ensure there wouldn't be any negative bandwidth or privacy impact.\" There is no doubt that relaying addresses to more peers could ensure they saturate the network. Heck, if that was all we cared about, why not forward addresses to every node? \r\n\r\nThe concern is if there would be any _other_ adverse impact, and that is difficult to reason about. We could model the bandwidth increase by estimating: number of nodes on network, expected frequency of initiating self-announcements, number of anticipated blackholes & multiplier of forwarding addresses. This could help build confidence, but a lot of these numbers would have to be estimates. Even harder would be to guarantee that there are no significant security concerns. For example, addr relay can reveal node topology which can ease a partition or eclipse attack. I believe it would be significantly more complex to usefully model how changing the relay policy would impact potential information leaks. And that wouldn't be the only security concern about changing addr relay policy, just one example.",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-864202916",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 4911072931,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkxMTA3MjkzMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4911072931",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T18:17:25Z"
    },
    {
      "event": "subscribed",
      "id": 4911072934,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MTEwNzI5MzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4911072934",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T18:17:25Z"
    },
    {
      "event": "commented",
      "id": 864633869,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NDYzMzg2OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864633869",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T00:08:47Z",
      "updated_at": "2021-06-21T00:08:47Z",
      "author_association": "MEMBER",
      "body": "Concept ACK.\r\n\r\n> As for relaying to more peers: currently we relay reachable addresses to 2 peers. So (assuming everybody relays) every node relays to two others (it spreads like a virus). And an average spread rate of <1 is required to stop an address from propagating. It means that if more than half of the peers are black holes then propagation will not work (will stop). I think we are far from 50% black holes but I could be wrong.\r\n\r\nI think that there are at least two limitations to a virus-like spread:\r\n1. Each full node relays a given addr only once to two peers, and becomes a black hole for it after that - if it receives the addr again from another peer, it won't relay it to different peers within 24h because of how `RelayAddress()` works. This makes addr gossip sensitive to network topology (hubs with many peers are bottlenecks) and makes it pretty much impossible for an addr to percolate through the entire network via gossip relay. Even with zero black holes, an addr would only reach ~35% of the nodes in my simulation.\r\n2. Each node in the network will stop relaying an addr 10 minutes after the announcement (that's 20 hops on average with `AVG_ADDRESS_BROADCAST_INTERVAL = 30s`), see [first condition here](https://github.com/bitcoin/bitcoin/blob/da69d9965a112c6421fce5649b5a18beb7513526/src/net_processing.cpp#L2783-L2786)\r\n\r\nMy impression is that the introduction of 20% block-relay-only connections could have effected addr gossip relay quite clearly. I did some quick simulations similar to @naumenkogs' work from #17194 but adjusted for points 1 and 2 from above: \r\nThe simulations ([code](https://github.com/mzumsande/addr_relay_sim)) suggest that the percentage of nodes reached by an initial self-announcement of a new non-listening node falls from 35% (0% black holes) to 21% (20% black holes) to 2% (35% black holes).\r\n\r\n> I think that currently address relay works, so maybe it is not a \"big\" problem, or not a problem at all?\r\n\r\nI think that whether addr gossip relay \"works\"  is not so easy to judge because other means of addr propagation (DNS seeds; getaddr mechanism) also contribute to addr propagation and introduce some degree of redundancy - maybe the best measure is how fast a new node on the network receives inbound connections?\r\nBut getaddr does not adapt quickly (older addrs, 24 hour cache) to changes in the network, so it makes sense to me to improve the state of gossip relay as suggested by this PR.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-864633869",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 4913919987,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkxMzkxOTk4Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4913919987",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T00:08:47Z"
    },
    {
      "event": "subscribed",
      "id": 4913919989,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MTM5MTk5ODk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4913919989",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T00:08:47Z"
    },
    {
      "event": "commented",
      "id": 864740342,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NDc0MDM0Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864740342",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T05:30:50Z",
      "updated_at": "2021-06-21T05:30:50Z",
      "author_association": "MEMBER",
      "body": "> The simulations ([code](https://github.com/mzumsande/addr_relay_sim)) suggest that the percentage of nodes reached by an initial self-announcement of a new non-listening node falls from 35% (0% black holes) to 21% (20% black holes) to 2% (35% black holes).\r\n\r\nI think that's simulating having 8 outbounds of which 20% (or 30%,35%,40%) are blackholes, rather than 8 full outbounds and an additional 2 blackholes.\r\n\r\nMight be worth distinguishing between the percentage of listening nodes that see an address versus total nodes -- I think with 8 outbounds, 0% blackholes it's 92% of listening nodes and 35% of all nodes that see an address, and 20% blackholes (6.4 full outbound 1.6 block relay only) gives 65% of listening nodes and 21% of all nodes see an address.\r\n\r\nI tried writing [my own sim](https://gist.github.com/ajtowns/ec27774113e5d1214b99281f6b7549c4) which only deals with listening peers; the numbers I got were 8 full-relay 0 block-relay gives ~80% of nodes seeing an address on average, while 8 full-relay 2 block-relay gives ~70% coverage, and 8 full-relay 5 block-relay gives ~50% coverage. Switching from 2 peers to 3 for addr relay brings those numbers up to 95%, 92% and 85% respectively.",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-864740342",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "commented",
      "id": 865093349,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NTA5MzM0OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865093349",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T14:48:14Z",
      "updated_at": "2021-06-21T14:48:14Z",
      "author_association": "MEMBER",
      "body": "@mzumsande, @ajtowns, wow! That gives some rough picture on the severity of the problem. I think it rules out \"not a problem at all\". Thanks!\r\n\r\n@amitiuttarwar, I guess the \"waiting for confirmation\" for btcd and bitcoinj [above](https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-809906430) should be cleared before this PR is merged?",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-865093349",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 4917319384,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkxNzMxOTM4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4917319384",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T14:48:14Z"
    },
    {
      "event": "subscribed",
      "id": 4917319392,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MTczMTkzOTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4917319392",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T14:48:14Z"
    },
    {
      "event": "mentioned",
      "id": 4917319399,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkxNzMxOTM5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4917319399",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T14:48:14Z"
    },
    {
      "event": "subscribed",
      "id": 4917319403,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MTczMTk0MDM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4917319403",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T14:48:14Z"
    },
    {
      "event": "mentioned",
      "id": 4917319411,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkxNzMxOTQxMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4917319411",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T14:48:14Z"
    },
    {
      "event": "subscribed",
      "id": 4917319416,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MTczMTk0MTY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4917319416",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T14:48:14Z"
    },
    {
      "event": "closed",
      "id": 4917834156,
      "node_id": "MDExOkNsb3NlZEV2ZW50NDkxNzgzNDE1Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4917834156",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T16:10:40Z"
    },
    {
      "event": "reopened",
      "id": 4917834399,
      "node_id": "MDEzOlJlb3BlbmVkRXZlbnQ0OTE3ODM0Mzk5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4917834399",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T16:10:43Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4920067758,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDkyMDA2Nzc1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4920067758",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T03:01:32Z"
    },
    {
      "event": "commented",
      "id": 865505493,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NTUwNTQ5Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865505493",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T03:47:24Z",
      "updated_at": "2021-06-22T03:47:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "@mzumsande, thanks for putting together that awesome simulation! and thank you @ajtowns for reviewing :) very cool. \r\n\r\nbiggest changes in the recent push: \r\n- as per the conversation on #22245, I've removed the commit that uses `sendaddrv2` as a signal to set up addr relay on the connection \r\n- I was finding the `p2p_addr_relay.py` refactor commit hard to parse, so I pulled it out into #22306 and broke it down into multiple commits. this PR builds on that branch. ",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-865505493",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 4920171231,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkyMDE3MTIzMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4920171231",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T03:47:24Z"
    },
    {
      "event": "subscribed",
      "id": 4920171232,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MjAxNzEyMzI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4920171232",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T03:47:24Z"
    },
    {
      "event": "mentioned",
      "id": 4920171235,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkyMDE3MTIzNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4920171235",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T03:47:24Z"
    },
    {
      "event": "subscribed",
      "id": 4920171236,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MjAxNzEyMzY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4920171236",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T03:47:24Z"
    },
    {
      "event": "commented",
      "id": 865658016,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NTY1ODAxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865658016",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T07:09:05Z",
      "updated_at": "2021-06-22T07:09:05Z",
      "author_association": "MEMBER",
      "body": "Had a bit more of a [poke](https://gist.github.com/ajtowns/ec27774113e5d1214b99281f6b7549c4) at this, I think the interesting results are (with 10k listening nodes, 50k private nodes with only outbounds):\r\n\r\n```\r\nConn: 8+2 Spread: 2 Limit: 10000/600 Avg/dev: 78.5%±9.7% 26.1%±3.5%\r\nConn: 8+0 Spread: 2 Limit: 10000/600 Avg/dev: 90.5%±1.7% 33.5%±1.0%\r\nConn: 8+5 Spread: 2 Limit: 10000/600 Avg/dev: 44.5%±17.0% 13.0%±5.1%\r\n\r\nConn: 8+5 Spread: 3 Limit: 10000/600 Avg/dev: 96.5%±9.7% 35.8%±3.6%\r\nConn: 8+0 Spread: 3 Limit: 10000/600 Avg/dev: 99.6%±0.1% 46.1%±0.2%\r\n```\r\n\r\nThat is, with 8 regular outbounds, sending addresses to 2 peers gives ~78% coverage of listening peers (and ~26% coverage of total peers) with 2 additional block-relay-only/blackhole peers, or ~90% coverage with this patch, or ~44% coverage without this patch and 5 additional block-relay-only peers instead of 2.\r\n\r\nWith a spread of 3 instead, then 5 block-relay-only peers gets to 96% coverage even without this patch (though with a large stddev), and with this patch as well gets to 99% coverage with a small standard deviation. So this seems like a \"both\" rather than an \"either/or\" situation to me.\r\n\r\nAddr relay is pretty low bandwidth, so I think the extra 50% of data for going from 2 to 3 is probably pretty fine (maybe make it 3 peers of which at most 2 are outbounds so that private peers don't increase traffic to listening nodes?); I'm not seeing what the privacy concerns should really be.\r\n\r\nI think these numbers are a bit more robust and better match @mzumsande's results. I switched the limit to 600s with poisson timing rather than 20 hops; provided there were enough samples the results between the two methods seemed pretty consistent.\r\n\r\nSo in summary, Concept ACK?",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-865658016",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 4920782946,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkyMDc4Mjk0Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4920782946",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T07:09:05Z"
    },
    {
      "event": "subscribed",
      "id": 4920782952,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MjA3ODI5NTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4920782952",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T07:09:05Z"
    },
    {
      "event": "commented",
      "id": 865926162,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NTkyNjE2Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865926162",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-22T12:06:18Z",
      "updated_at": "2021-06-22T12:06:18Z",
      "author_association": "MEMBER",
      "body": "> Addr relay is pretty low bandwidth, so I think the extra 50% of data for going from 2 to 3 is probably pretty fine...\r\n\r\nI agree.\r\n\r\n> I'm not seeing what the privacy concerns should really be.\r\n\r\nMe neither.\r\n\r\nI reproduced the above results and ran one more simulation: just increase spread from 2 to 3:\r\n\r\n```\r\n# current (copy from above)\r\nConn: 8+2 Spread: 2 Limit: 10000/600 Avg/dev: 78.5%±9.7% 26.1%±3.5%\r\n\r\n# just increase spread from 2 to 3\r\nConn: 8+2 Spread: 3 Limit: 10000/600 Avg/dev: 99.1%/0.1% 41.4%/0.2%\r\n\r\n# increase spread from 2 to 3 and reduce blackholes as per this PR (copy from above)\r\nConn: 8+0 Spread: 3 Limit: 10000/600 Avg/dev: 99.6%±0.1% 46.1%±0.2%\r\n```\r\n\r\nSo, assuming spread is increased from 2 to 3 and we are at 99.1%/41.4% then this PR will only improve it to 99.6%/46.1% :eyes: \r\n\r\nAlso to consider relay of addresses from non-reachable networks, currently with spread 1.5. The script gives an error when given a float: TypeError: can't multiply sequence by non-int of type 'float'.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-865926162",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "commented",
      "id": 866573780,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NjU3Mzc4MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/866573780",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-23T06:43:40Z",
      "updated_at": "2021-06-23T06:43:40Z",
      "author_association": "MEMBER",
      "body": "> Also to consider relay of addresses from non-reachable networks, currently with spread 1.5.\r\n\r\nChanging the spread to `random.choice([1,2])` to simulate an address everyone considers unreachable gives about 5% coverage with 8 outbounds and 2 blackholes; but 27% with 8 outbounds and no blackholes (ie behaviour prior to block relay only nods or after this pr). If you wanted to model ipv4 vs ipv6 or tor, you'd need to model some nodes as considering those nets reachable and being peered with other nodes on the network (preferentially?) which would get complicated.",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-866573780",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "referenced",
      "id": 4933674485,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ5MzM2NzQ0ODU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4933674485",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "bfa885898a5f3260fd1628158d1d32093d61bd4a",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bfa885898a5f3260fd1628158d1d32093d61bd4a",
      "created_at": "2021-06-24T10:14:52Z"
    },
    {
      "event": "labeled",
      "id": 5037956995,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDUwMzc5NTY5OTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5037956995",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-19T11:48:28Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "mentioned",
      "id": 5040772524,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTA0MDc3MjUyNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5040772524",
      "actor": {
        "login": "Roasbeef",
        "id": 998190,
        "node_id": "MDQ6VXNlcjk5ODE5MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/998190?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Roasbeef",
        "html_url": "https://github.com/Roasbeef",
        "followers_url": "https://api.github.com/users/Roasbeef/followers",
        "following_url": "https://api.github.com/users/Roasbeef/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Roasbeef/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Roasbeef/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Roasbeef/subscriptions",
        "organizations_url": "https://api.github.com/users/Roasbeef/orgs",
        "repos_url": "https://api.github.com/users/Roasbeef/repos",
        "events_url": "https://api.github.com/users/Roasbeef/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Roasbeef/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-19T21:08:56Z"
    },
    {
      "event": "subscribed",
      "id": 5040772527,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUwNDA3NzI1Mjc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5040772527",
      "actor": {
        "login": "Roasbeef",
        "id": 998190,
        "node_id": "MDQ6VXNlcjk5ODE5MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/998190?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Roasbeef",
        "html_url": "https://github.com/Roasbeef",
        "followers_url": "https://api.github.com/users/Roasbeef/followers",
        "following_url": "https://api.github.com/users/Roasbeef/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Roasbeef/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Roasbeef/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Roasbeef/subscriptions",
        "organizations_url": "https://api.github.com/users/Roasbeef/orgs",
        "repos_url": "https://api.github.com/users/Roasbeef/repos",
        "events_url": "https://api.github.com/users/Roasbeef/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Roasbeef/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-19T21:08:56Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5070510236,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTA3MDUxMDIzNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5070510236",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-26T20:07:22Z"
    },
    {
      "event": "commented",
      "id": 887012346,
      "node_id": "IC_kwDOABII58403rv6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887012346",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-26T20:41:53Z",
      "updated_at": "2021-07-26T20:41:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "### Latest push: \r\n- rebased on master \r\n- introduced a new variable, `addr_relay_enabled`, to the Peer struct. this is used to expose this information to `getpeerinfo` without causing a thread safety issue. The bool made the `RelayAddrsWithPeer` function redundant, so I removed that.\r\n- these commits are generally small & isolated, so I'm hoping this PR is pretty straightforward to review :) \r\n\r\n### Status of this PR: \r\n- Ready for review! 🔎\r\n- My research of alternative clients suggests these changes would not harm other software: https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-809906430\r\n- I believe I have addressed all of the conceptual concerns that have been expressed by reviewers.  \r\n\r\n### Future thought: \r\n\r\nIf this PR gets accepted & released, we should keep an eye on the peer rate limiting introduced in #22387. `MAX_ADDR_RATE_PER_SECOND` is currently set to `0.1` based on network observations + some buffer. If this patch were widely adopted, it's possible the observed rate could naturally increase. \r\n\r\n☝️ Further explanation: based on an estimated number of listening nodes on the network & frequency of self announcements in Bitcoin Core, I was surprised to find the observed addr announcement rate / per / second to be ~0.025. I think a large part of the delta between conceptual math & observed frequency arises from blackhole rate (aka how well does a single announcement propagate) combined with the role of `m_addr_known`, which would fluctuate based on the node-path a specific announcement takes. \r\n\r\nAnyway, just want to mention that since this is a network level phenomena, its hard for us to accurately predict, and thus would want to observe. ",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-887012346",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "unlabeled",
      "id": 5070844008,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NTA3MDg0NDAwOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5070844008",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-26T21:25:00Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 715716437,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzE1NzE2NDM3",
      "url": null,
      "actor": null,
      "commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Looks good.\r\n\r\nI think the use of an atomic `addr_relay_enabled` is fine for now. Perhaps once #21527 has landed and we have proper locking in net_processing, `m_addr_known` can be guarded by the net processing lock and we can lose the additional atomic bool.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-715716437",
      "submitted_at": "2021-07-27T10:32:51Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5076729040,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTA3NjcyOTA0MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5076729040",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-27T21:13:14Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5076737312,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTA3NjczNzMxMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5076737312",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-27T21:15:24Z"
    },
    {
      "event": "commented",
      "id": 887843936,
      "node_id": "IC_kwDOABII584062xg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887843936",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-27T21:22:17Z",
      "updated_at": "2021-07-27T21:22:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "thanks for the review @jnewbery! incorporated all your feedback with one or two questions. \r\n\r\n> I think the use of an atomic addr_relay_enabled is fine for now. Perhaps once #21527 has landed and we have proper locking in net_processing, m_addr_known can be guarded by the net processing lock and we can lose the additional atomic bool.\r\n\r\nsounds good, I would definitely prefer that approach.",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-887843936",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 5076762319,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTA3Njc2MjMxOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5076762319",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-27T21:22:17Z"
    },
    {
      "event": "subscribed",
      "id": 5076762322,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUwNzY3NjIzMjI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5076762322",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-27T21:22:18Z"
    },
    {
      "event": "reviewed",
      "id": 716729381,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzE2NzI5Mzgx",
      "url": null,
      "actor": null,
      "commit_id": "ceb20ad575cb2cbe971844e8a6422eca87d44bbb",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK ceb20ad575cb2cbe971844e8a6422eca87d44bbb\r\n\r\nIn thread https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677304728 I've suggested follow-up work where all of the address data members are stored in a sub structure that only gets initialized if we're relaying addresses with the peer. I have an example implementation of that here: https://github.com/jnewbery/bitcoin/tree/pr21528.1 if you're interested.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-716729381",
      "submitted_at": "2021-07-28T11:23:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5082747351,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTA4Mjc0NzM1MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5082747351",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-28T22:08:49Z"
    },
    {
      "event": "commented",
      "id": 888655176,
      "node_id": "IC_kwDOABII5840981I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888655176",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-28T22:12:54Z",
      "updated_at": "2021-07-28T22:12:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "@jnewbery \r\n- incorporated all your feedback\r\n- also took a look at your branch, it looks awesome! I think it makes a lot of sense to encapsulate the address related data into a small data structure & only initialize where needed. I'd be happy to see this sorta thing through as a follow-up, if these changes get accepted. thank you!",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-888655176",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 5082761555,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTA4Mjc2MTU1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5082761555",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-28T22:12:54Z"
    },
    {
      "event": "subscribed",
      "id": 5082761558,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUwODI3NjE1NTg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5082761558",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-28T22:12:54Z"
    },
    {
      "event": "commented",
      "id": 889039481,
      "node_id": "IC_kwDOABII5840_ap5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889039481",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-29T11:28:45Z",
      "updated_at": "2021-07-29T11:28:45Z",
      "author_association": "MEMBER",
      "body": "Code review ACK 00a54cbddbc6bc69c30a9597f6e669b1af331d65",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-889039481",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "reviewed",
      "id": 717991899,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzE3OTkxODk5",
      "url": null,
      "actor": null,
      "commit_id": "4ef28624c3f8238e3688f841ba9d67e67ec747d0",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-717991899",
      "submitted_at": "2021-07-29T12:00:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyZmNhZWM3YmJiOTZkNmZlNzJhN2UzYTU3NDRiMGMzNWM3OTczM2U4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2fcaec7bbb96d6fe72a7e3a5744b0c35c79733e8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2fcaec7bbb96d6fe72a7e3a5744b0c35c79733e8",
      "tree": {
        "sha": "a1e9a9b03bd4ba4db75cabc00853f6078c077e0f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a1e9a9b03bd4ba4db75cabc00853f6078c077e0f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7925f3aba820f8965293148ef666c59f87dd3c7f",
          "sha": "7925f3aba820f8965293148ef666c59f87dd3c7f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7925f3aba820f8965293148ef666c59f87dd3c7f"
        }
      ],
      "message": "[net_processing] Introduce SetupAddressRelay\n\nIdempotent function that initializes m_addr_known for connections that support\naddress relay (anything other than block-relay-only). Unused until the next\ncommit.",
      "committer": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-30T00:40:17Z"
      },
      "author": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-03-22T22:48:17Z"
      },
      "sha": "2fcaec7bbb96d6fe72a7e3a5744b0c35c79733e8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2NjUzZmEzMzI4YjU2MDhmY2NlZGExYzZlYThlNjhjNWQ1ODczOWVj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6653fa3328b5608fcceda1c6ea8e68c5d58739ec",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6653fa3328b5608fcceda1c6ea8e68c5d58739ec",
      "tree": {
        "sha": "81a239e52ac763fc1a671bec698f86f06e65ae8f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/81a239e52ac763fc1a671bec698f86f06e65ae8f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2fcaec7bbb96d6fe72a7e3a5744b0c35c79733e8",
          "sha": "2fcaec7bbb96d6fe72a7e3a5744b0c35c79733e8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2fcaec7bbb96d6fe72a7e3a5744b0c35c79733e8"
        }
      ],
      "message": "[test] Update p2p_addr_relay test to prepare\n\nUse an init param to make clear whether a getaddr message should be sent when\nthe P2PConnection receives a version message. These changes are in preparation\nfor upcoming commits that modify the behavior of a bitcoind node and the test\nframework.",
      "committer": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-30T00:40:21Z"
      },
      "author": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-06-22T02:15:07Z"
      },
      "sha": "6653fa3328b5608fcceda1c6ea8e68c5d58739ec"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZDFlZjJkYjdlYTBkOTNjN2RhYjRhOTgwMGVjNzRhZmE3YTAxOWVi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1d1ef2db7ea0d93c7dab4a9800ec74afa7a019eb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1d1ef2db7ea0d93c7dab4a9800ec74afa7a019eb",
      "tree": {
        "sha": "816fb1785c870224e64dd6eb09ba1daad221d28e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/816fb1785c870224e64dd6eb09ba1daad221d28e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6653fa3328b5608fcceda1c6ea8e68c5d58739ec",
          "sha": "6653fa3328b5608fcceda1c6ea8e68c5d58739ec",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6653fa3328b5608fcceda1c6ea8e68c5d58739ec"
        }
      ],
      "message": "[net_processing] Defer initializing m_addr_known\n\nUse SetupAddressRelay to only initialize `m_addr_known` as needed. For outbound\npeers, we initialize the filter before sending our self announcement (not\napplicable for block-relay-only connections). For inbound peers, we initialize\nthe filter when we get an addr related message (ADDR, ADDRV2, GETADDR).\n\nThese changes intend to mitigate address blackholes. Since an inbound peer has\nto send us an addr related message to become eligible as a candidate for addr\nrelay, this should reduce our likelihood of sending them self-announcements.",
      "committer": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-30T00:40:21Z"
      },
      "author": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-03-24T22:01:05Z"
      },
      "sha": "1d1ef2db7ea0d93c7dab4a9800ec74afa7a019eb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyMDFlNDk2NDgxNmY4ODk2Y2ZlN2I0ZjZkOGRkYmZmZmU3MTAyZjg3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/201e4964816f8896cfe7b4f6d8ddbfffe7102f87",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/201e4964816f8896cfe7b4f6d8ddbfffe7102f87",
      "tree": {
        "sha": "428baf0ee19c92b69cc1894c455bcae859c88dc3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/428baf0ee19c92b69cc1894c455bcae859c88dc3"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1d1ef2db7ea0d93c7dab4a9800ec74afa7a019eb",
          "sha": "1d1ef2db7ea0d93c7dab4a9800ec74afa7a019eb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1d1ef2db7ea0d93c7dab4a9800ec74afa7a019eb"
        }
      ],
      "message": "[net_processing] Introduce new field to indicate if addr relay is enabled",
      "committer": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-30T00:41:19Z"
      },
      "author": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-26T18:48:58Z"
      },
      "sha": "201e4964816f8896cfe7b4f6d8ddbfffe7102f87"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjMDYxNTk5ZTQwZGMzZDM3OWMxMGI5MTQ3NjUwNjFhN2E4NDQ5ZGQ3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c061599e40dc3d379c10b914765061a7a8449dd7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c061599e40dc3d379c10b914765061a7a8449dd7",
      "tree": {
        "sha": "b83fa2278c41c8ac1fa90839a8fc3501acc59d2a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b83fa2278c41c8ac1fa90839a8fc3501acc59d2a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/201e4964816f8896cfe7b4f6d8ddbfffe7102f87",
          "sha": "201e4964816f8896cfe7b4f6d8ddbfffe7102f87",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/201e4964816f8896cfe7b4f6d8ddbfffe7102f87"
        }
      ],
      "message": "[net_processing] Remove RelayAddrsWithPeer function\n\nNow that we have a simple boolean stored on the field, the wrapper function is\nno longer necessary.",
      "committer": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-30T00:43:00Z"
      },
      "author": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-26T18:54:07Z"
      },
      "sha": "c061599e40dc3d379c10b914765061a7a8449dd7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzowOTgwY2E3OGNkOTMwYTAwYzk5ODVkN2YwMDA4M2EzYjhlOGJlODll",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0980ca78cd930a00c9985d7f00083a3b8e8be89e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0980ca78cd930a00c9985d7f00083a3b8e8be89e",
      "tree": {
        "sha": "d97275d3a14eb1aceb04fcd3cf1cc89729ae8f6d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d97275d3a14eb1aceb04fcd3cf1cc89729ae8f6d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c061599e40dc3d379c10b914765061a7a8449dd7",
          "sha": "c061599e40dc3d379c10b914765061a7a8449dd7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c061599e40dc3d379c10b914765061a7a8449dd7"
        }
      ],
      "message": "[test] Test that we intentionally select addr relay peers.\n\nThis test checks that we only relay addresses with inbound peers who have sent\nus an addr related message. Uses a combination of GETADDR and ADDR to verify\nwhen peers are eligible.",
      "committer": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-30T00:43:01Z"
      },
      "author": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-06-14T05:08:54Z"
      },
      "sha": "0980ca78cd930a00c9985d7f00083a3b8e8be89e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzozODkzZGEwNmRiMWViNjIyZjU0MDYwNTcwMGY4NjYzZjhkODdiMmRm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3893da06db1eb622f540605700f8663f8d87b2df",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3893da06db1eb622f540605700f8663f8d87b2df",
      "tree": {
        "sha": "1fcd444d77b18137da6aaa29da8f104c8a96fad5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1fcd444d77b18137da6aaa29da8f104c8a96fad5"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0980ca78cd930a00c9985d7f00083a3b8e8be89e",
          "sha": "0980ca78cd930a00c9985d7f00083a3b8e8be89e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0980ca78cd930a00c9985d7f00083a3b8e8be89e"
        }
      ],
      "message": "[RPC] Add field to getpeerinfo to indicate if addr relay is enabled",
      "committer": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-30T00:43:01Z"
      },
      "author": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-26T19:08:07Z"
      },
      "sha": "3893da06db1eb622f540605700f8663f8d87b2df"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzozZjcyNTBiMzI4YjhiMmY1ZDYzZjMyMzcwMjQ0NWFjNWM5ODliNzNk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "tree": {
        "sha": "d660890065d3cae0736d109a71012933ff304835",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d660890065d3cae0736d109a71012933ff304835"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3893da06db1eb622f540605700f8663f8d87b2df",
          "sha": "3893da06db1eb622f540605700f8663f8d87b2df",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3893da06db1eb622f540605700f8663f8d87b2df"
        }
      ],
      "message": "[test] Use the new endpoint to improve tests",
      "committer": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-30T00:43:01Z"
      },
      "author": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-07-24T01:19:32Z"
      },
      "sha": "3f7250b328b8b2f5d63f323702445ac5c989b73d"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5088917599,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTA4ODkxNzU5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5088917599",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-30T00:48:07Z"
    },
    {
      "event": "commented",
      "id": 889550648,
      "node_id": "IC_kwDOABII5841BXc4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889550648",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-30T00:50:15Z",
      "updated_at": "2021-07-30T00:50:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "thanks @MarcoFalke, addressed your comments ",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-889550648",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 5088922308,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTA4ODkyMjMwOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5088922308",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-30T00:50:15Z"
    },
    {
      "event": "subscribed",
      "id": 5088922310,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUwODg5MjIzMTA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5088922310",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-30T00:50:15Z"
    },
    {
      "event": "commented",
      "id": 889760155,
      "node_id": "IC_kwDOABII5841CKmb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889760155",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-30T09:17:56Z",
      "updated_at": "2021-07-30T09:17:56Z",
      "author_association": "MEMBER",
      "body": "reACK 3f7250b328b8b2f5d63f323702445ac5c989b73d\r\n\r\nOnly changes are addressing review comments from Marco.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-889760155",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "commented",
      "id": 889770457,
      "node_id": "IC_kwDOABII5841CNHZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889770457",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-30T09:37:00Z",
      "updated_at": "2021-07-30T09:37:00Z",
      "author_association": "MEMBER",
      "body": "ACK 3f7250b328b8b2f5d63f323702445ac5c989b73d\r\n\r\nCompared the `SetupAddressRelay()` call sites to where I thought they should be, threw in some asserts where I expected `m_addr_relay_enabled` to be true, did a code review looking for possibilities of `m_addr_known` being used before initialized. Test looks correct. Thanks for diligently checking for compatibility with other clients, seems to be a safe change. :)",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-889770457",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "review_requested",
      "id": 5096342075,
      "node_id": "MDIwOlJldmlld1JlcXVlc3RlZEV2ZW50NTA5NjM0MjA3NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5096342075",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-02T02:21:42Z",
      "requested_reviewer": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 720191910,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzIwMTkxOTEw",
      "url": null,
      "actor": null,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK 3f7250b328b8b2f5d63f323702445ac5c989b73d\r\n\r\nI don't think the potential interaction with #22387 should be an issue -- if the rate limit wasn't being hit before it was because addresses weren't being relayed, and if they're hit now the result is just that addresses aren't being relayed.",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-720191910",
      "submitted_at": "2021-08-02T13:39:40Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "reviewed",
      "id": 720711594,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzIwNzExNTk0",
      "url": null,
      "actor": null,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-720711594",
      "submitted_at": "2021-08-03T01:47:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "merged",
      "id": 5102028948,
      "node_id": "MDExOk1lcmdlZEV2ZW50NTEwMjAyODk0OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5102028948",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "06788c67058495b9aa4044e1512f0af53d186c7e",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/06788c67058495b9aa4044e1512f0af53d186c7e",
      "created_at": "2021-08-03T01:48:25Z"
    },
    {
      "event": "closed",
      "id": 5102028958,
      "node_id": "MDExOkNsb3NlZEV2ZW50NTEwMjAyODk1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5102028958",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-03T01:48:25Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 5102033944,
      "node_id": "MDE5OkhlYWRSZWZEZWxldGVkRXZlbnQ1MTAyMDMzOTQ0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5102033944",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-03T01:50:23Z"
    },
    {
      "event": "commented",
      "id": 891658146,
      "node_id": "IC_kwDOABII5841JZ-i",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/891658146",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-03T08:44:58Z",
      "updated_at": "2021-08-03T08:44:58Z",
      "author_association": "MEMBER",
      "body": "Maybe add a line to the release notes saying that inbound peers will never receive address messages unless they send ADDR, ADDRV2, or GETADDR themselves? ",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-891658146",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "reviewed",
      "id": 720952782,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzIwOTUyNzgy",
      "url": null,
      "actor": null,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#pullrequestreview-720952782",
      "submitted_at": "2021-08-03T08:58:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
    },
    {
      "event": "referenced",
      "id": 5105954212,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMDU5NTQyMTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5105954212",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "5da1ca2b525cde90d23902775ae27ed1b159cfe4",
      "commit_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/commits/5da1ca2b525cde90d23902775ae27ed1b159cfe4",
      "created_at": "2021-08-03T16:37:29Z"
    },
    {
      "event": "commented",
      "id": 892004202,
      "node_id": "IC_kwDOABII5841Kudq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/892004202",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-03T16:51:52Z",
      "updated_at": "2021-08-03T16:51:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "@MarcoFalke \r\n> Maybe add a line to the release notes\r\n\r\nAdded in #22618, thanks :) ",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#issuecomment-892004202",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21528"
    },
    {
      "event": "mentioned",
      "id": 5106022001,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTEwNjAyMjAwMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5106022001",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-03T16:51:53Z"
    },
    {
      "event": "subscribed",
      "id": 5106022006,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUxMDYwMjIwMDY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5106022006",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-03T16:51:53Z"
    },
    {
      "event": "referenced",
      "id": 5106153176,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMDYxNTMxNzY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5106153176",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "dddd05362e3e6ce64696ba457afdf6d5fccb823d",
      "commit_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/commits/dddd05362e3e6ce64696ba457afdf6d5fccb823d",
      "created_at": "2021-08-03T17:19:21Z"
    },
    {
      "event": "referenced",
      "id": 5108646102,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMDg2NDYxMDI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5108646102",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "9045bd0a3424fb674fa2f33a622160ca1ac513e1",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/9045bd0a3424fb674fa2f33a622160ca1ac513e1",
      "created_at": "2021-08-04T04:49:21Z"
    },
    {
      "event": "referenced",
      "id": 5113339410,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMTMzMzk0MTA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5113339410",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "aa79c912608fdc77c69dd43653aa87f1f34e01dd",
      "commit_url": "https://api.github.com/repos/amitiuttarwar/bitcoin/commits/aa79c912608fdc77c69dd43653aa87f1f34e01dd",
      "created_at": "2021-08-04T19:36:44Z"
    },
    {
      "event": "referenced",
      "id": 5115714557,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMTU3MTQ1NTc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5115714557",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "dd981b5e840c0f1b29e8adaaea285230efd0aba6",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/dd981b5e840c0f1b29e8adaaea285230efd0aba6",
      "created_at": "2021-08-05T07:31:13Z"
    },
    {
      "event": "referenced",
      "id": 5972860859,
      "node_id": "REFE_lADOABII584yGaN5zwAAAAFkAp-7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5972860859",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "d3a5c3e4328deddf2468d650b7a1c0e49fe0d299",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/d3a5c3e4328deddf2468d650b7a1c0e49fe0d299",
      "created_at": "2022-01-28T19:19:45Z"
    },
    {
      "event": "locked",
      "id": 7217158987,
      "node_id": "LOE_lADOABII584yGaN5zwAAAAGuLRtL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7217158987",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-18T19:52:02Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601057629",
      "pull_request_review_id": 620728925,
      "id": 601057629,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTA1NzYyOQ==",
      "diff_hunk": "@@ -2625,7 +2625,11 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             pfrom.fDisconnect = true;\n             return;\n         }\n-        pfrom.m_wants_addrv2 = true;\n+\n+        if (SetupAddressRelay(pfrom)) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "cd55b53800ec63b516bdca46bfee0d57e34e3af6",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't think there's any need to `SetupAddressRelay` here, and doing so would cause you to continue choosing inbounds that are treating you as block-relay-only instead of ignoring them as a black hole.",
      "created_at": "2021-03-25T05:32:50Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r601057629",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601057629"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2751,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601317221",
      "pull_request_review_id": 620941721,
      "id": 601317221,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTMxNzIyMQ==",
      "diff_hunk": "@@ -611,6 +611,8 @@ void CNode::copyStats(CNodeStats &stats, const std::vector<bool> &m_asmap)\n     stats.addrLocal = addrLocalUnlocked.IsValid() ? addrLocalUnlocked.ToString() : \"\";\n \n     X(m_conn_type);\n+\n+    stats.addr_relay_enabled = RelayAddrsWithConn();",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ea30030216e1a3456ff609bba7c4d2087940478a",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This isn't thread safe. By accessing `m_addr_known` from outside the message handler thread (eg an rpc worker thread or qt), this opens race conditions where `m_addr_known` is being set by the message handler thread and read by an rpc thread concurrently. In such cases, the thread reading the value could see the old value, the new value or garbage.",
      "created_at": "2021-03-25T10:21:59Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r601317221",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601317221"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 615,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601327487",
      "pull_request_review_id": 620941721,
      "id": 601327487,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTMyNzQ4Nw==",
      "diff_hunk": "@@ -2625,7 +2625,11 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             pfrom.fDisconnect = true;\n             return;\n         }\n-        pfrom.m_wants_addrv2 = true;\n+\n+        if (SetupAddressRelay(pfrom)) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "cd55b53800ec63b516bdca46bfee0d57e34e3af6",
      "in_reply_to_id": 601057629,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't think it matters much either way. The only peers this affects are inbound block-relay-only connections from v0.21 peers, which (incorrectly) send `sendaddrv2` to us. Inbound block-relay-only peers on v22 won't send `sendaddrv2` because of the change in commit _Stop sending SENDADDRV2 message to block relay only peers_.",
      "created_at": "2021-03-25T10:30:26Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r601327487",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601327487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2751,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601328295",
      "pull_request_review_id": 620941721,
      "id": 601328295,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTMyODI5NQ==",
      "diff_hunk": "@@ -4243,12 +4279,17 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n                     }\n                 }\n             }\n+\n             pto->vAddrToSend.clear();\n-            if (!vAddr.empty())\n+\n+            if (!vAddr.empty()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 121,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ea30030216e1a3456ff609bba7c4d2087940478a",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I suggest you drop these tidy-up changes in _Add some documentation and small style fixes_. They don't seem very related to the rest of the PR :see_no_evil: ",
      "created_at": "2021-03-25T10:31:11Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r601328295",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601328295"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603710494",
      "pull_request_review_id": 623763694,
      "id": 603710494,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzcxMDQ5NA==",
      "diff_hunk": "@@ -2625,7 +2625,11 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             pfrom.fDisconnect = true;\n             return;\n         }\n-        pfrom.m_wants_addrv2 = true;\n+\n+        if (SetupAddressRelay(pfrom)) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "cd55b53800ec63b516bdca46bfee0d57e34e3af6",
      "in_reply_to_id": 601057629,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ergh, its annoying that v0.21 peers will send us the `sendaddrv2` message, but I'm not sure if this warrants removing this conditional. some thoughts:\r\n- in terms of protocol & logical coherence, I'd expect `sendaddrv2` to indicate desire that the node wants to participate in addr relay\r\n- in this patch, calling `SetupAddressRelay` for the node mimics the behavior of current master. so I think of calling as the default (rather than the other way around)\r\n- in terms of safety, it seems better to have a blackhole than exclude a peer from address relay.   I think... a blackhole means an address, or set of addresses will not propagate as well this time, but excluding a peer from address relay (esp if programmatically / many peers exclude) means that peer could be at a higher risk of being eclipsed? \r\n\r\nI thought I was on the fence, but writing out this reasoning makes me realize I'd like to leave as is.\r\n\r\nthoughts? ",
      "created_at": "2021-03-30T01:05:47Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r603710494",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603710494"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2751,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603711802",
      "pull_request_review_id": 623764905,
      "id": 603711802,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzcxMTgwMg==",
      "diff_hunk": "@@ -611,6 +611,8 @@ void CNode::copyStats(CNodeStats &stats, const std::vector<bool> &m_asmap)\n     stats.addrLocal = addrLocalUnlocked.IsValid() ? addrLocalUnlocked.ToString() : \"\";\n \n     X(m_conn_type);\n+\n+    stats.addr_relay_enabled = RelayAddrsWithConn();",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ea30030216e1a3456ff609bba7c4d2087940478a",
      "in_reply_to_id": 601317221,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ayo, good catch. it feels like overkill to introduce a lock just to expose a boolean, so I've dropped this commit for now. will some of your addr-in-net-processing refactor will make it so we can do this safely? ",
      "created_at": "2021-03-30T01:09:14Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r603711802",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603711802"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 615,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603713142",
      "pull_request_review_id": 623766503,
      "id": 603713142,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzcxMzE0Mg==",
      "diff_hunk": "@@ -4243,12 +4279,17 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n                     }\n                 }\n             }\n+\n             pto->vAddrToSend.clear();\n-            if (!vAddr.empty())\n+\n+            if (!vAddr.empty()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 121,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ea30030216e1a3456ff609bba7c4d2087940478a",
      "in_reply_to_id": 601328295,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "sorry I'm not sorry!! I abhor two line if statements, they are great footguns. these changes are pretty trivial, I don't think they would make sense as a stand-alone PR, or that they increase the complexity of review, so I'd rather leave them in.",
      "created_at": "2021-03-30T01:13:48Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r603713142",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603713142"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603867126",
      "pull_request_review_id": 623952119,
      "id": 603867126,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzg2NzEyNg==",
      "diff_hunk": "@@ -611,6 +611,8 @@ void CNode::copyStats(CNodeStats &stats, const std::vector<bool> &m_asmap)\n     stats.addrLocal = addrLocalUnlocked.IsValid() ? addrLocalUnlocked.ToString() : \"\";\n \n     X(m_conn_type);\n+\n+    stats.addr_relay_enabled = RelayAddrsWithConn();",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ea30030216e1a3456ff609bba7c4d2087940478a",
      "in_reply_to_id": 601317221,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> will some of your addr-in-net-processing refactor will make it so we can do this safely?\r\n\r\nHopefully, yes!",
      "created_at": "2021-03-30T07:56:46Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r603867126",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603867126"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 615,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603872782",
      "pull_request_review_id": 623959766,
      "id": 603872782,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzg3Mjc4Mg==",
      "diff_hunk": "@@ -4243,12 +4279,17 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n                     }\n                 }\n             }\n+\n             pto->vAddrToSend.clear();\n-            if (!vAddr.empty())\n+\n+            if (!vAddr.empty()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 121,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ea30030216e1a3456ff609bba7c4d2087940478a",
      "in_reply_to_id": 601328295,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I agree that two line if statements are undesirable. If you were already touching these lines, then I'd agree that you should improve them. However, these are the only changes you make to `SendMessages()` and are unrelated to the rest of the changes in this PR.\r\n\r\nI refactor this entire chunk of logic in #21236. Without this tidy-up commit, the two PRs don't conflict and can be merged in either order. If you include these changes, then the PRs conflict and one will have to be rebased when the other is merged.",
      "created_at": "2021-03-30T08:05:19Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r603872782",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603872782"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603974606",
      "pull_request_review_id": 624095110,
      "id": 603974606,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzk3NDYwNg==",
      "diff_hunk": "@@ -2437,6 +2437,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         }\n \n         if (!pfrom.IsInboundConn() && !pfrom.IsBlockOnlyConn()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 3,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "9db8ab25b0aee97cad56e98200918fdf3cf849fb",
      "in_reply_to_id": null,
      "user": {
        "login": "ccdle12",
        "id": 18324680,
        "node_id": "MDQ6VXNlcjE4MzI0Njgw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18324680?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ccdle12",
        "html_url": "https://github.com/ccdle12",
        "followers_url": "https://api.github.com/users/ccdle12/followers",
        "following_url": "https://api.github.com/users/ccdle12/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ccdle12/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ccdle12/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ccdle12/subscriptions",
        "organizations_url": "https://api.github.com/users/ccdle12/orgs",
        "repos_url": "https://api.github.com/users/ccdle12/repos",
        "events_url": "https://api.github.com/users/ccdle12/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ccdle12/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: is it worth replacing `if (... && !pfrom.IsBlockOnlyConn())` with `if (... && SetupAddrssRelay(pfrom))` since it already checks if the peer is block-relay-only?",
      "created_at": "2021-03-30T10:27:09Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r603974606",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603974606"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2439,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603974781",
      "pull_request_review_id": 624095310,
      "id": 603974781,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzk3NDc4MQ==",
      "diff_hunk": "@@ -101,6 +115,25 @@ def relay_tests(self):\n \n         self.nodes[0].disconnect_p2ps()\n \n+    def blackhole_tests(self):",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 32,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "8e2bcc0cb68ef2f43c22d686010fde2c2b54080a",
      "in_reply_to_id": null,
      "user": {
        "login": "ccdle12",
        "id": 18324680,
        "node_id": "MDQ6VXNlcjE4MzI0Njgw",
        "avatar_url": "https://avatars.githubusercontent.com/u/18324680?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ccdle12",
        "html_url": "https://github.com/ccdle12",
        "followers_url": "https://api.github.com/users/ccdle12/followers",
        "following_url": "https://api.github.com/users/ccdle12/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ccdle12/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ccdle12/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ccdle12/subscriptions",
        "organizations_url": "https://api.github.com/users/ccdle12/orgs",
        "repos_url": "https://api.github.com/users/ccdle12/repos",
        "events_url": "https://api.github.com/users/ccdle12/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ccdle12/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nice tests, would it would be overkill to also test for the outbound case?",
      "created_at": "2021-03-30T10:27:23Z",
      "updated_at": "2021-03-30T21:03:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r603974781",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603974781"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604430768",
      "pull_request_review_id": 624702659,
      "id": 604430768,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDQzMDc2OA==",
      "diff_hunk": "@@ -4243,12 +4279,17 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n                     }\n                 }\n             }\n+\n             pto->vAddrToSend.clear();\n-            if (!vAddr.empty())\n+\n+            if (!vAddr.empty()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 121,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ea30030216e1a3456ff609bba7c4d2087940478a",
      "in_reply_to_id": 601328295,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ok! reverted :) ",
      "created_at": "2021-03-30T21:04:33Z",
      "updated_at": "2021-03-30T21:04:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604430768",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604430768"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604431246",
      "pull_request_review_id": 624703297,
      "id": 604431246,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDQzMTI0Ng==",
      "diff_hunk": "@@ -2437,6 +2437,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         }\n \n         if (!pfrom.IsInboundConn() && !pfrom.IsBlockOnlyConn()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 3,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "9db8ab25b0aee97cad56e98200918fdf3cf849fb",
      "in_reply_to_id": 603974606,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nice idea, done!",
      "created_at": "2021-03-30T21:05:24Z",
      "updated_at": "2021-03-30T21:05:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604431246",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604431246"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2439,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604432892",
      "pull_request_review_id": 624705469,
      "id": 604432892,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDQzMjg5Mg==",
      "diff_hunk": "@@ -101,6 +115,25 @@ def relay_tests(self):\n \n         self.nodes[0].disconnect_p2ps()\n \n+    def blackhole_tests(self):",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 32,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "8e2bcc0cb68ef2f43c22d686010fde2c2b54080a",
      "in_reply_to_id": 603974781,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "definitely not overkill, the inbound vs outbound behavior is different- inbounds we wait to hear an `addr` message before considering the peer eligible for relay, but with outbounds we setup relay, send `getaddr` & self-announce (unless its a block-relay-only connection). I added some tests to check these behaviors. ",
      "created_at": "2021-03-30T21:08:17Z",
      "updated_at": "2021-03-30T21:08:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604432892",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604432892"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604439165",
      "pull_request_review_id": 624713468,
      "id": 604439165,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDQzOTE2NQ==",
      "diff_hunk": "@@ -546,6 +543,20 @@ class CNode\n \n     // flood relay\n     std::vector<CAddress> vAddrToSend;\n+\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR, SENDADDRV2).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that\n+     *  are unlikely to forward them, effectively blackholing self\n+     *  announcements. Reasons peers might not support addr relay on the link\n+     *  is if they connected to us as a block-relay-only peer or as a light\n+     *  client.",
      "path": "src/net.h",
      "position": null,
      "original_position": 32,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n     *  announcements. Reasons peers might not support addr relay on the link\r\n     *  include that they connected to us as a block-relay-only peer or they are\r\n     *  a light client.\r\n```",
      "created_at": "2021-03-30T21:19:40Z",
      "updated_at": "2021-03-31T00:24:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604439165",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604439165"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 556,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 558,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604450797",
      "pull_request_review_id": 624713468,
      "id": 604450797,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDQ1MDc5Nw==",
      "diff_hunk": "@@ -82,6 +130,49 @@ def run_test(self):\n         ipv4_branching_factor = 2\n         assert_equal(total_ipv4_received, num_ipv4_addrs * ipv4_branching_factor)\n \n+        self.nodes[0].disconnect_p2ps()\n+\n+    def inbound_blackhole_tests(self):\n+        self.log.info('Check that we only relay addresses to inbound peers who have previously sent us addr related messages')\n+\n+        addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n+        receiver_peer = self.nodes[0].add_p2p_connection(AddrReceiver())\n+        blackhole_peer = self.nodes[0].add_p2p_connection(AddrBlackhole())\n+\n+        msg = self.setup_addr_msg(2)\n+        self.send_addr_msg(addr_source, msg, [receiver_peer, blackhole_peer])\n+\n+        assert_equal(receiver_peer.num_ipv4_received, 2)\n+        assert_equal(blackhole_peer.num_ipv4_received, 0)\n+\n+        self.nodes[0].disconnect_p2ps()",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 153,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Since peers are chosen randomly, does it make sense to run `self.inbound_blackhole_tests()` a few extra times, just to assert it's not because the node didn't pick `blackhole_peer` by chance?",
      "created_at": "2021-03-30T21:41:49Z",
      "updated_at": "2021-03-30T22:57:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604450797",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604450797"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604456653",
      "pull_request_review_id": 624713468,
      "id": 604456653,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDQ1NjY1Mw==",
      "diff_hunk": "@@ -82,6 +130,49 @@ def run_test(self):\n         ipv4_branching_factor = 2\n         assert_equal(total_ipv4_received, num_ipv4_addrs * ipv4_branching_factor)\n \n+        self.nodes[0].disconnect_p2ps()\n+\n+    def inbound_blackhole_tests(self):\n+        self.log.info('Check that we only relay addresses to inbound peers who have previously sent us addr related messages')\n+\n+        addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n+        receiver_peer = self.nodes[0].add_p2p_connection(AddrReceiver())\n+        blackhole_peer = self.nodes[0].add_p2p_connection(AddrBlackhole())\n+\n+        msg = self.setup_addr_msg(2)\n+        self.send_addr_msg(addr_source, msg, [receiver_peer, blackhole_peer])\n+\n+        assert_equal(receiver_peer.num_ipv4_received, 2)\n+        assert_equal(blackhole_peer.num_ipv4_received, 0)\n+\n+        self.nodes[0].disconnect_p2ps()",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 153,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": 604450797,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think this test could also be improved by asserting that, after `blackhole_peer` does send an `addr`/`addrv2`/`getaddrs`/`sendaddrv2` message, it can get selected for addr propagation.",
      "created_at": "2021-03-30T21:53:40Z",
      "updated_at": "2021-03-30T22:57:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604456653",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604456653"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604458405",
      "pull_request_review_id": 624713468,
      "id": 604458405,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDQ1ODQwNQ==",
      "diff_hunk": "@@ -82,6 +130,49 @@ def run_test(self):\n         ipv4_branching_factor = 2\n         assert_equal(total_ipv4_received, num_ipv4_addrs * ipv4_branching_factor)\n \n+        self.nodes[0].disconnect_p2ps()\n+\n+    def inbound_blackhole_tests(self):\n+        self.log.info('Check that we only relay addresses to inbound peers who have previously sent us addr related messages')\n+\n+        addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n+        receiver_peer = self.nodes[0].add_p2p_connection(AddrReceiver())\n+        blackhole_peer = self.nodes[0].add_p2p_connection(AddrBlackhole())\n+\n+        msg = self.setup_addr_msg(2)\n+        self.send_addr_msg(addr_source, msg, [receiver_peer, blackhole_peer])\n+\n+        assert_equal(receiver_peer.num_ipv4_received, 2)\n+        assert_equal(blackhole_peer.num_ipv4_received, 0)\n+\n+        self.nodes[0].disconnect_p2ps()",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 153,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": 604450797,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Another thought - for the blackhole peer, I think could be helpful to assert bytes received for addr-related messages = 0 using `getpeerinfo()`",
      "created_at": "2021-03-30T21:57:04Z",
      "updated_at": "2021-03-30T22:57:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604458405",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604458405"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604477534",
      "pull_request_review_id": 624713468,
      "id": 604477534,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDQ3NzUzNA==",
      "diff_hunk": "@@ -3569,6 +3584,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         }\n         pfrom.fSentAddr = true;\n \n+        SetupAddressRelay(pfrom);\n+\n         pfrom.vAddrToSend.clear();",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 78,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Side question: why do we clear this list here instead of appending to it, given that `PushAddress` and `SendMessages` filter for duplicates?",
      "created_at": "2021-03-30T22:41:05Z",
      "updated_at": "2021-03-30T22:57:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604477534",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604477534"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604497976",
      "pull_request_review_id": 624783523,
      "id": 604497976,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDQ5Nzk3Ng==",
      "diff_hunk": "@@ -82,6 +130,49 @@ def run_test(self):\n         ipv4_branching_factor = 2\n         assert_equal(total_ipv4_received, num_ipv4_addrs * ipv4_branching_factor)\n \n+        self.nodes[0].disconnect_p2ps()\n+\n+    def inbound_blackhole_tests(self):\n+        self.log.info('Check that we only relay addresses to inbound peers who have previously sent us addr related messages')\n+\n+        addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n+        receiver_peer = self.nodes[0].add_p2p_connection(AddrReceiver())\n+        blackhole_peer = self.nodes[0].add_p2p_connection(AddrBlackhole())\n+\n+        msg = self.setup_addr_msg(2)\n+        self.send_addr_msg(addr_source, msg, [receiver_peer, blackhole_peer])\n+\n+        assert_equal(receiver_peer.num_ipv4_received, 2)\n+        assert_equal(blackhole_peer.num_ipv4_received, 0)\n+\n+        self.nodes[0].disconnect_p2ps()",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 153,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": 604450797,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Since peers are chosen randomly..\r\n\r\nyes, peers are chosen randomly, but this test is set up to not be random- ipv4 addresses will be relayed to 2 peers that are not the source of the addr message. so both `receiver_peer` and `blackhole_peer` would receive the addr if they were eligible. definitely wouldn't want a flaky test there :) \r\n\r\n> I think this test could also be improved.. \r\n\r\nthats a great idea! I've added locally, will include in next push. \r\n\r\n> assert bytes received for addr-related messages = 0\r\n\r\nhm, `blackhole_peer` is a p2p connection, so we can't call `getpeerinfo()` on it to get the bytes received directly. that said, we could check `bytessent_per_msg` on the node to see that no bytes have been sent for an `addr` message. however, I its a bit brittle & the p2p connection is capturing directly receiving the addr message, so I don't think that's adding much value to the test. let me know if you think it'd add test coverage :) ",
      "created_at": "2021-03-30T23:35:10Z",
      "updated_at": "2021-03-30T23:35:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604497976",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604497976"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604518862",
      "pull_request_review_id": 624806781,
      "id": 604518862,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDUxODg2Mg==",
      "diff_hunk": "@@ -82,6 +130,49 @@ def run_test(self):\n         ipv4_branching_factor = 2\n         assert_equal(total_ipv4_received, num_ipv4_addrs * ipv4_branching_factor)\n \n+        self.nodes[0].disconnect_p2ps()\n+\n+    def inbound_blackhole_tests(self):\n+        self.log.info('Check that we only relay addresses to inbound peers who have previously sent us addr related messages')\n+\n+        addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n+        receiver_peer = self.nodes[0].add_p2p_connection(AddrReceiver())\n+        blackhole_peer = self.nodes[0].add_p2p_connection(AddrBlackhole())\n+\n+        msg = self.setup_addr_msg(2)\n+        self.send_addr_msg(addr_source, msg, [receiver_peer, blackhole_peer])\n+\n+        assert_equal(receiver_peer.num_ipv4_received, 2)\n+        assert_equal(blackhole_peer.num_ipv4_received, 0)\n+\n+        self.nodes[0].disconnect_p2ps()",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 153,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": 604450797,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> yes, peers are chosen randomly, but this test is set up to not be random- ipv4 addresses will be relayed to 2 peers that are not the source of the addr message. so both receiver_peer and blackhole_peer would receive the addr if they were eligible. definitely wouldn't want a flaky test there :)\r\n\r\nOh right it's always going to be the same one. That makes sense then, that the node has 2 options but doesn't send it to a peer that hasn't established addr relay. But wait I'm confused why it would be flaky, I thought `blackhole_peer` would never get the addr because it hasn't sent any addr-related messages?\r\n\r\n> hm, blackhole_peer is a p2p connection, so we can't call getpeerinfo() on it to get the bytes received directly.\r\n\r\nEr I mean, call `getpeerinfo()` on the node to see bytes received, kinda like this:\r\n\r\n```py\r\ndef sum_addr_messages(msgs):\r\n    return msgs['addr'] + msgs['addrv2'] + msgs['getaddr'] + msgs['sendaddrv2']\r\n...\r\n\r\npeerinfo = self.nodes[0].getpeerinfo()\r\n# receiver_peer sent us its own addr and a getaddr after the VERSION message, so we relay\r\nassert sum_addr_messages(peerinfo[1]['bytesrecv_per_msg']) > 0\r\nassert_equal(receiver_peer.num_ipv4_received, 2)\r\n\r\n# blackhole_peer should not have sent us any addr-related messages, so we don't relay\r\nassert sum_addr_messages(peerinfo[2]['bytesrecv_per_msg']) == 0\r\nassert_equal(blackhole_peer.num_ipv4_received, 0)\r\n```\r\nI just thought it'd be a more precise test, asserting that the addrs aren't relayed because no addr messages have been received. 😅 nbd",
      "created_at": "2021-03-31T00:39:13Z",
      "updated_at": "2021-03-31T00:45:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604518862",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604518862"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604526797",
      "pull_request_review_id": 624815696,
      "id": 604526797,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDUyNjc5Nw==",
      "diff_hunk": "@@ -82,6 +130,49 @@ def run_test(self):\n         ipv4_branching_factor = 2\n         assert_equal(total_ipv4_received, num_ipv4_addrs * ipv4_branching_factor)\n \n+        self.nodes[0].disconnect_p2ps()\n+\n+    def inbound_blackhole_tests(self):\n+        self.log.info('Check that we only relay addresses to inbound peers who have previously sent us addr related messages')\n+\n+        addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n+        receiver_peer = self.nodes[0].add_p2p_connection(AddrReceiver())\n+        blackhole_peer = self.nodes[0].add_p2p_connection(AddrBlackhole())\n+\n+        msg = self.setup_addr_msg(2)\n+        self.send_addr_msg(addr_source, msg, [receiver_peer, blackhole_peer])\n+\n+        assert_equal(receiver_peer.num_ipv4_received, 2)\n+        assert_equal(blackhole_peer.num_ipv4_received, 0)\n+\n+        self.nodes[0].disconnect_p2ps()",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 153,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": 604450797,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> But wait I'm confused why it would be flaky, I thought blackhole_peer would never get the addr because it hasn't sent any addr-related messages?\r\n\r\nyes yes, it would be flaky if it wasn't deterministic / `blackhole_peer` was being skipped by chance. I think we're on the same page, just confusion of my language now. \r\n\r\n> Er I mean, call getpeerinfo() on the node to see bytes received, kinda like this\r\n\r\noh I get it now, you're suggesting additional coverage to test the setup, not another way to test the `addr` relayed. that's a cool idea! sure, I'll add it :) \r\n\r\nsmol note: \r\n> receiver_peer sent us its own addr and a getaddr after the VERSION message, so we relay\r\n\r\nsince `receiver_peer` is essentially a `P2PInterface` object, it actually won't self announce upon receiving `version` message. I added  that it will send out a `getaddr` so tests wouldn't unexpectedly break  in this patch. but I think that highlights why this suggested coverage is useful, at the very least it communicates the relevant setup that's otherwise \"invisible\" from the POV of this test file. ",
      "created_at": "2021-03-31T01:06:30Z",
      "updated_at": "2021-03-31T01:06:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r604526797",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604526797"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605058607",
      "pull_request_review_id": 625507909,
      "id": 605058607,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA1ODYwNw==",
      "diff_hunk": "@@ -546,6 +543,20 @@ class CNode\n \n     // flood relay\n     std::vector<CAddress> vAddrToSend;\n+\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR, SENDADDRV2).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that\n+     *  are unlikely to forward them, effectively blackholing self\n+     *  announcements. Reasons peers might not support addr relay on the link\n+     *  is if they connected to us as a block-relay-only peer or as a light\n+     *  client.\n+     * */\n     std::unique_ptr<CRollingBloomFilter> m_addr_known{nullptr};",
      "path": "src/net.h",
      "position": null,
      "original_position": 34,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": null,
      "user": {
        "login": "GeneFerneau",
        "id": 80422284,
        "node_id": "MDQ6VXNlcjgwNDIyMjg0",
        "avatar_url": "https://avatars.githubusercontent.com/u/80422284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/GeneFerneau",
        "html_url": "https://github.com/GeneFerneau",
        "followers_url": "https://api.github.com/users/GeneFerneau/followers",
        "following_url": "https://api.github.com/users/GeneFerneau/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/GeneFerneau/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/GeneFerneau/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/GeneFerneau/subscriptions",
        "organizations_url": "https://api.github.com/users/GeneFerneau/orgs",
        "repos_url": "https://api.github.com/users/GeneFerneau/repos",
        "events_url": "https://api.github.com/users/GeneFerneau/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/GeneFerneau/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    std::unique_ptr<CRollingBloomFilter> m_addr_known GUARDED_BY(cs_addrKnown){nullptr};\r\n```\r\nand add `cs_addrKnown` as a private member:\r\n\r\n```\r\nmutable RecursiveMutex cs_addrKnown;\r\n```\r\n\r\nto address the point about race conditions mentioned by @jnewbery ",
      "created_at": "2021-03-31T16:46:07Z",
      "updated_at": "2021-03-31T16:46:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r605058607",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605058607"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 560,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651383772",
      "pull_request_review_id": 683482383,
      "id": 651383772,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MTM4Mzc3Mg==",
      "diff_hunk": "@@ -2625,7 +2625,11 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             pfrom.fDisconnect = true;\n             return;\n         }\n-        pfrom.m_wants_addrv2 = true;\n+\n+        if (SetupAddressRelay(pfrom)) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "cd55b53800ec63b516bdca46bfee0d57e34e3af6",
      "in_reply_to_id": 601057629,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Leaving this as is - I find it most logically consistent for `sendaddrv2` to indicate \"interested in addresses\". Opened #22245 to change the behavior for inbound block-relay-only v22.0 peers.",
      "created_at": "2021-06-15T01:34:48Z",
      "updated_at": "2021-06-15T01:34:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r651383772",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651383772"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2751,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651388591",
      "pull_request_review_id": 683487797,
      "id": 651388591,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MTM4ODU5MQ==",
      "diff_hunk": "@@ -546,6 +543,20 @@ class CNode\n \n     // flood relay\n     std::vector<CAddress> vAddrToSend;\n+\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR, SENDADDRV2).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that\n+     *  are unlikely to forward them, effectively blackholing self\n+     *  announcements. Reasons peers might not support addr relay on the link\n+     *  is if they connected to us as a block-relay-only peer or as a light\n+     *  client.",
      "path": "src/net.h",
      "position": null,
      "original_position": 32,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": 604439165,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "updated language ",
      "created_at": "2021-06-15T01:49:53Z",
      "updated_at": "2021-06-15T01:49:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r651388591",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651388591"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 556,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 558,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651389080",
      "pull_request_review_id": 683488319,
      "id": 651389080,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MTM4OTA4MA==",
      "diff_hunk": "@@ -82,6 +130,49 @@ def run_test(self):\n         ipv4_branching_factor = 2\n         assert_equal(total_ipv4_received, num_ipv4_addrs * ipv4_branching_factor)\n \n+        self.nodes[0].disconnect_p2ps()\n+\n+    def inbound_blackhole_tests(self):\n+        self.log.info('Check that we only relay addresses to inbound peers who have previously sent us addr related messages')\n+\n+        addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n+        receiver_peer = self.nodes[0].add_p2p_connection(AddrReceiver())\n+        blackhole_peer = self.nodes[0].add_p2p_connection(AddrBlackhole())\n+\n+        msg = self.setup_addr_msg(2)\n+        self.send_addr_msg(addr_source, msg, [receiver_peer, blackhole_peer])\n+\n+        assert_equal(receiver_peer.num_ipv4_received, 2)\n+        assert_equal(blackhole_peer.num_ipv4_received, 0)\n+\n+        self.nodes[0].disconnect_p2ps()",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 153,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": 604450797,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "based on this convo, I've updated the tests to assert that `blackhole_peer` starts receiving addr messages after sending one. I've also added `getpeerinfo` for the node to verify the test setup of which peers have sent addr related messages. \r\n\r\nthanks!   ",
      "created_at": "2021-06-15T01:51:21Z",
      "updated_at": "2021-06-15T01:51:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r651389080",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651389080"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651389788",
      "pull_request_review_id": 683489100,
      "id": 651389788,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MTM4OTc4OA==",
      "diff_hunk": "@@ -546,6 +543,20 @@ class CNode\n \n     // flood relay\n     std::vector<CAddress> vAddrToSend;\n+\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR, SENDADDRV2).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that\n+     *  are unlikely to forward them, effectively blackholing self\n+     *  announcements. Reasons peers might not support addr relay on the link\n+     *  is if they connected to us as a block-relay-only peer or as a light\n+     *  client.\n+     * */\n     std::unique_ptr<CRollingBloomFilter> m_addr_known{nullptr};",
      "path": "src/net.h",
      "position": null,
      "original_position": 34,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": 605058607,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Holding off on this to try to figure out if there's a better way I can expose this value through the `getpeerinfo` RPC than having to introduce a mutex for this one hyper-specific use case. Ideas welcome! ",
      "created_at": "2021-06-15T01:53:26Z",
      "updated_at": "2021-06-15T01:53:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r651389788",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/651389788"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 560,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/676929839",
      "pull_request_review_id": 715265031,
      "id": 676929839,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NjkyOTgzOQ==",
      "diff_hunk": "@@ -546,6 +543,20 @@ class CNode\n \n     // flood relay\n     std::vector<CAddress> vAddrToSend;\n+\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR, SENDADDRV2).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that\n+     *  are unlikely to forward them, effectively blackholing self\n+     *  announcements. Reasons peers might not support addr relay on the link\n+     *  is if they connected to us as a block-relay-only peer or as a light\n+     *  client.\n+     * */\n     std::unique_ptr<CRollingBloomFilter> m_addr_known{nullptr};",
      "path": "src/net.h",
      "position": null,
      "original_position": 34,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "0c194ffafd1ed23a9a65ca6f38a2388e34884388",
      "in_reply_to_id": 605058607,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "added `addr_relay_enabled` as an atomic to address this issue. ",
      "created_at": "2021-07-26T20:42:25Z",
      "updated_at": "2021-07-26T20:42:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r676929839",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/676929839"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 560,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677298006",
      "pull_request_review_id": 715716437,
      "id": 677298006,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzI5ODAwNg==",
      "diff_hunk": "@@ -1681,7 +1696,7 @@ void PeerManagerImpl::RelayAddress(NodeId originator,\n     LOCK(m_peer_mutex);\n \n     for (auto& [id, peer] : m_peer_map) {\n-        if (RelayAddrsWithPeer(*peer) && id != originator && IsAddrCompatible(*peer, addr)) {\n+        if ( peer->addr_relay_enabled && id != originator && IsAddrCompatible(*peer, addr)) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 89,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        if (peer->addr_relay_enabled && id != originator && IsAddrCompatible(*peer, addr)) {\r\n```",
      "created_at": "2021-07-27T09:53:20Z",
      "updated_at": "2021-07-27T10:32:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677298006",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677298006"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1699,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677298478",
      "pull_request_review_id": 715716437,
      "id": 677298478,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzI5ODQ3OA==",
      "diff_hunk": "@@ -166,11 +178,13 @@ def relay_tests(self):\n         # large GETADDR responses from being relayed, it now typically affects the self-announcement\n         # of the outbound peer which is often sent before the GETADDR response.\n         assert_equal(inbound_peer.num_ipv4_received, 0)\n+        inbound_peer.send_and_ping(msg_getaddr())",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 68,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is this new `getaddr` message to trigger addr relay from the node? What do you think about just sending an empty `addr` message instead?",
      "created_at": "2021-07-27T09:53:59Z",
      "updated_at": "2021-07-27T10:32:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677298478",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677298478"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 181,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677303641",
      "pull_request_review_id": 715716437,
      "id": 677303641,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMwMzY0MQ==",
      "diff_hunk": "@@ -184,7 +198,68 @@ def relay_tests(self):\n \n         self.nodes[0].disconnect_p2ps()\n \n+    def sum_addr_messages(self, msgs_dict):\n+        val = 0\n+        for msg in ['addr', 'addrv2', 'getaddr', 'sendaddrv2']:\n+            if msg in msgs_dict:\n+                val += msgs_dict[msg]\n+        return val",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 88,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        return sum(bytes_recvd for (msg, bytes_recvd) in msgs_dict.items() if msg in ['addr', 'addrv2', 'getaddr', 'sendaddrv2'])\r\n```\r\n",
      "created_at": "2021-07-27T10:01:19Z",
      "updated_at": "2021-07-27T10:32:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677303641",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677303641"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 202,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 206,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677304728",
      "pull_request_review_id": 715716437,
      "id": 677304728,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMwNDcyOA==",
      "diff_hunk": "@@ -3725,6 +3743,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         }\n         peer->m_getaddr_recvd = true;\n \n+        SetupAddressRelay(pfrom);",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 132,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Perhaps move this above the `m_getaddr_recvd` logic (to avoid reading the unused `m_getaddr_recvd` value for non-addr-relay peers).",
      "created_at": "2021-07-27T10:03:01Z",
      "updated_at": "2021-07-27T10:32:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677304728",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677304728"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3754,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677307450",
      "pull_request_review_id": 715716437,
      "id": 677307450,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMwNzQ1MA==",
      "diff_hunk": "@@ -2572,7 +2587,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         UpdatePreferredDownload(pfrom, State(pfrom.GetId()));\n         }\n \n-        if (!pfrom.IsInboundConn() && !pfrom.IsBlockOnlyConn()) {\n+        // Self advertisement logic",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 98,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is a bit misleading. The logic block below contains self-advertisement logic, but it also sends a `getaddr` to request addresses, which is not self-advertisement.",
      "created_at": "2021-07-27T10:07:04Z",
      "updated_at": "2021-07-27T10:32:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677307450",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677307450"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2590,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677310663",
      "pull_request_review_id": 715716437,
      "id": 677310663,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMxMDY2Mw==",
      "diff_hunk": "@@ -224,9 +224,23 @@ struct Peer {\n \n     /** A vector of addresses to send to the peer, limited to MAX_ADDR_TO_SEND. */\n     std::vector<CAddress> m_addrs_to_send;\n-    /** Probabilistic filter of addresses that this peer already knows.\n-     *  Used to avoid relaying addresses to this peer more than once. */\n-    const std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'd very much prefer not to introduce the word 'trickle' here. I've only ever heard the word 'trickle' being used to refer to transaction propagation (eg #7125). Adding the word here would be overloading the term with a new meaning.",
      "created_at": "2021-07-27T10:11:21Z",
      "updated_at": "2021-07-27T10:32:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677310663",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677310663"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 234,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677310877",
      "pull_request_review_id": 715716437,
      "id": 677310877,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMxMDg3Nw==",
      "diff_hunk": "@@ -184,7 +198,68 @@ def relay_tests(self):\n \n         self.nodes[0].disconnect_p2ps()\n \n+    def sum_addr_messages(self, msgs_dict):\n+        val = 0\n+        for msg in ['addr', 'addrv2', 'getaddr', 'sendaddrv2']:\n+            if msg in msgs_dict:\n+                val += msgs_dict[msg]\n+        return val\n+\n+    def inbound_blackhole_tests(self):\n+        self.log.info('Check that we only relay addresses to inbound peers who have previously sent us addr related messages')\n+\n+        addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n+        receiver_peer = self.nodes[0].add_p2p_connection(AddrReceiver())\n+        blackhole_peer = self.nodes[0].add_p2p_connection(AddrReceiver(send_getaddr=False))\n+        initial_addrs_received = receiver_peer.num_ipv4_received\n+\n+        peerinfo = self.nodes[0].getpeerinfo()\n+        assert_equal(peerinfo[0]['addr_relay_enabled'], True)  # addr_source\n+        assert_equal(peerinfo[1]['addr_relay_enabled'], True)  # receiver_peer\n+        assert_equal(peerinfo[2]['addr_relay_enabled'], False)  # blackhole_peer\n+\n+        # addr_source sends 2 addresses to node0\n+        msg = self.setup_addr_msg(2)\n+        addr_source.send_and_ping(msg)\n+        self.mocktime += 30 * 60\n+        self.nodes[0].setmocktime(self.mocktime)\n+        receiver_peer.sync_with_ping()\n+        blackhole_peer.sync_with_ping()\n+\n+        peerinfo = self.nodes[0].getpeerinfo()\n+\n+        # Confirm node received addr-related messages from receiver peer\n+        assert_greater_than(self.sum_addr_messages(peerinfo[1]['bytesrecv_per_msg']), 0)\n+        # And that peer received addresses\n+        assert_equal(receiver_peer.num_ipv4_received - initial_addrs_received, 2)\n+\n+        # Confirm node has not received addr-related messages from blackhole peer\n+        assert_equal(self.sum_addr_messages(peerinfo[2]['bytesrecv_per_msg']), 0)\n+        # And that peer did not receive addresses\n+        assert_equal(blackhole_peer.num_ipv4_received, 0)\n+\n+        self.log.info(\"After blackhole peer sends addr message, it becomes eligible for trickle relay\")",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 123,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Same comment as above about the word \"trickle\"",
      "created_at": "2021-07-27T10:11:41Z",
      "updated_at": "2021-07-27T10:32:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677310877",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677310877"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 241,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677311723",
      "pull_request_review_id": 715716437,
      "id": 677311723,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMxMTcyMw==",
      "diff_hunk": "@@ -184,7 +198,68 @@ def relay_tests(self):\n \n         self.nodes[0].disconnect_p2ps()\n \n+    def sum_addr_messages(self, msgs_dict):\n+        val = 0\n+        for msg in ['addr', 'addrv2', 'getaddr', 'sendaddrv2']:\n+            if msg in msgs_dict:\n+                val += msgs_dict[msg]\n+        return val",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 88,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677303641,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Also, remove `sendaddrv2` from the list?",
      "created_at": "2021-07-27T10:12:50Z",
      "updated_at": "2021-07-27T10:32:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677311723",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677311723"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 202,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 206,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677318087",
      "pull_request_review_id": 715716437,
      "id": 677318087,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMxODA4Nw==",
      "diff_hunk": "@@ -224,9 +224,23 @@ struct Peer {\n \n     /** A vector of addresses to send to the peer, limited to MAX_ADDR_TO_SEND. */\n     std::vector<CAddress> m_addrs_to_send;\n-    /** Probabilistic filter of addresses that this peer already knows.\n-     *  Used to avoid relaying addresses to this peer more than once. */\n-    const std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that\n+     *  are unlikely to forward them, effectively blackholing self\n+     *  announcements. Reasons peers might not support addr relay on the link\n+     *  include that they connected to us as a block-relay-only peer or they\n+     *  are a light client.",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is no longer true. We use `addr_relay_enabled` to decide whether a peer is eligible for addr relay.",
      "created_at": "2021-07-27T10:22:22Z",
      "updated_at": "2021-07-27T10:32:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677318087",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677318087"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 233,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 238,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677318160",
      "pull_request_review_id": 715716437,
      "id": 677318160,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMxODE2MA==",
      "diff_hunk": "@@ -224,9 +224,23 @@ struct Peer {\n \n     /** A vector of addresses to send to the peer, limited to MAX_ADDR_TO_SEND. */\n     std::vector<CAddress> m_addrs_to_send;\n-    /** Probabilistic filter of addresses that this peer already knows.\n-     *  Used to avoid relaying addresses to this peer more than once. */\n-    const std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that\n+     *  are unlikely to forward them, effectively blackholing self\n+     *  announcements. Reasons peers might not support addr relay on the link\n+     *  include that they connected to us as a block-relay-only peer or they\n+     *  are a light client.\n+     **/\n+    std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Whether we are participating in address relay with this connection.\n+     *  Must correlate with whether m_addr_known has been initialized. */\n+    std::atomic_bool addr_relay_enabled{false};",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    std::atomic_bool m_addr_relay_enabled{false};\r\n```",
      "created_at": "2021-07-27T10:22:29Z",
      "updated_at": "2021-07-27T10:32:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677318160",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677318160"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677321159",
      "pull_request_review_id": 715716437,
      "id": 677321159,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMyMTE1OQ==",
      "diff_hunk": "@@ -31,6 +31,7 @@ struct CNodeStateStats {\n     std::vector<int> vHeightInFlight;\n     uint64_t m_addr_processed = 0;\n     uint64_t m_addr_rate_limited = 0;\n+    bool addr_relay_enabled;",
      "path": "src/net_processing.h",
      "position": null,
      "original_position": 4,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    bool m_addr_relay_enabled;\r\n```",
      "created_at": "2021-07-27T10:27:34Z",
      "updated_at": "2021-07-27T10:32:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677321159",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677321159"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 34,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677322503",
      "pull_request_review_id": 715716437,
      "id": 677322503,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzMyMjUwMw==",
      "diff_hunk": "@@ -4423,6 +4443,24 @@ class CompareInvMempoolOrder\n };\n }\n \n+bool PeerManagerImpl::SetupAddressRelay(CNode& node) const\n+{\n+    // We don't participate in addr relay with outbound block-relay-only\n+    // connections to prevent providing adversaries with the additional\n+    // information of addr traffic to infer the link.\n+    if (node.IsBlockOnlyConn()) return false;\n+\n+    PeerRef peer = GetPeerRef(node.GetId());\n+    if (!peer->addr_relay_enabled) {\n+        // First addr message we have received from the peer, initialize\n+        // m_addr_known\n+        peer->m_addr_known = std::make_unique<CRollingBloomFilter>(5000, 0.001);\n+        peer->addr_relay_enabled = true;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 162,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You can atomically test and set the flag as follows:\r\n\r\n```suggestion\r\n    if (!peer->addr_relay_enabled.exchange(true)) {\r\n        // First addr message we have received from the peer, initialize\r\n        // m_addr_known\r\n        peer->m_addr_known = std::make_unique<CRollingBloomFilter>(5000, 0.001);\r\n```\r\n\r\n(`std::atomic<T>::exchange()` returns the value of the object before the call (https://en.cppreference.com/w/cpp/atomic/atomic/exchange))",
      "created_at": "2021-07-27T10:29:35Z",
      "updated_at": "2021-07-27T10:32:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677322503",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677322503"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 4454,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 4458,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677762857",
      "pull_request_review_id": 716330681,
      "id": 677762857,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3Nzc2Mjg1Nw==",
      "diff_hunk": "@@ -3725,6 +3743,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         }\n         peer->m_getaddr_recvd = true;\n \n+        SetupAddressRelay(pfrom);",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 132,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677304728,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't follow- there is an earlier clause that returns early if `!IsInboundConn`, so `SetupAddressRelay` should never return false. So I don't think the order matters here? ",
      "created_at": "2021-07-27T20:07:08Z",
      "updated_at": "2021-07-27T20:07:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677762857",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677762857"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3754,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677804715",
      "pull_request_review_id": 716384429,
      "id": 677804715,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwNDcxNQ==",
      "diff_hunk": "@@ -1681,7 +1696,7 @@ void PeerManagerImpl::RelayAddress(NodeId originator,\n     LOCK(m_peer_mutex);\n \n     for (auto& [id, peer] : m_peer_map) {\n-        if (RelayAddrsWithPeer(*peer) && id != originator && IsAddrCompatible(*peer, addr)) {\n+        if ( peer->addr_relay_enabled && id != originator && IsAddrCompatible(*peer, addr)) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 89,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677298006,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fixed",
      "created_at": "2021-07-27T21:13:44Z",
      "updated_at": "2021-07-27T21:13:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677804715",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677804715"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1699,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677806027",
      "pull_request_review_id": 716385982,
      "id": 677806027,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwNjAyNw==",
      "diff_hunk": "@@ -166,11 +178,13 @@ def relay_tests(self):\n         # large GETADDR responses from being relayed, it now typically affects the self-announcement\n         # of the outbound peer which is often sent before the GETADDR response.\n         assert_equal(inbound_peer.num_ipv4_received, 0)\n+        inbound_peer.send_and_ping(msg_getaddr())",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 68,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677298478,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "good idea! done & added a comment",
      "created_at": "2021-07-27T21:15:51Z",
      "updated_at": "2021-07-27T21:15:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677806027",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677806027"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 181,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677806229",
      "pull_request_review_id": 716386227,
      "id": 677806229,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwNjIyOQ==",
      "diff_hunk": "@@ -184,7 +198,68 @@ def relay_tests(self):\n \n         self.nodes[0].disconnect_p2ps()\n \n+    def sum_addr_messages(self, msgs_dict):\n+        val = 0\n+        for msg in ['addr', 'addrv2', 'getaddr', 'sendaddrv2']:\n+            if msg in msgs_dict:\n+                val += msgs_dict[msg]\n+        return val",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 88,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677303641,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done and done",
      "created_at": "2021-07-27T21:16:10Z",
      "updated_at": "2021-07-27T21:16:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677806229",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677806229"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 202,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 206,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677806468",
      "pull_request_review_id": 716386505,
      "id": 677806468,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwNjQ2OA==",
      "diff_hunk": "@@ -2572,7 +2587,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         UpdatePreferredDownload(pfrom, State(pfrom.GetId()));\n         }\n \n-        if (!pfrom.IsInboundConn() && !pfrom.IsBlockOnlyConn()) {\n+        // Self advertisement logic",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 98,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677307450,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "good point, updated to include ",
      "created_at": "2021-07-27T21:16:36Z",
      "updated_at": "2021-07-27T21:16:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677806468",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677806468"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2590,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677807103",
      "pull_request_review_id": 716387229,
      "id": 677807103,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwNzEwMw==",
      "diff_hunk": "@@ -224,9 +224,23 @@ struct Peer {\n \n     /** A vector of addresses to send to the peer, limited to MAX_ADDR_TO_SEND. */\n     std::vector<CAddress> m_addrs_to_send;\n-    /** Probabilistic filter of addresses that this peer already knows.\n-     *  Used to avoid relaying addresses to this peer more than once. */\n-    const std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677310663,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ah gotcha. I updated the language to use \"gossiping addr messages\", does that feel more appropriate / consistent? \r\n\r\n(also mentioned in https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677310877, linking as a reminder to myself for potential future updates)",
      "created_at": "2021-07-27T21:17:32Z",
      "updated_at": "2021-07-27T21:19:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677807103",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677807103"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 234,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677807351",
      "pull_request_review_id": 716387566,
      "id": 677807351,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwNzM1MQ==",
      "diff_hunk": "@@ -184,7 +198,68 @@ def relay_tests(self):\n \n         self.nodes[0].disconnect_p2ps()\n \n+    def sum_addr_messages(self, msgs_dict):\n+        val = 0\n+        for msg in ['addr', 'addrv2', 'getaddr', 'sendaddrv2']:\n+            if msg in msgs_dict:\n+                val += msgs_dict[msg]\n+        return val\n+\n+    def inbound_blackhole_tests(self):\n+        self.log.info('Check that we only relay addresses to inbound peers who have previously sent us addr related messages')\n+\n+        addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n+        receiver_peer = self.nodes[0].add_p2p_connection(AddrReceiver())\n+        blackhole_peer = self.nodes[0].add_p2p_connection(AddrReceiver(send_getaddr=False))\n+        initial_addrs_received = receiver_peer.num_ipv4_received\n+\n+        peerinfo = self.nodes[0].getpeerinfo()\n+        assert_equal(peerinfo[0]['addr_relay_enabled'], True)  # addr_source\n+        assert_equal(peerinfo[1]['addr_relay_enabled'], True)  # receiver_peer\n+        assert_equal(peerinfo[2]['addr_relay_enabled'], False)  # blackhole_peer\n+\n+        # addr_source sends 2 addresses to node0\n+        msg = self.setup_addr_msg(2)\n+        addr_source.send_and_ping(msg)\n+        self.mocktime += 30 * 60\n+        self.nodes[0].setmocktime(self.mocktime)\n+        receiver_peer.sync_with_ping()\n+        blackhole_peer.sync_with_ping()\n+\n+        peerinfo = self.nodes[0].getpeerinfo()\n+\n+        # Confirm node received addr-related messages from receiver peer\n+        assert_greater_than(self.sum_addr_messages(peerinfo[1]['bytesrecv_per_msg']), 0)\n+        # And that peer received addresses\n+        assert_equal(receiver_peer.num_ipv4_received - initial_addrs_received, 2)\n+\n+        # Confirm node has not received addr-related messages from blackhole peer\n+        assert_equal(self.sum_addr_messages(peerinfo[2]['bytesrecv_per_msg']), 0)\n+        # And that peer did not receive addresses\n+        assert_equal(blackhole_peer.num_ipv4_received, 0)\n+\n+        self.log.info(\"After blackhole peer sends addr message, it becomes eligible for trickle relay\")",
      "path": "test/functional/p2p_addr_relay.py",
      "position": null,
      "original_position": 123,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677310877,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "convo continued in https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677807103, resolving this thread",
      "created_at": "2021-07-27T21:18:00Z",
      "updated_at": "2021-07-27T21:18:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677807351",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677807351"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 241,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677808295",
      "pull_request_review_id": 716388652,
      "id": 677808295,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwODI5NQ==",
      "diff_hunk": "@@ -224,9 +224,23 @@ struct Peer {\n \n     /** A vector of addresses to send to the peer, limited to MAX_ADDR_TO_SEND. */\n     std::vector<CAddress> m_addrs_to_send;\n-    /** Probabilistic filter of addresses that this peer already knows.\n-     *  Used to avoid relaying addresses to this peer more than once. */\n-    const std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that\n+     *  are unlikely to forward them, effectively blackholing self\n+     *  announcements. Reasons peers might not support addr relay on the link\n+     *  include that they connected to us as a block-relay-only peer or they\n+     *  are a light client.",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677318087,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ah good point. updated the comments on both `m_addr_known` and `m_addr_relay_enabled`",
      "created_at": "2021-07-27T21:19:39Z",
      "updated_at": "2021-07-27T21:19:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677808295",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677808295"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 233,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 238,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677808482",
      "pull_request_review_id": 716388829,
      "id": 677808482,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwODQ4Mg==",
      "diff_hunk": "@@ -224,9 +224,23 @@ struct Peer {\n \n     /** A vector of addresses to send to the peer, limited to MAX_ADDR_TO_SEND. */\n     std::vector<CAddress> m_addrs_to_send;\n-    /** Probabilistic filter of addresses that this peer already knows.\n-     *  Used to avoid relaying addresses to this peer more than once. */\n-    const std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that\n+     *  are unlikely to forward them, effectively blackholing self\n+     *  announcements. Reasons peers might not support addr relay on the link\n+     *  include that they connected to us as a block-relay-only peer or they\n+     *  are a light client.\n+     **/\n+    std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Whether we are participating in address relay with this connection.\n+     *  Must correlate with whether m_addr_known has been initialized. */\n+    std::atomic_bool addr_relay_enabled{false};",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677318160,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done, thanks",
      "created_at": "2021-07-27T21:19:56Z",
      "updated_at": "2021-07-27T21:19:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677808482",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677808482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677808551",
      "pull_request_review_id": 716388920,
      "id": 677808551,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwODU1MQ==",
      "diff_hunk": "@@ -31,6 +31,7 @@ struct CNodeStateStats {\n     std::vector<int> vHeightInFlight;\n     uint64_t m_addr_processed = 0;\n     uint64_t m_addr_rate_limited = 0;\n+    bool addr_relay_enabled;",
      "path": "src/net_processing.h",
      "position": null,
      "original_position": 4,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677321159,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2021-07-27T21:20:03Z",
      "updated_at": "2021-07-27T21:20:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677808551",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677808551"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 34,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677808677",
      "pull_request_review_id": 716389049,
      "id": 677808677,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwODY3Nw==",
      "diff_hunk": "@@ -4423,6 +4443,24 @@ class CompareInvMempoolOrder\n };\n }\n \n+bool PeerManagerImpl::SetupAddressRelay(CNode& node) const\n+{\n+    // We don't participate in addr relay with outbound block-relay-only\n+    // connections to prevent providing adversaries with the additional\n+    // information of addr traffic to infer the link.\n+    if (node.IsBlockOnlyConn()) return false;\n+\n+    PeerRef peer = GetPeerRef(node.GetId());\n+    if (!peer->addr_relay_enabled) {\n+        // First addr message we have received from the peer, initialize\n+        // m_addr_known\n+        peer->m_addr_known = std::make_unique<CRollingBloomFilter>(5000, 0.001);\n+        peer->addr_relay_enabled = true;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 162,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677322503,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nice trick! done",
      "created_at": "2021-07-27T21:20:15Z",
      "updated_at": "2021-07-27T21:20:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677808677",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677808677"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": 4454,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 4458,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677822334",
      "pull_request_review_id": 716405818,
      "id": 677822334,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgyMjMzNA==",
      "diff_hunk": "@@ -224,9 +224,23 @@ struct Peer {\n \n     /** A vector of addresses to send to the peer, limited to MAX_ADDR_TO_SEND. */\n     std::vector<CAddress> m_addrs_to_send;\n-    /** Probabilistic filter of addresses that this peer already knows.\n-     *  Used to avoid relaying addresses to this peer more than once. */\n-    const std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Bloom filter to track recent addr messages relayed with this peer.\n+     *\n+     *  We initialize this filter for outbound peers (other than\n+     *  block-relay-only connections) or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  We use the presence of this filter to decide whether a peer is eligible\n+     *  for trickle relay of addr messages. This avoids relaying to peers that",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677310663,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "\"gossiping addr messages\" SGTM!",
      "created_at": "2021-07-27T21:45:17Z",
      "updated_at": "2021-07-27T21:45:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r677822334",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677822334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 234,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678092470",
      "pull_request_review_id": 716729381,
      "id": 678092470,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODA5MjQ3MA==",
      "diff_hunk": "@@ -612,6 +633,14 @@ class PeerManagerImpl final : public PeerManager\n      * @param[in]   vRecv           The raw message received\n      */\n     void ProcessGetCFCheckPt(CNode& peer, CDataStream& vRecv);\n+\n+    /** Checks if address relay is permitted with peer. If needed, initializes\n+     * the m_addr_known bloom filter and sets m_addr_relay_enabled to true.\n+     *\n+     *  @return   True if address relay is enabled with peer\n+     *            False if address relay is disallowed\n+     */\n+    bool SetupAddressRelay(CNode& node) const;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 57,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ceb20ad575cb2cbe971844e8a6422eca87d44bbb",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm not sure it makes sense to declare this method `const`. It doesn't mutate the state of the `PeerManagerImpl` object itself, but it can mutate a `Peer` object, which is owned by `PeerManagerImpl`.",
      "created_at": "2021-07-28T08:33:58Z",
      "updated_at": "2021-07-28T11:23:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r678092470",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678092470"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 643,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678098001",
      "pull_request_review_id": 716729381,
      "id": 678098001,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODA5ODAwMQ==",
      "diff_hunk": "@@ -3725,6 +3743,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         }\n         peer->m_getaddr_recvd = true;\n \n+        SetupAddressRelay(pfrom);",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 132,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677304728,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Logically, I think it makes sense to not access any addr data members until after `SetupAddressRelay()` is called. You're right that for now the ordering doesn't matter, but  I could imagine in the future we might want to collect the addr relay data members (`m_addrs_to_send`, `m_getaddr_sent`, `m_addr_send_times_mutex`, `m_next_addr_send`, etc)\r\ninto a struct which is initialized by `SetupAddressRelay()`, and only access those members after calling `SetupAddressRelay()`.\r\n\r\nI'll mark this comment as resolved.",
      "created_at": "2021-07-28T08:41:20Z",
      "updated_at": "2021-07-28T11:23:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r678098001",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678098001"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3754,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678209791",
      "pull_request_review_id": 716729381,
      "id": 678209791,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODIwOTc5MQ==",
      "diff_hunk": "@@ -31,6 +31,7 @@ struct CNodeStateStats {\n     std::vector<int> vHeightInFlight;\n     uint64_t m_addr_processed = 0;\n     uint64_t m_addr_rate_limited = 0;\n+    bool m_addr_relay_enabled;",
      "path": "src/net_processing.h",
      "position": null,
      "original_position": 4,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ceb20ad575cb2cbe971844e8a6422eca87d44bbb",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe explicitly default initialize this to `false`:\r\n\r\n```suggestion\r\n    bool m_addr_relay_enabled{false};\r\n```",
      "created_at": "2021-07-28T11:22:03Z",
      "updated_at": "2021-07-28T11:23:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r678209791",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678209791"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 34,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678686278",
      "pull_request_review_id": 717507510,
      "id": 678686278,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODY4NjI3OA==",
      "diff_hunk": "@@ -612,6 +633,14 @@ class PeerManagerImpl final : public PeerManager\n      * @param[in]   vRecv           The raw message received\n      */\n     void ProcessGetCFCheckPt(CNode& peer, CDataStream& vRecv);\n+\n+    /** Checks if address relay is permitted with peer. If needed, initializes\n+     * the m_addr_known bloom filter and sets m_addr_relay_enabled to true.\n+     *\n+     *  @return   True if address relay is enabled with peer\n+     *            False if address relay is disallowed\n+     */\n+    bool SetupAddressRelay(CNode& node) const;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 57,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ceb20ad575cb2cbe971844e8a6422eca87d44bbb",
      "in_reply_to_id": 678092470,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "removed",
      "created_at": "2021-07-28T22:09:32Z",
      "updated_at": "2021-07-28T22:09:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r678686278",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678686278"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 643,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678686351",
      "pull_request_review_id": 717507607,
      "id": 678686351,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODY4NjM1MQ==",
      "diff_hunk": "@@ -31,6 +31,7 @@ struct CNodeStateStats {\n     std::vector<int> vHeightInFlight;\n     uint64_t m_addr_processed = 0;\n     uint64_t m_addr_rate_limited = 0;\n+    bool m_addr_relay_enabled;",
      "path": "src/net_processing.h",
      "position": null,
      "original_position": 4,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "ceb20ad575cb2cbe971844e8a6422eca87d44bbb",
      "in_reply_to_id": 678209791,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2021-07-28T22:09:43Z",
      "updated_at": "2021-07-28T22:09:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r678686351",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678686351"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 34,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678686487",
      "pull_request_review_id": 717507767,
      "id": 678686487,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODY4NjQ4Nw==",
      "diff_hunk": "@@ -3725,6 +3743,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         }\n         peer->m_getaddr_recvd = true;\n \n+        SetupAddressRelay(pfrom);",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 132,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "d16a2296bf86ea1ed44dd745ac9a567849947473",
      "in_reply_to_id": 677304728,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ah gotcha, ok! moved",
      "created_at": "2021-07-28T22:10:02Z",
      "updated_at": "2021-07-28T22:10:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r678686487",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678686487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3754,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679074888",
      "pull_request_review_id": 717991899,
      "id": 679074888,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTA3NDg4OA==",
      "diff_hunk": "@@ -4423,6 +4431,23 @@ class CompareInvMempoolOrder\n };\n }\n \n+bool PeerManagerImpl::SetupAddressRelay(CNode& node)\n+{\n+    // We don't participate in addr relay with outbound block-relay-only\n+    // connections to prevent providing adversaries with the additional\n+    // information of addr traffic to infer the link.\n+    if (node.IsBlockOnlyConn()) return false;\n+\n+    PeerRef peer = GetPeerRef(node.GetId());",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "4ef28624c3f8238e3688f841ba9d67e67ec747d0",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Any reason to not pass in `PeerRef peer` from outside and remove this line?",
      "created_at": "2021-07-29T11:43:48Z",
      "updated_at": "2021-07-29T12:00:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r679074888",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679074888"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4441,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679085653",
      "pull_request_review_id": 717991899,
      "id": 679085653,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTA4NTY1Mw==",
      "diff_hunk": "@@ -230,8 +230,25 @@ struct Peer {\n      *  We initialize this filter for outbound peers (other than\n      *  block-relay-only connections) or when an inbound peer sends us an\n      *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  Presence of this filter must correlate with m_addr_relay_enabled.\n      **/\n     std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Whether we are participating in address relay with this connection.\n+     *\n+     *  We set this bool to true for outbound peers (other than\n+     *  block-relay-only connections), or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  We use this bool to decide whether a peer is eligible for gossiping\n+     *  addr messages. This avoids relaying to peers that are unlikely to\n+     *  forward them, effectively blaackholing self announcements. Reasons",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "7e4662b8a0ea0428aa9eefe7b8116f85e5eda486",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "7e4662b8a0ea0428aa9eefe7b8116f85e5eda486: blackholing",
      "created_at": "2021-07-29T12:00:33Z",
      "updated_at": "2021-07-29T12:00:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r679085653",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679085653"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679338070",
      "pull_request_review_id": 718341498,
      "id": 679338070,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTMzODA3MA==",
      "diff_hunk": "@@ -4423,6 +4431,23 @@ class CompareInvMempoolOrder\n };\n }\n \n+bool PeerManagerImpl::SetupAddressRelay(CNode& node)\n+{\n+    // We don't participate in addr relay with outbound block-relay-only\n+    // connections to prevent providing adversaries with the additional\n+    // information of addr traffic to infer the link.\n+    if (node.IsBlockOnlyConn()) return false;\n+\n+    PeerRef peer = GetPeerRef(node.GetId());",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "4ef28624c3f8238e3688f841ba9d67e67ec747d0",
      "in_reply_to_id": 679074888,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "no particular reason _not_ to, I'm trying to understand the differences... \r\n\r\ncurrent implementation: uses `GetPeerRef` which constructs an additional `shared_ptr`, and would have to update the control block used to coordinate between the pointers. \r\n\r\nyour suggestion: passing in `PeerRef peer`, doesn't this increment the refcount at the beginning of the function & decrement at the end? so what difference does it make? \r\n\r\nanother alternative: passing in `Peer& peer`. does this mean the lifetime of the reference would just be managed in the normal program execution? so would that mean this is the most efficient?",
      "created_at": "2021-07-29T17:11:15Z",
      "updated_at": "2021-07-29T17:19:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r679338070",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679338070"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4441,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679341641",
      "pull_request_review_id": 718346053,
      "id": 679341641,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTM0MTY0MQ==",
      "diff_hunk": "@@ -4423,6 +4431,23 @@ class CompareInvMempoolOrder\n };\n }\n \n+bool PeerManagerImpl::SetupAddressRelay(CNode& node)\n+{\n+    // We don't participate in addr relay with outbound block-relay-only\n+    // connections to prevent providing adversaries with the additional\n+    // information of addr traffic to infer the link.\n+    if (node.IsBlockOnlyConn()) return false;\n+\n+    PeerRef peer = GetPeerRef(node.GetId());",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "4ef28624c3f8238e3688f841ba9d67e67ec747d0",
      "in_reply_to_id": 679074888,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Also, you wouldn't need to check for nullptr, as the caller already did that",
      "created_at": "2021-07-29T17:16:17Z",
      "updated_at": "2021-07-29T17:16:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r679341641",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679341641"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4441,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679347992",
      "pull_request_review_id": 718354044,
      "id": 679347992,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTM0Nzk5Mg==",
      "diff_hunk": "@@ -4423,6 +4431,23 @@ class CompareInvMempoolOrder\n };\n }\n \n+bool PeerManagerImpl::SetupAddressRelay(CNode& node)\n+{\n+    // We don't participate in addr relay with outbound block-relay-only\n+    // connections to prevent providing adversaries with the additional\n+    // information of addr traffic to infer the link.\n+    if (node.IsBlockOnlyConn()) return false;\n+\n+    PeerRef peer = GetPeerRef(node.GetId());",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "4ef28624c3f8238e3688f841ba9d67e67ec747d0",
      "in_reply_to_id": 679074888,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> another alternative: passing in Peer& peer. does this mean the lifetime of the reference would just be managed in the normal program execution? so would that mean this is the most efficient?\r\n\r\nThis is the way to do it. The called function is not taking ownership of `Peer`, so just pass by reference. You only need to pass smart pointers when you're indicating ownership semantics: https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rf-inout (and items F26/27)",
      "created_at": "2021-07-29T17:25:25Z",
      "updated_at": "2021-07-29T17:25:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r679347992",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679347992"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4441,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679573334",
      "pull_request_review_id": 718637139,
      "id": 679573334,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTU3MzMzNA==",
      "diff_hunk": "@@ -230,8 +230,25 @@ struct Peer {\n      *  We initialize this filter for outbound peers (other than\n      *  block-relay-only connections) or when an inbound peer sends us an\n      *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  Presence of this filter must correlate with m_addr_relay_enabled.\n      **/\n     std::unique_ptr<CRollingBloomFilter> m_addr_known;\n+    /** Whether we are participating in address relay with this connection.\n+     *\n+     *  We set this bool to true for outbound peers (other than\n+     *  block-relay-only connections), or when an inbound peer sends us an\n+     *  address related message (ADDR, ADDRV2, GETADDR).\n+     *\n+     *  We use this bool to decide whether a peer is eligible for gossiping\n+     *  addr messages. This avoids relaying to peers that are unlikely to\n+     *  forward them, effectively blaackholing self announcements. Reasons",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "7e4662b8a0ea0428aa9eefe7b8116f85e5eda486",
      "in_reply_to_id": 679085653,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "*** blaaaaackholing \r\n\r\n:) fixed ",
      "created_at": "2021-07-30T00:48:58Z",
      "updated_at": "2021-07-30T00:48:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r679573334",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679573334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679573586",
      "pull_request_review_id": 718637368,
      "id": 679573586,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTU3MzU4Ng==",
      "diff_hunk": "@@ -4423,6 +4431,23 @@ class CompareInvMempoolOrder\n };\n }\n \n+bool PeerManagerImpl::SetupAddressRelay(CNode& node)\n+{\n+    // We don't participate in addr relay with outbound block-relay-only\n+    // connections to prevent providing adversaries with the additional\n+    // information of addr traffic to infer the link.\n+    if (node.IsBlockOnlyConn()) return false;\n+\n+    PeerRef peer = GetPeerRef(node.GetId());",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "4ef28624c3f8238e3688f841ba9d67e67ec747d0",
      "in_reply_to_id": 679074888,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "👍 done, thanks! ",
      "created_at": "2021-07-30T00:49:42Z",
      "updated_at": "2021-07-30T00:49:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r679573586",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679573586"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4441,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680963101",
      "pull_request_review_id": 720191910,
      "id": 680963101,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDk2MzEwMQ==",
      "diff_hunk": "@@ -3717,6 +3743,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        SetupAddressRelay(pfrom, *peer);",
      "path": "src/net_processing.cpp",
      "position": 140,
      "original_position": 140,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`if (!pfrom.IsInboundConn() || !SetupAddressRelay(pfrom, *peer)) { error; return; }` might have been better so you don't have to keep the knowledge that SetupAddressRelay always returns true for inbound conns in your head.",
      "created_at": "2021-08-02T13:18:29Z",
      "updated_at": "2021-08-02T13:39:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r680963101",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680963101"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3746,
      "original_line": 3746,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681016819",
      "pull_request_review_id": 720264341,
      "id": 681016819,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MTAxNjgxOQ==",
      "diff_hunk": "@@ -3717,6 +3743,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        SetupAddressRelay(pfrom, *peer);",
      "path": "src/net_processing.cpp",
      "position": 140,
      "original_position": 140,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "in_reply_to_id": 680963101,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "makes sense, I'll change if I have to push again ",
      "created_at": "2021-08-02T14:25:32Z",
      "updated_at": "2021-08-02T14:25:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r681016819",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681016819"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3746,
      "original_line": 3746,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681374594",
      "pull_request_review_id": 720711594,
      "id": 681374594,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MTM3NDU5NA==",
      "diff_hunk": "@@ -167,6 +179,9 @@ def relay_tests(self):\n         # of the outbound peer which is often sent before the GETADDR response.\n         assert_equal(inbound_peer.num_ipv4_received, 0)\n \n+        # Send an empty ADDR message to intialize address relay on this connection.",
      "path": "test/functional/p2p_addr_relay.py",
      "position": 68,
      "original_position": 68,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "s/intialize/initialize",
      "created_at": "2021-08-03T01:47:41Z",
      "updated_at": "2021-08-03T01:47:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r681374594",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681374594"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 182,
      "original_line": 182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681556819",
      "pull_request_review_id": 720934989,
      "id": 681556819,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MTU1NjgxOQ==",
      "diff_hunk": "@@ -3717,6 +3743,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        SetupAddressRelay(pfrom, *peer);",
      "path": "src/net_processing.cpp",
      "position": 140,
      "original_position": 140,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "in_reply_to_id": 680963101,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`Assume(Setup())` would do that?",
      "created_at": "2021-08-03T08:39:58Z",
      "updated_at": "2021-08-03T08:39:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r681556819",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681556819"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3746,
      "original_line": 3746,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681570767",
      "pull_request_review_id": 720952782,
      "id": 681570767,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MTU3MDc2Nw==",
      "diff_hunk": "@@ -11,14 +11,15 @@\n     NODE_NETWORK,\n     NODE_WITNESS,\n     msg_addr,\n-    msg_getaddr\n+    msg_getaddr,\n+    msg_verack",
      "path": "test/functional/p2p_addr_relay.py",
      "position": 6,
      "original_position": 6,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: Would be nice to always add a trailing comma to avoid ugly diffs and keeping the `git blame` depth lower in the future.",
      "created_at": "2021-08-03T08:58:08Z",
      "updated_at": "2021-08-03T08:58:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r681570767",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681570767"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 15,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681861829",
      "pull_request_review_id": 721335348,
      "id": 681861829,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MTg2MTgyOQ==",
      "diff_hunk": "@@ -11,14 +11,15 @@\n     NODE_NETWORK,\n     NODE_WITNESS,\n     msg_addr,\n-    msg_getaddr\n+    msg_getaddr,\n+    msg_verack",
      "path": "test/functional/p2p_addr_relay.py",
      "position": 6,
      "original_position": 6,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "in_reply_to_id": 681570767,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "noted",
      "created_at": "2021-08-03T15:19:30Z",
      "updated_at": "2021-08-03T15:19:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r681861829",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681861829"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 15,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681936270",
      "pull_request_review_id": 721432604,
      "id": 681936270,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MTkzNjI3MA==",
      "diff_hunk": "@@ -3717,6 +3743,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        SetupAddressRelay(pfrom, *peer);",
      "path": "src/net_processing.cpp",
      "position": 140,
      "original_position": 140,
      "commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "original_commit_id": "3f7250b328b8b2f5d63f323702445ac5c989b73d",
      "in_reply_to_id": 680963101,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "addressed in #22618 ",
      "created_at": "2021-08-03T16:51:14Z",
      "updated_at": "2021-08-03T16:51:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21528#discussion_r681936270",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/681936270"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21528"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3746,
      "original_line": 3746,
      "side": "RIGHT"
    }
  ]
}