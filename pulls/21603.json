{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603",
    "id": 608932991,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NjA4OTMyOTkx",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21603",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/21603.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/21603.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/c86d5ff02a31322612555db559e1d97ef329e27f",
    "number": 21603,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "log: Mitigate disk filling attacks by rate limiting LogPrintf",
    "user": {
      "login": "dergoegge",
      "id": 8077169,
      "node_id": "MDQ6VXNlcjgwNzcxNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dergoegge",
      "html_url": "https://github.com/dergoegge",
      "followers_url": "https://api.github.com/users/dergoegge/followers",
      "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
      "organizations_url": "https://api.github.com/users/dergoegge/orgs",
      "repos_url": "https://api.github.com/users/dergoegge/repos",
      "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/dergoegge/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This picks up #19995 in an attempt to solve #21559.\r\n\r\nThe goal of this PR is to mitigate disk filling attacks by temporarily rate limiting `LogPrintf(…)`.\r\n\r\nA disk fill attack is an attack where an untrusted party (such as a peer) is able to cheaply make your node log to disk excessively. The excessive logging may fill your disk and thus make your node crash either cleanly (best case: if disk fill rate is relatively slow) or uncleanly (worst case: if disk fill rate is relatively fast).\r\n\r\n## Approach\r\n\r\nThe hourly logging quota is set **per source location**. Every single source location (say net_processing.cpp:418) gets a quota of 1 MB of logging per hour. Logging is only dropped from source locations that exceed the quota.\r\n\r\n- Only logging to disk is rate limited. Logging to console is not rate limited.\r\n- Only `LogPrintf(…)` is rate limited. `LogPrint(category, …)` (`-debug`) is not rate limited.\r\n- `UpdateTip: new best=[…]` is logged using `LogPrintfWithoutRateLimiting(…)` to avoid rate limiting. High log volume is expected for that source location during IBD.\r\n- When logging is restarted a tally of how many messages/bytes were dropped is printed.\r\n- Log rate limiting can be disabled with the `-ratelimitlogging` config option.\r\n- All logs will be prefixed with `[*]` if there is at least one source location that is currently being suppressed.\r\n\r\n### Alternatives\r\n\r\nIn a recent [PR Review Club meeting](https://bitcoincore.reviews/21603) we discussed this PR and evaluated alternative approaches.\r\n\r\n<details>\r\n<summary>Global rate limiting </summary>\r\n\r\n#### Global rate limiting\r\n\r\nThere was some discussion around an alternative approach which would be to globally rate limit `LogPrintf(…)`.  This approach was implemented in a competing PR #21706. The main point [1] in favor of global rate limiting is that it could be confusing to have incomplete logs when logs from one source location are dropped but not from others. The main point against global rate limiting is that it opens another attack vector where an attacker could trigger rate limiting and then execute a 2. attack which would then not be document in the logs at all. With regard to the attack vector on the global approach and the overall reviews the two approaches have gotten I have chosen to continue with the approach in this PR. \r\n(To address the concern of [1] i have chosen to prefix all logs with `[*]` if there is at least one source location that is currently being suppressed.)\r\n</details>\r\n\r\n<details>\r\n<summary>logrotate</summary>\r\n\r\n#### logrotate\r\n\r\nLarryRuane brought up [logrotate](https://linux.die.net/man/8/logrotate) which can be used on linux to monitor log files and perform actions (delete, compress, send somewhere, etc.) on them when a certain size or point in time is reached. `logrotate` could be used to rate limit log but since we would like log rate limiting to be enabled by default it is not the best solution. Also on windows an alternative would have to be used.\r\n\r\n</details>\r\n\r\n## Testing\r\n\r\nI have a written a unit test which is contained in this PR. (Not the greatest test, it currently does not work on windows thanks to `\\r\\n`. If someone has an idea how to improve the test i would appreciate it)\r\n\r\nFurther more I made a RPC [here](https://github.com/dergoegge/bitcoin/commit/8e6d15d6be06834d1f634f4a54ea646be8bc3491) that can log excessive amounts of \"a\"s from different locations which i have found useful during my own testing.\r\n`bitcoin-cli excessivelog <location (1-5)> <num_bytes>`\r\n\r\n⚠️One thing to note with that rpc is that the rate limiting logic still prints the last message that triggered the limiting to disk, so something like `bitcoin-cli excessivelog 1 536870912` would still log ~512MiB to disk. Logging to console is also never suppressed (unless -printtoconsole=0)  ⚠️\r\n\r\nA simple example to use the rpc:\r\n```bash\r\nbitcoin-cli -regtest setmocktime 1\r\nbitcoin-cli -regtest excessivelog 1 1048500 # log just under 1MiB\r\nbitcoin-cli -regtest excessivelog 1 100 # this should get the total amount logged above 1MiB\r\n                                        # and the rate limiting logic should kick in\r\nbitcoin-cli -regtest setmocktime 3602 # let 1 hour pass (only works in regtest)\r\nbitcoin-cli -regtest excessivelog 1 100 # this should trigger logging to resume\r\n```\r\n",
    "labels": [
      {
        "id": 241832923,
        "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
        "name": "Utils/log/libs",
        "description": "",
        "color": "5319e7",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2021-04-05T12:47:33Z",
    "updated_at": "2022-10-07T10:18:05Z",
    "closed_at": "2022-10-07T10:18:05Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merge_commit_sha": "a9762d964b124cfebe98a08abf7366e4c9ff9155",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "dergoegge:log_ratelimiting",
      "ref": "log_ratelimiting",
      "sha": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 315023492,
        "node_id": "MDEwOlJlcG9zaXRvcnkzMTUwMjM0OTI=",
        "name": "bitcoin",
        "full_name": "dergoegge/bitcoin",
        "owner": {
          "login": "dergoegge",
          "id": 8077169,
          "node_id": "MDQ6VXNlcjgwNzcxNjk=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/dergoegge",
          "html_url": "https://github.com/dergoegge",
          "followers_url": "https://api.github.com/users/dergoegge/followers",
          "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
          "organizations_url": "https://api.github.com/users/dergoegge/orgs",
          "repos_url": "https://api.github.com/users/dergoegge/repos",
          "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/dergoegge/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/dergoegge/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/dergoegge/bitcoin",
        "archive_url": "https://api.github.com/repos/dergoegge/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/dergoegge/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/dergoegge/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/dergoegge/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/dergoegge/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/dergoegge/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/dergoegge/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/dergoegge/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/dergoegge/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/dergoegge/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/dergoegge/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/dergoegge/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/dergoegge/bitcoin/events",
        "forks_url": "https://api.github.com/repos/dergoegge/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/dergoegge/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/dergoegge/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/dergoegge/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/dergoegge/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/dergoegge/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/dergoegge/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/dergoegge/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/dergoegge/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/dergoegge/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/dergoegge/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/dergoegge/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/dergoegge/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/dergoegge/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/dergoegge/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/dergoegge/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:dergoegge/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/dergoegge/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/dergoegge/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/dergoegge/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/dergoegge/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/dergoegge/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/dergoegge/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/dergoegge/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/dergoegge/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/dergoegge/bitcoin/hooks",
        "svn_url": "https://github.com/dergoegge/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 222378,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T10:23:38Z",
        "created_at": "2020-11-22T11:41:30Z",
        "updated_at": "2023-05-05T12:10:28Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "29d540b7ada890dd588c4825d40c27c5e6f20061",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69819,
        "watchers_count": 69819,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-06T22:42:00Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T04:47:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 348,
    "deletions": 58,
    "changed_files": 7,
    "commits": 11,
    "review_comments": 59,
    "comments": 41
  },
  "events": [
    {
      "event": "labeled",
      "id": 4551485069,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ1NTE0ODUwNjk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4551485069",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-05T12:48:25Z",
      "label": {
        "name": "Utils/log/libs",
        "color": "5319e7"
      }
    },
    {
      "event": "commented",
      "id": 813376120,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzM3NjEyMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813376120",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-05T12:49:06Z",
      "updated_at": "2021-04-05T12:49:06Z",
      "author_association": "MEMBER",
      "body": "In response to @jnewbery's [comment](https://github.com/bitcoin/bitcoin/pull/19995#pullrequestreview-505540213)\r\n\r\n> I think I'd prefer log-shedding to be done globally, with a special log at the end of a log suppression period that tallies up which log locations have been suppressed.\r\n\r\nI disagree on the global schedding, i think the source location based schedding is over all the better approach.\r\nI agree with your point that it could be confusing to drop some logs in the context of user issues but schedding should only kick in if there is an attack or something is horribly wrong, so i would think that almost all logs provided by users would be complete. We can also always tell if rate limiting is taking place since we log when it starts/stops and in those cases a partial log is better then no log.\r\n\r\n(This is obviously mostly an opinion and I am totally willing to be convinced of global log-schedding if enough reviewers favor it)",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-813376120",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 4551487205,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDU1MTQ4NzIwNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4551487205",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-05T12:49:06Z"
    },
    {
      "event": "subscribed",
      "id": 4551487208,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ1NTE0ODcyMDg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4551487208",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-05T12:49:07Z"
    },
    {
      "event": "commented",
      "id": 813443768,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzQ0Mzc2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813443768",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-05T15:08:12Z",
      "updated_at": "2022-06-09T08:22:15Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25306](https://github.com/bitcoin/bitcoin/pull/25306) (logging: add LogPrintfCategory to log unconditionally with category by jonatack)\n* [#25287](https://github.com/bitcoin/bitcoin/pull/25287) (logging: threshold log level by klementtan)\n* [#25203](https://github.com/bitcoin/bitcoin/pull/25203) (logging: update to severity-based logging by jonatack)\n* [#24950](https://github.com/bitcoin/bitcoin/pull/24950) (Add config option to set max debug log size by tehelsper)\n* [#23443](https://github.com/bitcoin/bitcoin/pull/23443) (p2p: Erlay support signaling by naumenkogs)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-813443768",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4553806597,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU1MzgwNjU5Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4553806597",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-05T23:28:47Z"
    },
    {
      "event": "commented",
      "id": 813901411,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzkwMTQxMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813901411",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-06T07:39:20Z",
      "updated_at": "2021-04-06T07:39:20Z",
      "author_association": "MEMBER",
      "body": "> schedding should only kick in if there is an attack or something is horribly wrong, so i would think that almost all logs provided by users would be complete.\r\n\r\nRight, and those cases are exactly where we need the best possible logs.\r\n\r\n> We can also always tell if rate limiting is taking place since we log when it starts/stops and in those cases a partial log is better then no log.\r\n\r\nI guarantee you that not everyone will know this and most people will miss a single log line saying \"rate-limiting log x\".\r\n\r\nI can only speak from my own experience of supporting network equipment for several years - partial logs are often worse than no logs at all since they're so misleading.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-813901411",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 813912391,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzkxMjM5MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813912391",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-06T07:55:49Z",
      "updated_at": "2021-04-06T07:55:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "Strongest possible Concept ACK: this mitigation will kill an entire bug class (the \"disk fill via logging\" bug class). \r\n\r\nThanks for taking up this work @dergoegge.\r\n\r\nWill test and review.",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-813912391",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 4555166303,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDU1NTE2NjMwMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4555166303",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-06T07:55:49Z"
    },
    {
      "event": "subscribed",
      "id": 4555166307,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ1NTUxNjYzMDc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4555166307",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-06T07:55:49Z"
    },
    {
      "event": "commented",
      "id": 813933612,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzkzMzYxMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813933612",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-06T08:27:05Z",
      "updated_at": "2021-04-06T08:27:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "@jnewbery \r\n\r\n> I think I'd prefer log-shedding to be done globally, with a special log at the end of a log suppression period that tallies up which log locations have been suppressed.\r\n\r\nClarifying questions to fully understand what is suggested:\r\n\r\nLet's assume that log location A is a misplaced `LogPrintf` in a code path that the attacker can make us take.\r\n\r\nIn the case of an attacker using log location A to fill our disk by making us log from there repeatedly, is the suggestion then that _all_ log locations should be suppressed during the suppression period (instead of suppressing only the \"attacker controlled\" log location A)?\r\n\r\nTo make your suggestion clear: could you exemplify what the special log entry at the end of the log suppression period would look like? (A patch or even a separate PR would be even better, but an example log entry would probably clarify enough!)",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-813933612",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 4555328109,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDU1NTMyODEwOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4555328109",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-06T08:27:05Z"
    },
    {
      "event": "subscribed",
      "id": 4555328122,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ1NTUzMjgxMjI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4555328122",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-06T08:27:05Z"
    },
    {
      "event": "reviewed",
      "id": 629448028,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjI5NDQ4MDI4",
      "url": null,
      "actor": null,
      "commit_id": "fa114ff2d4b098891569d4f1d67c1e46850cbd5e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-629448028",
      "submitted_at": "2021-04-06T22:08:28Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4559463957,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU1OTQ2Mzk1Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4559463957",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-06T23:20:35Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4559500599,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU1OTUwMDU5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4559500599",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-06T23:37:17Z"
    },
    {
      "event": "reviewed",
      "id": 635686766,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjM1Njg2NzY2",
      "url": null,
      "actor": null,
      "commit_id": "1653167de64b15df306158d0d2e9bef9c8bea79e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-635686766",
      "submitted_at": "2021-04-14T14:26:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4601545503,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDYwMTU0NTUwMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4601545503",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-15T20:54:06Z"
    },
    {
      "event": "commented",
      "id": 820891905,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDg5MTkwNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820891905",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T04:09:33Z",
      "updated_at": "2021-04-16T04:09:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "@dergoegge \r\n\r\nThanks for your work on this PR!\r\n\r\nWould you be willing to implement also @jnewbery's suggestions as a separate PR?\r\n\r\nI tried to summarise his suggestion in https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-813933612. I'm not certain I got it right though - @jnewbery, feel free to chime in :)\r\n\r\nI think it makes sense to do it as separate PR since it deviates in important ways from the original suggestion. By having two separate PRs we would see which of the two approaches to address this type of attack that have consensus support.\r\n\r\nPersonally I think I could live with both approaches: as long as we kill the disk-fill-via-logging bug class sooner rather than later I'm happy :)",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-820891905",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 4602681599,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDYwMjY4MTU5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4602681599",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T04:09:33Z"
    },
    {
      "event": "subscribed",
      "id": 4602681604,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2MDI2ODE2MDQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4602681604",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T04:09:33Z"
    },
    {
      "event": "mentioned",
      "id": 4602681608,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDYwMjY4MTYwOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4602681608",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T04:09:33Z"
    },
    {
      "event": "subscribed",
      "id": 4602681609,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2MDI2ODE2MDk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4602681609",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T04:09:33Z"
    },
    {
      "event": "commented",
      "id": 821138307,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTEzODMwNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821138307",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T12:25:48Z",
      "updated_at": "2021-04-16T12:25:48Z",
      "author_association": "MEMBER",
      "body": "> Would you be willing to implement also jnewbery's suggestions as a separate PR?\r\n\r\n@practicalswift Sure, thats a good idea :)\r\n",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-821138307",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 4604567698,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDYwNDU2NzY5OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4604567698",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T12:25:48Z"
    },
    {
      "event": "subscribed",
      "id": 4604567702,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2MDQ1Njc3MDI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4604567702",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T12:25:48Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4605442786,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDYwNTQ0Mjc4Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4605442786",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-16T15:19:30Z"
    },
    {
      "event": "commented",
      "id": 821797545,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTc5NzU0NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821797545",
      "actor": {
        "login": "rebroad",
        "id": 1530283,
        "node_id": "MDQ6VXNlcjE1MzAyODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rebroad",
        "html_url": "https://github.com/rebroad",
        "followers_url": "https://api.github.com/users/rebroad/followers",
        "following_url": "https://api.github.com/users/rebroad/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rebroad/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rebroad/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
        "organizations_url": "https://api.github.com/users/rebroad/orgs",
        "repos_url": "https://api.github.com/users/rebroad/repos",
        "events_url": "https://api.github.com/users/rebroad/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rebroad/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-17T09:45:04Z",
      "updated_at": "2021-04-17T09:45:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "concept ACK (not that I'm sure if my opinion is relevant) and I think this makes more sense than the global alternative.",
      "user": {
        "login": "rebroad",
        "id": 1530283,
        "node_id": "MDQ6VXNlcjE1MzAyODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rebroad",
        "html_url": "https://github.com/rebroad",
        "followers_url": "https://api.github.com/users/rebroad/followers",
        "following_url": "https://api.github.com/users/rebroad/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rebroad/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rebroad/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
        "organizations_url": "https://api.github.com/users/rebroad/orgs",
        "repos_url": "https://api.github.com/users/rebroad/repos",
        "events_url": "https://api.github.com/users/rebroad/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rebroad/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-821797545",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "labeled",
      "id": 4635876468,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ2MzU4NzY0Njg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4635876468",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-23T09:36:42Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 831141878,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTE0MTg3OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/831141878",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-03T09:32:28Z",
      "updated_at": "2021-05-03T09:32:28Z",
      "author_association": "MEMBER",
      "body": "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\n🕵️ @sipa has been requested to review this pull request as specified in the REVIEWERS file.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-831141878",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 4677163737,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDY3NzE2MzczNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4677163737",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-03T09:32:28Z"
    },
    {
      "event": "subscribed",
      "id": 4677163744,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2NzcxNjM3NDQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4677163744",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-03T09:32:28Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4741565855,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDc0MTU2NTg1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4741565855",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-13T12:17:04Z"
    },
    {
      "event": "unlabeled",
      "id": 4741839619,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NDc0MTgzOTYxOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4741839619",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-13T13:23:55Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 4880823855,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ4ODA4MjM4NTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4880823855",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T04:41:50Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 860018394,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2MDAxODM5NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860018394",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T08:04:55Z",
      "updated_at": "2021-06-12T08:04:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "@dergoegge Thanks for working on this. Would you mind rebasing? I would like to review the updated version :)",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-860018394",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 4880993233,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDg4MDk5MzIzMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4880993233",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T08:04:55Z"
    },
    {
      "event": "subscribed",
      "id": 4880993234,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ4ODA5OTMyMzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4880993234",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T08:04:56Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4881083273,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDg4MTA4MzI3Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4881083273",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T09:54:52Z"
    },
    {
      "event": "unlabeled",
      "id": 4881136185,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NDg4MTEzNjE4NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4881136185",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T10:59:14Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 860037566,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2MDAzNzU2Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860037566",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T11:02:37Z",
      "updated_at": "2021-06-12T11:02:37Z",
      "author_association": "MEMBER",
      "body": "@practicalswift Rebased :)\r\n\r\nFor anyone reviewing this: I made a rpc [here](https://github.com/dergoegge/bitcoin/commit/8e6d15d6be06834d1f634f4a54ea646be8bc3491) that can log excessive amounts of \"a\"s from different locations which might be useful for testing.\r\n`bitcoin-cli excessivelog <location (1-5)> <num_bytes>`\r\n\r\n⚠️One thing to note with that rpc is that the rate limiting logic still prints the last message that triggered the limiting to disk, so something like `bitcoin-cli excessivelog 1 536870912` would still log ~512MiB to disk. Logging to console is also never suppressed (unless -printtoconsole=0)  ⚠️\r\n\r\nA simple example to use the rpc:\r\n```bash\r\nbitcoin-cli excessivelog 1 1048500 # log just under 1MiB\r\nbitcoin-cli excessivelog 1 100 # this should get the total amount logged above 1MiB and the rate limiting logic should kick in\r\n```",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-860037566",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 4881139120,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDg4MTEzOTEyMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4881139120",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T11:02:37Z"
    },
    {
      "event": "subscribed",
      "id": 4881139121,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ4ODExMzkxMjE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4881139121",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T11:02:37Z"
    },
    {
      "event": "commented",
      "id": 862552556,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjU1MjU1Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862552556",
      "actor": {
        "login": "Emzy",
        "id": 1223908,
        "node_id": "MDQ6VXNlcjEyMjM5MDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1223908?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Emzy",
        "html_url": "https://github.com/Emzy",
        "followers_url": "https://api.github.com/users/Emzy/followers",
        "following_url": "https://api.github.com/users/Emzy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Emzy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Emzy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Emzy/subscriptions",
        "organizations_url": "https://api.github.com/users/Emzy/orgs",
        "repos_url": "https://api.github.com/users/Emzy/repos",
        "events_url": "https://api.github.com/users/Emzy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Emzy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-16T17:01:44Z",
      "updated_at": "2021-06-16T17:01:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "concept ACK \r\nI think this PR makes more sense than the global alternative, because global rate limiting would open another attack vector.\r\nAn attacker could trigger the global limit in one category and conceal another attack from the log.",
      "user": {
        "login": "Emzy",
        "id": 1223908,
        "node_id": "MDQ6VXNlcjEyMjM5MDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1223908?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Emzy",
        "html_url": "https://github.com/Emzy",
        "followers_url": "https://api.github.com/users/Emzy/followers",
        "following_url": "https://api.github.com/users/Emzy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Emzy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Emzy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Emzy/subscriptions",
        "organizations_url": "https://api.github.com/users/Emzy/orgs",
        "repos_url": "https://api.github.com/users/Emzy/repos",
        "events_url": "https://api.github.com/users/Emzy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Emzy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-862552556",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4906071507,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDkwNjA3MTUwNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4906071507",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-17T18:58:49Z"
    },
    {
      "event": "commented",
      "id": 863494151,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2MzQ5NDE1MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863494151",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-17T19:07:31Z",
      "updated_at": "2021-06-17T19:07:31Z",
      "author_association": "MEMBER",
      "body": "I moved the rate limiting logic into its own method.\r\n[log_ratelimiting.0](https://github.com/dergoegge/bitcoin/tree/log_ratelimiting.0) -> [log_ratelimiting.1](https://github.com/dergoegge/bitcoin/tree/log_ratelimiting.1)\r\n\r\n<details>\r\n<summary>git range-diff master log_ratelimiting.0 log_ratelimiting.1</summary>\r\n\r\n```\r\n1:  76c59a1cc ! 1:  a3a2cfd64 log: Mitigate disk filling attacks by rate limiting LogPrintf\r\n    @@ Metadata\r\n      ## Commit message ##\r\n         log: Mitigate disk filling attacks by rate limiting LogPrintf\r\n     \r\n    +    Co-authored-by: dergoegge <n.goeggi@gmail.com>\r\n    +\r\n      ## src/init/common.cpp ##\r\n     @@ src/init/common.cpp: void AddLoggingArgs(ArgsManager& argsman)\r\n          argsman.AddArg(\"-logtimemicros\", strprintf(\"Add microsecond precision to debug timestamps (default: %u)\", DEFAULT_LOGTIMEMICROS), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\r\n    @@ src/logging.cpp: namespace BCLog {\r\n     -void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line)\r\n     +static constexpr uint64_t HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION{1024 * 1024};\r\n     +\r\n    ++bool BCLog::Logger::RateLimit(std::string& str, const std::string& logging_function, const SourceLocation& source_location)\r\n    ++{\r\n    ++    if (!m_rate_limiting) {\r\n    ++        // Rate limiting is disabled.\r\n    ++        return false;\r\n    ++    }\r\n    ++\r\n    ++    const std::chrono::seconds now = GetTime<std::chrono::seconds>();\r\n    ++    QuotaUsage& quota_usage = m_quota_usage_per_source_location[source_location];\r\n    ++    // Is the quota exceeded before this log call?\r\n    ++    bool quota_exceeded_before = quota_usage.m_bytes_logged > HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION;\r\n    ++\r\n    ++    bool dont_skip = false;\r\n    ++    // Every hour the quota usage for a source location is reset.\r\n    ++    if ((now - quota_usage.m_last_reset) > std::chrono::hours{1}) {\r\n    ++        // Should logging to disk continue to be disabled?\r\n    ++        bool quota_still_exceeded = quota_usage.m_bytes_dropped > HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION;\r\n    ++\r\n    ++        if (quota_still_exceeded) {\r\n    ++            str = LogTimestampStr(strprintf(\r\n    ++                \"Not restarting logging from %s:%d (%s): \"\r\n    ++                \"because %d messages (%d MiB) were dropped during the last hour which still exceeds the limit of %d MiB.\\n\",\r\n    ++                source_location.first, source_location.second, logging_function, quota_usage.m_messages_dropped,\r\n    ++                quota_usage.m_bytes_dropped / (1024 * 1024), HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION / (1024 * 1024)));\r\n    ++        } else if (quota_exceeded_before) {\r\n    ++            str = LogTimestampStr(strprintf(\r\n    ++                \"Restarting logging from %s:%d (%s): \"\r\n    ++                \"%d messages (%d MiB) were dropped during the last hour.\\n\"\r\n    ++                \"%s\",\r\n    ++                source_location.first, source_location.second, logging_function, quota_usage.m_messages_dropped,\r\n    ++                quota_usage.m_bytes_dropped / (1024 * 1024), str));\r\n    ++            --m_rate_limited_locations;\r\n    ++        }\r\n    ++\r\n    ++        // Dont skip the reset logs.\r\n    ++        dont_skip = quota_exceeded_before || quota_still_exceeded;\r\n    ++\r\n    ++        // Logging to disk is only re-enabled if the number of dropped bytes did not exceed the limit.\r\n    ++        if (!quota_still_exceeded) quota_usage.m_bytes_logged = 0;\r\n    ++        quota_usage.m_messages_dropped = 0;\r\n    ++        quota_usage.m_bytes_dropped = 0;\r\n    ++        quota_usage.m_last_reset = now;\r\n    ++    }\r\n    ++\r\n    ++    if (!quota_exceeded_before) quota_usage.m_bytes_logged += str.size();\r\n    ++\r\n    ++    bool quota_exceeded_after = quota_usage.m_bytes_logged > HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION;\r\n    ++    if (!quota_exceeded_after) {\r\n    ++        // The limits were not exceeded and the message should not be dropped.\r\n    ++        return false;\r\n    ++    }\r\n    ++\r\n    ++    if (!quota_exceeded_before) {\r\n    ++        str = LogTimestampStr(strprintf(\r\n    ++            \"Excessive logging detected from %s:%d (%s): \"\r\n    ++            \">%d MiB logged during the last hour. \"\r\n    ++            \"Suppressing logging to disk from this source location for up to one hour. \"\r\n    ++            \"Console logging unaffected. Last log entry: %s\",\r\n    ++            source_location.first, source_location.second, logging_function,\r\n    ++            HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION / (1024 * 1024), str));\r\n    ++        ++m_rate_limited_locations;\r\n    ++    } else if (!dont_skip) {\r\n    ++        // The log message should be dropped.\r\n    ++        quota_usage.m_messages_dropped++;\r\n    ++        quota_usage.m_bytes_dropped += str.size();\r\n    ++        return true;\r\n    ++    }\r\n    ++\r\n    ++    return false;\r\n    ++}\r\n    ++\r\n     +void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const SourceLocation& source_location, const bool skip_disk_usage_rate_limiting)\r\n      {\r\n          StdLockGuard scoped_lock(m_cs);\r\n    @@ src/logging.cpp: void BCLog::Logger::LogPrintStr(const std::string& str, const s\r\n      \r\n     +    // Rate limit logging to disk to avoid disk filling attacks.\r\n     +    bool skip_writing_to_disk_due_to_rate_limiting{false};\r\n    -+    if (!skip_disk_usage_rate_limiting && m_rate_limiting) {\r\n    -+        const std::chrono::seconds now = GetTime<std::chrono::seconds>();\r\n    -+        QuotaUsage& quota_usage = m_quota_usage_per_source_location[source_location];\r\n    -+        // Is the quota exceeded before this log call?\r\n    -+        bool quota_exceeded_before = quota_usage.m_bytes_logged > HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION;\r\n    -+\r\n    -+        bool dont_skip = false;\r\n    -+        // Every hour the quota usage for a source location is reset.\r\n    -+        if ((now - quota_usage.m_last_reset) > std::chrono::hours{1}) {\r\n    -+            // Should logging to disk continue to be disabled?\r\n    -+            bool quota_still_exceeded = quota_usage.m_bytes_dropped > HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION;\r\n    -+\r\n    -+            if (quota_still_exceeded) {\r\n    -+                str_prefixed = LogTimestampStr(strprintf(\"Not restarting logging from %s:%d (%s): because %d messages (%d MiB) were dropped during the last hour which still exceeds the limit of %d MiB.\\n\", source_location.first, source_location.second, logging_function, quota_usage.m_messages_dropped, quota_usage.m_bytes_dropped / (1024 * 1024), HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION / (1024 * 1024)));\r\n    -+            } else if (quota_exceeded_before) {\r\n    -+                str_prefixed = LogTimestampStr(strprintf(\"Restarting logging from %s:%d (%s): %d messages (%d MiB) were dropped during the last hour.\\n\", source_location.first, source_location.second, logging_function, quota_usage.m_messages_dropped, quota_usage.m_bytes_dropped / (1024 * 1024)));\r\n    -+            }\r\n    -+\r\n    -+            // Dont skip the reset logs.\r\n    -+            dont_skip = quota_exceeded_before || quota_still_exceeded;\r\n    -+\r\n    -+            // Logging to disk is only re-enabled if the number of dropped bytes did not exceed the limit.\r\n    -+            if (!quota_still_exceeded) quota_usage.m_bytes_logged = 0;\r\n    -+            quota_usage.m_messages_dropped = 0;\r\n    -+            quota_usage.m_bytes_dropped = 0;\r\n    -+            quota_usage.m_last_reset = now;\r\n    -+        }\r\n    ++    if (!skip_disk_usage_rate_limiting) {\r\n    ++        skip_writing_to_disk_due_to_rate_limiting = RateLimit(str_prefixed, logging_function, source_location);\r\n    ++    }\r\n     +\r\n    -+        if (!quota_exceeded_before) quota_usage.m_bytes_logged += str_prefixed.size();\r\n    -+\r\n    -+        bool quota_exceeded_after = quota_usage.m_bytes_logged > HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION;\r\n    -+        if (quota_exceeded_after) {\r\n    -+            if (!quota_exceeded_before) {\r\n    -+                str_prefixed = LogTimestampStr(strprintf(\"Excessive logging detected from %s:%d (%s): >%d MiB logged during the last hour. Suppressing logging to disk from this source location for up to one hour. Console logging unaffected. Last log entry: %s\", source_location.first, source_location.second, logging_function, HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION / (1024 * 1024), str_prefixed));\r\n    -+            } else if (!dont_skip) {\r\n    -+                skip_writing_to_disk_due_to_rate_limiting = !dont_skip;\r\n    -+                quota_usage.m_messages_dropped++;\r\n    -+                quota_usage.m_bytes_dropped += str_prefixed.size();\r\n    -+            }\r\n    -+        }\r\n    ++    if (m_rate_limited_locations > 0) {\r\n    ++        str_prefixed.insert(0, \"[*] \");\r\n     +    }\r\n     +\r\n          m_started_new_line = !str.empty() && str[str.size()-1] == '\\n';\r\n    @@ src/logging.h: namespace BCLog {\r\n              std::list<std::string> m_msgs_before_open GUARDED_BY(m_cs);\r\n              bool m_buffering GUARDED_BY(m_cs) = true; //!< Buffer messages before logging can be started.\r\n     +        std::unordered_map<SourceLocation, QuotaUsage, SourceLocationHasher> m_quota_usage_per_source_location GUARDED_BY(m_cs);\r\n    ++        std::atomic_int m_rate_limited_locations;\r\n      \r\n              /**\r\n               * m_started_new_line is a state variable that will suppress printing of\r\n    @@ src/logging.h: namespace BCLog {\r\n              fs::path m_file_path;\r\n              std::atomic<bool> m_reopen_file{false};\r\n      \r\n    ++        /** Evaluate if a log message should not be printed to disk.\r\n    ++         *\r\n    ++         * @param[in,out] The log message.\r\n    ++         *                The rate limiting logic message may change the message\r\n    ++         *                to signal the start or end of a supression period.\r\n    ++         * @param[in]     The function from which the log message originated.\r\n    ++         * @param[in]     The source location from which the log message originated.\r\n    ++         */\r\n    ++        bool RateLimit(std::string& str, const std::string& logging_function, const SourceLocation& source_location) EXCLUSIVE_LOCKS_REQUIRED(m_cs);\r\n    ++\r\n              /** Send a string to the log output */\r\n     -        void LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line);\r\n     +        void LogPrintStr(const std::string& str, const std::string& logging_function, const SourceLocation& source_location, const bool skip_disk_usage_rate_limiting);\r\n2:  855d05e43 = 2:  5b46965aa test: Add logging test for rate limiting\r\n```\r\n</details>\r\n\r\nI also decided to move forward with the approach in this PR and will close #21706. See the updated PR description for reasoning.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-863494151",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4906862169,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDkwNjg2MjE2OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4906862169",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-17T22:30:15Z"
    },
    {
      "event": "commented",
      "id": 864401970,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NDQwMTk3MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864401970",
      "actor": {
        "login": "Thoragh",
        "id": 12678227,
        "node_id": "MDQ6VXNlcjEyNjc4MjI3",
        "avatar_url": "https://avatars.githubusercontent.com/u/12678227?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Thoragh",
        "html_url": "https://github.com/Thoragh",
        "followers_url": "https://api.github.com/users/Thoragh/followers",
        "following_url": "https://api.github.com/users/Thoragh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Thoragh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Thoragh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Thoragh/subscriptions",
        "organizations_url": "https://api.github.com/users/Thoragh/orgs",
        "repos_url": "https://api.github.com/users/Thoragh/repos",
        "events_url": "https://api.github.com/users/Thoragh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Thoragh/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-19T12:48:29Z",
      "updated_at": "2021-06-19T12:48:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nMaybe it would be good to set m_last_reset to the current time when it start limiting so it takes 1 hour until the next reset?",
      "user": {
        "login": "Thoragh",
        "id": 12678227,
        "node_id": "MDQ6VXNlcjEyNjc4MjI3",
        "avatar_url": "https://avatars.githubusercontent.com/u/12678227?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Thoragh",
        "html_url": "https://github.com/Thoragh",
        "followers_url": "https://api.github.com/users/Thoragh/followers",
        "following_url": "https://api.github.com/users/Thoragh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Thoragh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Thoragh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Thoragh/subscriptions",
        "organizations_url": "https://api.github.com/users/Thoragh/orgs",
        "repos_url": "https://api.github.com/users/Thoragh/repos",
        "events_url": "https://api.github.com/users/Thoragh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Thoragh/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-864401970",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 864608309,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NDYwODMwOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864608309",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-20T20:33:57Z",
      "updated_at": "2021-06-20T20:33:57Z",
      "author_association": "MEMBER",
      "body": "> Maybe it would be good to set m_last_reset to the current time when it start limiting so it takes 1 hour until the next reset?\r\n\r\n@Thoragh Thanks for the suggestion, Im gonna test that out. It might make sense to do but it does make the approach a bit more conservative because a source location might have to wait longer before it can log again (at least 1hour). ",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-864608309",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 4913761426,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDkxMzc2MTQyNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4913761426",
      "actor": {
        "login": "Thoragh",
        "id": 12678227,
        "node_id": "MDQ6VXNlcjEyNjc4MjI3",
        "avatar_url": "https://avatars.githubusercontent.com/u/12678227?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Thoragh",
        "html_url": "https://github.com/Thoragh",
        "followers_url": "https://api.github.com/users/Thoragh/followers",
        "following_url": "https://api.github.com/users/Thoragh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Thoragh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Thoragh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Thoragh/subscriptions",
        "organizations_url": "https://api.github.com/users/Thoragh/orgs",
        "repos_url": "https://api.github.com/users/Thoragh/repos",
        "events_url": "https://api.github.com/users/Thoragh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Thoragh/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-20T20:33:58Z"
    },
    {
      "event": "subscribed",
      "id": 4913761428,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5MTM3NjE0Mjg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4913761428",
      "actor": {
        "login": "Thoragh",
        "id": 12678227,
        "node_id": "MDQ6VXNlcjEyNjc4MjI3",
        "avatar_url": "https://avatars.githubusercontent.com/u/12678227?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Thoragh",
        "html_url": "https://github.com/Thoragh",
        "followers_url": "https://api.github.com/users/Thoragh/followers",
        "following_url": "https://api.github.com/users/Thoragh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Thoragh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Thoragh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Thoragh/subscriptions",
        "organizations_url": "https://api.github.com/users/Thoragh/orgs",
        "repos_url": "https://api.github.com/users/Thoragh/repos",
        "events_url": "https://api.github.com/users/Thoragh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Thoragh/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-20T20:33:58Z"
    },
    {
      "event": "reviewed",
      "id": 688980292,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njg4OTgwMjky",
      "url": null,
      "actor": null,
      "commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-688980292",
      "submitted_at": "2021-06-22T06:35:24Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "reviewed",
      "id": 689639316,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njg5NjM5MzE2",
      "url": null,
      "actor": null,
      "commit_id": "01ba3285d40ca70e14e7b8664f98135c55b280a6",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "Thoragh",
        "id": 12678227,
        "node_id": "MDQ6VXNlcjEyNjc4MjI3",
        "avatar_url": "https://avatars.githubusercontent.com/u/12678227?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Thoragh",
        "html_url": "https://github.com/Thoragh",
        "followers_url": "https://api.github.com/users/Thoragh/followers",
        "following_url": "https://api.github.com/users/Thoragh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Thoragh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Thoragh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Thoragh/subscriptions",
        "organizations_url": "https://api.github.com/users/Thoragh/orgs",
        "repos_url": "https://api.github.com/users/Thoragh/repos",
        "events_url": "https://api.github.com/users/Thoragh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Thoragh/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-689639316",
      "submitted_at": "2021-06-22T15:08:18Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4935302695,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDkzNTMwMjY5NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4935302695",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-24T15:23:19Z"
    },
    {
      "event": "commented",
      "id": 867736556,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NzczNjU1Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/867736556",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-24T15:34:56Z",
      "updated_at": "2021-06-24T15:34:56Z",
      "author_association": "MEMBER",
      "body": "[`log_ratelimiting.2`](https://github.com/dergoegge/bitcoin/tree/log_ratelimiting.2) -> [`log_ratelimiting.3`](https://github.com/dergoegge/bitcoin/tree/log_ratelimiting.3)\r\n\r\n<details>\r\n<summary>git range-diff log_ratelimiting.2...log_ratelimiting.3</summary>\r\n\r\n```c++\r\n1:  01ba3285d ! 1:  2cab018d9 log: Mitigate disk filling attacks by rate limiting LogPrintf\r\n    @@ src/init/common.cpp: void AddLoggingArgs(ArgsManager& argsman)\r\n          argsman.AddArg(\"-logtimemicros\", strprintf(\"Add microsecond precision to debug timestamps (default: %u)\", DEFAULT_LOGTIMEMICROS), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\r\n          argsman.AddArg(\"-printtoconsole\", \"Send trace/debug info to console (default: 1 when no -daemon. To disable logging to file, set -nodebuglogfile)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\r\n          argsman.AddArg(\"-shrinkdebugfile\", \"Shrink debug.log file on client startup (default: 1 when no -debug)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\r\n    -+    argsman.AddArg(\"-logratelimiting\", strprintf(\"Rate limit debug logging to disk (default: %u)\", DEFAULT_LOGRATELIMITING), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n    ++    argsman.AddArg(\"-logratelimiting\", strprintf(\"Rate limit debug logging to disk (default: %u)\", DEFAULT_LOGRATELIMITING), ArgsManager::ALLOW_BOOL, OptionsCategory::OPTIONS);\r\n      }\r\n      \r\n      void SetLoggingOptions(const ArgsManager& args)\r\n    @@ src/logging.cpp: namespace BCLog {\r\n     +            str = LogTimestampStr(strprintf(\r\n     +                \"Not restarting logging from %s:%d (%s): \"\r\n     +                \"because %d messages (%d MiB) were dropped during the last hour which still exceeds the limit of %d MiB.\\n\",\r\n    -+                source_location.first, source_location.second, logging_function, quota_usage.m_messages_dropped,\r\n    ++                source_location.m_file, source_location.m_line, logging_function, quota_usage.m_messages_dropped,\r\n     +                quota_usage.m_bytes_dropped / (1024 * 1024), HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION / (1024 * 1024)));\r\n     +        } else if (quota_exceeded_before) {\r\n     +            str = LogTimestampStr(strprintf(\r\n     +                \"Restarting logging from %s:%d (%s): \"\r\n     +                \"%d messages (%d MiB) were dropped during the last hour.\\n\"\r\n     +                \"%s\",\r\n    -+                source_location.first, source_location.second, logging_function, quota_usage.m_messages_dropped,\r\n    ++                source_location.m_file, source_location.m_line, logging_function, quota_usage.m_messages_dropped,\r\n     +                quota_usage.m_bytes_dropped / (1024 * 1024), str));\r\n     +            --m_rate_limited_locations;\r\n     +        }\r\n    @@ src/logging.cpp: namespace BCLog {\r\n     +            \">%d MiB logged during the last hour. \"\r\n     +            \"Suppressing logging to disk from this source location for up to one hour. \"\r\n     +            \"Console logging unaffected. Last log entry: %s\",\r\n    -+            source_location.first, source_location.second, logging_function,\r\n    ++            source_location.m_file, source_location.m_line, logging_function,\r\n     +            HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION / (1024 * 1024), str));\r\n     +        ++m_rate_limited_locations;\r\n     +    } else if (!dont_skip) {\r\n    @@ src/logging.cpp: namespace BCLog {\r\n      \r\n          if (m_log_sourcelocations && m_started_new_line) {\r\n     -        str_prefixed.insert(0, \"[\" + RemovePrefix(source_file, \"./\") + \":\" + ToString(source_line) + \"] [\" + logging_function + \"] \");\r\n    -+        str_prefixed.insert(0, \"[\" + RemovePrefix(source_location.first, \"./\") + \":\" + ToString(source_location.second) + \"] [\" + logging_function + \"] \");\r\n    ++        str_prefixed.insert(0, \"[\" + RemovePrefix(source_location.m_file, \"./\") + \":\" + ToString(source_location.m_line) + \"] [\" + logging_function + \"] \");\r\n          }\r\n      \r\n          if (m_log_threadnames && m_started_new_line) {\r\n    @@ src/logging.cpp: void BCLog::Logger::LogPrintStr(const std::string& str, const s\r\n          str_prefixed = LogTimestampStr(str_prefixed);\r\n      \r\n     +    // Rate limit logging to disk to avoid disk filling attacks.\r\n    -+    bool skip_writing_to_disk_due_to_rate_limiting{false};\r\n    -+    if (!skip_disk_usage_rate_limiting) {\r\n    -+        skip_writing_to_disk_due_to_rate_limiting = RateLimit(str_prefixed, logging_function, source_location);\r\n    -+    }\r\n    ++    bool log_quota_exceeded = !skip_disk_usage_rate_limiting &&\r\n    ++                              RateLimit(str_prefixed, logging_function, source_location);\r\n     +\r\n    ++    // To avoid confusion caused by dropped log messages when debugging an issue, we prefix log lines with \"[*]\"\r\n    ++    // when there are any supressed source locations.\r\n     +    if (m_rate_limited_locations > 0) {\r\n     +        str_prefixed.insert(0, \"[*] \");\r\n     +    }\r\n    @@ src/logging.cpp: void BCLog::Logger::LogPrintStr(const std::string& str, const s\r\n              cb(str_prefixed);\r\n          }\r\n     -    if (m_print_to_file) {\r\n    -+    if (m_print_to_file && !skip_writing_to_disk_due_to_rate_limiting) {\r\n    ++    if (m_print_to_file && !log_quota_exceeded) {\r\n              assert(m_fileout != nullptr);\r\n      \r\n              // reopen the log file, if requested\r\n    @@ src/logging.h: struct LogCategory {\r\n      };\r\n      \r\n     +// Replace with std::source_location when switching to C++20.\r\n    -+using SourceLocation = std::pair<const char*, int>;\r\n    ++struct SourceLocation {\r\n    ++    const char* m_file{nullptr};\r\n    ++    int m_line{0};\r\n    ++\r\n    ++    bool operator==(const SourceLocation& other) const\r\n    ++    {\r\n    ++        return m_file && other.m_file &&\r\n    ++               std::strcmp(m_file, other.m_file) == 0 &&\r\n    ++               m_line == other.m_line;\r\n    ++    }\r\n    ++};\r\n    ++\r\n     +struct SourceLocationHasher {\r\n     +    size_t operator()(const SourceLocation& source_location) const noexcept\r\n     +    {\r\n     +        // Use CSipHasher(0, 0) as a simple way to get uniform distribution.\r\n    -+        return static_cast<size_t>(CSipHasher(0, 0).Write(std::hash<const char*>{}(source_location.first)).Write(std::hash<int>{}(source_location.second)).Finalize());\r\n    ++        return static_cast<size_t>(CSipHasher(0, 0).Write(std::hash<const char*>{}(source_location.m_file)).Write(std::hash<int>{}(source_location.m_line)).Finalize());\r\n     +    }\r\n     +};\r\n     +\r\n    @@ src/logging.h: namespace BCLog {\r\n              std::list<std::string> m_msgs_before_open GUARDED_BY(m_cs);\r\n              bool m_buffering GUARDED_BY(m_cs) = true; //!< Buffer messages before logging can be started.\r\n     +        std::unordered_map<SourceLocation, QuotaUsage, SourceLocationHasher> m_quota_usage_per_source_location GUARDED_BY(m_cs);\r\n    -+        std::atomic_int m_rate_limited_locations;\r\n    ++        int m_rate_limited_locations GUARDED_BY(m_cs) = 0;\r\n      \r\n              /**\r\n               * m_started_new_line is a state variable that will suppress printing of\r\n    @@ src/logging.h: namespace BCLog {\r\n      \r\n     +        /** Evaluate if a log message should not be printed to disk.\r\n     +         *\r\n    -+         * @param[in,out] str                 The log message.\r\n    -+         *                                    The rate limiting logic message may change the message\r\n    -+         *                                    to signal the start or end of a supression period.\r\n    -+         * @param[in]     logging_function    The function name from which the log message originated.\r\n    -+         * @param[in]     source_location     The source location from which the log message originated.\r\n    ++         * @param[in,out] str              The log message.\r\n    ++         *                                 The rate limiting logic message may change the message\r\n    ++         *                                 to signal the start or end of a supression period.\r\n    ++         * @param[in]     logging_function The function name from which the log message originated.\r\n    ++         * @param[in]     source_location  The source location from which the log message originated.\r\n    ++         *\r\n    ++         * @return true if the message should not be printed to disk, false otherwise.\r\n     +         */\r\n     +        bool RateLimit(std::string& str, const std::string& logging_function, const SourceLocation& source_location) EXCLUSIVE_LOCKS_REQUIRED(m_cs);\r\n     +\r\n    @@ src/logging.h: static inline void LogPrintf_(const std::string& logging_function\r\n              }\r\n     -        LogInstance().LogPrintStr(log_msg, logging_function, source_file, source_line);\r\n     +\r\n    -+        const SourceLocation source_location = std::make_pair(source_file, source_line);\r\n    ++        const SourceLocation source_location{source_file, source_line};\r\n     +        LogInstance().LogPrintStr(log_msg, logging_function, source_location, skip_disk_usage_rate_limiting);\r\n          }\r\n      }\r\n2:  a2916ae50 ! 2:  e51bd0bdc test: Add logging test for rate limiting\r\n    @@ src/test/logging_tests.cpp: BOOST_AUTO_TEST_CASE(logging_timer)\r\n          BOOST_CHECK_EQUAL(micro_timer.LogMsg(\"test micros\"), \"tests: test micros (1000000.00μs)\");\r\n      }\r\n      \r\n    -+void GetLogFileSize(size_t& size)\r\n    ++size_t GetLogFileSize()\r\n     +{\r\n     +    boost::system::error_code ec;\r\n    -+    size = fs::file_size(LogInstance().m_file_path, ec);\r\n    ++    size_t size = fs::file_size(LogInstance().m_file_path, ec);\r\n     +    if (ec) LogPrintf(\"%s: %s %s\\n\", __func__, ec.message(), LogInstance().m_file_path);\r\n     +    BOOST_CHECK(!ec);\r\n    ++    return size;\r\n     +}\r\n     +\r\n     +void LogFromFixedLocation(const std::string& str)\r\n    @@ src/test/logging_tests.cpp: BOOST_AUTO_TEST_CASE(logging_timer)\r\n     +    bool prev_log_threadnames = LogInstance().m_log_threadnames;\r\n     +    LogInstance().m_log_threadnames = false;\r\n     +\r\n    ++    // Log 1024-character lines (1023 plus newline) to make the math simple.\r\n     +    std::string log_message(1023, 'a');\r\n     +\r\n     +    SetMockTime(std::chrono::seconds{1});\r\n     +\r\n     +    size_t prev_log_file_size, curr_log_file_size;\r\n    -+    GetLogFileSize(prev_log_file_size);\r\n    ++    prev_log_file_size = GetLogFileSize();\r\n     +\r\n     +    // Log 1 MiB, this should be allowed.\r\n     +    for (int i = 0; i < 1024; ++i) {\r\n     +        LogFromFixedLocation(log_message);\r\n     +    }\r\n    -+    GetLogFileSize(curr_log_file_size);\r\n    ++    curr_log_file_size = GetLogFileSize();\r\n     +    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 1024 * 1024);\r\n     +\r\n     +    LogFromFixedLocation(\"This should trigger rate limiting\");\r\n    -+    GetLogFileSize(prev_log_file_size);\r\n    ++    prev_log_file_size = GetLogFileSize();\r\n     +\r\n     +    // Log 0.5 MiB, this should not be allowed and all messages should be dropped.\r\n     +    for (int i = 0; i < 512; ++i) {\r\n     +        LogFromFixedLocation(log_message);\r\n     +    }\r\n    -+    GetLogFileSize(curr_log_file_size);\r\n    ++    curr_log_file_size = GetLogFileSize();\r\n     +    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 0);\r\n     +\r\n     +    // Let one hour pass.\r\n     +    SetMockTime(std::chrono::seconds{60 * 60 + 1});\r\n     +    LogFromFixedLocation(\"This should trigger the quota usage reset\");\r\n    -+    GetLogFileSize(prev_log_file_size);\r\n    ++    prev_log_file_size = GetLogFileSize();\r\n     +\r\n     +    // Log 1 MiB, this should be allowed since the usage was reset.\r\n     +    for (int i = 0; i < 1024; ++i) {\r\n     +        LogFromFixedLocation(log_message);\r\n     +    }\r\n    -+    GetLogFileSize(curr_log_file_size);\r\n    ++    curr_log_file_size = GetLogFileSize();\r\n     +    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 1024 * 1024);\r\n     +\r\n     +    LogFromFixedLocation(\"This should trigger rate limiting\");\r\n    -+    GetLogFileSize(prev_log_file_size);\r\n    ++    prev_log_file_size = GetLogFileSize();\r\n     +\r\n     +    // Log 1 MiB, this should not be allowed and all messages should be dropped.\r\n     +    for (int i = 0; i < 1024; ++i) {\r\n     +        LogFromFixedLocation(log_message);\r\n     +    }\r\n    -+    GetLogFileSize(curr_log_file_size);\r\n    ++    curr_log_file_size = GetLogFileSize();\r\n     +    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 0);\r\n     +\r\n     +    LogFromFixedLocation(\"This should also be dropped and bring the total of dropped bytes above 1 MiB.\");\r\n    -+    GetLogFileSize(curr_log_file_size);\r\n    ++    curr_log_file_size = GetLogFileSize();\r\n     +    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 0);\r\n     +\r\n     +    // Let another hour pass\r\n     +    SetMockTime(std::chrono::seconds{2 * (60 * 60 + 1)});\r\n     +    LogFromFixedLocation(\"Normally this would reset the usage but it does not because we dropped more than 1 MiB in the previous hour.\");\r\n    -+    GetLogFileSize(prev_log_file_size);\r\n    ++    prev_log_file_size = GetLogFileSize();\r\n     +\r\n     +    // Log 1 MiB, this should not be allowed and all messages should be dropped.\r\n     +    for (int i = 0; i < 1024; ++i) {\r\n     +        LogFromFixedLocation(log_message);\r\n     +    }\r\n    -+    GetLogFileSize(curr_log_file_size);\r\n    ++    curr_log_file_size = GetLogFileSize();\r\n     +    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 0);\r\n     +\r\n     +    // Let another hour pass\r\n     +    SetMockTime(std::chrono::seconds{3 * (60 * 60 + 1)});\r\n     +    LogFromFixedLocation(\"This should trigger the quota usage reset\");\r\n    -+    GetLogFileSize(prev_log_file_size);\r\n    ++    prev_log_file_size = GetLogFileSize();\r\n     +\r\n     +    // Log 1 MiB, this should be allowed since the usage was reset.\r\n     +    for (int i = 0; i < 1024; ++i) {\r\n     +        LogFromFixedLocation(log_message);\r\n     +    }\r\n    -+    GetLogFileSize(curr_log_file_size);\r\n    ++    curr_log_file_size = GetLogFileSize();\r\n     +    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 1024 * 1024);\r\n     +\r\n     +    LogInstance().m_log_timestamps = prev_log_timestamps;\r\n\r\n```\r\n\r\n</details>",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-867736556",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 869226443,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2OTIyNjQ0Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/869226443",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-27T21:31:37Z",
      "updated_at": "2021-06-27T21:31:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "Reviewers, please take a look at this alternate approach: https://github.com/bitcoin/bitcoin/pull/22350.",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-869226443",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 880079584,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg4MDA3OTU4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880079584",
      "actor": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-14T17:33:09Z",
      "updated_at": "2021-07-14T17:33:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "fwiw prefer the more traditional log rotation approach in #22350; i find it cognitively easier to think in terms of stale logs rather than source suppression.",
      "user": {
        "login": "narula",
        "id": 177646,
        "node_id": "MDQ6VXNlcjE3NzY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/177646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/narula",
        "html_url": "https://github.com/narula",
        "followers_url": "https://api.github.com/users/narula/followers",
        "following_url": "https://api.github.com/users/narula/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/narula/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/narula/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/narula/subscriptions",
        "organizations_url": "https://api.github.com/users/narula/orgs",
        "repos_url": "https://api.github.com/users/narula/repos",
        "events_url": "https://api.github.com/users/narula/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/narula/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-880079584",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "labeled",
      "id": 5352469465,
      "node_id": "LE_lADOABII584yrzZYzwAAAAE_CDPZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5352469465",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-23T21:11:49Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 934552951,
      "node_id": "IC_kwDOABII5843tCV3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/934552951",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-05T16:11:37Z",
      "updated_at": "2021-10-05T16:11:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "@dergoegge Would you mind rebasing? I would like to re-review it after rebase :)\r\n\r\nFWIW I prefer this solution to the more complex log rotation approach taken in #22350. I find the simpler approach taken in this PR much easier to reason about. This PR solves the issue at hand in the simplest possible way IMO.",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-934552951",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 5411889884,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAFCkuLc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5411889884",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-05T16:11:38Z"
    },
    {
      "event": "subscribed",
      "id": 5411889890,
      "node_id": "SE_lADOABII584yrzZYzwAAAAFCkuLi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5411889890",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-05T16:11:38Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5412721898,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAFCn5Tq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5412721898",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-05T18:42:47Z"
    },
    {
      "event": "commented",
      "id": 934677093,
      "node_id": "IC_kwDOABII5843tgpl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/934677093",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-05T18:49:06Z",
      "updated_at": "2021-10-05T18:49:06Z",
      "author_association": "MEMBER",
      "body": "@practicalswift Thanks for the nudge! :)\r\n\r\nRebased on latest master.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-934677093",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 5412756686,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAFCoBzO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5412756686",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-05T18:49:06Z"
    },
    {
      "event": "subscribed",
      "id": 5412756695,
      "node_id": "SE_lADOABII584yrzZYzwAAAAFCoBzX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5412756695",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-05T18:49:06Z"
    },
    {
      "event": "unlabeled",
      "id": 5412924829,
      "node_id": "UNLE_lADOABII584yrzZYzwAAAAFCoq2d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5412924829",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-05T19:20:41Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6092275492,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAFrIL8k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6092275492",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-17T17:56:12Z"
    },
    {
      "event": "commented",
      "id": 1043248338,
      "node_id": "IC_kwDOABII584-LrTS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1043248338",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-17T17:59:56Z",
      "updated_at": "2022-02-17T17:59:56Z",
      "author_association": "MEMBER",
      "body": "In an attempt to make this more reviewable, i split the changes into multiple commits.\r\n\r\n@practicalswift pinging you, since you were previously interested in reviewing",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1043248338",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 6092297734,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAFrIRYG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6092297734",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-17T17:59:56Z"
    },
    {
      "event": "subscribed",
      "id": 6092297742,
      "node_id": "SE_lADOABII584yrzZYzwAAAAFrIRYO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6092297742",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-17T17:59:56Z"
    },
    {
      "event": "reviewed",
      "id": 892204452,
      "node_id": "PRR_kwDOABII5841LfWk",
      "url": null,
      "actor": null,
      "commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-892204452",
      "submitted_at": "2022-02-24T12:03:24Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6225638627,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAFzE7Tj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6225638627",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T15:27:28Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6226578341,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAFzIgul",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6226578341",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T17:57:51Z"
    },
    {
      "event": "labeled",
      "id": 6396942477,
      "node_id": "LE_lADOABII584yrzZYzwAAAAF9SZiN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6396942477",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-08T14:34:46Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6433437071,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAF_dnWP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6433437071",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-14T10:09:37Z"
    },
    {
      "event": "unlabeled",
      "id": 6433638799,
      "node_id": "UNLE_lADOABII584yrzZYzwAAAAF_eYmP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6433638799",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-14T10:46:00Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 942522620,
      "node_id": "PRR_kwDOABII5844LcD8",
      "url": null,
      "actor": null,
      "commit_id": "f1cc42c04e9d73d235dc4a010dc85e828969112f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-942522620",
      "submitted_at": "2022-04-14T17:54:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "reviewed",
      "id": 942608550,
      "node_id": "PRR_kwDOABII5844LxCm",
      "url": null,
      "actor": null,
      "commit_id": "f1cc42c04e9d73d235dc4a010dc85e828969112f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK \r\n\r\nRe: source-based vs global rate-limiting or rotation: from what I understand, the disk-filling attack we're trying to prevent is an attacker figuring out some unconditional logging they can trigger over and over again, so a source-based rate-limiting approach seems to be the correct solution. I assume there aren't other attacks we're looking to prevent?",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-942608550",
      "submitted_at": "2022-04-14T17:58:24Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6439508271,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAF_0xkv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6439508271",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T09:02:10Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6439578753,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAF_1CyB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6439578753",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T09:19:50Z"
    },
    {
      "event": "commented",
      "id": 1099993254,
      "node_id": "IC_kwDOABII585BkJCm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099993254",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T09:26:08Z",
      "updated_at": "2022-04-15T09:26:08Z",
      "author_association": "MEMBER",
      "body": "Thanks for the review @mzumsande @glozow!\r\n\r\n> [...] the disk-filling attack we're trying to prevent is an attacker figuring out some unconditional logging they can trigger over and over again [...]\r\n> I assume there aren't other attacks we're looking to prevent?\r\n\r\nNone that I can think of, this PR is aimed at exactly what you described.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1099993254",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 6439603803,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAF_1I5b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6439603803",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T09:26:08Z"
    },
    {
      "event": "subscribed",
      "id": 6439603806,
      "node_id": "SE_lADOABII584yrzZYzwAAAAF_1I5e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6439603806",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T09:26:08Z"
    },
    {
      "event": "mentioned",
      "id": 6439603811,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAF_1I5j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6439603811",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T09:26:08Z"
    },
    {
      "event": "subscribed",
      "id": 6439603812,
      "node_id": "SE_lADOABII584yrzZYzwAAAAF_1I5k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6439603812",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T09:26:08Z"
    },
    {
      "event": "reviewed",
      "id": 982117359,
      "node_id": "PRR_kwDOABII5846ievv",
      "url": null,
      "actor": null,
      "commit_id": "092e023d832ca2f63e274c3eb0528602209aa5cc",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-982117359",
      "submitted_at": "2022-05-23T17:44:37Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "labeled",
      "id": 6671250613,
      "node_id": "LE_lADOABII584yrzZYzwAAAAGNozS1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6671250613",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-24T17:50:50Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6676636237,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAGN9WJN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6676636237",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-25T10:40:29Z"
    },
    {
      "event": "unlabeled",
      "id": 6677387333,
      "node_id": "UNLE_lADOABII584yrzZYzwAAAAGOANhF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6677387333",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-25T12:36:14Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 987737220,
      "node_id": "PRR_kwDOABII584636yE",
      "url": null,
      "actor": null,
      "commit_id": "9d84cb2cd20d7951682ca8415488ed96a5f2cf1c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-987737220",
      "submitted_at": "2022-05-27T17:15:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6701892047,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAGPdsHP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6701892047",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-30T10:34:24Z"
    },
    {
      "event": "commented",
      "id": 1141024541,
      "node_id": "IC_kwDOABII585EAqcd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1141024541",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-30T11:11:10Z",
      "updated_at": "2022-05-30T11:11:10Z",
      "author_association": "MEMBER",
      "body": "utACK a6377c5fe4f8d8fabbae527df888afdd9c6f771a",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1141024541",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1141037105,
      "node_id": "IC_kwDOABII585EAtgx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1141037105",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-30T11:24:05Z",
      "updated_at": "2022-05-30T11:24:05Z",
      "author_association": "MEMBER",
      "body": ">     * Only `LogPrintf(…)` is rate limited. `LogPrint(category, …)` (`-debug`) is not rate limited.\r\n\r\nIt looks like many of the LogPrintf messages will be going away with the update to severity-based logging and the added complexity here may be worth reevaluating (and potentially avoiding) after that.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1141037105",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "reviewed",
      "id": 989195045,
      "node_id": "PRR_kwDOABII58469esl",
      "url": null,
      "actor": null,
      "commit_id": "a6377c5fe4f8d8fabbae527df888afdd9c6f771a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "left some nits (feel free to ignore for now)",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#pullrequestreview-989195045",
      "submitted_at": "2022-05-30T11:33:29Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNhMDk0MmI5MmQwMTkwZjU2ZmE5MzljNGEwY2UzZTgyYWY4ODJhZDI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ca0942b92d0190f56fa939c4a0ce3e82af882ad2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ca0942b92d0190f56fa939c4a0ce3e82af882ad2",
      "tree": {
        "sha": "4bee67129e8a5fe9da46aad1e18e2bdc503d5d9f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4bee67129e8a5fe9da46aad1e18e2bdc503d5d9f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8c721fff3a007db613b22464b40fe7cd6b1ead80",
          "sha": "8c721fff3a007db613b22464b40fe7cd6b1ead80",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8c721fff3a007db613b22464b40fe7cd6b1ead80"
        }
      ],
      "message": "[log] Introduce log rate limiter class\n\nThe LogRatelimiter class implements a fixed window rate limiter. The\nrate limiter allows a fixed amount of bytes to be consumed within a\nfixed time window.",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2021-12-29T20:15:53Z"
      },
      "sha": "ca0942b92d0190f56fa939c4a0ce3e82af882ad2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDUyOGRlYzgzMjNhYjkyYzBlNDBiMjA4ZDQyNmQyMDY2Yjg3YWQ2OGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/528dec8323ab92c0e40b208d426d2066b87ad68d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/528dec8323ab92c0e40b208d426d2066b87ad68d",
      "tree": {
        "sha": "86ce82ee582cf1853c1081ab62db1f8e21e9ac95",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/86ce82ee582cf1853c1081ab62db1f8e21e9ac95"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ca0942b92d0190f56fa939c4a0ce3e82af882ad2",
          "sha": "ca0942b92d0190f56fa939c4a0ce3e82af882ad2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ca0942b92d0190f56fa939c4a0ce3e82af882ad2"
        }
      ],
      "message": "[log] Introduce source location type\n\nThe SourceLocation type stores the filename and line of a source code\nlocation.\nIn a later commit we use this type as the key type in an unordered map\nand set to keep track of rate limters for each location.",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2021-12-29T20:19:26Z"
      },
      "sha": "528dec8323ab92c0e40b208d426d2066b87ad68d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFkZTM0YWRhNTdjMDliNTg4MjhjYWI1NWJmZjliMTFhYjM1ZjEwYjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ade34ada57c09b58828cab55bff9b11ab35f10b2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ade34ada57c09b58828cab55bff9b11ab35f10b2",
      "tree": {
        "sha": "6fe94fd8da6315d64bac94dd733c799c89734e03",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6fe94fd8da6315d64bac94dd733c799c89734e03"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/528dec8323ab92c0e40b208d426d2066b87ad68d",
          "sha": "528dec8323ab92c0e40b208d426d2066b87ad68d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/528dec8323ab92c0e40b208d426d2066b87ad68d"
        }
      ],
      "message": "[config] Add -ratelimitlogging config option\n\nThe -ratelimitlogging can be used to enable/disable the rate limiting to\ndisk. Rate limiting is enabled by default.",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-01-02T22:35:52Z"
      },
      "sha": "ade34ada57c09b58828cab55bff9b11ab35f10b2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ1YTA4NmJmNThjYmJlNGM0MjQ2ZjU1MWFjMWQzZjUwZDE1MTBlZTY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/45a086bf58cbbe4c4246f551ac1d3f50d1510ee6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/45a086bf58cbbe4c4246f551ac1d3f50d1510ee6",
      "tree": {
        "sha": "4cf129be00bb369ca8cb824e6cc495f0290a9432",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4cf129be00bb369ca8cb824e6cc495f0290a9432"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ade34ada57c09b58828cab55bff9b11ab35f10b2",
          "sha": "ade34ada57c09b58828cab55bff9b11ab35f10b2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ade34ada57c09b58828cab55bff9b11ab35f10b2"
        }
      ],
      "message": "[log] Add two new categories for unconditional logging\n\nWe create two new categories `UNCONDITIONAL_ALWAYS` and\n`UNCONDITIONAL_RATE_LIMITED` that are always enabled by default.\n\nLogPrintf now logs using the `UNCONDITIONAL_RATE_LIMITED` category which\nwill start to apply rate limiting in a later commit.\n\nFor some log locations it might be safe to allow more frequent logging\nwithout rate limiting. These locations should use the\n`UNCONDITIONAL_ALWAYS` category.",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-03-11T13:45:25Z"
      },
      "sha": "45a086bf58cbbe4c4246f551ac1d3f50d1510ee6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk1Y2JiNDBhODZiOTFiNDI1YmMxN2M5OTEwMjkwYzdmZjE2ZDYwNmQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/95cbb40a86b91b425bc17c9910290c7ff16d606d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/95cbb40a86b91b425bc17c9910290c7ff16d606d",
      "tree": {
        "sha": "4b9ea914ac838f017d4ce7e8e834926870f6bb6e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4b9ea914ac838f017d4ce7e8e834926870f6bb6e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/45a086bf58cbbe4c4246f551ac1d3f50d1510ee6",
          "sha": "45a086bf58cbbe4c4246f551ac1d3f50d1510ee6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/45a086bf58cbbe4c4246f551ac1d3f50d1510ee6"
        }
      ],
      "message": "[validation] Exempt UpdateTipLog from rate limiting\n\nUpdateTipLog logs everytime a new tip is activated. This occurs at an\nincreased frequency during IBD and should therefore be exempt from rate\nlimiting.",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-01-02T23:01:57Z"
      },
      "sha": "95cbb40a86b91b425bc17c9910290c7ff16d606d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk1OTc4YTE2NjMxZGQ3YjdjYjNlYzk1M2Y5NGMwNTA0MGE4YzA4MGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/95978a16631dd7b7cb3ec953f94c05040a8c080d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/95978a16631dd7b7cb3ec953f94c05040a8c080d",
      "tree": {
        "sha": "171e25c6c6a0e877994524671a3bc695617cb00e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/171e25c6c6a0e877994524671a3bc695617cb00e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/95cbb40a86b91b425bc17c9910290c7ff16d606d",
          "sha": "95cbb40a86b91b425bc17c9910290c7ff16d606d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/95cbb40a86b91b425bc17c9910290c7ff16d606d"
        }
      ],
      "message": "[log] Add rate limiting to LogPrintf\n\nTo mitigate disk filling attacks caused by unsafe usages of LogPrintf,\nwe rate limit LogPrintf by using the fixed window rate limiter\n(BCLog::LogRatelimiter) introduced in an earlier commit.\n\nThe rate limiting logic is applied per source location instead of\nglobally. A source location is allowed to log up to 1 MiB per hour.\nSource locations that violate the limit will have their logs supressed\nfor up to one hour.",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-01-02T11:35:15Z"
      },
      "sha": "95978a16631dd7b7cb3ec953f94c05040a8c080d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDAyYWQxMmM3MTljOTQ1NGIxM2UxNTIyOGU2ODlmNGI2Yzc4NzY0NDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/02ad12c719c9454b13e15228e689f4b6c7876447",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/02ad12c719c9454b13e15228e689f4b6c7876447",
      "tree": {
        "sha": "f50aad3133ff6725a6da9e095c3588fdf836c0d7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f50aad3133ff6725a6da9e095c3588fdf836c0d7"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/95978a16631dd7b7cb3ec953f94c05040a8c080d",
          "sha": "95978a16631dd7b7cb3ec953f94c05040a8c080d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/95978a16631dd7b7cb3ec953f94c05040a8c080d"
        }
      ],
      "message": "[test util] Mark ~DebugLogHelper as noexcept(false)\n\nWe mark ~DebugLogHelper as noexcept(false) to be able to catch the\nexception it throws. This lets us use it in test in combination with\nBOOST_CHECK_THROW and BOOST_CHECK_NO_THROW to check that certain log\nmessages are (not) logged.",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-01-01T11:38:59Z"
      },
      "sha": "02ad12c719c9454b13e15228e689f4b6c7876447"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI3MDIwMjU5N2E0ODYzOTczZjZmMzU0NGM0ZDhhOTdkMThkZTQxMWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/270202597a4863973f6f3544c4d8a97d18de411c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/270202597a4863973f6f3544c4d8a97d18de411c",
      "tree": {
        "sha": "7beebe090d2bc7debe6bc55196acbd2d24ed1420",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7beebe090d2bc7debe6bc55196acbd2d24ed1420"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/02ad12c719c9454b13e15228e689f4b6c7876447",
          "sha": "02ad12c719c9454b13e15228e689f4b6c7876447",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/02ad12c719c9454b13e15228e689f4b6c7876447"
        }
      ],
      "message": "[test] Check for expected log rate limiting messages",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-01-04T22:48:11Z"
      },
      "sha": "270202597a4863973f6f3544c4d8a97d18de411c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc5ZjcwOTFmZWY5YmYxZTYxZTM0YWZkMWNiZWI5OTQwOTQyNjM4ZmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/79f7091fef9bf1e61e34afd1cbeb9940942638fb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/79f7091fef9bf1e61e34afd1cbeb9940942638fb",
      "tree": {
        "sha": "c8e6bda6b4e595967d6a064b412c82d157e9d94e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c8e6bda6b4e595967d6a064b412c82d157e9d94e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/270202597a4863973f6f3544c4d8a97d18de411c",
          "sha": "270202597a4863973f6f3544c4d8a97d18de411c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/270202597a4863973f6f3544c4d8a97d18de411c"
        }
      ],
      "message": "[test] Test for expected file size changes when rate limiting is enabled",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-01-04T22:50:30Z"
      },
      "sha": "79f7091fef9bf1e61e34afd1cbeb9940942638fb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGI5MjYxYThiYmU1NDUwZTdiMWRjNzg4ZTE4OTIzMzlmYzYzMDE0Yzg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b9261a8bbe5450e7b1dc788e1892339fc63014c8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b9261a8bbe5450e7b1dc788e1892339fc63014c8",
      "tree": {
        "sha": "595a851ca42f207b4ae76336fd471f47e331b5f0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/595a851ca42f207b4ae76336fd471f47e331b5f0"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/79f7091fef9bf1e61e34afd1cbeb9940942638fb",
          "sha": "79f7091fef9bf1e61e34afd1cbeb9940942638fb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/79f7091fef9bf1e61e34afd1cbeb9940942638fb"
        }
      ],
      "message": "[test] Check that log rate limiting is disabled for exempt source locations",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-01-04T23:18:18Z"
      },
      "sha": "b9261a8bbe5450e7b1dc788e1892339fc63014c8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM4NmQ1ZmYwMmEzMTMyMjYxMjU1NWRiNTU5ZTFkOTdlZjMyOWUyN2Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c86d5ff02a31322612555db559e1d97ef329e27f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c86d5ff02a31322612555db559e1d97ef329e27f",
      "tree": {
        "sha": "018cb8057bc8486e2ade4dea4264e962bb19e92f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/018cb8057bc8486e2ade4dea4264e962bb19e92f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b9261a8bbe5450e7b1dc788e1892339fc63014c8",
          "sha": "b9261a8bbe5450e7b1dc788e1892339fc63014c8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b9261a8bbe5450e7b1dc788e1892339fc63014c8"
        }
      ],
      "message": "[test] Check that rate limiting can be disabled",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-05-30T13:17:11Z"
      },
      "author": {
        "name": "Niklas Gögge",
        "email": "n.goeggi@gmail.com",
        "date": "2022-01-04T23:37:17Z"
      },
      "sha": "c86d5ff02a31322612555db559e1d97ef329e27f"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6703272814,
      "node_id": "HRFPE_lADOABII584yrzZYzwAAAAGPi9Nu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6703272814",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-30T13:50:45Z"
    },
    {
      "event": "commented",
      "id": 1141207648,
      "node_id": "IC_kwDOABII585EBXJg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1141207648",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-30T14:13:25Z",
      "updated_at": "2022-05-30T14:13:25Z",
      "author_association": "MEMBER",
      "body": "> It looks like many of the LogPrintf messages will be going away with the update to severity-based logging and the added complexity here may be worth reevaluating (and potentially avoiding) after that.\r\n\r\n@jonatack IMO removing some of the `LogPrintf` locations (or assigning them a severity level which is not logged by default) does not really address the issue at its root like this PR is trying to do. Any remaining default logging could still cause issues as well as any logging that is introduced in the future.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1141207648",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 6703438446,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAGPjlpu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6703438446",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-30T14:13:25Z"
    },
    {
      "event": "subscribed",
      "id": 6703438454,
      "node_id": "SE_lADOABII584yrzZYzwAAAAGPjlp2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6703438454",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-30T14:13:25Z"
    },
    {
      "event": "commented",
      "id": 1141216700,
      "node_id": "IC_kwDOABII585EBZW8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1141216700",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-30T14:21:42Z",
      "updated_at": "2022-05-30T14:26:03Z",
      "author_association": "MEMBER",
      "body": "What I am working on is that no logging on by default would be externally provokable (and potentially removing LogPrintf). That along with reducing default logging in general has appeared to be the desired direction for some time now AFAICS. Of course, this could still be merged in the interim and then removed if no longer needed, but I'm targeting the next release.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1141216700",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1141231549,
      "node_id": "IC_kwDOABII585EBc-9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1141231549",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-30T14:36:56Z",
      "updated_at": "2022-05-30T14:36:56Z",
      "author_association": "MEMBER",
      "body": "reACK c86d5ff02a31322612555db559e1d97ef329e27f",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1141231549",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1142288592,
      "node_id": "IC_kwDOABII585EFfDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1142288592",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-31T15:29:46Z",
      "updated_at": "2022-05-31T15:29:46Z",
      "author_association": "MEMBER",
      "body": "> What I am working on is that no logging on by default would be externally provokable (and potentially removing LogPrintf). That along with reducing default logging in general has appeared to be the desired direction for some time now AFAICS. Of course, this could still be merged in the interim and then removed if no longer needed, but I'm targeting the next release.\r\n\r\nWith https://github.com/bitcoin/bitcoin/pull/25202/commits/bd971bffb02c7b06aac9a479f7e5ed8f71de2bec, category-based logging with a severity `>= BCLog::Level::Warning` is equivalent to `LogPrintf` from the viewpoint of disk filling attacks.\r\nI think that it would be really good to have this general countermeasure in place, especially with probable future PRs that convert more existing log messages to the new format, because we'll now have to be careful about not adding category-based warnings or errors that could be triggered externally. The old rule, which is no longer valid but probably still in many contributors' heads was that one only needs to be careful about `LogPrintf`, while category-base logging is not so critical.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1142288592",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1142381498,
      "node_id": "IC_kwDOABII585EF1u6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1142381498",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-31T16:51:32Z",
      "updated_at": "2022-05-31T17:00:43Z",
      "author_association": "MEMBER",
      "body": "> convert more existing log messages to the new format, because we'll now have to be careful about not adding category-based warnings or errors that could be triggered externally\n\nYes, doing precisely this right now for all of them. Though, assuming people are in favor of that, maybe reviewers might prefer extending this rate limiting to non-default logging or otherwise it can always still be removed.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1142381498",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1142392438,
      "node_id": "IC_kwDOABII585EF4Z2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1142392438",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-31T17:04:05Z",
      "updated_at": "2022-05-31T17:04:05Z",
      "author_association": "MEMBER",
      "body": "Is it possible to convert *all* of them? I think currently we don't have a way to express a log category but unconditional log severity. Unless you want to use `Warning`/`Error` for \"unconditional\".",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1142392438",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1142396140,
      "node_id": "IC_kwDOABII585EF5Ts",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1142396140",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-31T17:08:03Z",
      "updated_at": "2022-06-06T14:07:44Z",
      "author_association": "MEMBER",
      "body": "@MarcoFalke added that in #25203.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1142396140",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 6711464387,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAGQCNHD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6711464387",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-31T17:08:03Z"
    },
    {
      "event": "subscribed",
      "id": 6711464396,
      "node_id": "SE_lADOABII584yrzZYzwAAAAGQCNHM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6711464396",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-31T17:08:03Z"
    },
    {
      "event": "commented",
      "id": 1142522007,
      "node_id": "IC_kwDOABII585EGYCX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1142522007",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-31T18:43:50Z",
      "updated_at": "2022-05-31T18:43:50Z",
      "author_association": "MEMBER",
      "body": "> Though, assuming people are in favor of that, maybe reviewers might prefer extending this rate limiting to non-default logging.\r\n\r\nGood point, I think that this would definitely be useful (here or as a follow-up) - having a rate limit only for `LogPrintf` but not for unconditionally logged category-based warnings and errors would be confusing.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1142522007",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1142528802,
      "node_id": "IC_kwDOABII585EGZsi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1142528802",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-31T18:52:22Z",
      "updated_at": "2022-06-06T14:15:38Z",
      "author_association": "MEMBER",
      "body": "> Good point, I think that this would definitely be useful (here or as a follow-up) - having a rate limit only for `LogPrintf` but not for unconditionally logged category-based warnings and errors would be confusing.\r\n\r\nI agree; though as an example just updated the (copious) net processing logging in #25203 and there are a only a few remaining unconditional messages (user-controlled or unusual):\r\n```\r\nsrc/net_processing.cpp:2305:                LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"Large reorg, won't direct fetch to %s (%d)\\n\",\r\nsrc/net_processing.cpp:2702:            LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"Connected to self at %s, disconnecting\\n\", pfrom.addr.ToString());\r\nsrc/net_processing.cpp:3425:                    LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"Not relaying non-mempool transaction %s from forcerelay peer=%d\\n\", tx.GetHash().ToString(), pfrom.GetId());\r\nsrc/net_processing.cpp:4190:        LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"Not punishing misbehaving peer %d because it has noban permission set!\\n\", peer.m_id);\r\nsrc/net_processing.cpp:4196:        LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"Not punishing misbehaving peer %d because it was manually connected!\\n\", peer.m_id);\r\nsrc/net_processing.cpp:4873:                        LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"Announcing block %s not on main chain (tip=%s)\\n\",\r\n```\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1142528802",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1147399881,
      "node_id": "IC_kwDOABII585EY-7J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1147399881",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T12:35:54Z",
      "updated_at": "2022-06-06T12:35:54Z",
      "author_association": "MEMBER",
      "body": "> having a rate limit only for LogPrintf but not for unconditionally logged category-based warnings and errors would be confusing.\r\n\r\nAlso agree with this and i want to add that to this PR.\r\n\r\nThe two new categories I introduce here (`UNCONDITIONAL_ALWAYS` and `UNCONDITIONAL_RATE_LIMITED`) don't really make sense anymore, given that we now also have category based unconditional logging. Whether a log location should be rate limited could purely be based on the severity level.\r\nI was thinking of the following: Adding an extra severity `Always` which is logged unconditionally without rate limiting (e.g. for [this](https://github.com/bitcoin/bitcoin/blob/1b2e1d179c5b350cac69ee670e01355314f25e11/src/validation.cpp#L2517) location) and rate limiting logging to disk if `severity == None || (severity >= Warning && severity < Always)`. Additionally, categories specified by `-debug=cat` should still be logged unconditionally without rate limiting.  @mzumsande @jonatack @MarcoFalke what do y'all think of that?",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1147399881",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 6752676763,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAGSfaub",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6752676763",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T12:35:59Z"
    },
    {
      "event": "subscribed",
      "id": 6752676777,
      "node_id": "SE_lADOABII584yrzZYzwAAAAGSfaup",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6752676777",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T12:35:59Z"
    },
    {
      "event": "mentioned",
      "id": 6752676792,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAGSfau4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6752676792",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T12:35:59Z"
    },
    {
      "event": "subscribed",
      "id": 6752676801,
      "node_id": "SE_lADOABII584yrzZYzwAAAAGSfavB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6752676801",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T12:35:59Z"
    },
    {
      "event": "mentioned",
      "id": 6752676821,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAGSfavV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6752676821",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T12:35:59Z"
    },
    {
      "event": "subscribed",
      "id": 6752676829,
      "node_id": "SE_lADOABII584yrzZYzwAAAAGSfavd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6752676829",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-06T12:35:59Z"
    },
    {
      "event": "commented",
      "id": 1155035833,
      "node_id": "IC_kwDOABII585E2HK5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1155035833",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-14T11:03:34Z",
      "updated_at": "2022-06-14T11:03:34Z",
      "author_association": "MEMBER",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1155035833",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "labeled",
      "id": 6803316871,
      "node_id": "LE_lADOABII584yrzZYzwAAAAGVgmCH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6803316871",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-14T11:03:34Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1163223549,
      "node_id": "IC_kwDOABII585FVWH9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1163223549",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:01:31Z",
      "updated_at": "2022-06-22T15:13:11Z",
      "author_association": "MEMBER",
      "body": "> I was thinking of the following: Adding an extra severity `Always` which is logged unconditionally without rate limiting (e.g. for [this](https://github.com/bitcoin/bitcoin/blob/1b2e1d179c5b350cac69ee670e01355314f25e11/src/validation.cpp#L2517) location) and rate limiting logging to disk if `severity == None || (severity >= Warning && severity < Always)`. Additionally, categories specified by `-debug=cat` should still be logged unconditionally without rate limiting. @mzumsande @jonatack @MarcoFalke what do y'all think of that?\r\n\r\nSo, it seems to me that with the recent changes, we currently have \r\n1) Unconditional logging with no level and no category (`LogPrintf`)\r\n2) Conditional logging with category but no level (`LogPrint`) - not relevant to this PR\r\n3) Unconditional logging with category but no level (`LogPrintfCategory`)\r\n4) Logging with category and level, which may be unconditional depending on the level (`LogPrintLevel`)\r\n\r\nThe \"missing\" combination of logging by level but without a category is currently not possible as far as I can see.\r\n\r\nIf there would be a use case for having \"Always\" logged messages also to have a severity like \"Warning\" or \"Error\" we'd need another dimension -  but I think that at least for the current uses this is not the case, so your suggestion makes sense to me.\r\n\r\nHowever, I'm really not sure how stable the current state of the changes to the logging framework is, it seems very much in flow and I'm a little bit confused about what direction it is heading:\r\n- The severity threshold mentioned in 4) was added in #25202, but after reading [this comment](https://github.com/bitcoin/bitcoin/pull/25306#issuecomment-1150250132) by @laanwj I'm not sure it will stay.\r\n- Is the final goal for each logging message to have both a category and a level so that 1) and 2)  and 3) would vanish over time? That would probably reduce the complexity of the rate-limiting considerably.\r\n\r\n",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1163223549",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "mentioned",
      "id": 6857251646,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAGYuVs-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6857251646",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:01:31Z"
    },
    {
      "event": "subscribed",
      "id": 6857251654,
      "node_id": "SE_lADOABII584yrzZYzwAAAAGYuVtG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6857251654",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:01:31Z"
    },
    {
      "event": "mentioned",
      "id": 6857251667,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAGYuVtT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6857251667",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:01:31Z"
    },
    {
      "event": "subscribed",
      "id": 6857251674,
      "node_id": "SE_lADOABII584yrzZYzwAAAAGYuVta",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6857251674",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:01:31Z"
    },
    {
      "event": "mentioned",
      "id": 6857251683,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAGYuVtj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6857251683",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:01:32Z"
    },
    {
      "event": "subscribed",
      "id": 6857251688,
      "node_id": "SE_lADOABII584yrzZYzwAAAAGYuVto",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6857251688",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:01:32Z"
    },
    {
      "event": "mentioned",
      "id": 6857367195,
      "node_id": "MEE_lADOABII584yrzZYzwAAAAGYux6b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6857367195",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:13:12Z"
    },
    {
      "event": "subscribed",
      "id": 6857367210,
      "node_id": "SE_lADOABII584yrzZYzwAAAAGYux6q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6857367210",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:13:12Z"
    },
    {
      "event": "commented",
      "id": 1163269607,
      "node_id": "IC_kwDOABII585FVhXn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1163269607",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T15:34:03Z",
      "updated_at": "2022-06-22T15:34:03Z",
      "author_association": "MEMBER",
      "body": "If there is a log category with `Info`, which is also the default level, you wouldn't need an `Always` level?",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1163269607",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1163816359,
      "node_id": "IC_kwDOABII585FXm2n",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1163816359",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-23T01:11:40Z",
      "updated_at": "2022-06-23T01:11:40Z",
      "author_association": "MEMBER",
      "body": "> If there is a log category with `Info`, which is also the default level, you wouldn't need an `Always` level?\r\n\r\nI don't see how - the \"Always\" level is meant for noisy unconditional logs that can hit the rate limit, but are so important that they should be exempt from it - basically only `UpdateTipLog` during IBD.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1163816359",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1164723719,
      "node_id": "IC_kwDOABII585FbEYH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1164723719",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-23T18:14:37Z",
      "updated_at": "2022-06-23T18:15:54Z",
      "author_association": "MEMBER",
      "body": "I'm about to push an update to #25203 to incorporate https://github.com/bitcoin/bitcoin/pull/25287 and the changes discussed in #25306, and the current approach is that the `None` severity level is only used internally, i.e. in src/logging.{h.cpp}, and moved to the end of the enum to permit iterating through it similar to GetNetworkNames() / `NET_MAX`.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1164723719",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1164727482,
      "node_id": "IC_kwDOABII585FbFS6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1164727482",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-23T18:18:16Z",
      "updated_at": "2022-06-23T18:20:31Z",
      "author_association": "MEMBER",
      "body": "The logging you might be worried about limiting would be, with the current direction, IIRC:\r\n\r\n- LogPrintf\r\n- LogPrintfWithCategory\r\n- LogPrintLevel with level Info/Warning/Error (these levels are planned to be logged unconditionally, while Debug and Trace would not)\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1164727482",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "commented",
      "id": 1271405533,
      "node_id": "IC_kwDOABII585LyBvd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1271405533",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-07T10:18:05Z",
      "updated_at": "2022-10-07T10:18:05Z",
      "author_association": "MEMBER",
      "body": "Haven't had the time to maintain this. I still think some general mitigation for disk-filling would be nice, so I might pick this up again later unless someone else beats me to it. Closing for now.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#issuecomment-1271405533",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21603"
    },
    {
      "event": "closed",
      "id": 7542352721,
      "node_id": "CE_lADOABII584yrzZYzwAAAAHBjytR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7542352721",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-07T10:18:05Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/608211735",
      "pull_request_review_id": 629448028,
      "id": 608211735,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwODIxMTczNQ==",
      "diff_hunk": "@@ -33,4 +32,109 @@ BOOST_AUTO_TEST_CASE(logging_timer)\n     SetMockTime(0);\n }\n \n+void GetLogFileSize(size_t& size)\n+{\n+    boost::system::error_code ec;\n+    size = fs::file_size(LogInstance().m_file_path, ec);\n+    if (ec) LogPrintf(\"%s: %s %s\\n\", __func__, ec.message(), LogInstance().m_file_path);\n+    BOOST_CHECK(!ec);\n+}\n+\n+template <typename... Args>\n+void LogFromFixedLocation(const char* fmt, const Args&... args)\n+{\n+    LogPrintf(fmt, args...);",
      "path": "src/test/logging_tests.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "fa114ff2d4b098891569d4f1d67c1e46850cbd5e",
      "in_reply_to_id": null,
      "user": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "this line is tripping up the linter:\r\n```\r\nsrc/test/logging_tests.cpp: Expected 0 argument(s) after format string but found 1 argument(s): LogPrintf(fmt, args...)\r\n```",
      "created_at": "2021-04-06T22:08:27Z",
      "updated_at": "2021-04-16T15:19:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r608211735",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/608211735"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613296430",
      "pull_request_review_id": 635686766,
      "id": 613296430,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMzI5NjQzMA==",
      "diff_hunk": "@@ -33,4 +32,108 @@ BOOST_AUTO_TEST_CASE(logging_timer)\n     SetMockTime(0);\n }\n \n+void GetLogFileSize(size_t& size)\n+{\n+    boost::system::error_code ec;\n+    size = fs::file_size(LogInstance().m_file_path, ec);\n+    if (ec) LogPrintf(\"%s: %s %s\\n\", __func__, ec.message(), LogInstance().m_file_path);\n+    BOOST_CHECK(!ec);\n+}\n+\n+void LogFromFixedLocation(const std::string& str)\n+{\n+    LogPrintf(\"%s\\n\", str);\n+}\n+\n+BOOST_AUTO_TEST_CASE(rate_limiting)\n+{\n+    // This allows us to check for exact size differences in the log file.\n+    bool prev_log_timestamps = LogInstance().m_log_sourcelocations;\n+    LogInstance().m_log_timestamps = false;\n+    bool prev_log_sourcelocations = LogInstance().m_log_sourcelocations;\n+    LogInstance().m_log_sourcelocations = false;\n+    bool prev_log_threadnames = LogInstance().m_log_threadnames;\n+    LogInstance().m_log_threadnames = false;\n+\n+    // A string containing 1023 bytes.\n+    std::string s1023(1023, 'a');\n+\n+    SetMockTime(std::chrono::seconds{1});\n+\n+    size_t prev_log_file_size, curr_log_file_size;\n+    GetLogFileSize(prev_log_file_size);\n+\n+    // Log 1 MiB, this should be allowed.\n+    for (int i = 0; i < 1024; ++i) {\n+        LogFromFixedLocation(s1023);\n+    }\n+    GetLogFileSize(curr_log_file_size);\n+    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 1024 * 1024);\n+\n+    LogFromFixedLocation(\"This should trigger rate limiting\");\n+    GetLogFileSize(prev_log_file_size);\n+\n+    // Log 0.5 MiB, this should not be allowed and all messages should be dropped.\n+    for (int i = 0; i < 512; ++i) {\n+        LogFromFixedLocation(s1023);\n+    }\n+    GetLogFileSize(curr_log_file_size);\n+    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 0);\n+\n+    // Let one hour pass.\n+    SetMockTime(std::chrono::seconds{60 * 60 + 1});\n+    LogFromFixedLocation(\"This should trigger the quota usage reset\");\n+    GetLogFileSize(prev_log_file_size);\n+\n+    // Log 1 MiB, this should be allowed since the usage was reset.\n+    for (int i = 0; i < 1024; ++i) {\n+        LogFromFixedLocation(s1023);\n+    }\n+    GetLogFileSize(curr_log_file_size);\n+    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 1024 * 1024);\n+\n+    LogFromFixedLocation(\"This should trigger rate limiting\");\n+    GetLogFileSize(prev_log_file_size);\n+\n+    // Log 1 MiB, this should not be allowed and all messages should be dropped.\n+    for (int i = 0; i < 1024; ++i) {\n+        LogFromFixedLocation(s1023);\n+    }\n+    GetLogFileSize(curr_log_file_size);\n+    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 0);\n+\n+    LogFromFixedLocation(\"This should also be dropped and bring the total of dropped bytes above 1 MiB.\");\n+    GetLogFileSize(curr_log_file_size);\n+    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 0);\n+\n+    // Let another hour pass\n+    SetMockTime(std::chrono::seconds{2 * (60 * 60 + 1)});\n+    LogFromFixedLocation(\"Normally this would reset the usage but it does not because we dropped more than 1 MiB in the previous hour.\");\n+    GetLogFileSize(prev_log_file_size);\n+\n+    // Log 1 MiB, this should not be allowed and all messages should be dropped.\n+    for (int i = 0; i < 1024; ++i) {\n+        LogFromFixedLocation(s1023);\n+    }\n+    GetLogFileSize(curr_log_file_size);\n+    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 0);\n+\n+    // Let another hour pass\n+    SetMockTime(std::chrono::seconds{3 * (60 * 60 + 1)});\n+    LogFromFixedLocation(\"This should trigger the quota usage reset\");\n+    GetLogFileSize(prev_log_file_size);\n+\n+    // Log 1 MiB, this should be allowed since the usage was reset.\n+    for (int i = 0; i < 1024; ++i) {\n+        LogFromFixedLocation(s1023);\n+    }\n+    GetLogFileSize(curr_log_file_size);\n+    BOOST_CHECK(curr_log_file_size - prev_log_file_size == 1024 * 1024);",
      "path": "src/test/logging_tests.cpp",
      "position": null,
      "original_position": 108,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "1653167de64b15df306158d0d2e9bef9c8bea79e",
      "in_reply_to_id": null,
      "user": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Both windows CI builds are failing on this line. See [cirrus](https://cirrus-ci.com/task/6258137339527168?logs=ci#L642).",
      "created_at": "2021-04-14T14:26:09Z",
      "updated_at": "2021-04-16T15:19:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r613296430",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613296430"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 138,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655806917",
      "pull_request_review_id": 688980292,
      "id": 655806917,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTgwNjkxNw==",
      "diff_hunk": "@@ -76,6 +76,7 @@ void AddLoggingArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-logtimemicros\", strprintf(\"Add microsecond precision to debug timestamps (default: %u)\", DEFAULT_LOGTIMEMICROS), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-printtoconsole\", \"Send trace/debug info to console (default: 1 when no -daemon. To disable logging to file, set -nodebuglogfile)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-shrinkdebugfile\", \"Shrink debug.log file on client startup (default: 1 when no -debug)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n+    argsman.AddArg(\"-logratelimiting\", strprintf(\"Rate limit debug logging to disk (default: %u)\", DEFAULT_LOGRATELIMITING), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);",
      "path": "src/init/common.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    argsman.AddArg(\"-logratelimiting\", strprintf(\"Rate limit debug logging to disk (default: %u)\", DEFAULT_LOGRATELIMITING), ArgsManager::ALLOW_BOOL, OptionsCategory::OPTIONS);\r\n```\r\nOptional change; most of the other boolean arguments do specify `ALLOW_ANY`, I don't know why. But since `ALLOW_BOOL` exists, may as well use it -- if nothing else, it documents that the argument is a flag rather than some kind of rate threshold (integer value).",
      "created_at": "2021-06-22T01:17:13Z",
      "updated_at": "2021-06-22T06:35:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655806917",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655806917"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655865672",
      "pull_request_review_id": 688980292,
      "id": 655865672,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTg2NTY3Mg==",
      "diff_hunk": "@@ -30,4 +30,115 @@ BOOST_AUTO_TEST_CASE(logging_timer)\n     BOOST_CHECK_EQUAL(micro_timer.LogMsg(\"test micros\"), \"tests: test micros (1000000.00μs)\");\n }\n \n+void GetLogFileSize(size_t& size)\n+{\n+    boost::system::error_code ec;\n+    size = fs::file_size(LogInstance().m_file_path, ec);\n+    if (ec) LogPrintf(\"%s: %s %s\\n\", __func__, ec.message(), LogInstance().m_file_path);\n+    BOOST_CHECK(!ec);\n+}\n+\n+void LogFromFixedLocation(const std::string& str)\n+{\n+    LogPrintf(\"%s\\n\", str);\n+}\n+\n+BOOST_AUTO_TEST_CASE(rate_limiting)\n+{\n+#if defined(_WIN32)\n+    // TODO\n+    // Since windows prints \\r\\n to file instead of \\n, the log file size\n+    // does not match up with the internal \"bytes logged\" count.\n+    // This test relies on matching file sizes with expected values.\n+    return;\n+#endif\n+\n+    // This allows us to check for exact size differences in the log file.\n+    bool prev_log_timestamps = LogInstance().m_log_sourcelocations;\n+    LogInstance().m_log_timestamps = false;\n+    bool prev_log_sourcelocations = LogInstance().m_log_sourcelocations;\n+    LogInstance().m_log_sourcelocations = false;\n+    bool prev_log_threadnames = LogInstance().m_log_threadnames;\n+    LogInstance().m_log_threadnames = false;\n+",
      "path": "src/test/logging_tests.cpp",
      "position": 92,
      "original_position": 34,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n\r\n    // Log 1024-character lines (1023 plus newline) to make the math simple.\r\n```",
      "created_at": "2021-06-22T04:25:14Z",
      "updated_at": "2021-06-22T06:35:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655865672",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655865672"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 219,
      "original_line": 219,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655885112",
      "pull_request_review_id": 688980292,
      "id": 655885112,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTg4NTExMg==",
      "diff_hunk": "@@ -30,4 +30,115 @@ BOOST_AUTO_TEST_CASE(logging_timer)\n     BOOST_CHECK_EQUAL(micro_timer.LogMsg(\"test micros\"), \"tests: test micros (1000000.00μs)\");\n }\n \n+void GetLogFileSize(size_t& size)",
      "path": "src/test/logging_tests.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\nsize_t GetLogFileSize()\r\n```",
      "created_at": "2021-06-22T05:24:44Z",
      "updated_at": "2021-06-22T06:35:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655885112",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655885112"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 33,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655888433",
      "pull_request_review_id": 688980292,
      "id": 655888433,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTg4ODQzMw==",
      "diff_hunk": "@@ -32,6 +38,23 @@ struct LogCategory {\n     bool active;\n };\n \n+// Replace with std::source_location when switching to C++20.\n+using SourceLocation = std::pair<const char*, int>;",
      "path": "src/logging.h",
      "position": null,
      "original_position": 35,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I would prefer `struct` here to `std::pair`. I think `pair` should be used in situations where two items are grouped together for some deep, fundamental reason, for example, a map key and its value. If you just happen to want to combine two things, but later it could be (say) three, then I think a `struct` is better. Also, it's easier to read, `location.file` and `location.line`.",
      "created_at": "2021-06-22T05:33:15Z",
      "updated_at": "2021-06-22T06:35:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655888433",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655888433"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655890465",
      "pull_request_review_id": 688980292,
      "id": 655890465,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTg5MDQ2NQ==",
      "diff_hunk": "@@ -70,6 +93,8 @@ namespace BCLog {\n         FILE* m_fileout GUARDED_BY(m_cs) = nullptr;\n         std::list<std::string> m_msgs_before_open GUARDED_BY(m_cs);\n         bool m_buffering GUARDED_BY(m_cs) = true; //!< Buffer messages before logging can be started.\n+        std::unordered_map<SourceLocation, QuotaUsage, SourceLocationHasher> m_quota_usage_per_source_location GUARDED_BY(m_cs);\n+        std::atomic_int m_rate_limited_locations;",
      "path": "src/logging.h",
      "position": null,
      "original_position": 59,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It seems like this doesn't need to be atomic.",
      "created_at": "2021-06-22T05:38:45Z",
      "updated_at": "2021-06-22T06:35:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655890465",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655890465"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 97,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655903333",
      "pull_request_review_id": 688980292,
      "id": 655903333,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTkwMzMzMw==",
      "diff_hunk": "@@ -254,6 +327,16 @@ void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& loggi\n \n     str_prefixed = LogTimestampStr(str_prefixed);\n \n+    // Rate limit logging to disk to avoid disk filling attacks.\n+    bool skip_writing_to_disk_due_to_rate_limiting{false};\n+    if (!skip_disk_usage_rate_limiting) {\n+        skip_writing_to_disk_due_to_rate_limiting = RateLimit(str_prefixed, logging_function, source_location);\n+    }\n+\n+    if (m_rate_limited_locations > 0) {\n+        str_prefixed.insert(0, \"[*] \");",
      "path": "src/logging.cpp",
      "position": 111,
      "original_position": 100,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What's this for? Maybe add a comment.",
      "created_at": "2021-06-22T06:08:36Z",
      "updated_at": "2021-06-22T06:35:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655903333",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655903333"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 413,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655906309",
      "pull_request_review_id": 688980292,
      "id": 655906309,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTkwNjMwOQ==",
      "diff_hunk": "@@ -239,13 +239,86 @@ namespace BCLog {\n     }\n }\n \n-void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line)\n+static constexpr uint64_t HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION{1024 * 1024};\n+",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Comment needed describing what this function does at a high level and documenting the return value.",
      "created_at": "2021-06-22T06:14:54Z",
      "updated_at": "2021-06-22T06:35:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655906309",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655906309"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 249,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655912029",
      "pull_request_review_id": 688980292,
      "id": 655912029,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTkxMjAyOQ==",
      "diff_hunk": "@@ -254,6 +327,16 @@ void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& loggi\n \n     str_prefixed = LogTimestampStr(str_prefixed);\n \n+    // Rate limit logging to disk to avoid disk filling attacks.\n+    bool skip_writing_to_disk_due_to_rate_limiting{false};\n+    if (!skip_disk_usage_rate_limiting) {\n+        skip_writing_to_disk_due_to_rate_limiting = RateLimit(str_prefixed, logging_function, source_location);\n+    }",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 97,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Consider moving this down to just before it's needed.",
      "created_at": "2021-06-22T06:26:45Z",
      "updated_at": "2021-06-22T06:35:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655912029",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655912029"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": 331,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 270,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655915216",
      "pull_request_review_id": 688980292,
      "id": 655915216,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTkxNTIxNg==",
      "diff_hunk": "@@ -270,7 +353,7 @@ void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& loggi\n     for (const auto& cb : m_print_callbacks) {\n         cb(str_prefixed);\n     }\n-    if (m_print_to_file) {\n+    if (m_print_to_file && !skip_writing_to_disk_due_to_rate_limiting) {",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 111,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm not sure it's worth creating this variable `skip_writing_to_disk_due_to_rate_limiting`, maybe:\r\n```\r\nif (m_print_to_file && (skip_disk_usage_rate_limiting || !RateLimit(str_prefixed, logging_function, source_location))) {\r\n```",
      "created_at": "2021-06-22T06:32:53Z",
      "updated_at": "2021-06-22T06:35:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655915216",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655915216"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 356,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655933116",
      "pull_request_review_id": 689130292,
      "id": 655933116,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTkzMzExNg==",
      "diff_hunk": "@@ -76,6 +76,7 @@ void AddLoggingArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-logtimemicros\", strprintf(\"Add microsecond precision to debug timestamps (default: %u)\", DEFAULT_LOGTIMEMICROS), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-printtoconsole\", \"Send trace/debug info to console (default: 1 when no -daemon. To disable logging to file, set -nodebuglogfile)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-shrinkdebugfile\", \"Shrink debug.log file on client startup (default: 1 when no -debug)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n+    argsman.AddArg(\"-logratelimiting\", strprintf(\"Rate limit debug logging to disk (default: %u)\", DEFAULT_LOGRATELIMITING), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);",
      "path": "src/init/common.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": 655806917,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point. I think the more specific ones were added later and the idea is to prefer using them for new code.",
      "created_at": "2021-06-22T07:04:12Z",
      "updated_at": "2021-06-22T07:04:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r655933116",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655933116"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/656316492",
      "pull_request_review_id": 689639316,
      "id": 656316492,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NjMxNjQ5Mg==",
      "diff_hunk": "@@ -239,13 +239,86 @@ namespace BCLog {\n     }\n }\n \n-void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line)\n+static constexpr uint64_t HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION{1024 * 1024};\n+\n+bool BCLog::Logger::RateLimit(std::string& str, const std::string& logging_function, const SourceLocation& source_location)\n+{\n+    if (!m_rate_limiting) {\n+        // Rate limiting is disabled.\n+        return false;\n+    }\n+\n+    const std::chrono::seconds now = GetTime<std::chrono::seconds>();\n+    QuotaUsage& quota_usage = m_quota_usage_per_source_location[source_location];\n+    // Is the quota exceeded before this log call?\n+    bool quota_exceeded_before = quota_usage.m_bytes_logged > HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION;\n+\n+    bool dont_skip = false;",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "01ba3285d40ca70e14e7b8664f98135c55b280a6",
      "in_reply_to_id": null,
      "user": {
        "login": "Thoragh",
        "id": 12678227,
        "node_id": "MDQ6VXNlcjEyNjc4MjI3",
        "avatar_url": "https://avatars.githubusercontent.com/u/12678227?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Thoragh",
        "html_url": "https://github.com/Thoragh",
        "followers_url": "https://api.github.com/users/Thoragh/followers",
        "following_url": "https://api.github.com/users/Thoragh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Thoragh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Thoragh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Thoragh/subscriptions",
        "organizations_url": "https://api.github.com/users/Thoragh/orgs",
        "repos_url": "https://api.github.com/users/Thoragh/repos",
        "events_url": "https://api.github.com/users/Thoragh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Thoragh/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If i understand the code correctly, `dont_skip` is used to make sure the hourly reset messages are printed.\r\nMaybe the code could be simplified by removing `dont_skip` and calling `LogPrintf` instead for the hourly messages?\r\n",
      "created_at": "2021-06-22T15:08:18Z",
      "updated_at": "2021-06-22T15:08:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r656316492",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/656316492"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/657510892",
      "pull_request_review_id": 691205788,
      "id": 657510892,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NzUxMDg5Mg==",
      "diff_hunk": "@@ -270,7 +353,7 @@ void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& loggi\n     for (const auto& cb : m_print_callbacks) {\n         cb(str_prefixed);\n     }\n-    if (m_print_to_file) {\n+    if (m_print_to_file && !skip_writing_to_disk_due_to_rate_limiting) {",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 111,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": 655915216,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "We want the rate limiting messages like \"restarting logging from...\" to also be printed to the console, so we have to call `RateLimit` before that and store the result. I am still gonna change the name of `skip_writing_to_disk_due_to_rate_limiting` because its a bit long.",
      "created_at": "2021-06-23T22:50:38Z",
      "updated_at": "2021-06-23T22:50:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r657510892",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/657510892"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 356,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/657518350",
      "pull_request_review_id": 691214683,
      "id": 657518350,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NzUxODM1MA==",
      "diff_hunk": "@@ -239,13 +239,86 @@ namespace BCLog {\n     }\n }\n \n-void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line)\n+static constexpr uint64_t HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION{1024 * 1024};\n+\n+bool BCLog::Logger::RateLimit(std::string& str, const std::string& logging_function, const SourceLocation& source_location)\n+{\n+    if (!m_rate_limiting) {\n+        // Rate limiting is disabled.\n+        return false;\n+    }\n+\n+    const std::chrono::seconds now = GetTime<std::chrono::seconds>();\n+    QuotaUsage& quota_usage = m_quota_usage_per_source_location[source_location];\n+    // Is the quota exceeded before this log call?\n+    bool quota_exceeded_before = quota_usage.m_bytes_logged > HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION;\n+\n+    bool dont_skip = false;",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "01ba3285d40ca70e14e7b8664f98135c55b280a6",
      "in_reply_to_id": 656316492,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That is correct!\r\nBut this does unfortunately not work because we hold a lock here https://github.com/bitcoin/bitcoin/blob/a2916ae5043436d3fd22acb44c5663227fa7eb90/src/logging.cpp#L317\r\n\r\nA recursive call to `LogPrintf` also feels a bit dangerous to me.",
      "created_at": "2021-06-23T23:10:42Z",
      "updated_at": "2021-06-23T23:10:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r657518350",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/657518350"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658061925",
      "pull_request_review_id": 691914652,
      "id": 658061925,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1ODA2MTkyNQ==",
      "diff_hunk": "@@ -239,13 +239,86 @@ namespace BCLog {\n     }\n }\n \n-void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line)\n+static constexpr uint64_t HOURLY_LOG_QUOTA_IN_BYTES_PER_SOURCE_LOCATION{1024 * 1024};\n+",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a2916ae5043436d3fd22acb44c5663227fa7eb90",
      "in_reply_to_id": 655906309,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "There is a comment in `src/logging.h`.",
      "created_at": "2021-06-24T15:36:50Z",
      "updated_at": "2021-06-24T15:36:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r658061925",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658061925"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 249,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813712733",
      "pull_request_review_id": 892204452,
      "id": 813712733,
      "node_id": "PRRC_kwDOABII584wgEVd",
      "diff_hunk": "@@ -66,6 +94,49 @@ namespace BCLog {\n         ALL         = ~(uint32_t)0,\n     };\n \n+    //! Fixed window rate limiter for logging.\n+    class LogRatelimiter",
      "path": "src/logging.h",
      "position": null,
      "original_position": 62,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Limit is a separate word, so perhaps:\r\n\r\n```suggestion\r\n    class LogRateLimiter\r\n```",
      "created_at": "2022-02-24T09:49:14Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813712733",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813712733"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813713028",
      "pull_request_review_id": 892204452,
      "id": 813713028,
      "node_id": "PRRC_kwDOABII584wgEaE",
      "diff_hunk": "@@ -66,6 +94,49 @@ namespace BCLog {\n         ALL         = ~(uint32_t)0,\n     };\n \n+    //! Fixed window rate limiter for logging.\n+    class LogRatelimiter\n+    {\n+    private:\n+        //! Timestamp of the last window reset.\n+        std::chrono::seconds m_last_reset;\n+        //! Interval after which the window is reset.\n+        std::chrono::seconds m_reset_interval;",
      "path": "src/logging.h",
      "position": null,
      "original_position": 68,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        const std::chrono::seconds m_reset_interval;\r\n```",
      "created_at": "2022-02-24T09:49:34Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813713028",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813713028"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 104,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813714442",
      "pull_request_review_id": 892204452,
      "id": 813714442,
      "node_id": "PRRC_kwDOABII584wgEwK",
      "diff_hunk": "@@ -66,6 +94,49 @@ namespace BCLog {\n         ALL         = ~(uint32_t)0,\n     };\n \n+    //! Fixed window rate limiter for logging.\n+    class LogRatelimiter\n+    {\n+    private:\n+        //! Timestamp of the last window reset.\n+        std::chrono::seconds m_last_reset;\n+        //! Interval after which the window is reset.\n+        std::chrono::seconds m_reset_interval;\n+        //! Remaining bytes in the current window interval.\n+        uint64_t m_available_bytes;\n+        //! Number of bytes that were not consumed within the current window.\n+        uint64_t m_dropped_bytes{0};\n+        //! The maximum number of bytes that can be logged withon one window.",
      "path": "src/logging.h",
      "position": null,
      "original_position": 73,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        //! The maximum number of bytes that can be logged within one window.\r\n```",
      "created_at": "2022-02-24T09:51:14Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813714442",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813714442"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 109,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813734077",
      "pull_request_review_id": 892204452,
      "id": 813734077,
      "node_id": "PRRC_kwDOABII584wgJi9",
      "diff_hunk": "@@ -262,7 +264,43 @@ void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& loggi\n \n     str_prefixed = LogTimestampStr(str_prefixed);\n \n-    m_started_new_line = !str.empty() && str[str.size()-1] == '\\n';\n+    if (m_ratelimiters.find(source_location) == m_ratelimiters.end()) {\n+        // We create a new rate limit window for this source location on its first log attempt.\n+        m_ratelimiters.emplace(source_location, LogRatelimiter{RATELIMIT_WINDOW_SIZE, RATELIMIT_WINDOW_MAX_BYTES});\n+    }\n+\n+    uint64_t dropped_bytes = m_ratelimiters[source_location].GetDroppedBytes();",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You've done existence checking above (\"We create a new rate limit window...\"), so you can use `std::unordered_map::at()` instead of the `[]` operator. `[]` will insert a new item in the map if the key doesn't exist, whereas `at()` will throw. Using `[]` therefore requires defining a default constructor for the value object.\r\n\r\nIf you make that replacement here and two lines below, you can remove the default constructor for `LotRatelimiter`, and then make the const members `const`:\r\n\r\n<details><summary>diff</summary>\r\n\r\n```diff\r\ndiff --git a/src/logging.cpp b/src/logging.cpp\r\nindex c96483366d..6df6ffcf80 100644\r\n--- a/src/logging.cpp\r\n+++ b/src/logging.cpp\r\n@@ -269,10 +269,10 @@ void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& loggi\r\n         m_ratelimiters.emplace(source_location, LogRatelimiter{RATELIMIT_WINDOW_SIZE, RATELIMIT_WINDOW_MAX_BYTES});\r\n     }\r\n \r\n-    uint64_t dropped_bytes = m_ratelimiters[source_location].GetDroppedBytes();\r\n+    uint64_t dropped_bytes = m_ratelimiters.at(source_location).GetDroppedBytes();\r\n     bool was_ratelimited = m_supressed_locations.find(source_location) != m_supressed_locations.end();\r\n     bool is_ratelimited = !skip_ratelimiting && m_ratelimit &&\r\n-                          !m_ratelimiters[source_location].Consume(str_prefixed.size());\r\n+                          !m_ratelimiters.at(source_location).Consume(str_prefixed.size());\r\n     if (!is_ratelimited && was_ratelimited) {\r\n         // Logging will restart for this source location.\r\n         m_supressed_locations.erase(source_location);\r\ndiff --git a/src/logging.h b/src/logging.h\r\nindex e3df9b45d0..7fa811ef1e 100644\r\n--- a/src/logging.h\r\n+++ b/src/logging.h\r\n@@ -101,25 +101,26 @@ namespace BCLog {\r\n         //! Timestamp of the last window reset.\r\n         std::chrono::seconds m_last_reset;\r\n         //! Interval after which the window is reset.\r\n-        std::chrono::seconds m_reset_interval;\r\n+        const std::chrono::seconds m_reset_interval;\r\n         //! Remaining bytes in the current window interval.\r\n         uint64_t m_available_bytes;\r\n         //! Number of bytes that were not consumed within the current window.\r\n         uint64_t m_dropped_bytes{0};\r\n         //! The maximum number of bytes that can be logged withon one window.\r\n-        uint64_t m_max_bytes;\r\n+        const uint64_t m_max_bytes;\r\n \r\n         //! Reset the window if the window interval has passed since the last reset.\r\n         void MaybeReset();\r\n \r\n     public:\r\n-        LogRatelimiter() {}\r\n+        LogRatelimiter() = delete;\r\n \r\n         LogRatelimiter(std::chrono::seconds interval, uint64_t max_bytes)\r\n```\r\n\r\n</details>",
      "created_at": "2022-02-24T10:14:17Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813734077",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813734077"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813734356",
      "pull_request_review_id": 892204452,
      "id": 813734356,
      "node_id": "PRRC_kwDOABII584wgJnU",
      "diff_hunk": "@@ -66,6 +94,49 @@ namespace BCLog {\n         ALL         = ~(uint32_t)0,\n     };\n \n+    //! Fixed window rate limiter for logging.\n+    class LogRatelimiter\n+    {\n+    private:\n+        //! Timestamp of the last window reset.\n+        std::chrono::seconds m_last_reset;\n+        //! Interval after which the window is reset.\n+        std::chrono::seconds m_reset_interval;\n+        //! Remaining bytes in the current window interval.\n+        uint64_t m_available_bytes;\n+        //! Number of bytes that were not consumed within the current window.\n+        uint64_t m_dropped_bytes{0};\n+        //! The maximum number of bytes that can be logged withon one window.\n+        uint64_t m_max_bytes;",
      "path": "src/logging.h",
      "position": null,
      "original_position": 74,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        const uint64_t m_max_bytes;\r\n```",
      "created_at": "2022-02-24T10:14:37Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813734356",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813734356"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813779163",
      "pull_request_review_id": 892204452,
      "id": 813779163,
      "node_id": "PRRC_kwDOABII584wgUjb",
      "diff_hunk": "@@ -66,6 +94,49 @@ namespace BCLog {\n         ALL         = ~(uint32_t)0,\n     };\n \n+    //! Fixed window rate limiter for logging.\n+    class LogRatelimiter\n+    {\n+    private:\n+        //! Timestamp of the last window reset.\n+        std::chrono::seconds m_last_reset;\n+        //! Interval after which the window is reset.\n+        std::chrono::seconds m_reset_interval;\n+        //! Remaining bytes in the current window interval.\n+        uint64_t m_available_bytes;\n+        //! Number of bytes that were not consumed within the current window.\n+        uint64_t m_dropped_bytes{0};\n+        //! The maximum number of bytes that can be logged withon one window.\n+        uint64_t m_max_bytes;\n+\n+        //! Reset the window if the window interval has passed since the last reset.\n+        void MaybeReset();\n+\n+    public:\n+        LogRatelimiter() {}\n+\n+        LogRatelimiter(std::chrono::seconds interval, uint64_t max_bytes)\n+            : m_reset_interval{interval}, m_available_bytes{max_bytes}, m_max_bytes{max_bytes}\n+        {\n+            m_last_reset = GetTime<std::chrono::seconds>();\n+        }",
      "path": "src/logging.h",
      "position": null,
      "original_position": 86,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Do the `m_reset_interval` and `m_max_bytes` members need to be parametrized and provided in the constructor? The `LogRatelimiter` object is only ever constructed with `RATELIMIT_WINDOW_SIZE` and `RATELIMIT_WINDOW_MAX_BYTES` except in the unit test, which could easily be modified to use the same value. The log `Excessive logging detected from %s:%d (%s): >%d MiB logged during the last hour...` also implicitly assumes that the objects have been constructed with these constants.",
      "created_at": "2022-02-24T11:11:19Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813779163",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813779163"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": 118,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 122,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813779499",
      "pull_request_review_id": 892204452,
      "id": 813779499,
      "node_id": "PRRC_kwDOABII584wgUor",
      "diff_hunk": "@@ -66,6 +94,49 @@ namespace BCLog {\n         ALL         = ~(uint32_t)0,\n     };\n \n+    //! Fixed window rate limiter for logging.\n+    class LogRatelimiter\n+    {\n+    private:\n+        //! Timestamp of the last window reset.\n+        std::chrono::seconds m_last_reset;\n+        //! Interval after which the window is reset.\n+        std::chrono::seconds m_reset_interval;\n+        //! Remaining bytes in the current window interval.\n+        uint64_t m_available_bytes;\n+        //! Number of bytes that were not consumed within the current window.\n+        uint64_t m_dropped_bytes{0};\n+        //! The maximum number of bytes that can be logged withon one window.\n+        uint64_t m_max_bytes;\n+\n+        //! Reset the window if the window interval has passed since the last reset.\n+        void MaybeReset();\n+\n+    public:\n+        LogRatelimiter() {}\n+\n+        LogRatelimiter(std::chrono::seconds interval, uint64_t max_bytes)\n+            : m_reset_interval{interval}, m_available_bytes{max_bytes}, m_max_bytes{max_bytes}\n+        {\n+            m_last_reset = GetTime<std::chrono::seconds>();",
      "path": "src/logging.h",
      "position": null,
      "original_position": 85,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`m_last_reset` can be set in the initializer list:\r\n\r\n```\r\n        LogRatelimiter(std::chrono::seconds interval, uint64_t max_bytes)\r\n            : m_last_reset{GetTime<std::chrono::seconds>()}\r\n            , m_reset_interval{interval}\r\n            , m_available_bytes{max_bytes}\r\n            , m_max_bytes{max_bytes}\r\n        {}\r\n```",
      "created_at": "2022-02-24T11:11:50Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813779499",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813779499"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 121,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813800882",
      "pull_request_review_id": 892204452,
      "id": 813800882,
      "node_id": "PRRC_kwDOABII584wgZ2y",
      "diff_hunk": "@@ -6,28 +6,56 @@\n #ifndef BITCOIN_LOGGING_H\n #define BITCOIN_LOGGING_H\n \n+#include <crypto/siphash.h>\n #include <fs.h>\n #include <tinyformat.h>\n #include <threadsafety.h>\n #include <util/string.h>\n+#include <util/time.h>\n \n #include <atomic>\n #include <cstdint>\n #include <functional>\n #include <list>\n #include <mutex>\n #include <string>\n+#include <unordered_map>\n+#include <unordered_set>\n #include <vector>\n \n static const bool DEFAULT_LOGTIMEMICROS = false;\n static const bool DEFAULT_LOGIPS        = false;\n static const bool DEFAULT_LOGTIMESTAMPS = true;\n static const bool DEFAULT_LOGTHREADNAMES = false;\n static const bool DEFAULT_LOGSOURCELOCATIONS = false;\n+static const bool DEFAULT_RATELIMITLOGGING = true;",
      "path": "src/logging.h",
      "position": null,
      "original_position": 26,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I know you've just copied the other consts here, but current style is to prefer:\r\n\r\n```suggestion\r\nstatic constexpr bool DEFAULT_RATELIMITLOGGING{true};\r\n```",
      "created_at": "2022-02-24T11:43:24Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813800882",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813800882"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813801020",
      "pull_request_review_id": 892204452,
      "id": 813801020,
      "node_id": "PRRC_kwDOABII584wgZ48",
      "diff_hunk": "@@ -98,12 +174,13 @@ namespace BCLog {\n         bool m_log_time_micros = DEFAULT_LOGTIMEMICROS;\n         bool m_log_threadnames = DEFAULT_LOGTHREADNAMES;\n         bool m_log_sourcelocations = DEFAULT_LOGSOURCELOCATIONS;\n+        bool m_ratelimit = DEFAULT_RATELIMITLOGGING;",
      "path": "src/logging.h",
      "position": null,
      "original_position": 123,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        bool m_ratelimit{DEFAULT_RATELIMITLOGGING};\r\n```",
      "created_at": "2022-02-24T11:43:38Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813801020",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813801020"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 177,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813811058",
      "pull_request_review_id": 892204452,
      "id": 813811058,
      "node_id": "PRRC_kwDOABII584wgcVy",
      "diff_hunk": "@@ -30,4 +31,140 @@ BOOST_AUTO_TEST_CASE(logging_timer)\n     BOOST_CHECK_EQUAL(sec_timer.LogMsg(\"test secs\"), \"tests: test secs (1.00s)\");\n }\n \n+BOOST_AUTO_TEST_CASE(logging_ratelimit_window)\n+{\n+    SetMockTime(std::chrono::minutes{1});\n+    BCLog::LogRatelimiter window{std::chrono::minutes{1}, 1000};\n+\n+    // Check that window gets initialised correctly.\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 1000ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    BOOST_CHECK(window.Consume(500));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 500ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    BOOST_CHECK(window.Consume(500));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 0ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    // Consuming another 500 bytes after already having consumed a 1000 bytes should fail.\n+    BOOST_CHECK(!window.Consume(500));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 0ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 500ull);\n+\n+    // Advance time by one minute. This should trigger a window reset.\n+    SetMockTime(std::chrono::minutes{2});\n+\n+    // Check that the window resets as expected when new bytes are consumed.\n+    BOOST_CHECK(window.Consume(100));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 900ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+}\n+\n+void LogFromLocation(int location, std::string message)\n+{\n+    switch (location) {\n+    case 0:\n+        LogPrintf(\"%s\\n\", message);\n+        break;\n+    case 1:\n+        LogPrintf(\"%s\\n\", message);\n+        break;\n+    case 2:\n+        LogPrintfWithoutRateLimiting(\"%s\\n\", message);\n+        break;\n+    case 3:\n+        LogPrint(BCLog::ALL, \"%s\\n\", message);\n+        break;\n+    default:\n+        BOOST_CHECK_MESSAGE(false, \"Unkown log location\");\n+    }\n+}\n+\n+void LogFromLocationAndExpect(int location, std::string message, std::string expect)\n+{\n+    ASSERT_DEBUG_LOG(expect);\n+    LogFromLocation(location, message);\n+}\n+\n+BOOST_AUTO_TEST_CASE(rate_limiting)\n+{\n+    bool prev_log_timestamps = LogInstance().m_log_sourcelocations;\n+    LogInstance().m_log_timestamps = false;\n+    bool prev_log_sourcelocations = LogInstance().m_log_sourcelocations;\n+    LogInstance().m_log_sourcelocations = false;\n+    bool prev_log_threadnames = LogInstance().m_log_threadnames;\n+    LogInstance().m_log_threadnames = false;\n+\n+    // Log 1024-character lines (1023 plus newline) to make the math simple.\n+    std::string log_message(1023, 'a');\n+\n+    SetMockTime(std::chrono::hours{1});\n+\n+    size_t log_file_size = std::filesystem::file_size(LogInstance().m_file_path);",
      "path": "src/test/logging_tests.cpp",
      "position": 98,
      "original_position": 83,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'd be tempted to remove all the log file size checks. Don't the `LogFromLocationAndExpect()` checks already show that the expected messages are being written to the log?",
      "created_at": "2022-02-24T11:58:26Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813811058",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813811058"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 225,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813812736",
      "pull_request_review_id": 892204452,
      "id": 813812736,
      "node_id": "PRRC_kwDOABII584wgcwA",
      "diff_hunk": "@@ -30,4 +31,140 @@ BOOST_AUTO_TEST_CASE(logging_timer)\n     BOOST_CHECK_EQUAL(sec_timer.LogMsg(\"test secs\"), \"tests: test secs (1.00s)\");\n }\n \n+BOOST_AUTO_TEST_CASE(logging_ratelimit_window)\n+{\n+    SetMockTime(std::chrono::minutes{1});\n+    BCLog::LogRatelimiter window{std::chrono::minutes{1}, 1000};\n+\n+    // Check that window gets initialised correctly.\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 1000ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    BOOST_CHECK(window.Consume(500));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 500ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    BOOST_CHECK(window.Consume(500));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 0ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    // Consuming another 500 bytes after already having consumed a 1000 bytes should fail.\n+    BOOST_CHECK(!window.Consume(500));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 0ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 500ull);\n+\n+    // Advance time by one minute. This should trigger a window reset.\n+    SetMockTime(std::chrono::minutes{2});\n+\n+    // Check that the window resets as expected when new bytes are consumed.\n+    BOOST_CHECK(window.Consume(100));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 900ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+}\n+\n+void LogFromLocation(int location, std::string message)\n+{\n+    switch (location) {\n+    case 0:\n+        LogPrintf(\"%s\\n\", message);\n+        break;\n+    case 1:\n+        LogPrintf(\"%s\\n\", message);\n+        break;\n+    case 2:\n+        LogPrintfWithoutRateLimiting(\"%s\\n\", message);\n+        break;\n+    case 3:\n+        LogPrint(BCLog::ALL, \"%s\\n\", message);\n+        break;\n+    default:\n+        BOOST_CHECK_MESSAGE(false, \"Unkown log location\");",
      "path": "src/test/logging_tests.cpp",
      "position": null,
      "original_position": 59,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This shouldn't be a `BOOST_CHECK`, which is used to check program logic. This is to catch errors in the unit test code. I think just remove it and let the compiler warn.\r\n\r\n```suggestion\r\n    // no default case, so the compiler can warn about missing cases\r\n```",
      "created_at": "2022-02-24T12:01:00Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813812736",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813812736"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": 80,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813813835",
      "pull_request_review_id": 892204452,
      "id": 813813835,
      "node_id": "PRRC_kwDOABII584wgdBL",
      "diff_hunk": "@@ -181,18 +257,31 @@ static inline void LogPrintf_(const std::string& logging_function, const std::st\n             /* Original format string will have newline so don't add one here */\n             log_msg = \"Error \\\"\" + std::string(fmterr.what()) + \"\\\" while formatting log message: \" + fmt;\n         }\n-        LogInstance().LogPrintStr(log_msg, logging_function, source_file, source_line);\n+\n+        const SourceLocation source_location{source_file, source_line};\n+        LogInstance().LogPrintStr(log_msg, logging_function, source_location, skip_ratelimiting);\n     }\n }\n \n-#define LogPrintf(...) LogPrintf_(__func__, __FILE__, __LINE__, __VA_ARGS__)\n+// Unconditional logging. Uses basic rate limiting to mitigate disk filling attacks.\n+#define LogPrintf(...) LogPrintf_(__func__, __FILE__, __LINE__, /* skip_ratelimiting */ false, __VA_ARGS__)\n+\n+// Unconditional logging WITHOUT rate limiting. Use only for log messages that\n+// MUST NOT be rate limited no matter how often they are logged. That requirement\n+// should be extremely rare, so please use with care. Prefer LogPrintf(...) if\n+// possible.\n+#define LogPrintfWithoutRateLimiting(...) LogPrintf_(__func__, __FILE__, __LINE__, /* skip_ratelimiting */ true, __VA_ARGS__)",
      "path": "src/logging.h",
      "position": null,
      "original_position": 170,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think it'd be nice to unify the various logprint macros by introducing new categories:\r\n\r\n- `UNCONDITIONAL_RATE_LIMITED` replaces `LogPrintf`\r\n- `UNCONDITIONAL_ALWAYS` replaces `LogPrintfWithoutRateLimiting`\r\n\r\nor similar.",
      "created_at": "2022-02-24T12:02:33Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813813835",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813813835"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 273,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813814387",
      "pull_request_review_id": 892204452,
      "id": 813814387,
      "node_id": "PRRC_kwDOABII584wgdJz",
      "diff_hunk": "@@ -247,13 +249,13 @@ namespace BCLog {\n     }\n } // namespace BCLog\n \n-void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line)\n+void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const SourceLocation& source_location, bool skip_ratelimiting)",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Do we have any idea if the new logic in this function impacts performance?",
      "created_at": "2022-02-24T12:03:20Z",
      "updated_at": "2022-02-24T12:03:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r813814387",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813814387"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 252,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820637222",
      "pull_request_review_id": 901593560,
      "id": 820637222,
      "node_id": "PRRC_kwDOABII584w6e4m",
      "diff_hunk": "@@ -30,4 +31,140 @@ BOOST_AUTO_TEST_CASE(logging_timer)\n     BOOST_CHECK_EQUAL(sec_timer.LogMsg(\"test secs\"), \"tests: test secs (1.00s)\");\n }\n \n+BOOST_AUTO_TEST_CASE(logging_ratelimit_window)\n+{\n+    SetMockTime(std::chrono::minutes{1});\n+    BCLog::LogRatelimiter window{std::chrono::minutes{1}, 1000};\n+\n+    // Check that window gets initialised correctly.\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 1000ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    BOOST_CHECK(window.Consume(500));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 500ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    BOOST_CHECK(window.Consume(500));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 0ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    // Consuming another 500 bytes after already having consumed a 1000 bytes should fail.\n+    BOOST_CHECK(!window.Consume(500));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 0ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 500ull);\n+\n+    // Advance time by one minute. This should trigger a window reset.\n+    SetMockTime(std::chrono::minutes{2});\n+\n+    // Check that the window resets as expected when new bytes are consumed.\n+    BOOST_CHECK(window.Consume(100));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 900ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+}\n+\n+void LogFromLocation(int location, std::string message)\n+{\n+    switch (location) {\n+    case 0:\n+        LogPrintf(\"%s\\n\", message);\n+        break;\n+    case 1:\n+        LogPrintf(\"%s\\n\", message);\n+        break;\n+    case 2:\n+        LogPrintfWithoutRateLimiting(\"%s\\n\", message);\n+        break;\n+    case 3:\n+        LogPrint(BCLog::ALL, \"%s\\n\", message);\n+        break;\n+    default:\n+        BOOST_CHECK_MESSAGE(false, \"Unkown log location\");\n+    }\n+}\n+\n+void LogFromLocationAndExpect(int location, std::string message, std::string expect)\n+{\n+    ASSERT_DEBUG_LOG(expect);\n+    LogFromLocation(location, message);\n+}\n+\n+BOOST_AUTO_TEST_CASE(rate_limiting)\n+{\n+    bool prev_log_timestamps = LogInstance().m_log_sourcelocations;\n+    LogInstance().m_log_timestamps = false;\n+    bool prev_log_sourcelocations = LogInstance().m_log_sourcelocations;\n+    LogInstance().m_log_sourcelocations = false;\n+    bool prev_log_threadnames = LogInstance().m_log_threadnames;\n+    LogInstance().m_log_threadnames = false;\n+\n+    // Log 1024-character lines (1023 plus newline) to make the math simple.\n+    std::string log_message(1023, 'a');\n+\n+    SetMockTime(std::chrono::hours{1});\n+\n+    size_t log_file_size = std::filesystem::file_size(LogInstance().m_file_path);",
      "path": "src/test/logging_tests.cpp",
      "position": 98,
      "original_position": 83,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": 813811058,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think i would like to keep them, as `LogFromLocationAndExpect` uses the log callbacks which fire regardless of whether or not the message is actually printed to the console or disk.\r\n\r\nI think these checks make sense just to be really sure that the file sizes change as expected. I have had bugs while writing this where the messages from the rate limiting logic where printed at the wrong time, so simply relying on those is not enough IMO.",
      "created_at": "2022-03-07T11:58:35Z",
      "updated_at": "2022-03-07T11:58:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r820637222",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820637222"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 225,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820924461",
      "pull_request_review_id": 902002043,
      "id": 820924461,
      "node_id": "PRRC_kwDOABII584w7lAt",
      "diff_hunk": "@@ -181,18 +257,31 @@ static inline void LogPrintf_(const std::string& logging_function, const std::st\n             /* Original format string will have newline so don't add one here */\n             log_msg = \"Error \\\"\" + std::string(fmterr.what()) + \"\\\" while formatting log message: \" + fmt;\n         }\n-        LogInstance().LogPrintStr(log_msg, logging_function, source_file, source_line);\n+\n+        const SourceLocation source_location{source_file, source_line};\n+        LogInstance().LogPrintStr(log_msg, logging_function, source_location, skip_ratelimiting);\n     }\n }\n \n-#define LogPrintf(...) LogPrintf_(__func__, __FILE__, __LINE__, __VA_ARGS__)\n+// Unconditional logging. Uses basic rate limiting to mitigate disk filling attacks.\n+#define LogPrintf(...) LogPrintf_(__func__, __FILE__, __LINE__, /* skip_ratelimiting */ false, __VA_ARGS__)\n+\n+// Unconditional logging WITHOUT rate limiting. Use only for log messages that\n+// MUST NOT be rate limited no matter how often they are logged. That requirement\n+// should be extremely rare, so please use with care. Prefer LogPrintf(...) if\n+// possible.\n+#define LogPrintfWithoutRateLimiting(...) LogPrintf_(__func__, __FILE__, __LINE__, /* skip_ratelimiting */ true, __VA_ARGS__)",
      "path": "src/logging.h",
      "position": null,
      "original_position": 170,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": 813813835,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Are you suggesting to get rid of `LogPrintf` completely or to define it as the following?\r\n```c++\r\n#define LogPrintf(...) LogPrint(UNCONDITIONAL_RATE_LIMITED, __VA_ARGS__)\r\n```\r\nI would not be a fan of replacing every usage of `LogPrintf` in this PR.",
      "created_at": "2022-03-07T17:17:00Z",
      "updated_at": "2022-03-07T17:17:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r820924461",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820924461"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 273,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824216339",
      "pull_request_review_id": 906541897,
      "id": 824216339,
      "node_id": "PRRC_kwDOABII584xIIsT",
      "diff_hunk": "@@ -247,13 +249,13 @@ namespace BCLog {\n     }\n } // namespace BCLog\n \n-void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line)\n+void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const SourceLocation& source_location, bool skip_ratelimiting)",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": 813814387,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Here are some benchmarks using the code from #18815:\r\n\r\nmerge base:\r\n```\r\n|               ns/op |                op/s |    err% |          ins/op |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|---------------:|--------:|----------:|:----------\r\n|                3.63 |      275,623,892.70 |    0.5% |           54.00 |          13.00 |    0.0% |      0.01 | `LoggingNoCategory`\r\n|               40.65 |       24,600,010.03 |    0.9% |          659.00 |         155.00 |    0.0% |      0.01 | `LoggingNoFile`\r\n|            2,165.69 |          461,746.80 |    0.2% |       19,809.05 |       3,709.01 |    0.1% |      0.01 | `LoggingNoThreadNames`\r\n|            2,189.45 |          456,736.09 |    0.8% |       19,842.05 |       3,717.01 |    0.2% |      0.01 | `LoggingYoCategory`\r\n|            2,224.15 |          449,609.33 |    0.9% |       20,373.05 |       3,839.01 |    0.1% |      0.01 | `LoggingYoThreadNames`\r\n\r\n```\r\n\r\npull request:\r\n```\r\n|               ns/op |                op/s |    err% |          ins/op |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|---------------:|--------:|----------:|:----------\r\n|                3.88 |      257,848,736.66 |    1.2% |           54.00 |          13.00 |    0.0% |      0.01 | `LoggingNoCategory`\r\n|               40.29 |       24,820,332.51 |    2.5% |          663.00 |         155.00 |    0.0% |      0.01 | `LoggingNoFile`\r\n|            2,440.31 |          409,783.92 |    1.5% |       22,024.06 |       4,017.01 |    0.1% |      0.01 | `LoggingNoThreadNames`\r\n|            2,486.87 |          402,111.61 |    4.6% |       21,513.06 |       3,951.01 |    0.1% |      0.01 | `LoggingYoCategory`\r\n|            2,571.68 |          388,850.52 |    3.3% |       22,584.06 |       4,147.01 |    0.1% |      0.01 | `LoggingYoThreadNames`\r\n```\r\n\r\nI would say that the additional 200 - 300 nano seconds per `LogPrintf` call are negligible.",
      "created_at": "2022-03-10T22:09:28Z",
      "updated_at": "2022-03-10T22:09:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r824216339",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824216339"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 252,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824700294",
      "pull_request_review_id": 907198372,
      "id": 824700294,
      "node_id": "PRRC_kwDOABII584xJ-2G",
      "diff_hunk": "@@ -181,18 +257,31 @@ static inline void LogPrintf_(const std::string& logging_function, const std::st\n             /* Original format string will have newline so don't add one here */\n             log_msg = \"Error \\\"\" + std::string(fmterr.what()) + \"\\\" while formatting log message: \" + fmt;\n         }\n-        LogInstance().LogPrintStr(log_msg, logging_function, source_file, source_line);\n+\n+        const SourceLocation source_location{source_file, source_line};\n+        LogInstance().LogPrintStr(log_msg, logging_function, source_location, skip_ratelimiting);\n     }\n }\n \n-#define LogPrintf(...) LogPrintf_(__func__, __FILE__, __LINE__, __VA_ARGS__)\n+// Unconditional logging. Uses basic rate limiting to mitigate disk filling attacks.\n+#define LogPrintf(...) LogPrintf_(__func__, __FILE__, __LINE__, /* skip_ratelimiting */ false, __VA_ARGS__)\n+\n+// Unconditional logging WITHOUT rate limiting. Use only for log messages that\n+// MUST NOT be rate limited no matter how often they are logged. That requirement\n+// should be extremely rare, so please use with care. Prefer LogPrintf(...) if\n+// possible.\n+#define LogPrintfWithoutRateLimiting(...) LogPrintf_(__func__, __FILE__, __LINE__, /* skip_ratelimiting */ true, __VA_ARGS__)",
      "path": "src/logging.h",
      "position": null,
      "original_position": 170,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": 813813835,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think it'd be good to get rid of `LogPrintf` completely in the future, but I'm not suggesting you do that in this PR. I'd just prefer that his PR doesn't add a new log macro.",
      "created_at": "2022-03-11T13:12:55Z",
      "updated_at": "2022-03-11T13:12:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r824700294",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824700294"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 273,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824828452",
      "pull_request_review_id": 907381308,
      "id": 824828452,
      "node_id": "PRRC_kwDOABII584xKeIk",
      "diff_hunk": "@@ -262,7 +264,43 @@ void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& loggi\n \n     str_prefixed = LogTimestampStr(str_prefixed);\n \n-    m_started_new_line = !str.empty() && str[str.size()-1] == '\\n';\n+    if (m_ratelimiters.find(source_location) == m_ratelimiters.end()) {\n+        // We create a new rate limit window for this source location on its first log attempt.\n+        m_ratelimiters.emplace(source_location, LogRatelimiter{RATELIMIT_WINDOW_SIZE, RATELIMIT_WINDOW_MAX_BYTES});\n+    }\n+\n+    uint64_t dropped_bytes = m_ratelimiters[source_location].GetDroppedBytes();",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": 813734077,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I dropped the non-default constructor since we only ever constructed with `RATELIMIT_WINDOW_SIZE` and `RATELIMIT_WINDOW_MAX_BYTES`. So now a new `LogRateLimiter` will be constructed using the default constructor when `[]` is used the first time.",
      "created_at": "2022-03-11T15:33:30Z",
      "updated_at": "2022-03-11T15:33:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r824828452",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824828452"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824828709",
      "pull_request_review_id": 907381669,
      "id": 824828709,
      "node_id": "PRRC_kwDOABII584xKeMl",
      "diff_hunk": "@@ -66,6 +94,49 @@ namespace BCLog {\n         ALL         = ~(uint32_t)0,\n     };\n \n+    //! Fixed window rate limiter for logging.\n+    class LogRatelimiter\n+    {\n+    private:\n+        //! Timestamp of the last window reset.\n+        std::chrono::seconds m_last_reset;\n+        //! Interval after which the window is reset.\n+        std::chrono::seconds m_reset_interval;\n+        //! Remaining bytes in the current window interval.\n+        uint64_t m_available_bytes;\n+        //! Number of bytes that were not consumed within the current window.\n+        uint64_t m_dropped_bytes{0};\n+        //! The maximum number of bytes that can be logged withon one window.\n+        uint64_t m_max_bytes;\n+\n+        //! Reset the window if the window interval has passed since the last reset.\n+        void MaybeReset();\n+\n+    public:\n+        LogRatelimiter() {}\n+\n+        LogRatelimiter(std::chrono::seconds interval, uint64_t max_bytes)\n+            : m_reset_interval{interval}, m_available_bytes{max_bytes}, m_max_bytes{max_bytes}\n+        {\n+            m_last_reset = GetTime<std::chrono::seconds>();\n+        }",
      "path": "src/logging.h",
      "position": null,
      "original_position": 86,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "6f7fd4be58c8283237023879e84d2c289d31e58b",
      "in_reply_to_id": 813779163,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "See https://github.com/bitcoin/bitcoin/pull/21603#discussion_r824828452",
      "created_at": "2022-03-11T15:33:47Z",
      "updated_at": "2022-03-11T15:33:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r824828709",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824828709"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": 118,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 122,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850611668",
      "pull_request_review_id": 942522620,
      "id": 850611668,
      "node_id": "PRRC_kwDOABII584ys03U",
      "diff_hunk": "@@ -94,20 +94,35 @@ BOOST_AUTO_TEST_CASE(rate_limiting)\n \n     SetMockTime(std::chrono::hours{1});\n \n+    size_t log_file_size = std::filesystem::file_size(LogInstance().m_file_path);\n     // Logging 1 MiB should be allowed.\n     for (int i = 0; i < 1024; ++i) {\n         LogFromLocation(0, log_message);\n     }\n+    BOOST_CHECK_MESSAGE(log_file_size < std::filesystem::file_size(LogInstance().m_file_path), \"should be able to log 1 MiB from location 0\");\n \n+    log_file_size = std::filesystem::file_size(LogInstance().m_file_path);\n     BOOST_CHECK_NO_THROW(\n         LogFromLocationAndExpect(0, log_message, \"Excessive logging detected\"));\n+    BOOST_CHECK_MESSAGE(log_file_size < std::filesystem::file_size(LogInstance().m_file_path), \"the start of the supression period should be logged\");\n+\n+    log_file_size = std::filesystem::file_size(LogInstance().m_file_path);\n+    for (int i = 0; i < 1024; ++i) {\n+        LogFromLocation(0, log_message);\n+    }\n+    BOOST_CHECK_MESSAGE(log_file_size == std::filesystem::file_size(LogInstance().m_file_path), \"all further logs from location 0 should be dropped\");\n+\n     BOOST_CHECK_THROW(\n         LogFromLocationAndExpect(1, log_message, \"Excessive logging detected\"), std::runtime_error);\n+    BOOST_CHECK_MESSAGE(log_file_size < std::filesystem::file_size(LogInstance().m_file_path), \"locaiton 1 should be unaffected by other locations\");",
      "path": "src/test/logging_tests.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "3eaafe7cc811da3da21c722e7f6a66cf93e1d4f9",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "typo: location (here and in two other spots)",
      "created_at": "2022-04-14T16:27:46Z",
      "updated_at": "2022-04-14T17:54:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r850611668",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850611668"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 117,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850617035",
      "pull_request_review_id": 942522620,
      "id": 850617035,
      "node_id": "PRRC_kwDOABII584ys2LL",
      "diff_hunk": "@@ -265,7 +265,38 @@ void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& loggi\n \n     str_prefixed = LogTimestampStr(str_prefixed);\n \n-    m_started_new_line = !str.empty() && str[str.size()-1] == '\\n';\n+    uint64_t dropped_bytes = m_ratelimiters[source_location].GetDroppedBytes();\n+    bool was_ratelimited = m_supressed_locations.find(source_location) != m_supressed_locations.end();\n+    bool is_ratelimited = !skip_rate_limiting && m_ratelimit &&",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "7654c1762580c0de7d5cbaedeb06040df63eea98",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "All these checks seem unnecessary for locations that are not subject to rate limiting (e.g. special category logs, or with rate limiting disabled). Wouldn't it be better to make this entire block conditional on `!skip_rate_limiting && m_ratelimit` so that we don't needlessly add locations to `m_ratelimiters` and perform other operations for these locations?",
      "created_at": "2022-04-14T16:34:20Z",
      "updated_at": "2022-04-14T17:54:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r850617035",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850617035"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 270,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850623650",
      "pull_request_review_id": 942522620,
      "id": 850623650,
      "node_id": "PRRC_kwDOABII584ys3yi",
      "diff_hunk": "@@ -76,6 +76,7 @@ void AddLoggingArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-logtimemicros\", strprintf(\"Add microsecond precision to debug timestamps (default: %u)\", DEFAULT_LOGTIMEMICROS), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-printtoconsole\", \"Send trace/debug info to console (default: 1 when no -daemon. To disable logging to file, set -nodebuglogfile)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-shrinkdebugfile\", \"Shrink debug.log file on client startup (default: 1 when no -debug)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n+    argsman.AddArg(\"-ratelimitlogging\", strprintf(\"Rate limit debug logging to disk (default: %u)\", DEFAULT_RATELIMITLOGGING), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);",
      "path": "src/init/common.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "8ff8a856e70d8897e5996c06225b5fff380309b6",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The naming might be confusing, maybe drop the \"debug\" in it because \"debug logging\" could be understood as the specialised logs (`-debug`), which are not subject to the rate limiting.",
      "created_at": "2022-04-14T16:43:11Z",
      "updated_at": "2022-04-14T17:54:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r850623650",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850623650"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850673831",
      "pull_request_review_id": 942608550,
      "id": 850673831,
      "node_id": "PRRC_kwDOABII584ytECn",
      "diff_hunk": "@@ -165,6 +164,8 @@ const CLogCategoryDesc LogCategories[] =\n #endif\n     {BCLog::UTIL, \"util\"},\n     {BCLog::BLOCKSTORE, \"blockstorage\"},\n+    {BCLog::UNCONDITIONAL_RATE_LIMITED, \"uncond_rate_limited\"},\n+    {BCLog::UNCONDITIONAL_ALWAYS, \"uncond_always\"},",
      "path": "src/logging.cpp",
      "position": 22,
      "original_position": 13,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "f1cc42c04e9d73d235dc4a010dc85e828969112f",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Just to clarify - all the other categories (`QT`, `REINDEX`, `BENCH`, etc.) are not rate-limited?",
      "created_at": "2022-04-14T17:51:09Z",
      "updated_at": "2022-04-14T17:58:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r850673831",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850673831"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": 167,
      "original_start_line": 167,
      "start_side": "RIGHT",
      "line": 168,
      "original_line": 168,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851162186",
      "pull_request_review_id": 943278495,
      "id": 851162186,
      "node_id": "PRRC_kwDOABII584yu7RK",
      "diff_hunk": "@@ -76,6 +76,7 @@ void AddLoggingArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-logtimemicros\", strprintf(\"Add microsecond precision to debug timestamps (default: %u)\", DEFAULT_LOGTIMEMICROS), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-printtoconsole\", \"Send trace/debug info to console (default: 1 when no -daemon. To disable logging to file, set -nodebuglogfile)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-shrinkdebugfile\", \"Shrink debug.log file on client startup (default: 1 when no -debug)\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n+    argsman.AddArg(\"-ratelimitlogging\", strprintf(\"Rate limit debug logging to disk (default: %u)\", DEFAULT_RATELIMITLOGGING), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);",
      "path": "src/init/common.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "8ff8a856e70d8897e5996c06225b5fff380309b6",
      "in_reply_to_id": 850623650,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Replaced \"debug\" with \"unconditional\".",
      "created_at": "2022-04-15T09:02:57Z",
      "updated_at": "2022-04-15T09:02:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r851162186",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851162186"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851164551",
      "pull_request_review_id": 943281420,
      "id": 851164551,
      "node_id": "PRRC_kwDOABII584yu72H",
      "diff_hunk": "@@ -165,6 +164,8 @@ const CLogCategoryDesc LogCategories[] =\n #endif\n     {BCLog::UTIL, \"util\"},\n     {BCLog::BLOCKSTORE, \"blockstorage\"},\n+    {BCLog::UNCONDITIONAL_RATE_LIMITED, \"uncond_rate_limited\"},\n+    {BCLog::UNCONDITIONAL_ALWAYS, \"uncond_always\"},",
      "path": "src/logging.cpp",
      "position": 22,
      "original_position": 13,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "f1cc42c04e9d73d235dc4a010dc85e828969112f",
      "in_reply_to_id": 850673831,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, only uses of `LogPrintf` (`LogPrint(BCLog::UNCONDITIONAL_RATE_LIMITED, ...)`) are rate limited.",
      "created_at": "2022-04-15T09:07:36Z",
      "updated_at": "2022-04-15T09:07:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r851164551",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851164551"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": 167,
      "original_start_line": 167,
      "start_side": "RIGHT",
      "line": 168,
      "original_line": 168,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/879701462",
      "pull_request_review_id": 982117359,
      "id": 879701462,
      "node_id": "PRRC_kwDOABII5840by3W",
      "diff_hunk": "@@ -85,7 +158,7 @@ namespace BCLog {\n         std::atomic_bool m_started_new_line{true};\n \n         /** Log categories bitfield. */\n-        std::atomic<uint32_t> m_categories{0};\n+        std::atomic<uint32_t> m_categories{BCLog::UNCONDITIONAL_RATE_LIMITED | BCLog::UNCONDITIONAL_ALWAYS};",
      "path": "src/logging.h",
      "position": null,
      "original_position": 181,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "092e023d832ca2f63e274c3eb0528602209aa5cc",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Does setting the default to `BCLog::UNCONDITIONAL_RATE_LIMITED | BCLog::UNCONDITIONAL_ALWAYS` break the logic in `DefaultShrinkDebugFile()`?",
      "created_at": "2022-05-23T17:14:15Z",
      "updated_at": "2022-05-23T17:44:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r879701462",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/879701462"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 161,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/879708904",
      "pull_request_review_id": 982117359,
      "id": 879708904,
      "node_id": "PRRC_kwDOABII5840b0ro",
      "diff_hunk": "@@ -337,3 +374,26 @@ void BCLog::Logger::ShrinkDebugFile()\n     else if (file != nullptr)\n         fclose(file);\n }\n+\n+void BCLog::LogRateLimiter::MaybeReset()\n+{\n+    const std::chrono::seconds now = GetTime<std::chrono::seconds>();\n+    if ((now - m_last_reset) >= WINDOW_SIZE) {\n+        m_available_bytes = WINDOW_MAX_BYTES;\n+        m_last_reset = now;\n+        m_dropped_bytes = 0;\n+    }\n+}\n+\n+bool BCLog::LogRateLimiter::Consume(uint64_t bytes)",
      "path": "src/logging.cpp",
      "position": 142,
      "original_position": 102,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "092e023d832ca2f63e274c3eb0528602209aa5cc",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is it possible for this to return false followed by true, even if the rate limiter doesn't reset, eg:\r\n\r\n- m_available_bytes is 100\r\n- `Consume(110)` is called and returns false\r\n- `Consume(90)` is called and returns true.\r\n\r\nWhich would then cause the \"Restarting logging from ...\" and \"Excessive logging detected from...\" logs to be called before the LogRateLimiter has been reset.\r\n\r\nIf so, I think this is the fix:\r\n\r\n```diff\r\n    if (bytes > m_available_bytes) {\r\n        m_dropped_bytes += bytes;\r\n+       m_available_bytes = 0;\r\n        return false;\r\n    }",
      "created_at": "2022-05-23T17:24:25Z",
      "updated_at": "2022-05-23T17:44:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r879708904",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/879708904"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 500,
      "original_line": 500,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/879711795",
      "pull_request_review_id": 982117359,
      "id": 879711795,
      "node_id": "PRRC_kwDOABII5840b1Yz",
      "diff_hunk": "@@ -264,7 +265,43 @@ void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& loggi\n \n     str_prefixed = LogTimestampStr(str_prefixed);\n \n-    m_started_new_line = !str.empty() && str[str.size()-1] == '\\n';\n+    // Whether or not logging to disk was/is ratelimited for this source location.\n+    bool was_ratelimited{false};\n+    bool is_ratelimited{false};\n+\n+    if (!skip_rate_limiting && m_ratelimit) {\n+        was_ratelimited = m_supressed_locations.find(source_location) != m_supressed_locations.end();\n+        is_ratelimited = !m_ratelimiters[source_location].Consume(str_prefixed.size());\n+\n+        if (!is_ratelimited && was_ratelimited) {\n+            // Logging will restart for this source location.\n+            m_supressed_locations.erase(source_location);\n+\n+            str_prefixed = LogTimestampStr(strprintf(\n+                \"Restarting logging from %s:%d (%s): \"\n+                \"(%d MiB) were dropped during the last hour.\\n%s\",\n+                source_location.m_file, source_location.m_line, logging_function,\n+                m_ratelimiters[source_location].GetDroppedBytes() / (1024 * 1024), str_prefixed));\n+        } else if (is_ratelimited && !was_ratelimited) {\n+            // Logging from this source location will be supressed until the current window resets.\n+            m_supressed_locations.insert(source_location);\n+\n+            str_prefixed = LogTimestampStr(strprintf(\n+                \"Excessive logging detected from %s:%d (%s): >%d MiB logged during the last hour.\"\n+                \"Suppressing logging to disk from this source location for up to one hour. \"\n+                \"Console logging unaffected. Last log entry: %s\",\n+                source_location.m_file, source_location.m_line, logging_function,\n+                LogRateLimiter::WINDOW_MAX_BYTES / (1024 * 1024), str_prefixed));\n+        }\n+\n+        // To avoid confusion caused by dropped log messages when debugging an issue,\n+        // we prefix log lines with \"[*]\" when there are any supressed source locations.\n+        if (m_supressed_locations.size() > 0) {\n+            str_prefixed.insert(0, \"[*] \");\n+        }",
      "path": "src/logging.cpp",
      "position": null,
      "original_position": 71,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "092e023d832ca2f63e274c3eb0528602209aa5cc",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should this be outside the `skip_rate_limiting` conditional, so it is prefixed to all lines?\r\n\r\n```diff\r\n                 source_location.m_file, source_location.m_line, logging_function,\r\n                 LogRateLimiter::WINDOW_MAX_BYTES / (1024 * 1024), str_prefixed));\r\n         }\r\n+    }\r\n \r\n-        // To avoid confusion caused by dropped log messages when debugging an issue,\r\n-        // we prefix log lines with \"[*]\" when there are any supressed source locations.\r\n-        if (m_supressed_locations.size() > 0) {\r\n-            str_prefixed.insert(0, \"[*] \");\r\n-        }\r\n+    // To avoid confusion caused by dropped log messages when debugging an issue,\r\n+    // we prefix log lines with \"[*]\" when there are any supressed source locations.\r\n+    if (m_supressed_locations.size() > 0) {\r\n+        str_prefixed.insert(0, \"[*] \");\r\n     }\r\n```",
      "created_at": "2022-05-23T17:28:13Z",
      "updated_at": "2022-05-23T17:44:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r879711795",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/879711795"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": 299,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 301,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881502715",
      "pull_request_review_id": 984599352,
      "id": 881502715,
      "node_id": "PRRC_kwDOABII5840iqn7",
      "diff_hunk": "@@ -85,7 +158,7 @@ namespace BCLog {\n         std::atomic_bool m_started_new_line{true};\n \n         /** Log categories bitfield. */\n-        std::atomic<uint32_t> m_categories{0};\n+        std::atomic<uint32_t> m_categories{BCLog::UNCONDITIONAL_RATE_LIMITED | BCLog::UNCONDITIONAL_ALWAYS};",
      "path": "src/logging.h",
      "position": null,
      "original_position": 181,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "092e023d832ca2f63e274c3eb0528602209aa5cc",
      "in_reply_to_id": 879701462,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good catch, fixed!",
      "created_at": "2022-05-25T10:41:52Z",
      "updated_at": "2022-05-25T10:41:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r881502715",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881502715"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 161,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881503983",
      "pull_request_review_id": 984601103,
      "id": 881503983,
      "node_id": "PRRC_kwDOABII5840iq7v",
      "diff_hunk": "@@ -337,3 +374,26 @@ void BCLog::Logger::ShrinkDebugFile()\n     else if (file != nullptr)\n         fclose(file);\n }\n+\n+void BCLog::LogRateLimiter::MaybeReset()\n+{\n+    const std::chrono::seconds now = GetTime<std::chrono::seconds>();\n+    if ((now - m_last_reset) >= WINDOW_SIZE) {\n+        m_available_bytes = WINDOW_MAX_BYTES;\n+        m_last_reset = now;\n+        m_dropped_bytes = 0;\n+    }\n+}\n+\n+bool BCLog::LogRateLimiter::Consume(uint64_t bytes)",
      "path": "src/logging.cpp",
      "position": 142,
      "original_position": 102,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "092e023d832ca2f63e274c3eb0528602209aa5cc",
      "in_reply_to_id": 879708904,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, trying to consume more bytes than are available should result in no available bytes afterwards.",
      "created_at": "2022-05-25T10:43:20Z",
      "updated_at": "2022-05-25T10:43:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r881503983",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881503983"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 500,
      "original_line": 500,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/883765766",
      "pull_request_review_id": 987737220,
      "id": 883765766,
      "node_id": "PRRC_kwDOABII5840rTIG",
      "diff_hunk": "@@ -150,4 +152,138 @@ BOOST_FIXTURE_TEST_CASE(logging_LogPrintMacros_CategoryName, LogSetup)\n     BOOST_CHECK_EQUAL_COLLECTIONS(log_lines.begin(), log_lines.end(), expected.begin(), expected.end());\n }\n \n+BOOST_AUTO_TEST_CASE(logging_ratelimit_window)\n+{\n+    SetMockTime(std::chrono::hours{1});\n+    BCLog::LogRateLimiter window;\n+\n+    // Check that window gets initialised correctly.\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 1024ull * 1024ull);",
      "path": "src/test/logging_tests.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "9d84cb2cd20d7951682ca8415488ed96a5f2cf1c",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Would it be better to use `WINDOW_MAX_BYTES` here to reduce maintenance burden?\r\n```suggestion\r\n    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), BCLog::LogRateLimiter::WINDOW_MAX_BYTES);\r\n```",
      "created_at": "2022-05-27T16:25:59Z",
      "updated_at": "2022-05-27T17:15:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r883765766",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/883765766"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 161,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/883766689",
      "pull_request_review_id": 987737220,
      "id": 883766689,
      "node_id": "PRRC_kwDOABII5840rTWh",
      "diff_hunk": "@@ -150,4 +152,138 @@ BOOST_FIXTURE_TEST_CASE(logging_LogPrintMacros_CategoryName, LogSetup)\n     BOOST_CHECK_EQUAL_COLLECTIONS(log_lines.begin(), log_lines.end(), expected.begin(), expected.end());\n }\n \n+BOOST_AUTO_TEST_CASE(logging_ratelimit_window)\n+{\n+    SetMockTime(std::chrono::hours{1});\n+    BCLog::LogRateLimiter window;\n+\n+    // Check that window gets initialised correctly.\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 1024ull * 1024ull);\n+    BOOST_CHECK_EQUAL(window.GetDroppedBytes(), 0ull);\n+\n+    BOOST_CHECK(window.Consume(512ull * 1024ull));\n+    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), 512ull * 1024ull);",
      "path": "src/test/logging_tests.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "9d84cb2cd20d7951682ca8415488ed96a5f2cf1c",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Perhaps:\r\n\r\n```suggestion\r\n\r\n    const uint64_t MESSAGE_SIZE{512 * 1024};\r\n\r\n    BOOST_CHECK(window.Consume(MESSAGE_SIZE));\r\n    BOOST_CHECK_EQUAL(window.GetAvailableBytes(), WINDOW_MAX_BYTES - MESSAGE_SIZE);\r\n```",
      "created_at": "2022-05-27T16:27:18Z",
      "updated_at": "2022-05-27T17:15:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r883766689",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/883766689"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": 163,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 165,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/883768346",
      "pull_request_review_id": 987737220,
      "id": 883768346,
      "node_id": "PRRC_kwDOABII5840rTwa",
      "diff_hunk": "@@ -107,12 +183,13 @@ namespace BCLog {\n         bool m_log_time_micros = DEFAULT_LOGTIMEMICROS;\n         bool m_log_threadnames = DEFAULT_LOGTHREADNAMES;\n         bool m_log_sourcelocations = DEFAULT_LOGSOURCELOCATIONS;\n+        bool m_ratelimit{DEFAULT_RATELIMITLOGGING};\n \n         fs::path m_file_path;\n         std::atomic<bool> m_reopen_file{false};\n \n         /** Send a string to the log output */\n-        void LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line, const BCLog::LogFlags category, const BCLog::Level level);\n+        void LogPrintStr(const std::string& str, const std::string& logging_function, const SourceLocation& source_location, const BCLog::LogFlags category, const BCLog::Level level);",
      "path": "src/logging.h",
      "position": null,
      "original_position": 206,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "9d84cb2cd20d7951682ca8415488ed96a5f2cf1c",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Can I convince you to split this line to make it a bit more readable?\r\n\r\n```suggestion\r\n        void LogPrintStr(const std::string& str, const std::string& logging_function,\r\n                         const SourceLocation& source_location, const BCLog::LogFlags category,\r\n                         const BCLog::Level level);\r\n```",
      "created_at": "2022-05-27T16:29:33Z",
      "updated_at": "2022-05-27T17:15:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r883768346",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/883768346"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 192,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/883793744",
      "pull_request_review_id": 987737220,
      "id": 883793744,
      "node_id": "PRRC_kwDOABII5840rZ9Q",
      "diff_hunk": "@@ -334,19 +339,20 @@ namespace BCLog {\n     }\n } // namespace BCLog\n \n-void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line, const BCLog::LogFlags category, const BCLog::Level level)\n+void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const SourceLocation& source_location, const BCLog::LogFlags category, const BCLog::Level level)\n {\n     StdLockGuard scoped_lock(m_cs);\n     std::string str_prefixed = LogEscapeMessage(str);\n \n-    if ((category != LogFlags::NONE || level != Level::None) && m_started_new_line) {\n+    const bool print_category{category != LogFlags::NONE && category != LogFlags::UNCONDITIONAL_ALWAYS && category != LogFlags::UNCONDITIONAL_RATE_LIMITED};",
      "path": "src/logging.cpp",
      "position": 50,
      "original_position": 48,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "9d84cb2cd20d7951682ca8415488ed96a5f2cf1c",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is the `category != LogFlags::NONE` necessary here? I don't think anything logs with category NONE now.",
      "created_at": "2022-05-27T17:06:06Z",
      "updated_at": "2022-05-27T17:15:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r883793744",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/883793744"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 349,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884686588",
      "pull_request_review_id": 989151574,
      "id": 884686588,
      "node_id": "PRRC_kwDOABII5840uz78",
      "diff_hunk": "@@ -334,19 +339,20 @@ namespace BCLog {\n     }\n } // namespace BCLog\n \n-void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line, const BCLog::LogFlags category, const BCLog::Level level)\n+void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const SourceLocation& source_location, const BCLog::LogFlags category, const BCLog::Level level)\n {\n     StdLockGuard scoped_lock(m_cs);\n     std::string str_prefixed = LogEscapeMessage(str);\n \n-    if ((category != LogFlags::NONE || level != Level::None) && m_started_new_line) {\n+    const bool print_category{category != LogFlags::NONE && category != LogFlags::UNCONDITIONAL_ALWAYS && category != LogFlags::UNCONDITIONAL_RATE_LIMITED};",
      "path": "src/logging.cpp",
      "position": 50,
      "original_position": 48,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "9d84cb2cd20d7951682ca8415488ed96a5f2cf1c",
      "in_reply_to_id": 883793744,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "There are still tests that log using NONE:\r\nhttps://github.com/bitcoin/bitcoin/blob/a6377c5fe4f8d8fabbae527df888afdd9c6f771a/src/test/logging_tests.cpp#L80-L81\r\n\r\nWhat do you think of removing the NONE category entirely?",
      "created_at": "2022-05-30T10:39:03Z",
      "updated_at": "2022-05-30T10:39:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r884686588",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884686588"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 349,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884712427",
      "pull_request_review_id": 989187978,
      "id": 884712427,
      "node_id": "PRRC_kwDOABII5840u6Pr",
      "diff_hunk": "@@ -334,19 +339,20 @@ namespace BCLog {\n     }\n } // namespace BCLog\n \n-void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const std::string& source_file, const int source_line, const BCLog::LogFlags category, const BCLog::Level level)\n+void BCLog::Logger::LogPrintStr(const std::string& str, const std::string& logging_function, const SourceLocation& source_location, const BCLog::LogFlags category, const BCLog::Level level)\n {\n     StdLockGuard scoped_lock(m_cs);\n     std::string str_prefixed = LogEscapeMessage(str);\n \n-    if ((category != LogFlags::NONE || level != Level::None) && m_started_new_line) {\n+    const bool print_category{category != LogFlags::NONE && category != LogFlags::UNCONDITIONAL_ALWAYS && category != LogFlags::UNCONDITIONAL_RATE_LIMITED};",
      "path": "src/logging.cpp",
      "position": 50,
      "original_position": 48,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "9d84cb2cd20d7951682ca8415488ed96a5f2cf1c",
      "in_reply_to_id": 883793744,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think those should be replaced with `LogPrintf_(..., BCLog::LogFlags::UNCONDITIONAL_ALWAYS, ...)`, since it's impossible for `LogPrintf_(..., BCLog::LogFlags::NONE, ...)` to be called in the produce code.\r\n\r\nIt seems fine to remove `BCLog::LogFlags::NONE` after that, but I don't think it's necessary in this PR.",
      "created_at": "2022-05-30T11:10:49Z",
      "updated_at": "2022-05-30T11:10:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r884712427",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884712427"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 349,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884717374",
      "pull_request_review_id": 989195045,
      "id": 884717374,
      "node_id": "PRRC_kwDOABII5840u7c-",
      "diff_hunk": "@@ -7,7 +7,6 @@\n #include <logging.h>\n #include <util/threadnames.h>\n #include <util/string.h>\n-#include <util/time.h>",
      "path": "src/logging.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a6377c5fe4f8d8fabbae527df888afdd9c6f771a",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why are you removing this include when it is needed?",
      "created_at": "2022-05-30T11:17:17Z",
      "updated_at": "2022-05-30T11:33:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r884717374",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884717374"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 10,
      "original_line": 10,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884721244",
      "pull_request_review_id": 989195045,
      "id": 884721244,
      "node_id": "PRRC_kwDOABII5840u8Zc",
      "diff_hunk": "@@ -75,6 +105,47 @@ namespace BCLog {\n         Error = 4,\n     };\n \n+    static constexpr LogFlags DEFAULT_LOG_FLAGS{UNCONDITIONAL_RATE_LIMITED | UNCONDITIONAL_ALWAYS};\n+\n+    //! Fixed window rate limiter for logging.\n+    class LogRateLimiter\n+    {\n+    private:\n+        //! Timestamp of the last window reset.\n+        std::chrono::seconds m_last_reset;\n+        //! Remaining bytes in the current window interval.\n+        uint64_t m_available_bytes;\n+        //! Number of bytes that were not consumed within the current window.\n+        uint64_t m_dropped_bytes{0};\n+        //! Reset the window if the window interval has passed since the last reset.\n+        void MaybeReset();\n+\n+    public:\n+        //! Interval after which the window is reset.\n+        static constexpr std::chrono::hours WINDOW_SIZE{1};\n+        //! The maximum number of bytes that can be logged within one window.\n+        static constexpr uint64_t WINDOW_MAX_BYTES{1024 * 1024};\n+\n+        LogRateLimiter()\n+            : m_last_reset{GetTime<std::chrono::seconds>()},\n+              m_available_bytes{WINDOW_MAX_BYTES} {}",
      "path": "src/logging.h",
      "position": null,
      "original_position": 153,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a6377c5fe4f8d8fabbae527df888afdd9c6f771a",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could drop this and use C++11 member init?",
      "created_at": "2022-05-30T11:22:16Z",
      "updated_at": "2022-05-30T11:33:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r884721244",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884721244"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 131,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884722666",
      "pull_request_review_id": 989195045,
      "id": 884722666,
      "node_id": "PRRC_kwDOABII5840u8vq",
      "diff_hunk": "@@ -75,6 +105,47 @@ namespace BCLog {\n         Error = 4,\n     };\n \n+    static constexpr LogFlags DEFAULT_LOG_FLAGS{UNCONDITIONAL_RATE_LIMITED | UNCONDITIONAL_ALWAYS};\n+\n+    //! Fixed window rate limiter for logging.\n+    class LogRateLimiter\n+    {\n+    private:\n+        //! Timestamp of the last window reset.\n+        std::chrono::seconds m_last_reset;",
      "path": "src/logging.h",
      "position": null,
      "original_position": 137,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a6377c5fe4f8d8fabbae527df888afdd9c6f771a",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        std::chrono::steady_clock::time_point m_last_reset{std::chrono::steady_clock::now()};\r\n```\r\n\r\nLooks like you are not mocking this in the tests, so could use steady clock?\r\n\r\nIf not, new code should probably use `NodeClock::now()` over `GetTime()`.",
      "created_at": "2022-05-30T11:24:07Z",
      "updated_at": "2022-05-30T11:33:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r884722666",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884722666"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884853910",
      "pull_request_review_id": 989385683,
      "id": 884853910,
      "node_id": "PRRC_kwDOABII5840vcyW",
      "diff_hunk": "@@ -7,7 +7,6 @@\n #include <logging.h>\n #include <util/threadnames.h>\n #include <util/string.h>\n-#include <util/time.h>",
      "path": "src/logging.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a6377c5fe4f8d8fabbae527df888afdd9c6f771a",
      "in_reply_to_id": 884717374,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I moved the include to `logging.h` where it is needed for `GetTime()` etc.",
      "created_at": "2022-05-30T13:51:47Z",
      "updated_at": "2022-05-30T13:51:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r884853910",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884853910"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 10,
      "original_line": 10,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884854133",
      "pull_request_review_id": 989386010,
      "id": 884854133,
      "node_id": "PRRC_kwDOABII5840vc11",
      "diff_hunk": "@@ -75,6 +105,47 @@ namespace BCLog {\n         Error = 4,\n     };\n \n+    static constexpr LogFlags DEFAULT_LOG_FLAGS{UNCONDITIONAL_RATE_LIMITED | UNCONDITIONAL_ALWAYS};\n+\n+    //! Fixed window rate limiter for logging.\n+    class LogRateLimiter\n+    {\n+    private:\n+        //! Timestamp of the last window reset.\n+        std::chrono::seconds m_last_reset;",
      "path": "src/logging.h",
      "position": null,
      "original_position": 137,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a6377c5fe4f8d8fabbae527df888afdd9c6f771a",
      "in_reply_to_id": 884722666,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changed it to use `NodeClock`.",
      "created_at": "2022-05-30T13:52:01Z",
      "updated_at": "2022-05-30T13:52:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r884854133",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884854133"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884859900",
      "pull_request_review_id": 989394005,
      "id": 884859900,
      "node_id": "PRRC_kwDOABII5840veP8",
      "diff_hunk": "@@ -7,7 +7,6 @@\n #include <logging.h>\n #include <util/threadnames.h>\n #include <util/string.h>\n-#include <util/time.h>",
      "path": "src/logging.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a6377c5fe4f8d8fabbae527df888afdd9c6f771a",
      "in_reply_to_id": 884717374,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "According to the dev notes and iwyu it will need to be included in both files if both files use it.",
      "created_at": "2022-05-30T13:58:04Z",
      "updated_at": "2022-05-30T13:58:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r884859900",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884859900"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 10,
      "original_line": 10,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884863156",
      "pull_request_review_id": 989398798,
      "id": 884863156,
      "node_id": "PRRC_kwDOABII5840vfC0",
      "diff_hunk": "@@ -7,7 +7,6 @@\n #include <logging.h>\n #include <util/threadnames.h>\n #include <util/string.h>\n-#include <util/time.h>",
      "path": "src/logging.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "c86d5ff02a31322612555db559e1d97ef329e27f",
      "original_commit_id": "a6377c5fe4f8d8fabbae527df888afdd9c6f771a",
      "in_reply_to_id": 884717374,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah I wasn't aware, thanks for pointing this out. Will amend.",
      "created_at": "2022-05-30T14:01:46Z",
      "updated_at": "2022-05-30T14:01:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21603#discussion_r884863156",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/884863156"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21603"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 10,
      "original_line": 10,
      "side": "LEFT"
    }
  ]
}