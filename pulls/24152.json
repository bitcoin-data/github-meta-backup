{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
    "id": 831521938,
    "node_id": "PR_kwDOABII584xkASS",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/24152",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/24152.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/24152.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/9bebf35e269b2a918df27708565ecd0c5bd3f116",
    "number": 24152,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "policy / validation: CPFP fee bumping within packages",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Part of #22290, aka [Package Mempool Accept](https://gist.github.com/glozow/dc4e9d5c5b14ade7cdfac40f43adb18a).\r\n\r\nThis enables CPFP fee bumping in child-with-unconfirmed-parents packages by introducing [package feerate](https://gist.github.com/glozow/dc4e9d5c5b14ade7cdfac40f43adb18a#fee-related-checks-use-package-feerate) (total modified fees divided by total virtual size) and using it in place of individual feerate. We also always [validate individual transactions first](https://gist.github.com/glozow/dc4e9d5c5b14ade7cdfac40f43adb18a#always-try-individual-submission-first) to avoid incentive-incompatible policies like \"parents pay for children\" or \"siblings pay for siblings\" behavior.",
    "labels": [
      {
        "id": 82428251,
        "node_id": "MDU6TGFiZWw4MjQyODI1MQ==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/TX%20fees%20and%20policy",
        "name": "TX fees and policy",
        "color": "5319e7",
        "default": false
      },
      {
        "id": 118379652,
        "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
        "name": "Validation",
        "color": "6060aa",
        "default": false
      }
    ],
    "created_at": "2022-01-25T14:32:10Z",
    "updated_at": "2022-06-10T12:58:15Z",
    "closed_at": "2022-04-07T09:06:02Z",
    "mergeable_state": "unknown",
    "merged_at": "2022-04-07T09:06:02Z",
    "merge_commit_sha": "d844b5e7999419de82bfe6cbc7c9f0b7848248ef",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "glozow:package-cpfp",
      "ref": "package-cpfp",
      "sha": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 244262754,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNDQyNjI3NTQ=",
        "name": "bitcoin",
        "full_name": "glozow/bitcoin",
        "owner": {
          "login": "glozow",
          "id": 25183001,
          "node_id": "MDQ6VXNlcjI1MTgzMDAx",
          "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/glozow",
          "html_url": "https://github.com/glozow",
          "followers_url": "https://api.github.com/users/glozow/followers",
          "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
          "organizations_url": "https://api.github.com/users/glozow/orgs",
          "repos_url": "https://api.github.com/users/glozow/repos",
          "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/glozow/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/glozow/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/glozow/bitcoin",
        "archive_url": "https://api.github.com/repos/glozow/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/glozow/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/glozow/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/glozow/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/glozow/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/glozow/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/glozow/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/glozow/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/glozow/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/glozow/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/glozow/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/glozow/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/glozow/bitcoin/events",
        "forks_url": "https://api.github.com/repos/glozow/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/glozow/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/glozow/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/glozow/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/glozow/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/glozow/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/glozow/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/glozow/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/glozow/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/glozow/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/glozow/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/glozow/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/glozow/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/glozow/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/glozow/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/glozow/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:glozow/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/glozow/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/glozow/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/glozow/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/glozow/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/glozow/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/glozow/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/glozow/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/glozow/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/glozow/bitcoin/hooks",
        "svn_url": "https://github.com/glozow/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 7,
        "watchers_count": 7,
        "size": 225090,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-02T10:00:34Z",
        "created_at": "2020-03-02T02:31:56Z",
        "updated_at": "2022-01-07T17:55:23Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "15220ec9039ac330dbc6fd53fa06424cde04d0b6",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34324,
        "stargazers_count": 69819,
        "watchers_count": 69819,
        "size": 233879,
        "default_branch": "master",
        "open_issues_count": 627,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-07T05:35:10Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-07T04:47:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 362,
    "deletions": 21,
    "changed_files": 5,
    "commits": 5,
    "review_comments": 65,
    "comments": 20
  },
  "events": [
    {
      "event": "labeled",
      "id": 5950830503,
      "node_id": "LE_lADOABII585CZbTCzwAAAAFisnen",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5950830503",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-25T15:38:45Z",
      "label": {
        "name": "TX fees and policy",
        "color": "5319e7"
      }
    },
    {
      "event": "labeled",
      "id": 5951275768,
      "node_id": "LE_lADOABII585CZbTCzwAAAAFiuUL4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5951275768",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-25T16:40:31Z",
      "label": {
        "name": "Validation",
        "color": "6060aa"
      }
    },
    {
      "event": "commented",
      "id": 1021726430,
      "node_id": "IC_kwDOABII58485k7e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021726430",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-26T00:08:41Z",
      "updated_at": "2022-04-03T19:35:09Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24007](https://github.com/bitcoin/bitcoin/pull/24007) ([mempool] allow tx replacement by smaller witness by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1021726430",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "reviewed",
      "id": 877471788,
      "node_id": "PRR_kwDOABII5840TSgs",
      "url": null,
      "actor": null,
      "commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nleft a few comments below",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-877471788",
      "submitted_at": "2022-02-09T18:03:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "reviewed",
      "id": 877867313,
      "node_id": "PRR_kwDOABII5840UzEx",
      "url": null,
      "actor": null,
      "commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-877867313",
      "submitted_at": "2022-02-09T18:19:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "reviewed",
      "id": 878118993,
      "node_id": "PRR_kwDOABII5840VwhR",
      "url": null,
      "actor": null,
      "commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-878118993",
      "submitted_at": "2022-02-09T22:17:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "commented",
      "id": 1034278526,
      "node_id": "IC_kwDOABII5849pdZ-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1034278526",
      "actor": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-09T22:50:03Z",
      "updated_at": "2022-02-09T22:51:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nBuilt on MacOS Big Sur, ran unit tests (diagrams from [PR review club](https://bitcoincore.reviews/24152) are helpful here illustrating each unit test). Ideally I'd play around with these but just read through and ran them today. Didn't run the fuzz tests but the fuzzer seems to be failing on the CI.\r\n\r\nI asked about DoS vectors for CPFP in today's PR review club as that seems the greatest hurdle to get over for updated RBF rules and package RBF but seem to be less of a concern with CPFP (?). Not sure whether the CPFP carve out rule needs to be tweaked when CPFPing within a package?\r\n\r\nGreat to see this series of PRs progress. \r\n\r\n",
      "user": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1034278526",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "reviewed",
      "id": 878210505,
      "node_id": "PRR_kwDOABII5840WG3J",
      "url": null,
      "actor": null,
      "commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-878210505",
      "submitted_at": "2022-02-10T00:54:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "comment_deleted",
      "id": 6041213089,
      "node_id": "CDE_lADOABII585CZbTCzwAAAAFoFZih",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041213089",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T11:05:26Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6041273227,
      "node_id": "HRFPE_lADOABII585CZbTCzwAAAAFoFoOL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041273227",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T11:14:06Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6041512369,
      "node_id": "HRFPE_lADOABII585CZbTCzwAAAAFoGimx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041512369",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T11:48:57Z"
    },
    {
      "event": "commented",
      "id": 1034853086,
      "node_id": "IC_kwDOABII5849rpre",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1034853086",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T12:15:23Z",
      "updated_at": "2022-02-10T12:15:23Z",
      "author_association": "MEMBER",
      "body": "Thanks @ariard @mzumsande @LarryRuane @michaelfolkson! Addressed your review comments. Clarified the documentation, adjusted the fuzz/tx_pool, and added the test for negative prioritisation.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1034853086",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "mentioned",
      "id": 6041687623,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAFoHNZH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041687623",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T12:15:23Z"
    },
    {
      "event": "subscribed",
      "id": 6041687631,
      "node_id": "SE_lADOABII585CZbTCzwAAAAFoHNZP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041687631",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T12:15:23Z"
    },
    {
      "event": "mentioned",
      "id": 6041687646,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAFoHNZe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041687646",
      "actor": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T12:15:23Z"
    },
    {
      "event": "subscribed",
      "id": 6041687659,
      "node_id": "SE_lADOABII585CZbTCzwAAAAFoHNZr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041687659",
      "actor": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T12:15:24Z"
    },
    {
      "event": "mentioned",
      "id": 6041687676,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAFoHNZ8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041687676",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T12:15:24Z"
    },
    {
      "event": "subscribed",
      "id": 6041687682,
      "node_id": "SE_lADOABII585CZbTCzwAAAAFoHNaC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041687682",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T12:15:24Z"
    },
    {
      "event": "mentioned",
      "id": 6041687689,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAFoHNaJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041687689",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T12:15:24Z"
    },
    {
      "event": "subscribed",
      "id": 6041687697,
      "node_id": "SE_lADOABII585CZbTCzwAAAAFoHNaR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6041687697",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T12:15:24Z"
    },
    {
      "event": "commented",
      "id": 1035964288,
      "node_id": "IC_kwDOABII5849v4-A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1035964288",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-11T08:09:58Z",
      "updated_at": "2022-02-11T08:09:58Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1035964288",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "commented",
      "id": 1037566659,
      "node_id": "IC_kwDOABII58492ALD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1037566659",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-12T23:19:39Z",
      "updated_at": "2022-02-12T23:19:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1037566659",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "referenced",
      "id": 6116457030,
      "node_id": "REFE_lADOABII585CZbTCzwAAAAFskbpG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6116457030",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "bc49650b7c1240b076849bd805ac10e403764c33",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/bc49650b7c1240b076849bd805ac10e403764c33",
      "created_at": "2022-02-22T09:17:10Z"
    },
    {
      "event": "labeled",
      "id": 6116658506,
      "node_id": "LE_lADOABII585CZbTCzwAAAAFslM1K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6116658506",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-22T09:46:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1047617839,
      "node_id": "IC_kwDOABII584-cWEv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1047617839",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-22T09:55:49Z",
      "updated_at": "2022-02-22T09:55:49Z",
      "author_association": "MEMBER",
      "body": "Rebased",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1047617839",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6116727476,
      "node_id": "HRFPE_lADOABII585CZbTCzwAAAAFsldq0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6116727476",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-22T09:55:59Z"
    },
    {
      "event": "unlabeled",
      "id": 6117476262,
      "node_id": "UNLE_lADOABII585CZbTCzwAAAAFsoUem",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6117476262",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-22T11:53:37Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "referenced",
      "id": 6119414287,
      "node_id": "REFE_lADOABII585CZbTCzwAAAAFsvtoP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6119414287",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "b2aae5647b3f312b8e5852f931be992a7b406ddd",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/b2aae5647b3f312b8e5852f931be992a7b406ddd",
      "created_at": "2022-02-22T16:35:01Z"
    },
    {
      "event": "reviewed",
      "id": 890450201,
      "node_id": "PRR_kwDOABII5841EzEZ",
      "url": null,
      "actor": null,
      "commit_id": "9001b9ab2ef4dd7c185f8055fe90bbac66c295c5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-890450201",
      "submitted_at": "2022-02-22T23:37:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6124886891,
      "node_id": "HRFPE_lADOABII585CZbTCzwAAAAFtEltr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6124886891",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-23T13:10:50Z"
    },
    {
      "event": "commented",
      "id": 1048925167,
      "node_id": "IC_kwDOABII584-hVPv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1048925167",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-23T15:49:02Z",
      "updated_at": "2022-02-23T15:49:02Z",
      "author_association": "MEMBER",
      "body": "Fixed the fuzzer issue, added a commit for quitting early if transactions fail for reasons other than policy or missing inputs.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1048925167",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "commented",
      "id": 1061590410,
      "node_id": "IC_kwDOABII584_RpWK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1061590410",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T09:45:46Z",
      "updated_at": "2022-03-08T09:45:46Z",
      "author_association": "MEMBER",
      "body": "pinging @ariard @darosior @LarryRuane @mzumsande if you have time to take another look? :)",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1061590410",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "mentioned",
      "id": 6201178071,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAFxnnfX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6201178071",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T09:45:47Z"
    },
    {
      "event": "subscribed",
      "id": 6201178084,
      "node_id": "SE_lADOABII585CZbTCzwAAAAFxnnfk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6201178084",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T09:45:47Z"
    },
    {
      "event": "mentioned",
      "id": 6201178098,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAFxnnfy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6201178098",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T09:45:47Z"
    },
    {
      "event": "subscribed",
      "id": 6201178108,
      "node_id": "SE_lADOABII585CZbTCzwAAAAFxnnf8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6201178108",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T09:45:47Z"
    },
    {
      "event": "mentioned",
      "id": 6201178118,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAFxnngG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6201178118",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T09:45:47Z"
    },
    {
      "event": "subscribed",
      "id": 6201178126,
      "node_id": "SE_lADOABII585CZbTCzwAAAAFxnngO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6201178126",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T09:45:47Z"
    },
    {
      "event": "mentioned",
      "id": 6201178136,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAFxnngY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6201178136",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T09:45:47Z"
    },
    {
      "event": "subscribed",
      "id": 6201178144,
      "node_id": "SE_lADOABII585CZbTCzwAAAAFxnngg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6201178144",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T09:45:47Z"
    },
    {
      "event": "reviewed",
      "id": 903741036,
      "node_id": "PRR_kwDOABII58413f5s",
      "url": null,
      "actor": null,
      "commit_id": "a70175076a5f85391a089607f6a19a58f173d4a1",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code Review ACK a7017507\r\n\r\nModifications since last review are typying arguments in `AcceptMultipleTransactions` and `quit_early` new a7017507 commit.",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-903741036",
      "submitted_at": "2022-03-09T00:29:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "labeled",
      "id": 6218983135,
      "node_id": "LE_lADOABII585CZbTCzwAAAAFyribf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6218983135",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-10T16:14:05Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6224203828,
      "node_id": "HRFPE_lADOABII585CZbTCzwAAAAFy_dA0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6224203828",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T11:24:41Z"
    },
    {
      "event": "commented",
      "id": 1065036238,
      "node_id": "IC_kwDOABII584_eynO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1065036238",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T11:41:32Z",
      "updated_at": "2022-03-11T11:41:32Z",
      "author_association": "MEMBER",
      "body": "Rebased",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1065036238",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "unlabeled",
      "id": 6224776622,
      "node_id": "UNLE_lADOABII585CZbTCzwAAAAFzBo2u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6224776622",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T13:13:45Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 907163525,
      "node_id": "PRR_kwDOABII5842EjeF",
      "url": null,
      "actor": null,
      "commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "WIP review, looked at the doc and starting trying to grok the tests",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-907163525",
      "submitted_at": "2022-03-11T13:34:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "reviewed",
      "id": 918083714,
      "node_id": "PRR_kwDOABII5842uNiC",
      "url": null,
      "actor": null,
      "commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "One thing I had to think really hard about (maybe it's just me) is the effect of deduplication. I pictured a package like A <-- B <-- C (A is B's parent, B is C's parent). What happens if (only) B is already in the mempool, so we deduplicate it out of the package? Then the package would consist of A <-- ??? <-- C, which is no longer a valid package.\r\n\r\nI think the answer to this is that if B is already in the mempool, then A _must_ also already be in the mempool, so it will be deduplicated out of the package _too_. (This wasn't obvious to me at first.) Or I guess A could be mined, so the package would end up being just C, which is not actually a package (which is okay, evaluate C on its own). In any event, deduplication only removes from the \"left\" (if you view the transactions payments as flowing left to right as I've done here) -- it can't remove from the middle of this big DAG (well, it can't be a big DAG yet, but will in the future).\r\n\r\nOne other comment, and again, it may just be me, but it may not be obvious to the uninitiated why package relay is needed at all. Taking the most basic single parent and single child case, if the parent's fee is so low that it drops out of the mempool (or at least many nodes' mempools), then why not just reconstitute the parent with a higher fee and broadcast this new transaction? Why is a child even needed?\r\n\r\nI _think_ the answer (and correct me if I'm wrong) is that the parent transaction's broadcaster may not _be able_ to create a new version of the parent transaction. It may have been signed by other parties, and they're not around (or aren't willing) to sign a replacement transaction. In L2 applications especially, this transaction may have been formed months ago.\r\n\r\nI'm not sure if I'm suggesting any changes to this document, but you may want to consider trying to get this concept across (if my understanding is correct).",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-918083714",
      "submitted_at": "2022-03-23T03:39:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "reviewed",
      "id": 918836947,
      "node_id": "PRR_kwDOABII5842xFbT",
      "url": null,
      "actor": null,
      "commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Thanks @LarryRuane for the thoughtful review.\r\n\r\n> One thing I had to think really hard about (maybe it's just me) is the effect of deduplication.  I pictured a package like A <-- B <-- C (A is B's parent, B is C's parent)...\r\n\r\nNote that A<-B<-C is already not a valid package with these rules; it would fail `IsChildWithParents`. I'll continue with this example considering just A<-B.\r\n\r\nYou are correct that if B is already in the mempool, A (and any other ancestors or transactions to the \"left\") must either be in the mempool or already confirmed. Unfortunately, we cannot query with absolute certainty if a transaction has already confirmed, which is why the rule is it must be a child with all *unconfirmed* parents. The only possibilities for B already being in the mempool are:\r\n\r\n1. A in mempool, B in mempool. We deduplicate both; the package is already in.\r\n2. A confirmed, B in mempool. We fail on `package-not-child-with-unconfirmed-parents` because A's inputs were not available. This is correct, since a *confirmed* parent of B was included in the package.\r\n\r\n> why not just reconstitute the parent with a higher fee and broadcast this new transaction? Why is a child even needed? I think the answer (and correct me if I'm wrong) is that the parent transaction's broadcaster may not be able to...\r\n\r\nYou are correct.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-918836947",
      "submitted_at": "2022-03-23T14:19:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "reviewed",
      "id": 923777051,
      "node_id": "PRR_kwDOABII5843D7gb",
      "url": null,
      "actor": null,
      "commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review, tested ACK dc0b2d3fa375ec0641bd2075a99be0383d1129ee\r\n\r\nSuggestions are optional.\r\n\r\nRegarding your reply to my earlier [comment](https://github.com/bitcoin/bitcoin/pull/24152#discussion_r832775358):\r\n\r\n> there are cases where it [my little strawman algorithm] doesn't work [for the general case]\r\n\r\nThanks, you're right, I see now that this trivial algorithm is definitely wrong. This made me think about the general case more carefully, and I ended up writing a little Python demo to help with my understanding. This in no way affects the current PR (which is excellent as-is), but anyone interested in this topic may find this useful, and it may be helpful in writing a future PR if we want to generalize the allowed package forms:\r\n\r\nhttps://github.com/LarryRuane/bitcoin_package_accept_demo\r\n\r\n",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-923777051",
      "submitted_at": "2022-03-29T19:10:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "labeled",
      "id": 6350483177,
      "node_id": "LE_lADOABII585CZbTCzwAAAAF6hK7p",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6350483177",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-01T08:32:49Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA5ZjMyY2ZmYTZjM2U4YjJkNzcyODFhNTk4M2ZmZThmNDgyYTU5NDU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/09f32cffa6c3e8b2d77281a5983ffe8f482a5945",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/09f32cffa6c3e8b2d77281a5983ffe8f482a5945",
      "tree": {
        "sha": "f3709e43756de4f53ced28fed45dc30717035575",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f3709e43756de4f53ced28fed45dc30717035575"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a7f0c37c2baea0e8b1da3cc24e7c2a9963745a0c",
          "sha": "a7f0c37c2baea0e8b1da3cc24e7c2a9963745a0c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a7f0c37c2baea0e8b1da3cc24e7c2a9963745a0c"
        }
      ],
      "message": "[docs] package feerate",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-04-01T18:14:57Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-01-21T13:48:27Z"
      },
      "sha": "09f32cffa6c3e8b2d77281a5983ffe8f482a5945"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6354453008,
      "node_id": "HRFPE_lADOABII585CZbTCzwAAAAF6wUIQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6354453008",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-01T18:36:52Z"
    },
    {
      "event": "commented",
      "id": 1086215631,
      "node_id": "IC_kwDOABII585AvlXP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1086215631",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-01T18:36:56Z",
      "updated_at": "2022-04-01T18:36:56Z",
      "author_association": "MEMBER",
      "body": "Rebased and addressed @jonatack and @LarryRuane's comments",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1086215631",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "mentioned",
      "id": 6354453395,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF6wUOT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6354453395",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-01T18:36:56Z"
    },
    {
      "event": "subscribed",
      "id": 6354453401,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF6wUOZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6354453401",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-01T18:36:56Z"
    },
    {
      "event": "mentioned",
      "id": 6354453411,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF6wUOj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6354453411",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-01T18:36:56Z"
    },
    {
      "event": "subscribed",
      "id": 6354453418,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF6wUOq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6354453418",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-01T18:36:56Z"
    },
    {
      "event": "unlabeled",
      "id": 6354566116,
      "node_id": "UNLE_lADOABII585CZbTCzwAAAAF6wvvk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6354566116",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-01T19:00:26Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1086913299,
      "node_id": "IC_kwDOABII585AyPsT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1086913299",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-03T17:27:56Z",
      "updated_at": "2022-04-03T17:28:05Z",
      "author_association": "MEMBER",
      "body": "Code Review ACK a7017507\r\n\r\nModifications since last review are extending `ATMPArgs` private ctor extension with `m_package_feerates` and changes in the unit tests.",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1086913299",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "commented",
      "id": 1086925127,
      "node_id": "IC_kwDOABII585AySlH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1086925127",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-03T18:40:31Z",
      "updated_at": "2022-04-03T18:40:31Z",
      "author_association": "MEMBER",
      "body": "cc @darosior @t-bast ",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1086925127",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "mentioned",
      "id": 6358638667,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF7ASBL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6358638667",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-03T18:40:31Z"
    },
    {
      "event": "subscribed",
      "id": 6358638668,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF7ASBM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6358638668",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-03T18:40:31Z"
    },
    {
      "event": "mentioned",
      "id": 6358638671,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF7ASBP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6358638671",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-03T18:40:31Z"
    },
    {
      "event": "subscribed",
      "id": 6358638673,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF7ASBR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6358638673",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-03T18:40:31Z"
    },
    {
      "event": "reviewed",
      "id": 929898693,
      "node_id": "PRR_kwDOABII5843bSDF",
      "url": null,
      "actor": null,
      "commit_id": "157a7bb547abc90a8bbb595cdee8eaac9c3300c9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK https://github.com/bitcoin/bitcoin/pull/24152/commits/157a7bb547abc90a8bbb595cdee8eaac9c3300c9, nice set of unit tests :+1: ",
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-929898693",
      "submitted_at": "2022-04-04T06:51:24Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "review_requested",
      "id": 6362184674,
      "node_id": "RRE_lADOABII585CZbTCzwAAAAF7Nzvi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6362184674",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T11:28:10Z",
      "requested_reviewer": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "commented",
      "id": 1087673261,
      "node_id": "IC_kwDOABII585A1JOt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1087673261",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T15:05:45Z",
      "updated_at": "2022-04-04T15:05:45Z",
      "author_association": "MEMBER",
      "body": "Out of scope for now but dropped a message on the gist itself https://gist.github.com/glozow/dc4e9d5c5b14ade7cdfac40f43adb18a\r\n\r\nI see no reason for this(possibly wrongly perceived) shortfall to stop incremental improvements",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1087673261",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "commented",
      "id": 1087704320,
      "node_id": "IC_kwDOABII585A1Q0A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1087704320",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T15:30:08Z",
      "updated_at": "2022-04-04T15:30:08Z",
      "author_association": "MEMBER",
      "body": "> Out of scope for now but dropped a message on the gist itself\n\nWill respond on the gist. I don't think it's relevant to packages actually.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1087704320",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "mentioned",
      "id": 6364138769,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF7VQ0R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6364138769",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T15:31:57Z"
    },
    {
      "event": "subscribed",
      "id": 6364138792,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF7VQ0o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6364138792",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T15:31:57Z"
    },
    {
      "event": "commented",
      "id": 1087731272,
      "node_id": "IC_kwDOABII585A1XZI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1087731272",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T15:56:18Z",
      "updated_at": "2022-04-04T15:56:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Rebased and addressed @jonatack and @LarryRuane's comments\r\n\r\nThanks, suggestion for future, make the rebase and address-review-comments two separate force-pushes for easier review.",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1087731272",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "mentioned",
      "id": 6364324008,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF7V-Co",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6364324008",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T15:56:19Z"
    },
    {
      "event": "subscribed",
      "id": 6364324021,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF7V-C1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6364324021",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T15:56:19Z"
    },
    {
      "event": "mentioned",
      "id": 6364324034,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF7V-DC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6364324034",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T15:56:19Z"
    },
    {
      "event": "subscribed",
      "id": 6364324043,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF7V-DL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6364324043",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T15:56:19Z"
    },
    {
      "event": "reviewed",
      "id": 930626807,
      "node_id": "PRR_kwDOABII5843eDz3",
      "url": null,
      "actor": null,
      "commit_id": "157a7bb547abc90a8bbb595cdee8eaac9c3300c9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "code review ACK 157a7bb547abc90a8bbb595cdee8eaac9c3300c9\r\n\r\ndocs are clear re:design, tests look fairly comprehensive, nice step forward",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-930626807",
      "submitted_at": "2022-04-04T16:06:17Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "commented",
      "id": 1087953513,
      "node_id": "IC_kwDOABII585A2Npp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1087953513",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T19:56:35Z",
      "updated_at": "2022-04-04T19:56:35Z",
      "author_association": "MEMBER",
      "body": "> Code Review ACK https://github.com/bitcoin/bitcoin/commit/a70175076a5f85391a089607f6a19a58f173d4a1\r\n\r\n@ariard seems you ACKed an old commit? A rebase + small changes since then, should be pretty easy to review `git range-diff a701750...157a7bb`",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1087953513",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "mentioned",
      "id": 6365836031,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF7bvL_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6365836031",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T19:56:35Z"
    },
    {
      "event": "subscribed",
      "id": 6365836041,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF7bvMJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6365836041",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T19:56:36Z"
    },
    {
      "event": "reviewed",
      "id": 930808243,
      "node_id": "PRR_kwDOABII5843ewGz",
      "url": null,
      "actor": null,
      "commit_id": "157a7bb547abc90a8bbb595cdee8eaac9c3300c9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Reviewed again and it looks good to me, just two questions before I ACK:\r\n\r\nCould this introduce some weird behavior for the `testmempoolaccept` RPC? That RPC bypasses `AcceptPackage()` and calls `AcceptMultipleTransactions()` directly, which now has logic to calculate a package feerate (and possibly return a related error) which only makes sense for the special case of a \"exactly one child and its parents\" package that `AcceptPackage()`  ensures.\r\n\r\nAnother question about RBF below.\r\n",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-930808243",
      "submitted_at": "2022-04-04T20:50:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6375120065,
      "node_id": "HRFPE_lADOABII585CZbTCzwAAAAF7_JzB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6375120065",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-05T22:50:04Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE3YThmZmQ4MDIwMzc1ZDYwNDI4Njk1ODU4NTU4ZjJiZTI2NGFhMzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/17a8ffd8020375d60428695858558f2be264aa36",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/17a8ffd8020375d60428695858558f2be264aa36",
      "tree": {
        "sha": "8ee0339a63128cb71f5118d64b4bb1cc3781e48c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8ee0339a63128cb71f5118d64b4bb1cc3781e48c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/09f32cffa6c3e8b2d77281a5983ffe8f482a5945",
          "sha": "09f32cffa6c3e8b2d77281a5983ffe8f482a5945",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/09f32cffa6c3e8b2d77281a5983ffe8f482a5945"
        }
      ],
      "message": "[packages/policy] use package feerate in package validation\n\nThis allows CPFP within a package prior to submission to mempool.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-04-05T22:51:37Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2021-07-20T12:26:26Z"
      },
      "sha": "17a8ffd8020375d60428695858558f2be264aa36"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFiOTM3NDhjOTM3ZTg3MGU3NTc0YThlMTIwYTg1YmVlNmY5MDEzZmY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1b93748c937e870e7574a8e120a85bee6f9013ff",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1b93748c937e870e7574a8e120a85bee6f9013ff",
      "tree": {
        "sha": "d9b93020e1d810a3126c4ae7f31f904f3e58f701",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d9b93020e1d810a3126c4ae7f31f904f3e58f701"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/17a8ffd8020375d60428695858558f2be264aa36",
          "sha": "17a8ffd8020375d60428695858558f2be264aa36",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/17a8ffd8020375d60428695858558f2be264aa36"
        }
      ],
      "message": "[validation] try individual validation before package validation\n\nThis avoids \"parents pay for children\" and \"siblings pay for siblings\"\nbehavior, since package feerate is calculated with totals and is\ntopology-unaware.\n\nIt also ensures that package validation never causes us to reject a\ntransaction that we would have otherwise accepted in single-tx\nvalidation.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-04-05T22:51:37Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-01-25T11:39:03Z"
      },
      "sha": "1b93748c937e870e7574a8e120a85bee6f9013ff"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDUxZWRjZmZhMGUxNTZkYmEwNjE5MWE4ZDVjNjM2YmEwMWZhNWI2NWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/51edcffa0e156dba06191a8d5c636ba01fa5b65f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/51edcffa0e156dba06191a8d5c636ba01fa5b65f",
      "tree": {
        "sha": "57288d17611fb3e0b33bb510cb4443a66ebd4993",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/57288d17611fb3e0b33bb510cb4443a66ebd4993"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1b93748c937e870e7574a8e120a85bee6f9013ff",
          "sha": "1b93748c937e870e7574a8e120a85bee6f9013ff",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1b93748c937e870e7574a8e120a85bee6f9013ff"
        }
      ],
      "message": "[unit test] package feerate and package cpfp",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-04-05T22:51:37Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-01-25T11:58:36Z"
      },
      "sha": "51edcffa0e156dba06191a8d5c636ba01fa5b65f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDliZWJmMzVlMjY5YjJhOTE4ZGYyNzcwODU2NWVjZDBjNWJkM2YxMTY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "tree": {
        "sha": "569ab91409c871b51c131f3a9667c9f91aef44a8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/569ab91409c871b51c131f3a9667c9f91aef44a8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/51edcffa0e156dba06191a8d5c636ba01fa5b65f",
          "sha": "51edcffa0e156dba06191a8d5c636ba01fa5b65f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/51edcffa0e156dba06191a8d5c636ba01fa5b65f"
        }
      ],
      "message": "[validation] don't package validate if not policy or missing inputs\n\nPackage validation policy only differs from individual policy in its\nevaluation of feerate. Minimize DoS surface; don't validate all over\nagain if we know the result will be the same.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-04-05T22:51:37Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2022-02-23T11:42:33Z"
      },
      "sha": "9bebf35e269b2a918df27708565ecd0c5bd3f116"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6375168331,
      "node_id": "HRFPE_lADOABII585CZbTCzwAAAAF7_VlL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6375168331",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-05T22:53:28Z"
    },
    {
      "event": "commented",
      "id": 1089490321,
      "node_id": "IC_kwDOABII585A8E2R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1089490321",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-05T22:58:26Z",
      "updated_at": "2022-04-05T22:58:26Z",
      "author_association": "MEMBER",
      "body": "In response to @mzumsande's (very good) questions, I have made these 2 changes:\r\n\r\n`ATMPArgs::PackageTestAccept.m_package_feerates=false` because there is no child-with-parents restriction (it accepts completely independent transactions), which means package feerate isn't very meaningful and we shouldn't use it in `CheckFeeRate()`.\r\n\r\n`ATMPArgs::SingleInPackageAccept.m_allow_bip125_replacement=true` because RBF should be allowed for the individual transactions.\r\n\r\nAlso addressed @LarryRuane's https://github.com/bitcoin/bitcoin/pull/24152#discussion_r836867916 which I forgot to address last time.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1089490321",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "mentioned",
      "id": 6375234728,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF7_lyo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6375234728",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-05T22:58:26Z"
    },
    {
      "event": "subscribed",
      "id": 6375234733,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF7_lyt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6375234733",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-05T22:58:26Z"
    },
    {
      "event": "mentioned",
      "id": 6375234753,
      "node_id": "MEE_lADOABII585CZbTCzwAAAAF7_lzB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6375234753",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-05T22:58:27Z"
    },
    {
      "event": "subscribed",
      "id": 6375234756,
      "node_id": "SE_lADOABII585CZbTCzwAAAAF7_lzE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6375234756",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-05T22:58:27Z"
    },
    {
      "event": "commented",
      "id": 1090376715,
      "node_id": "IC_kwDOABII585A_dQL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1090376715",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-06T15:03:28Z",
      "updated_at": "2022-04-06T15:03:28Z",
      "author_association": "MEMBER",
      "body": "changes are the aforementioned `ATMPArgs::PackageTestAccept.m_package_feerates=false` \r\n, `ATMPArgs::SingleInPackageAccept.m_allow_bip125_replacement=true`, and the has_value change.\r\n\r\nreACK https://github.com/bitcoin/bitcoin/pull/24152/commits/9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1090376715",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "review_requested",
      "id": 6381157902,
      "node_id": "RRE_lADOABII585CZbTCzwAAAAF8WL4O",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6381157902",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-06T15:29:21Z",
      "requested_reviewer": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 6381159408,
      "node_id": "RRE_lADOABII585CZbTCzwAAAAF8WMPw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6381159408",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-06T15:29:33Z",
      "requested_reviewer": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "commented",
      "id": 1090928415,
      "node_id": "IC_kwDOABII585BBj8f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1090928415",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-06T23:39:03Z",
      "updated_at": "2022-04-06T23:39:03Z",
      "author_association": "MEMBER",
      "body": "Code review ACK 9bebf35e269b2a918df27708565ecd0c5bd3f116 \r\nI am not extremely experienced with this area of code, but all changes make sense to me.\r\nI verified via git range-diff that the only changes compared to my review from yesterday are those explained above (ATMPArgs and std::optional changes).",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1090928415",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "reviewed",
      "id": 934619550,
      "node_id": "PRR_kwDOABII5843tSme",
      "url": null,
      "actor": null,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK https://github.com/bitcoin/bitcoin/pull/24152/commits/9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-934619550",
      "submitted_at": "2022-04-07T07:45:33Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "merged",
      "id": 6386535533,
      "node_id": "ME_lADOABII585CZbTCzwAAAAF8qsxt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6386535533",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "d844b5e7999419de82bfe6cbc7c9f0b7848248ef",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d844b5e7999419de82bfe6cbc7c9f0b7848248ef",
      "created_at": "2022-04-07T09:06:02Z"
    },
    {
      "event": "closed",
      "id": 6386535571,
      "node_id": "CE_lADOABII585CZbTCzwAAAAF8qsyT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6386535571",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-07T09:06:02Z"
    },
    {
      "event": "referenced",
      "id": 6387752123,
      "node_id": "REFE_lADOABII585CZbTCzwAAAAF8vVy7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6387752123",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "f87f25948a3b43d55c74d4f988a6f16f11649341",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/f87f25948a3b43d55c74d4f988a6f16f11649341",
      "created_at": "2022-04-07T11:52:24Z"
    },
    {
      "event": "referenced",
      "id": 6388969235,
      "node_id": "REFE_lADOABII585CZbTCzwAAAAF8z-8T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6388969235",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "bcd8fc83766a651a61c62ed1e3f744ebf102c1a5",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/bcd8fc83766a651a61c62ed1e3f744ebf102c1a5",
      "created_at": "2022-04-07T14:12:43Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 6397809627,
      "node_id": "HRDE_lADOABII585CZbTCzwAAAAF9VtPb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6397809627",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-08T16:30:57Z"
    },
    {
      "event": "commented",
      "id": 1097071793,
      "node_id": "IC_kwDOABII585BY_yx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1097071793",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-12T18:39:52Z",
      "updated_at": "2022-04-12T18:39:52Z",
      "author_association": "MEMBER",
      "body": "Post-Merge Review ACK 9bebf35e\r\n\r\nChanges since last ACK are turning `m_packages_feerates` to `false` for `PackageTestAccept` and authorizing bip 125 replacement for `SingleInPackageAccept`. ",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1097071793",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24152"
    },
    {
      "event": "referenced",
      "id": 6439319416,
      "node_id": "REFE_lADOABII585CZbTCzwAAAAF_0Dd4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6439319416",
      "actor": {
        "login": "russeree",
        "id": 3104223,
        "node_id": "MDQ6VXNlcjMxMDQyMjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3104223?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/russeree",
        "html_url": "https://github.com/russeree",
        "followers_url": "https://api.github.com/users/russeree/followers",
        "following_url": "https://api.github.com/users/russeree/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/russeree/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/russeree/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/russeree/subscriptions",
        "organizations_url": "https://api.github.com/users/russeree/orgs",
        "repos_url": "https://api.github.com/users/russeree/repos",
        "events_url": "https://api.github.com/users/russeree/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/russeree/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "c4e34158423e33e5faef3226d3fd6b34a1a5eef6",
      "commit_url": "https://api.github.com/repos/russeree/bitcoin/commits/c4e34158423e33e5faef3226d3fd6b34a1a5eef6",
      "created_at": "2022-04-15T08:14:38Z"
    },
    {
      "event": "referenced",
      "id": 6439553644,
      "node_id": "REFE_lADOABII585CZbTCzwAAAAF_08ps",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6439553644",
      "actor": {
        "login": "russeree",
        "id": 3104223,
        "node_id": "MDQ6VXNlcjMxMDQyMjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3104223?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/russeree",
        "html_url": "https://github.com/russeree",
        "followers_url": "https://api.github.com/users/russeree/followers",
        "following_url": "https://api.github.com/users/russeree/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/russeree/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/russeree/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/russeree/subscriptions",
        "organizations_url": "https://api.github.com/users/russeree/orgs",
        "repos_url": "https://api.github.com/users/russeree/repos",
        "events_url": "https://api.github.com/users/russeree/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/russeree/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ac83524b2006a0c20ed603023d4fe7885e648e98",
      "commit_url": "https://api.github.com/repos/russeree/bitcoin/commits/ac83524b2006a0c20ed603023d4fe7885e648e98",
      "created_at": "2022-04-15T09:13:15Z"
    },
    {
      "event": "reviewed",
      "id": 989689132,
      "node_id": "PRR_kwDOABII5846_XUs",
      "url": null,
      "actor": null,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "~~I think the package feerate check shouldn't be in `AcceptMultipleTransactions`, since it doesn't necessarily take a child-with-parents package.~~\r\n\r\n~~(sorry, i know i'm late to the party)~~\r\n\r\nEDIT: aarg. I was reviewing an older branch which didn't have the fix for `m_package_feerates` in `PackageTestAccept` (https://github.com/bitcoin/bitcoin/pull/24152#discussion_r843317502)... Sorry for the noise.\r\n\r\n",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-989689132",
      "submitted_at": "2022-06-09T17:33:58Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    },
    {
      "event": "reviewed",
      "id": 1002728279,
      "node_id": "PRR_kwDOABII5847xGtX",
      "url": null,
      "actor": null,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Post-merge ACK 9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-1002728279",
      "submitted_at": "2022-06-10T12:58:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802669892",
      "pull_request_review_id": 877471788,
      "id": 802669892,
      "node_id": "PRRC_kwDOABII584v18VE",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 29,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fee-bump **for** transaction B",
      "created_at": "2022-02-09T13:38:53Z",
      "updated_at": "2022-02-09T18:03:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802669892",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802669892"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802723149",
      "pull_request_review_id": 877471788,
      "id": 802723149,
      "node_id": "PRRC_kwDOABII584v2JVN",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 8,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's not really clear at this point of the document what \"deduplication\" means - I think both removal of transaction already in the mempool, and removal of package txs that would also get accepted individually. The *Rationale* section on this only mentions the first. Maybe add an explanation/pointer to the following section.",
      "created_at": "2022-02-09T14:31:46Z",
      "updated_at": "2022-02-09T18:03:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802723149",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802723149"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 64,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802799166",
      "pull_request_review_id": 877471788,
      "id": 802799166,
      "node_id": "PRRC_kwDOABII584v2b4-",
      "diff_hunk": "@@ -1199,6 +1211,21 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n         m_viewmempool.PackageAddTransaction(ws.m_ptx);\n     }\n \n+    // Transactions must meet two minimum feerates: the mempool minimum fee and min relay fee.\n+    // For transactions consisting of exactly one child and its parents, it suffices to use the\n+    // package feerate (total modified fees / total virtual size) to check this requirement.\n+    m_total_vsize = std::accumulate(workspaces.cbegin(), workspaces.cend(), 0,\n+        [](int64_t sum, auto& ws) { return sum + ws.m_vsize; });\n+    m_total_modified_fees = std::accumulate(workspaces.cbegin(), workspaces.cend(), 0,\n+        [](CAmount sum, auto& ws) { return sum + ws.m_modified_fees; });\n+    const CFeeRate package_feerate(m_total_modified_fees, m_total_vsize);\n+    TxValidationState placeholder_state;\n+    if (args.m_package_feerates &&\n+        !CheckFeeRate(m_total_vsize, m_total_modified_fees, placeholder_state)) {\n+        package_state.Invalid(PackageValidationResult::PCKG_POLICY, \"package-fee-too-low\");\n+        return PackageMempoolAcceptResult(package_state, package_feerate, {});",
      "path": "src/validation.cpp",
      "position": 97,
      "original_position": 76,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "f90b6c52681c4a7968c2467641a383f1fc1991d2",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Now that a PackageMempoolAcceptResult with empty `m_tx_results` is returned if the fee is too low, the `tx_pool_standard` fuzz test needs an update, because it [asserts](https://github.com/bitcoin/bitcoin/blob/5e8e0b3d7f6055e326bda61e60712b530e8920f0/src/test/fuzz/tx_pool.cpp#L242) non-emptiness.",
      "created_at": "2022-02-09T15:39:09Z",
      "updated_at": "2022-02-09T18:03:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802799166",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802799166"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1243,
      "original_line": 1243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802851282",
      "pull_request_review_id": 877471788,
      "id": 802851282,
      "node_id": "PRRC_kwDOABII584v2onS",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.\n+Package feerate, as defined above, does not consider the fees and relationships between all\n+transactions in the package. We want to prevent \"parents pay for children\" behavior; fees of",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 31,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "this sentence confused me at first because it seems to describe the very use case of CPFP where a high fee of a child does impact the consideration of a parent - maybe \"insufficient fees of children should...\"",
      "created_at": "2022-02-09T16:24:46Z",
      "updated_at": "2022-02-09T18:03:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802851282",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802851282"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802858141",
      "pull_request_review_id": 877471788,
      "id": 802858141,
      "node_id": "PRRC_kwDOABII584v2qSd",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.\n+Package feerate, as defined above, does not consider the fees and relationships between all\n+transactions in the package. We want to prevent \"parents pay for children\" behavior; fees of\n+children should have no impact on the consideration of their parents, since they are not necessary\n+for the parents to be mined. More generally, if transaction B is not needed in order for transaction\n+A to be mined, B's fees cannot help A. In a child-with-parents package, simply excluding any parent",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 34,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "shouldn't this be \"A's fees cannot help B\"?",
      "created_at": "2022-02-09T16:29:52Z",
      "updated_at": "2022-02-09T18:03:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802858141",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802858141"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 90,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802872913",
      "pull_request_review_id": 877471788,
      "id": 802872913,
      "node_id": "PRRC_kwDOABII584v2t5R",
      "diff_hunk": "@@ -649,6 +656,10 @@ class MemPoolAccept\n \n     CChainState& m_active_chainstate;\n \n+    // Used to calculate package feerate.\n+    CAmount m_total_modified_fees;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 40,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "f90b6c52681c4a7968c2467641a383f1fc1991d2",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could `m_total_modified_fees` and  `m_total_vsize` just be local variables? They seem to be used only in `MemPoolAccept::AcceptMultipleTransactions`.",
      "created_at": "2022-02-09T16:43:22Z",
      "updated_at": "2022-02-09T18:03:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802872913",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802872913"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 660,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802952279",
      "pull_request_review_id": 877867313,
      "id": 802952279,
      "node_id": "PRRC_kwDOABII584v3BRX",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 29,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit, most examples seem to designate a parent as A and its child as B (which I like, because that corresponds to time-order, first A, then B), but this seems to be reversed? I believe a few lines below, the convention I'm suggesting is followed, (A is parent, B is child). Also, should \"transaction B\" be \"transaction for B\"?",
      "created_at": "2022-02-09T18:07:18Z",
      "updated_at": "2022-02-09T18:19:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802952279",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802952279"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802954740",
      "pull_request_review_id": 877867313,
      "id": 802954740,
      "node_id": "PRRC_kwDOABII584v3B30",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 7,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is okay, but when I first read this, I had no idea what \"modified\" meant (only learning later that the `prioritisetransaction` RPC does the modifying); perhaps \"modified\" can be dropped? I think it's implicit. Or maybe briefly mention the RPC here.",
      "created_at": "2022-02-09T18:10:16Z",
      "updated_at": "2022-02-09T18:19:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802954740",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802954740"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802955759",
      "pull_request_review_id": 877867313,
      "id": 802955759,
      "node_id": "PRRC_kwDOABII584v3CHv",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 8,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's unclear to me what \"deduplication\" means here. I thought a package, by definition, contains no duplicate transactions.",
      "created_at": "2022-02-09T18:11:30Z",
      "updated_at": "2022-02-09T18:19:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802955759",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802955759"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 64,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803135521",
      "pull_request_review_id": 878118993,
      "id": 803135521,
      "node_id": "PRRC_kwDOABII584v3uAh",
      "diff_hunk": "@@ -557,6 +577,182 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Even though the parent pays 0 absolute fees, the child pays 1 BTC which is enough for the\n+    // package feerate to meet the threshold.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_state.IsValid(),\n+                            \"Package validation unexpectedly failed: \" << submit_cpfp.m_state.GetRejectReason());\n+        auto it_parent = submit_cpfp.m_tx_results.find(tx_parent->GetWitnessHash());\n+        auto it_child = submit_cpfp.m_tx_results.find(tx_child->GetWitnessHash());\n+        BOOST_CHECK(it_parent != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_parent->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_parent->second.m_base_fees.value() == 0);\n+        BOOST_CHECK(it_child != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_child->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_child->second.m_base_fees.value() == COIN);\n+\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_parent->GetHash())));\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_child->GetHash())));\n+\n+        const CFeeRate expected_feerate(coinbase_value - child_value,\n+                                        GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() > 1000);\n+        BOOST_CHECK(submit_cpfp.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_cpfp.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Just because we allow low-fee parents doesn't mean we allow low-feerate packages.\n+    // This package just pays 200 satoshis total. This would be enough to pay for the child alone,\n+    // but isn't enough for the entire package to meet the 1sat/vbyte minimum.\n+    Package package_still_too_low;\n+    auto mtx_parent_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[1], /*vout=*/ 0,\n+                                                          /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                          /*output_destination=*/ parent_spk,\n+                                                          /*output_amount=*/ coinbase_value, /*submit=*/ false);\n+    CTransactionRef tx_parent_cheap = MakeTransactionRef(mtx_parent_cheap);\n+    package_still_too_low.push_back(tx_parent_cheap);\n+\n+    auto mtx_child_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent_cheap, /*vout=*/ 0,\n+                                                         /*input_height=*/ 101, /* input_signing_key */ child_key,\n+                                                         /*output_destination=*/ child_spk,\n+                                                         /*output_amount=*/ coinbase_value - 200, /*submit=*/ false);\n+    CTransactionRef tx_child_cheap = MakeTransactionRef(mtx_child_cheap);\n+    package_still_too_low.push_back(tx_child_cheap);\n+\n+    // Cheap package should fail with package-fee-too-low.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_package_too_low = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_still_too_low, /* test_accept */ false);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_state.IsInvalid(), \"Package validation unexpectedly succeeded\");\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetRejectReason(), \"package-fee-too-low\");\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate child_feerate(200, GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(child_feerate.GetFeePerK() > 1000);\n+        const CFeeRate expected_feerate(200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() < 1000);\n+        BOOST_CHECK(submit_package_too_low.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_package_too_low.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate includes the modified fees of the transactions.\n+    // This means a child with its fee delta from prioritisetransaction can pay for a parent.\n+    m_node.mempool->PrioritiseTransaction(tx_child_cheap->GetHash(), 1 * COIN);\n+    // Now that the child's fees have \"increased\" by 1 BTC, the cheap package should succeed.\n+    {\n+        const auto submit_prioritised_package = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                                  package_still_too_low, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_state.IsValid(),\n+                \"Package validation unexpectedly failed\" << submit_prioritised_package.m_state.GetRejectReason());\n+        const CFeeRate expected_feerate(1 * COIN + 200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(submit_prioritised_package.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_prioritised_package.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate is calculated without topology in mind; it's just aggregating fees and sizes.\n+    // However, this should not allow parents to pay for children. Each transaction should be",
      "path": "src/test/txpackage_tests.cpp",
      "position": 274,
      "original_position": 249,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": null,
      "user": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "\"However, this should not allow parents to pay for children\"\r\n\r\nThis reads to me like \"parents must not pay for children\". When it is more (to my understanding), parents must be validated first before considering children. If the parent(s) is accepted into the mempool first a low fee child can later join them as part of a sufficient fee package but a low fee child must not prevent a sufficient fee parent from being accepted into the mempool. That's right yeah?",
      "created_at": "2022-02-09T22:17:13Z",
      "updated_at": "2022-02-09T22:17:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803135521",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803135521"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 744,
      "original_line": 744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803207380",
      "pull_request_review_id": 878210505,
      "id": 803207380,
      "node_id": "PRRC_kwDOABII584v3_jU",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.\n+Package feerate, as defined above, does not consider the fees and relationships between all\n+transactions in the package. We want to prevent \"parents pay for children\" behavior; fees of\n+children should have no impact on the consideration of their parents, since they are not necessary\n+for the parents to be mined. More generally, if transaction B is not needed in order for transaction\n+A to be mined, B's fees cannot help A. In a child-with-parents package, simply excluding any parent\n+transactions that meet feerate requirements individually is sufficient to ensure this.\n+\n+*Rationale*: For backwards-compatibility of transaction relay policy, it's important that package",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 37,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "i agree as a design principle that backwards-compatibility of transaction relay policy is worthwhile.\r\n\r\nThat said, we might have in the future to make exceptions to that principle, where a transaction/package might be relayed across non-upgraded nodes though rejected by upgraded nodes. E.g I'm thinking if replace-by-feerate is deployed instead of replace-by-fee, you might have a (2000 sats; 10 sat/vB) transaction replacing a (5000 sats; 5 sat/vB) already-in-mempool one (even if we can envision some transition period with dual-support).\r\n\r\nThus I'm suggesting to enlighten the wording here, \"As a principle, backwards-compatibility of transaction relay policy is prioritized\", \"we prevent non-programmed restriction of policy\". Especially as all those questions of policy loosening/tightening and how the project operates them are relatively young, I think it's cautious to be more formal in the phrasing. Thereby avoiding in the future ecosystems users to claim an adamant stability of Core policy rules, like in the zero-conf/full-rbf past polemics.",
      "created_at": "2022-02-10T00:39:42Z",
      "updated_at": "2022-02-10T00:54:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803207380",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803207380"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 93,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803208009",
      "pull_request_review_id": 878210505,
      "id": 803208009,
      "node_id": "PRRC_kwDOABII584v3_tJ",
      "diff_hunk": "@@ -557,6 +577,182 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Even though the parent pays 0 absolute fees, the child pays 1 BTC which is enough for the\n+    // package feerate to meet the threshold.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_state.IsValid(),\n+                            \"Package validation unexpectedly failed: \" << submit_cpfp.m_state.GetRejectReason());\n+        auto it_parent = submit_cpfp.m_tx_results.find(tx_parent->GetWitnessHash());\n+        auto it_child = submit_cpfp.m_tx_results.find(tx_child->GetWitnessHash());\n+        BOOST_CHECK(it_parent != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_parent->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_parent->second.m_base_fees.value() == 0);\n+        BOOST_CHECK(it_child != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_child->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_child->second.m_base_fees.value() == COIN);\n+\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_parent->GetHash())));\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_child->GetHash())));\n+\n+        const CFeeRate expected_feerate(coinbase_value - child_value,\n+                                        GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() > 1000);\n+        BOOST_CHECK(submit_cpfp.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_cpfp.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Just because we allow low-fee parents doesn't mean we allow low-feerate packages.\n+    // This package just pays 200 satoshis total. This would be enough to pay for the child alone,\n+    // but isn't enough for the entire package to meet the 1sat/vbyte minimum.\n+    Package package_still_too_low;\n+    auto mtx_parent_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[1], /*vout=*/ 0,\n+                                                          /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                          /*output_destination=*/ parent_spk,\n+                                                          /*output_amount=*/ coinbase_value, /*submit=*/ false);\n+    CTransactionRef tx_parent_cheap = MakeTransactionRef(mtx_parent_cheap);\n+    package_still_too_low.push_back(tx_parent_cheap);\n+\n+    auto mtx_child_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent_cheap, /*vout=*/ 0,\n+                                                         /*input_height=*/ 101, /* input_signing_key */ child_key,\n+                                                         /*output_destination=*/ child_spk,\n+                                                         /*output_amount=*/ coinbase_value - 200, /*submit=*/ false);\n+    CTransactionRef tx_child_cheap = MakeTransactionRef(mtx_child_cheap);\n+    package_still_too_low.push_back(tx_child_cheap);\n+\n+    // Cheap package should fail with package-fee-too-low.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_package_too_low = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_still_too_low, /* test_accept */ false);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_state.IsInvalid(), \"Package validation unexpectedly succeeded\");\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetRejectReason(), \"package-fee-too-low\");\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate child_feerate(200, GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(child_feerate.GetFeePerK() > 1000);\n+        const CFeeRate expected_feerate(200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() < 1000);\n+        BOOST_CHECK(submit_package_too_low.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_package_too_low.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate includes the modified fees of the transactions.\n+    // This means a child with its fee delta from prioritisetransaction can pay for a parent.\n+    m_node.mempool->PrioritiseTransaction(tx_child_cheap->GetHash(), 1 * COIN);",
      "path": "src/test/txpackage_tests.cpp",
      "position": 257,
      "original_position": 232,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "From checking `prioritisetransaction` documentation, I think it's a valid behavior to subtract fees from a transaction, thus altering `ProcessNewPackage` result. If you think it's a case worthy to cover.",
      "created_at": "2022-02-10T00:41:05Z",
      "updated_at": "2022-02-10T00:54:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803208009",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803208009"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 727,
      "original_line": 727,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803499685",
      "pull_request_review_id": 878595870,
      "id": 803499685,
      "node_id": "PRRC_kwDOABII584v5G6l",
      "diff_hunk": "@@ -557,6 +577,182 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Even though the parent pays 0 absolute fees, the child pays 1 BTC which is enough for the\n+    // package feerate to meet the threshold.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_state.IsValid(),\n+                            \"Package validation unexpectedly failed: \" << submit_cpfp.m_state.GetRejectReason());\n+        auto it_parent = submit_cpfp.m_tx_results.find(tx_parent->GetWitnessHash());\n+        auto it_child = submit_cpfp.m_tx_results.find(tx_child->GetWitnessHash());\n+        BOOST_CHECK(it_parent != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_parent->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_parent->second.m_base_fees.value() == 0);\n+        BOOST_CHECK(it_child != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_child->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_child->second.m_base_fees.value() == COIN);\n+\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_parent->GetHash())));\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_child->GetHash())));\n+\n+        const CFeeRate expected_feerate(coinbase_value - child_value,\n+                                        GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() > 1000);\n+        BOOST_CHECK(submit_cpfp.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_cpfp.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Just because we allow low-fee parents doesn't mean we allow low-feerate packages.\n+    // This package just pays 200 satoshis total. This would be enough to pay for the child alone,\n+    // but isn't enough for the entire package to meet the 1sat/vbyte minimum.\n+    Package package_still_too_low;\n+    auto mtx_parent_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[1], /*vout=*/ 0,\n+                                                          /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                          /*output_destination=*/ parent_spk,\n+                                                          /*output_amount=*/ coinbase_value, /*submit=*/ false);\n+    CTransactionRef tx_parent_cheap = MakeTransactionRef(mtx_parent_cheap);\n+    package_still_too_low.push_back(tx_parent_cheap);\n+\n+    auto mtx_child_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent_cheap, /*vout=*/ 0,\n+                                                         /*input_height=*/ 101, /* input_signing_key */ child_key,\n+                                                         /*output_destination=*/ child_spk,\n+                                                         /*output_amount=*/ coinbase_value - 200, /*submit=*/ false);\n+    CTransactionRef tx_child_cheap = MakeTransactionRef(mtx_child_cheap);\n+    package_still_too_low.push_back(tx_child_cheap);\n+\n+    // Cheap package should fail with package-fee-too-low.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_package_too_low = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_still_too_low, /* test_accept */ false);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_state.IsInvalid(), \"Package validation unexpectedly succeeded\");\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetRejectReason(), \"package-fee-too-low\");\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate child_feerate(200, GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(child_feerate.GetFeePerK() > 1000);\n+        const CFeeRate expected_feerate(200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() < 1000);\n+        BOOST_CHECK(submit_package_too_low.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_package_too_low.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate includes the modified fees of the transactions.\n+    // This means a child with its fee delta from prioritisetransaction can pay for a parent.\n+    m_node.mempool->PrioritiseTransaction(tx_child_cheap->GetHash(), 1 * COIN);",
      "path": "src/test/txpackage_tests.cpp",
      "position": 257,
      "original_position": 232,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": 803208009,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good idea! I will add a test for this.",
      "created_at": "2022-02-10T10:02:45Z",
      "updated_at": "2022-02-10T10:02:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803499685",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803499685"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 727,
      "original_line": 727,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803511729",
      "pull_request_review_id": 878612319,
      "id": 803511729,
      "node_id": "PRRC_kwDOABII584v5J2x",
      "diff_hunk": "@@ -557,6 +577,182 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Even though the parent pays 0 absolute fees, the child pays 1 BTC which is enough for the\n+    // package feerate to meet the threshold.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_state.IsValid(),\n+                            \"Package validation unexpectedly failed: \" << submit_cpfp.m_state.GetRejectReason());\n+        auto it_parent = submit_cpfp.m_tx_results.find(tx_parent->GetWitnessHash());\n+        auto it_child = submit_cpfp.m_tx_results.find(tx_child->GetWitnessHash());\n+        BOOST_CHECK(it_parent != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_parent->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_parent->second.m_base_fees.value() == 0);\n+        BOOST_CHECK(it_child != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_child->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_child->second.m_base_fees.value() == COIN);\n+\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_parent->GetHash())));\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_child->GetHash())));\n+\n+        const CFeeRate expected_feerate(coinbase_value - child_value,\n+                                        GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() > 1000);\n+        BOOST_CHECK(submit_cpfp.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_cpfp.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Just because we allow low-fee parents doesn't mean we allow low-feerate packages.\n+    // This package just pays 200 satoshis total. This would be enough to pay for the child alone,\n+    // but isn't enough for the entire package to meet the 1sat/vbyte minimum.\n+    Package package_still_too_low;\n+    auto mtx_parent_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[1], /*vout=*/ 0,\n+                                                          /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                          /*output_destination=*/ parent_spk,\n+                                                          /*output_amount=*/ coinbase_value, /*submit=*/ false);\n+    CTransactionRef tx_parent_cheap = MakeTransactionRef(mtx_parent_cheap);\n+    package_still_too_low.push_back(tx_parent_cheap);\n+\n+    auto mtx_child_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent_cheap, /*vout=*/ 0,\n+                                                         /*input_height=*/ 101, /* input_signing_key */ child_key,\n+                                                         /*output_destination=*/ child_spk,\n+                                                         /*output_amount=*/ coinbase_value - 200, /*submit=*/ false);\n+    CTransactionRef tx_child_cheap = MakeTransactionRef(mtx_child_cheap);\n+    package_still_too_low.push_back(tx_child_cheap);\n+\n+    // Cheap package should fail with package-fee-too-low.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_package_too_low = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_still_too_low, /* test_accept */ false);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_state.IsInvalid(), \"Package validation unexpectedly succeeded\");\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetRejectReason(), \"package-fee-too-low\");\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate child_feerate(200, GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(child_feerate.GetFeePerK() > 1000);\n+        const CFeeRate expected_feerate(200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() < 1000);\n+        BOOST_CHECK(submit_package_too_low.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_package_too_low.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate includes the modified fees of the transactions.\n+    // This means a child with its fee delta from prioritisetransaction can pay for a parent.\n+    m_node.mempool->PrioritiseTransaction(tx_child_cheap->GetHash(), 1 * COIN);\n+    // Now that the child's fees have \"increased\" by 1 BTC, the cheap package should succeed.\n+    {\n+        const auto submit_prioritised_package = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                                  package_still_too_low, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_state.IsValid(),\n+                \"Package validation unexpectedly failed\" << submit_prioritised_package.m_state.GetRejectReason());\n+        const CFeeRate expected_feerate(1 * COIN + 200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(submit_prioritised_package.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_prioritised_package.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate is calculated without topology in mind; it's just aggregating fees and sizes.\n+    // However, this should not allow parents to pay for children. Each transaction should be",
      "path": "src/test/txpackage_tests.cpp",
      "position": 274,
      "original_position": 249,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": 803135521,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Our goals are:\r\n\r\n(1) If the child's feerate is too low to be accepted, the parent's fees should not be able to pay for it. A parent should not pay for a child, because the child is not necessary for the parent to be mined.\r\n\r\n(2) If the child's feerate is too low to be accepted, that should not prevent the parent from being accepted. A child's fees should not harm its parent, because the child is not necessary for the parent to be mined.\r\n\r\nValidating the parents individually first is _how_ we achieve these goals. It is not the goal itself.\r\n\r\n> This reads to me like \"parents must not pay for children\". When it is more (to my understanding), parents must be validated first before considering children.\r\n\r\nThis is a reversal of the goal/implementation relationship. We install seatbelts in the car (implementation) so that drivers are protected in accidents (goal). The goal is not to install seatbelts for no reason, it's to protect drivers.",
      "created_at": "2022-02-10T10:16:06Z",
      "updated_at": "2022-02-10T10:16:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803511729",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803511729"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 744,
      "original_line": 744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803543706",
      "pull_request_review_id": 878655662,
      "id": 803543706,
      "node_id": "PRRC_kwDOABII584v5Rqa",
      "diff_hunk": "@@ -557,6 +577,182 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Even though the parent pays 0 absolute fees, the child pays 1 BTC which is enough for the\n+    // package feerate to meet the threshold.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_state.IsValid(),\n+                            \"Package validation unexpectedly failed: \" << submit_cpfp.m_state.GetRejectReason());\n+        auto it_parent = submit_cpfp.m_tx_results.find(tx_parent->GetWitnessHash());\n+        auto it_child = submit_cpfp.m_tx_results.find(tx_child->GetWitnessHash());\n+        BOOST_CHECK(it_parent != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_parent->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_parent->second.m_base_fees.value() == 0);\n+        BOOST_CHECK(it_child != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_child->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_child->second.m_base_fees.value() == COIN);\n+\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_parent->GetHash())));\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_child->GetHash())));\n+\n+        const CFeeRate expected_feerate(coinbase_value - child_value,\n+                                        GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() > 1000);\n+        BOOST_CHECK(submit_cpfp.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_cpfp.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Just because we allow low-fee parents doesn't mean we allow low-feerate packages.\n+    // This package just pays 200 satoshis total. This would be enough to pay for the child alone,\n+    // but isn't enough for the entire package to meet the 1sat/vbyte minimum.\n+    Package package_still_too_low;\n+    auto mtx_parent_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[1], /*vout=*/ 0,\n+                                                          /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                          /*output_destination=*/ parent_spk,\n+                                                          /*output_amount=*/ coinbase_value, /*submit=*/ false);\n+    CTransactionRef tx_parent_cheap = MakeTransactionRef(mtx_parent_cheap);\n+    package_still_too_low.push_back(tx_parent_cheap);\n+\n+    auto mtx_child_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent_cheap, /*vout=*/ 0,\n+                                                         /*input_height=*/ 101, /* input_signing_key */ child_key,\n+                                                         /*output_destination=*/ child_spk,\n+                                                         /*output_amount=*/ coinbase_value - 200, /*submit=*/ false);\n+    CTransactionRef tx_child_cheap = MakeTransactionRef(mtx_child_cheap);\n+    package_still_too_low.push_back(tx_child_cheap);\n+\n+    // Cheap package should fail with package-fee-too-low.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_package_too_low = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_still_too_low, /* test_accept */ false);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_state.IsInvalid(), \"Package validation unexpectedly succeeded\");\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetRejectReason(), \"package-fee-too-low\");\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate child_feerate(200, GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(child_feerate.GetFeePerK() > 1000);\n+        const CFeeRate expected_feerate(200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() < 1000);\n+        BOOST_CHECK(submit_package_too_low.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_package_too_low.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate includes the modified fees of the transactions.\n+    // This means a child with its fee delta from prioritisetransaction can pay for a parent.\n+    m_node.mempool->PrioritiseTransaction(tx_child_cheap->GetHash(), 1 * COIN);\n+    // Now that the child's fees have \"increased\" by 1 BTC, the cheap package should succeed.\n+    {\n+        const auto submit_prioritised_package = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                                  package_still_too_low, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_state.IsValid(),\n+                \"Package validation unexpectedly failed\" << submit_prioritised_package.m_state.GetRejectReason());\n+        const CFeeRate expected_feerate(1 * COIN + 200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(submit_prioritised_package.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_prioritised_package.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate is calculated without topology in mind; it's just aggregating fees and sizes.\n+    // However, this should not allow parents to pay for children. Each transaction should be",
      "path": "src/test/txpackage_tests.cpp",
      "position": 274,
      "original_position": 249,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": 803135521,
      "user": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ok thanks. I understand why we'd want goal 2. What's the rationale for goal 1? Introduces too much complexity by reaching into the mempool to assess things not yet in the mempool? The parent is already in the mempool and what is in the mempool (parent) shouldn't impact what isn't in the mempool (child)?",
      "created_at": "2022-02-10T10:52:15Z",
      "updated_at": "2022-02-10T10:52:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803543706",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803543706"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 744,
      "original_line": 744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803552783",
      "pull_request_review_id": 878672854,
      "id": 803552783,
      "node_id": "PRRC_kwDOABII584v5T4P",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 29,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "in_reply_to_id": 802952279,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point, I guess that is convention now: ancestors < descendants alphanumerically.",
      "created_at": "2022-02-10T11:02:48Z",
      "updated_at": "2022-02-10T11:02:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803552783",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803552783"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803557914",
      "pull_request_review_id": 878679025,
      "id": 803557914,
      "node_id": "PRRC_kwDOABII584v5VIa",
      "diff_hunk": "@@ -557,6 +577,182 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Even though the parent pays 0 absolute fees, the child pays 1 BTC which is enough for the\n+    // package feerate to meet the threshold.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_state.IsValid(),\n+                            \"Package validation unexpectedly failed: \" << submit_cpfp.m_state.GetRejectReason());\n+        auto it_parent = submit_cpfp.m_tx_results.find(tx_parent->GetWitnessHash());\n+        auto it_child = submit_cpfp.m_tx_results.find(tx_child->GetWitnessHash());\n+        BOOST_CHECK(it_parent != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_parent->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_parent->second.m_base_fees.value() == 0);\n+        BOOST_CHECK(it_child != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_child->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_child->second.m_base_fees.value() == COIN);\n+\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_parent->GetHash())));\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_child->GetHash())));\n+\n+        const CFeeRate expected_feerate(coinbase_value - child_value,\n+                                        GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() > 1000);\n+        BOOST_CHECK(submit_cpfp.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_cpfp.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Just because we allow low-fee parents doesn't mean we allow low-feerate packages.\n+    // This package just pays 200 satoshis total. This would be enough to pay for the child alone,\n+    // but isn't enough for the entire package to meet the 1sat/vbyte minimum.\n+    Package package_still_too_low;\n+    auto mtx_parent_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[1], /*vout=*/ 0,\n+                                                          /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                          /*output_destination=*/ parent_spk,\n+                                                          /*output_amount=*/ coinbase_value, /*submit=*/ false);\n+    CTransactionRef tx_parent_cheap = MakeTransactionRef(mtx_parent_cheap);\n+    package_still_too_low.push_back(tx_parent_cheap);\n+\n+    auto mtx_child_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent_cheap, /*vout=*/ 0,\n+                                                         /*input_height=*/ 101, /* input_signing_key */ child_key,\n+                                                         /*output_destination=*/ child_spk,\n+                                                         /*output_amount=*/ coinbase_value - 200, /*submit=*/ false);\n+    CTransactionRef tx_child_cheap = MakeTransactionRef(mtx_child_cheap);\n+    package_still_too_low.push_back(tx_child_cheap);\n+\n+    // Cheap package should fail with package-fee-too-low.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_package_too_low = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_still_too_low, /* test_accept */ false);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_state.IsInvalid(), \"Package validation unexpectedly succeeded\");\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetRejectReason(), \"package-fee-too-low\");\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate child_feerate(200, GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(child_feerate.GetFeePerK() > 1000);\n+        const CFeeRate expected_feerate(200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() < 1000);\n+        BOOST_CHECK(submit_package_too_low.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_package_too_low.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate includes the modified fees of the transactions.\n+    // This means a child with its fee delta from prioritisetransaction can pay for a parent.\n+    m_node.mempool->PrioritiseTransaction(tx_child_cheap->GetHash(), 1 * COIN);\n+    // Now that the child's fees have \"increased\" by 1 BTC, the cheap package should succeed.\n+    {\n+        const auto submit_prioritised_package = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                                  package_still_too_low, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_state.IsValid(),\n+                \"Package validation unexpectedly failed\" << submit_prioritised_package.m_state.GetRejectReason());\n+        const CFeeRate expected_feerate(1 * COIN + 200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(submit_prioritised_package.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_prioritised_package.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate is calculated without topology in mind; it's just aggregating fees and sizes.\n+    // However, this should not allow parents to pay for children. Each transaction should be",
      "path": "src/test/txpackage_tests.cpp",
      "position": 274,
      "original_position": 249,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": 803135521,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "A parent should not pay for its child, because the child is not necessary for the parent to be mined. We get a better feerate if we just include the parent by itself.",
      "created_at": "2022-02-10T11:08:00Z",
      "updated_at": "2022-02-10T11:08:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803557914",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803557914"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 744,
      "original_line": 744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803560027",
      "pull_request_review_id": 878681224,
      "id": 803560027,
      "node_id": "PRRC_kwDOABII584v5Vpb",
      "diff_hunk": "@@ -557,6 +577,182 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Even though the parent pays 0 absolute fees, the child pays 1 BTC which is enough for the\n+    // package feerate to meet the threshold.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_state.IsValid(),\n+                            \"Package validation unexpectedly failed: \" << submit_cpfp.m_state.GetRejectReason());\n+        auto it_parent = submit_cpfp.m_tx_results.find(tx_parent->GetWitnessHash());\n+        auto it_child = submit_cpfp.m_tx_results.find(tx_child->GetWitnessHash());\n+        BOOST_CHECK(it_parent != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_parent->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_parent->second.m_base_fees.value() == 0);\n+        BOOST_CHECK(it_child != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_child->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_child->second.m_base_fees.value() == COIN);\n+\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_parent->GetHash())));\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_child->GetHash())));\n+\n+        const CFeeRate expected_feerate(coinbase_value - child_value,\n+                                        GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() > 1000);\n+        BOOST_CHECK(submit_cpfp.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_cpfp.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Just because we allow low-fee parents doesn't mean we allow low-feerate packages.\n+    // This package just pays 200 satoshis total. This would be enough to pay for the child alone,\n+    // but isn't enough for the entire package to meet the 1sat/vbyte minimum.\n+    Package package_still_too_low;\n+    auto mtx_parent_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[1], /*vout=*/ 0,\n+                                                          /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                          /*output_destination=*/ parent_spk,\n+                                                          /*output_amount=*/ coinbase_value, /*submit=*/ false);\n+    CTransactionRef tx_parent_cheap = MakeTransactionRef(mtx_parent_cheap);\n+    package_still_too_low.push_back(tx_parent_cheap);\n+\n+    auto mtx_child_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent_cheap, /*vout=*/ 0,\n+                                                         /*input_height=*/ 101, /* input_signing_key */ child_key,\n+                                                         /*output_destination=*/ child_spk,\n+                                                         /*output_amount=*/ coinbase_value - 200, /*submit=*/ false);\n+    CTransactionRef tx_child_cheap = MakeTransactionRef(mtx_child_cheap);\n+    package_still_too_low.push_back(tx_child_cheap);\n+\n+    // Cheap package should fail with package-fee-too-low.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_package_too_low = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_still_too_low, /* test_accept */ false);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_state.IsInvalid(), \"Package validation unexpectedly succeeded\");\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetRejectReason(), \"package-fee-too-low\");\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate child_feerate(200, GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(child_feerate.GetFeePerK() > 1000);\n+        const CFeeRate expected_feerate(200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() < 1000);\n+        BOOST_CHECK(submit_package_too_low.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_package_too_low.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate includes the modified fees of the transactions.\n+    // This means a child with its fee delta from prioritisetransaction can pay for a parent.\n+    m_node.mempool->PrioritiseTransaction(tx_child_cheap->GetHash(), 1 * COIN);\n+    // Now that the child's fees have \"increased\" by 1 BTC, the cheap package should succeed.\n+    {\n+        const auto submit_prioritised_package = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                                  package_still_too_low, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_state.IsValid(),\n+                \"Package validation unexpectedly failed\" << submit_prioritised_package.m_state.GetRejectReason());\n+        const CFeeRate expected_feerate(1 * COIN + 200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(submit_prioritised_package.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_prioritised_package.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate is calculated without topology in mind; it's just aggregating fees and sizes.\n+    // However, this should not allow parents to pay for children. Each transaction should be",
      "path": "src/test/txpackage_tests.cpp",
      "position": 274,
      "original_position": 249,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": 803135521,
      "user": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Or maybe because in the process of a child (subsidized by a parent) being accepted into the mempool the parent could be mined on its own and then the child would need to be kicked out the mempool? ",
      "created_at": "2022-02-10T11:10:01Z",
      "updated_at": "2022-02-10T11:10:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803560027",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803560027"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 744,
      "original_line": 744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803563613",
      "pull_request_review_id": 878684919,
      "id": 803563613,
      "node_id": "PRRC_kwDOABII584v5Whd",
      "diff_hunk": "@@ -557,6 +577,182 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Even though the parent pays 0 absolute fees, the child pays 1 BTC which is enough for the\n+    // package feerate to meet the threshold.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_state.IsValid(),\n+                            \"Package validation unexpectedly failed: \" << submit_cpfp.m_state.GetRejectReason());\n+        auto it_parent = submit_cpfp.m_tx_results.find(tx_parent->GetWitnessHash());\n+        auto it_child = submit_cpfp.m_tx_results.find(tx_child->GetWitnessHash());\n+        BOOST_CHECK(it_parent != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_parent->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_parent->second.m_base_fees.value() == 0);\n+        BOOST_CHECK(it_child != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_child->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_child->second.m_base_fees.value() == COIN);\n+\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_parent->GetHash())));\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_child->GetHash())));\n+\n+        const CFeeRate expected_feerate(coinbase_value - child_value,\n+                                        GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() > 1000);\n+        BOOST_CHECK(submit_cpfp.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_cpfp.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Just because we allow low-fee parents doesn't mean we allow low-feerate packages.\n+    // This package just pays 200 satoshis total. This would be enough to pay for the child alone,\n+    // but isn't enough for the entire package to meet the 1sat/vbyte minimum.\n+    Package package_still_too_low;\n+    auto mtx_parent_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[1], /*vout=*/ 0,\n+                                                          /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                          /*output_destination=*/ parent_spk,\n+                                                          /*output_amount=*/ coinbase_value, /*submit=*/ false);\n+    CTransactionRef tx_parent_cheap = MakeTransactionRef(mtx_parent_cheap);\n+    package_still_too_low.push_back(tx_parent_cheap);\n+\n+    auto mtx_child_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent_cheap, /*vout=*/ 0,\n+                                                         /*input_height=*/ 101, /* input_signing_key */ child_key,\n+                                                         /*output_destination=*/ child_spk,\n+                                                         /*output_amount=*/ coinbase_value - 200, /*submit=*/ false);\n+    CTransactionRef tx_child_cheap = MakeTransactionRef(mtx_child_cheap);\n+    package_still_too_low.push_back(tx_child_cheap);\n+\n+    // Cheap package should fail with package-fee-too-low.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_package_too_low = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_still_too_low, /* test_accept */ false);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_state.IsInvalid(), \"Package validation unexpectedly succeeded\");\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetRejectReason(), \"package-fee-too-low\");\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate child_feerate(200, GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(child_feerate.GetFeePerK() > 1000);\n+        const CFeeRate expected_feerate(200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() < 1000);\n+        BOOST_CHECK(submit_package_too_low.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_package_too_low.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate includes the modified fees of the transactions.\n+    // This means a child with its fee delta from prioritisetransaction can pay for a parent.\n+    m_node.mempool->PrioritiseTransaction(tx_child_cheap->GetHash(), 1 * COIN);\n+    // Now that the child's fees have \"increased\" by 1 BTC, the cheap package should succeed.\n+    {\n+        const auto submit_prioritised_package = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                                  package_still_too_low, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_state.IsValid(),\n+                \"Package validation unexpectedly failed\" << submit_prioritised_package.m_state.GetRejectReason());\n+        const CFeeRate expected_feerate(1 * COIN + 200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(submit_prioritised_package.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_prioritised_package.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate is calculated without topology in mind; it's just aggregating fees and sizes.\n+    // However, this should not allow parents to pay for children. Each transaction should be",
      "path": "src/test/txpackage_tests.cpp",
      "position": 274,
      "original_position": 249,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": 803135521,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "We shouldn't accept the child into the mempool if it doesn't meet the minimum feerate.",
      "created_at": "2022-02-10T11:13:24Z",
      "updated_at": "2022-02-10T11:13:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803563613",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803563613"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 744,
      "original_line": 744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803570323",
      "pull_request_review_id": 878692821,
      "id": 803570323,
      "node_id": "PRRC_kwDOABII584v5YKT",
      "diff_hunk": "@@ -557,6 +577,182 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Even though the parent pays 0 absolute fees, the child pays 1 BTC which is enough for the\n+    // package feerate to meet the threshold.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_state.IsValid(),\n+                            \"Package validation unexpectedly failed: \" << submit_cpfp.m_state.GetRejectReason());\n+        auto it_parent = submit_cpfp.m_tx_results.find(tx_parent->GetWitnessHash());\n+        auto it_child = submit_cpfp.m_tx_results.find(tx_child->GetWitnessHash());\n+        BOOST_CHECK(it_parent != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_parent->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_parent->second.m_base_fees.value() == 0);\n+        BOOST_CHECK(it_child != submit_cpfp.m_tx_results.end());\n+        BOOST_CHECK(it_child->second.m_result_type == MempoolAcceptResult::ResultType::VALID);\n+        BOOST_CHECK(it_child->second.m_base_fees.value() == COIN);\n+\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_parent->GetHash())));\n+        BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(tx_child->GetHash())));\n+\n+        const CFeeRate expected_feerate(coinbase_value - child_value,\n+                                        GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() > 1000);\n+        BOOST_CHECK(submit_cpfp.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_cpfp.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_cpfp.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Just because we allow low-fee parents doesn't mean we allow low-feerate packages.\n+    // This package just pays 200 satoshis total. This would be enough to pay for the child alone,\n+    // but isn't enough for the entire package to meet the 1sat/vbyte minimum.\n+    Package package_still_too_low;\n+    auto mtx_parent_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[1], /*vout=*/ 0,\n+                                                          /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                          /*output_destination=*/ parent_spk,\n+                                                          /*output_amount=*/ coinbase_value, /*submit=*/ false);\n+    CTransactionRef tx_parent_cheap = MakeTransactionRef(mtx_parent_cheap);\n+    package_still_too_low.push_back(tx_parent_cheap);\n+\n+    auto mtx_child_cheap = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent_cheap, /*vout=*/ 0,\n+                                                         /*input_height=*/ 101, /* input_signing_key */ child_key,\n+                                                         /*output_destination=*/ child_spk,\n+                                                         /*output_amount=*/ coinbase_value - 200, /*submit=*/ false);\n+    CTransactionRef tx_child_cheap = MakeTransactionRef(mtx_child_cheap);\n+    package_still_too_low.push_back(tx_child_cheap);\n+\n+    // Cheap package should fail with package-fee-too-low.\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_package_too_low = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_still_too_low, /* test_accept */ false);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_state.IsInvalid(), \"Package validation unexpectedly succeeded\");\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetResult(), PackageValidationResult::PCKG_POLICY);\n+        BOOST_CHECK_EQUAL(submit_package_too_low.m_state.GetRejectReason(), \"package-fee-too-low\");\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate child_feerate(200, GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(child_feerate.GetFeePerK() > 1000);\n+        const CFeeRate expected_feerate(200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(expected_feerate.GetFeePerK() < 1000);\n+        BOOST_CHECK(submit_package_too_low.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_package_too_low.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_package_too_low.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate includes the modified fees of the transactions.\n+    // This means a child with its fee delta from prioritisetransaction can pay for a parent.\n+    m_node.mempool->PrioritiseTransaction(tx_child_cheap->GetHash(), 1 * COIN);\n+    // Now that the child's fees have \"increased\" by 1 BTC, the cheap package should succeed.\n+    {\n+        const auto submit_prioritised_package = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                                  package_still_too_low, /*test_accept=*/ false);\n+        expected_pool_size += 2;\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_state.IsValid(),\n+                \"Package validation unexpectedly failed\" << submit_prioritised_package.m_state.GetRejectReason());\n+        const CFeeRate expected_feerate(1 * COIN + 200,\n+            GetVirtualTransactionSize(*tx_parent_cheap) + GetVirtualTransactionSize(*tx_child_cheap));\n+        BOOST_CHECK(submit_prioritised_package.m_package_feerate != std::nullopt);\n+        BOOST_CHECK_MESSAGE(submit_prioritised_package.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      submit_prioritised_package.m_package_feerate.value().ToString()));\n+    }\n+\n+    // Package feerate is calculated without topology in mind; it's just aggregating fees and sizes.\n+    // However, this should not allow parents to pay for children. Each transaction should be",
      "path": "src/test/txpackage_tests.cpp",
      "position": 274,
      "original_position": 249,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": 803135521,
      "user": {
        "login": "michaelfolkson",
        "id": 16323900,
        "node_id": "MDQ6VXNlcjE2MzIzOTAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/16323900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/michaelfolkson",
        "html_url": "https://github.com/michaelfolkson",
        "followers_url": "https://api.github.com/users/michaelfolkson/followers",
        "following_url": "https://api.github.com/users/michaelfolkson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/michaelfolkson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/michaelfolkson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/michaelfolkson/subscriptions",
        "organizations_url": "https://api.github.com/users/michaelfolkson/orgs",
        "repos_url": "https://api.github.com/users/michaelfolkson/repos",
        "events_url": "https://api.github.com/users/michaelfolkson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/michaelfolkson/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah its a miner's economic interest argument. Ok gotcha, makes sense. Thanks",
      "created_at": "2022-02-10T11:20:22Z",
      "updated_at": "2022-02-10T11:20:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803570323",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803570323"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 744,
      "original_line": 744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803610838",
      "pull_request_review_id": 878750098,
      "id": 803610838,
      "node_id": "PRRC_kwDOABII584v5iDW",
      "diff_hunk": "@@ -649,6 +656,10 @@ class MemPoolAccept\n \n     CChainState& m_active_chainstate;\n \n+    // Used to calculate package feerate.\n+    CAmount m_total_modified_fees;",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 40,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "f90b6c52681c4a7968c2467641a383f1fc1991d2",
      "in_reply_to_id": 802872913,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes good point, changed now. I originally added it as a member variable so we could reuse it in `PackageRBFChecks()` in the future, but we'll cross that bridge when we get there.",
      "created_at": "2022-02-10T12:12:49Z",
      "updated_at": "2022-02-10T12:12:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803610838",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803610838"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 660,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803610953",
      "pull_request_review_id": 878750274,
      "id": 803610953,
      "node_id": "PRRC_kwDOABII584v5iFJ",
      "diff_hunk": "@@ -1199,6 +1211,21 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n         m_viewmempool.PackageAddTransaction(ws.m_ptx);\n     }\n \n+    // Transactions must meet two minimum feerates: the mempool minimum fee and min relay fee.\n+    // For transactions consisting of exactly one child and its parents, it suffices to use the\n+    // package feerate (total modified fees / total virtual size) to check this requirement.\n+    m_total_vsize = std::accumulate(workspaces.cbegin(), workspaces.cend(), 0,\n+        [](int64_t sum, auto& ws) { return sum + ws.m_vsize; });\n+    m_total_modified_fees = std::accumulate(workspaces.cbegin(), workspaces.cend(), 0,\n+        [](CAmount sum, auto& ws) { return sum + ws.m_modified_fees; });\n+    const CFeeRate package_feerate(m_total_modified_fees, m_total_vsize);\n+    TxValidationState placeholder_state;\n+    if (args.m_package_feerates &&\n+        !CheckFeeRate(m_total_vsize, m_total_modified_fees, placeholder_state)) {\n+        package_state.Invalid(PackageValidationResult::PCKG_POLICY, \"package-fee-too-low\");\n+        return PackageMempoolAcceptResult(package_state, package_feerate, {});",
      "path": "src/validation.cpp",
      "position": 97,
      "original_position": 76,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "f90b6c52681c4a7968c2467641a383f1fc1991d2",
      "in_reply_to_id": 802799166,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ooooh good catch",
      "created_at": "2022-02-10T12:13:00Z",
      "updated_at": "2022-02-10T12:13:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803610953",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803610953"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1243,
      "original_line": 1243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803611173",
      "pull_request_review_id": 878750597,
      "id": 803611173,
      "node_id": "PRRC_kwDOABII584v5iIl",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 7,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "in_reply_to_id": 802954740,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Added explanation",
      "created_at": "2022-02-10T12:13:18Z",
      "updated_at": "2022-02-10T12:13:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803611173",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803611173"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803611542",
      "pull_request_review_id": 878751085,
      "id": 803611542,
      "node_id": "PRRC_kwDOABII584v5iOW",
      "diff_hunk": "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.\n+Package feerate, as defined above, does not consider the fees and relationships between all\n+transactions in the package. We want to prevent \"parents pay for children\" behavior; fees of\n+children should have no impact on the consideration of their parents, since they are not necessary\n+for the parents to be mined. More generally, if transaction B is not needed in order for transaction\n+A to be mined, B's fees cannot help A. In a child-with-parents package, simply excluding any parent\n+transactions that meet feerate requirements individually is sufficient to ensure this.\n+\n+*Rationale*: For backwards-compatibility of transaction relay policy, it's important that package",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 37,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "in_reply_to_id": 803207380,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agree, added a sentence at the beginning to this effect.",
      "created_at": "2022-02-10T12:13:48Z",
      "updated_at": "2022-02-10T12:13:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r803611542",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803611542"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 93,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/812421159",
      "pull_request_review_id": 890450201,
      "id": 812421159,
      "node_id": "PRRC_kwDOABII584wbJAn",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+Implementation Note: Transactions within a package are always validated individually first, and\n+package validation is used for the transactions that failed. Since package feerate is only\n+calculated using transactions that are not in the mempool, this implementation detail affects the\n+outcome of package validation.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping: transaction B is a\n+\"legitimate\" fee-bump for transaction A only if B is a descendant of A and has a *higher* feerate\n+than A. We want to prevent \"parents pay for children\" behavior; fees of parents should not help\n+their children, since the parents can be mined without the child.  More generally, if transaction A\n+is not needed in order for transaction B to be mined, A's fees cannot help B. In a\n+child-with-parents package, simply excluding any parent transactions that meet feerate requirements\n+individually is sufficient to ensure this.\n+\n+*Rationale*: We must not allow a low-feerate child to prevent its parent from being accepted; fees\n+of children should not negatively impact their parents, since they are not necessary for the parents\n+to be mined. More generally, if transaction B is not needed in order for transaction A to be mined,\n+B's fees cannot harm A. In a child-with-parents package, simply validating parents individually\n+first is sufficient to ensure this.\n+\n+*Rationale*: As a principle, we want to avoid accidentally restricting policy in order to be\n+backwards-compatibile for users and applications that rely on p2p transaction relay. Concretely,",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 45,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "9001b9ab2ef4dd7c185f8055fe90bbac66c295c5",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "s/backwards/backward/g ; s/compatibile/compatible/g (though ofc compatibility exists) ?",
      "created_at": "2022-02-22T22:41:36Z",
      "updated_at": "2022-02-22T23:37:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r812421159",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/812421159"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 116,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/812442247",
      "pull_request_review_id": 890450201,
      "id": 812442247,
      "node_id": "PRRC_kwDOABII584wbOKH",
      "diff_hunk": "@@ -1338,18 +1376,33 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n             results.emplace(wtxid, MempoolAcceptResult::MempoolTxDifferentWitness(iter.value()->GetTx().GetWitnessHash()));\n         } else {\n             // Transaction does not already exist in the mempool.\n-            txns_new.push_back(tx);\n+            // Try submitting the transaction on its own.\n+            const auto single_res = AcceptSingleTransaction(tx, single_args);",
      "path": "src/validation.cpp",
      "position": 152,
      "original_position": 135,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "9001b9ab2ef4dd7c185f8055fe90bbac66c295c5",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think the `TxValidationState` could be inspected here. If the failure cannot be assigned to the feerate check, the package validation could fail early ? Otherwise if you have a package of 25th component and the latest is faultive, we might validate twice the first 24 ones. Once here, the other one in `AcceptMultipleTransactions` and this could be avoid.\r\n\r\nAm I correct ?\r\n\r\nIf yes, I think it's always good to minimize our DoS surface. Though I'm unsure if the difference would be significant between the two implementations.",
      "created_at": "2022-02-22T23:21:35Z",
      "updated_at": "2022-02-22T23:37:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r812442247",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/812442247"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1373,
      "original_line": 1373,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/812449465",
      "pull_request_review_id": 890450201,
      "id": 812449465,
      "node_id": "PRRC_kwDOABII584wbP65",
      "diff_hunk": "@@ -1338,18 +1376,33 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n             results.emplace(wtxid, MempoolAcceptResult::MempoolTxDifferentWitness(iter.value()->GetTx().GetWitnessHash()));\n         } else {\n             // Transaction does not already exist in the mempool.\n-            txns_new.push_back(tx);\n+            // Try submitting the transaction on its own.\n+            const auto single_res = AcceptSingleTransaction(tx, single_args);\n+            if (single_res.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                // The transaction succeeded on its own and is now in the mempool. Don't include it\n+                // in package validation, because its fees should only be \"used\" once.\n+                assert(m_pool.exists(GenTxid::Wtxid(wtxid)));\n+                results.emplace(wtxid, single_res);\n+            } else {\n+                txns_new.push_back(tx);\n+            }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (txns_new.empty()) return PackageMempoolAcceptResult(package_state, std::move(results));\n+    // Also quit now if any of the transactions was consensus-invalid because package validation",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 149,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "9001b9ab2ef4dd7c185f8055fe90bbac66c295c5",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "IIUC `txns_new` is empty only if all submitted package transactions are accepted. Not because transactions are consensus-invalid, I'm unsure if the comment is accurate with the latest version of the code ?",
      "created_at": "2022-02-22T23:37:18Z",
      "updated_at": "2022-02-22T23:37:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r812449465",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/812449465"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813033268",
      "pull_request_review_id": 891280687,
      "id": 813033268,
      "node_id": "PRRC_kwDOABII584wdec0",
      "diff_hunk": "@@ -1338,18 +1376,33 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n             results.emplace(wtxid, MempoolAcceptResult::MempoolTxDifferentWitness(iter.value()->GetTx().GetWitnessHash()));\n         } else {\n             // Transaction does not already exist in the mempool.\n-            txns_new.push_back(tx);\n+            // Try submitting the transaction on its own.\n+            const auto single_res = AcceptSingleTransaction(tx, single_args);",
      "path": "src/validation.cpp",
      "position": 152,
      "original_position": 135,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "9001b9ab2ef4dd7c185f8055fe90bbac66c295c5",
      "in_reply_to_id": 812442247,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Correct - if the failure isn't feerate or missing inputs (i.e. the child, or the parents could depend on each other), then there's nothing package validation can do. I had this in the original version and took it out, but you're right that it's safer to have here. I've added it back in the latest push.",
      "created_at": "2022-02-23T15:45:00Z",
      "updated_at": "2022-02-23T15:45:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r813033268",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813033268"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1373,
      "original_line": 1373,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813033741",
      "pull_request_review_id": 891281360,
      "id": 813033741,
      "node_id": "PRRC_kwDOABII584wdekN",
      "diff_hunk": "@@ -1338,18 +1376,33 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n             results.emplace(wtxid, MempoolAcceptResult::MempoolTxDifferentWitness(iter.value()->GetTx().GetWitnessHash()));\n         } else {\n             // Transaction does not already exist in the mempool.\n-            txns_new.push_back(tx);\n+            // Try submitting the transaction on its own.\n+            const auto single_res = AcceptSingleTransaction(tx, single_args);\n+            if (single_res.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                // The transaction succeeded on its own and is now in the mempool. Don't include it\n+                // in package validation, because its fees should only be \"used\" once.\n+                assert(m_pool.exists(GenTxid::Wtxid(wtxid)));\n+                results.emplace(wtxid, single_res);\n+            } else {\n+                txns_new.push_back(tx);\n+            }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (txns_new.empty()) return PackageMempoolAcceptResult(package_state, std::move(results));\n+    // Also quit now if any of the transactions was consensus-invalid because package validation",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 149,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "9001b9ab2ef4dd7c185f8055fe90bbac66c295c5",
      "in_reply_to_id": 812449465,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah sorry, leftover comment",
      "created_at": "2022-02-23T15:45:27Z",
      "updated_at": "2022-02-23T15:45:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r813033741",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/813033741"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824676230",
      "pull_request_review_id": 907163525,
      "id": 824676230,
      "node_id": "PRRC_kwDOABII584xJ4-G",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 10,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "drop the comma, as the dependent clause has no subject\r\n```suggestion\r\n(\"deduplicated\") and are thus excluded from this calculation.\r\n```",
      "created_at": "2022-03-11T12:38:18Z",
      "updated_at": "2022-03-11T13:39:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824676230",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824676230"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824677991",
      "pull_request_review_id": 907163525,
      "id": 824677991,
      "node_id": "PRRC_kwDOABII584xJ5Zn",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 13,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n(`minRelayTxFee`) and the dynamic mempool minimum feerate, the total package feerate is used instead of\r\n```",
      "created_at": "2022-03-11T12:40:50Z",
      "updated_at": "2022-03-11T13:34:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824677991",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824677991"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824678812",
      "pull_request_review_id": 907163525,
      "id": 824678812,
      "node_id": "PRRC_kwDOABII584xJ5mc",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 14,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\nthe individual feerate. The individual transactions are allowed to be below the feerate requirements if\r\n```",
      "created_at": "2022-03-11T12:42:02Z",
      "updated_at": "2022-03-11T13:34:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824678812",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824678812"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824679515",
      "pull_request_review_id": 907163525,
      "id": 824679515,
      "node_id": "PRRC_kwDOABII584xJ5xb",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 15,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "\"Two\" is written out in the same paragraph (instead of 2), so s/0/zero/.\r\n```suggestion\r\nthe package meets the feerate requirements. For example, the parent(s) in the package can have zero\r\n```",
      "created_at": "2022-03-11T12:43:04Z",
      "updated_at": "2022-03-11T13:34:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824679515",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824679515"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 86,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824681566",
      "pull_request_review_id": 907163525,
      "id": 824681566,
      "node_id": "PRRC_kwDOABII584xJ6Re",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 19,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "L2 (layer two) isn't previously defined in this document, so perhaps something like\r\n```suggestion\r\nmeeting minimum fees on its own. This would allow applications building on Bitcoin Core to adjust their fees at broadcast time\r\n```\r\nAlso, both sentences begin with \"This...\"; it may be good to replace the first one with \"The package feerate can be thought of...\" ",
      "created_at": "2022-03-11T12:45:33Z",
      "updated_at": "2022-03-11T13:34:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824681566",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824681566"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 90,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824690922",
      "pull_request_review_id": 907163525,
      "id": 824690922,
      "node_id": "PRRC_kwDOABII584xJ8jq",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 20,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "getting stuck/pinned -> becoming stuck or pinned",
      "created_at": "2022-03-11T12:58:53Z",
      "updated_at": "2022-03-11T13:34:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824690922",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824690922"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824694411",
      "pull_request_review_id": 907163525,
      "id": 824694411,
      "node_id": "PRRC_kwDOABII584xJ9aL",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+Implementation Note: Transactions within a package are always validated individually first, and\n+package validation is used for the transactions that failed. Since package feerate is only\n+calculated using transactions that are not in the mempool, this implementation detail affects the\n+outcome of package validation.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping: transaction B is a\n+\"legitimate\" fee-bump for transaction A only if B is a descendant of A and has a *higher* feerate\n+than A. We want to prevent \"parents pay for children\" behavior; fees of parents should not help\n+their children, since the parents can be mined without the child.  More generally, if transaction A\n+is not needed in order for transaction B to be mined, A's fees cannot help B. In a\n+child-with-parents package, simply excluding any parent transactions that meet feerate requirements\n+individually is sufficient to ensure this.\n+\n+*Rationale*: We must not allow a low-feerate child to prevent its parent from being accepted; fees\n+of children should not negatively impact their parents, since they are not necessary for the parents\n+to be mined. More generally, if transaction B is not needed in order for transaction A to be mined,\n+B's fees cannot harm A. In a child-with-parents package, simply validating parents individually\n+first is sufficient to ensure this.\n+\n+*Rationale*: As a principle, we want to avoid accidentally restricting policy in order to be\n+backwards-compatibile for users and applications that rely on p2p transaction relay. Concretely,\n+it's important that package validation does not prevent the acceptance of a transaction that would",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 46,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "prefer active voice: s/it's important that package validation does not/package validation must not/ (ignore if you disagree)",
      "created_at": "2022-03-11T13:04:14Z",
      "updated_at": "2022-03-11T13:47:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824694411",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824694411"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 117,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824702177",
      "pull_request_review_id": 907163525,
      "id": 824702177,
      "node_id": "PRRC_kwDOABII584xJ_Th",
      "diff_hunk": "@@ -568,6 +587,205 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 132,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "22bf054\r\n- prefer absolute references to cs_main in new code\r\n- use `size_t` type for `size()` (or `auto`), same for line 216\r\n```diff\r\n-    LOCK(cs_main);\r\n-    unsigned int expected_pool_size = m_node.mempool->size();\r\n+    LOCK(::cs_main);\r\n+    size_t expected_pool_size{m_node.mempool->size()};\r\n```\r\n",
      "created_at": "2022-03-11T13:15:17Z",
      "updated_at": "2022-03-11T13:34:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824702177",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824702177"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 604,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824704838",
      "pull_request_review_id": 907163525,
      "id": 824704838,
      "node_id": "PRRC_kwDOABII584xJ_9G",
      "diff_hunk": "@@ -568,6 +587,205 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 121,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "22bf054eee6bfc7148bb40150d648b0dcf0db44b nit, this is the only non-const `expected_feerate` in the test and it can be const too\r\n```suggestion\r\n        const CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\r\n```",
      "created_at": "2022-03-11T13:18:58Z",
      "updated_at": "2022-03-11T13:34:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824704838",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824704838"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 593,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824734826",
      "pull_request_review_id": 907248070,
      "id": 824734826,
      "node_id": "PRRC_kwDOABII584xKHRq",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 19,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": 824681566,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'll change to \"contracting applications.\" I specifically mean contracting applications that negotiate fees + sign with counterparties long before broadcast time",
      "created_at": "2022-03-11T13:56:49Z",
      "updated_at": "2022-03-11T13:57:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r824734826",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824734826"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 90,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832772623",
      "pull_request_review_id": 918083714,
      "id": 832772623,
      "node_id": "PRRC_kwDOABII584xoxoP",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+Implementation Note: Transactions within a package are always validated individually first, and",
      "path": "doc/policy/packages.md",
      "position": 25,
      "original_position": 25,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7e758fa192eba3458c92724559567b7b4c7a35a6",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\nImplementation Note: Transactions within a package are always feerate-validated individually first, and\r\n```\r\n\"feerate-validated\" may prevent readers from thinking you're referring to transaction consensus validation.",
      "created_at": "2022-03-23T02:01:25Z",
      "updated_at": "2022-03-23T03:39:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r832772623",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832772623"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 96,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832775358",
      "pull_request_review_id": 918083714,
      "id": 832775358,
      "node_id": "PRRC_kwDOABII584xoyS-",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+Implementation Note: Transactions within a package are always validated individually first, and\n+package validation is used for the transactions that failed. Since package feerate is only",
      "path": "doc/policy/packages.md",
      "position": 26,
      "original_position": 26,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7e758fa192eba3458c92724559567b7b4c7a35a6",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "\"... used for the transactions that failed.\" This is a bit vague for me, and maybe that's okay since this is a high-level document. But let me try to describe what this actually means at a high level (without looking at the code), Pythonically:\r\n```python\r\n# Create a new package (t-sorted list of transactions) from the incoming package\r\nnew_package = []\r\nfor tx in package:\r\n    if has_parent(new_package, tx) or not feerate_okay(tx):\r\n        new_package.append(tx)\r\nfee_validate(new_package)\r\n```\r\nConsider the most trivial (and useful) case, child pays for parent. Here, parent A has a low feerate, and its child B has a high feerate, `package` is `[A, B]`. The first loop iteration looks at A, and asks: does A have a parent (within `new_package`)? No -- `new_package` is empty. So then we check A's feerate. It's not okay, so we add A to `new_package`. The second loop iteration considers B. Does it have a parent in `new_package`? Yes, so add it to `new_package` (no need to check its feerate). So `new_package` ends up `[A, B]`, so we evaluate that and it likely passes.\r\n\r\nLet's consider the reverse case, parent pays for child. Here, parent A has a high feerate, and B has a low feerate. Again, `package` is `[A, B]`. The first loop iteration finds that A does not have a parent (in `new_package`), so we check A's feerate. It is okay, so we _don't_ add A to the result list. The second loop checks B; it does not have a parent in `new_package`, so we check its feerate. It's not okay, so we add it to `new_package`, which becomes `[B]`. We check this package feerate and it fails. So parent A was not able to pay for child B, which is what we want.\r\n\r\nNote that any `package` transactions that are _not_ in `new_package` (in this second example, A) have passed their individual feerate test, so there is no need to check them again.\r\n\r\nI think this algorithm generalizes to an arbitrary package DAG but I'm not completely sure.",
      "created_at": "2022-03-23T02:08:14Z",
      "updated_at": "2022-03-23T03:39:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r832775358",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832775358"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 97,
      "original_line": 97,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833290916",
      "pull_request_review_id": 918810550,
      "id": 833290916,
      "node_id": "PRRC_kwDOABII584xqwKk",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+Implementation Note: Transactions within a package are always validated individually first, and",
      "path": "doc/policy/packages.md",
      "position": 25,
      "original_position": 25,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7e758fa192eba3458c92724559567b7b4c7a35a6",
      "in_reply_to_id": 832772623,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't agree; we *are* validating the transaction fully. I don't think \"feerate-validate\" is a commonly used term so could be even more confusing.",
      "created_at": "2022-03-23T13:49:41Z",
      "updated_at": "2022-03-23T13:49:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r833290916",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833290916"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 96,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833309768",
      "pull_request_review_id": 918836947,
      "id": 833309768,
      "node_id": "PRRC_kwDOABII584xq0xI",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+Implementation Note: Transactions within a package are always validated individually first, and\n+package validation is used for the transactions that failed. Since package feerate is only",
      "path": "doc/policy/packages.md",
      "position": 26,
      "original_position": 26,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "7e758fa192eba3458c92724559567b7b4c7a35a6",
      "in_reply_to_id": 832775358,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Your description is correct at a high level, and is what I intend to communicate to the reader. To be nitpicky, we'll add transactions to the package for *any* policy reason, not just feerate, since `TxValidationResult` doesn't specify whether it's a fee-related or other policy issue.\r\n\r\n> I think this algorithm generalizes to an arbitrary package DAG but I'm not completely sure.\r\n\r\nWhile I wish this were true, there are cases where it doesn't work - see [example Q2](https://gist.github.com/glozow/dc4e9d5c5b14ade7cdfac40f43adb18a#always-try-individual-submission-first) in the package mempool accept gist. This is why the package-child-with-unconfirmed-parents restriction is so important. ",
      "created_at": "2022-03-23T14:05:45Z",
      "updated_at": "2022-03-23T14:19:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r833309768",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833309768"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 97,
      "original_line": 97,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836867916",
      "pull_request_review_id": 923777051,
      "id": 836867916,
      "node_id": "PRRC_kwDOABII584x4ZdM",
      "diff_hunk": "@@ -1380,18 +1394,31 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n             results.emplace(wtxid, MempoolAcceptResult::MempoolTxDifferentWitness(iter.value()->GetTx().GetWitnessHash()));\n         } else {\n             // Transaction does not already exist in the mempool.\n-            txns_new.push_back(tx);\n+            // Try submitting the transaction on its own.\n+            const auto single_res = AcceptSingleTransaction(tx, single_args);\n+            if (single_res.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                // The transaction succeeded on its own and is now in the mempool. Don't include it\n+                // in package validation, because its fees should only be \"used\" once.\n+                assert(m_pool.exists(GenTxid::Wtxid(wtxid)));\n+                results.emplace(wtxid, single_res);\n+            } else {\n+                txns_new.push_back(tx);\n+            }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (txns_new.empty()) return PackageMempoolAcceptResult(package_state, std::move(results));\n+    if (txns_new.empty()) {\n+        // No package feerate when no package validation was done.\n+        return PackageMempoolAcceptResult(package_state, std::move(results));\n+    }\n     // Validate the (deduplicated) transactions as a package.\n     auto submission_result = AcceptMultipleTransactions(txns_new, args);\n     // Include already-in-mempool transaction results in the final result.\n     for (const auto& [wtxid, mempoolaccept_res] : results) {\n         submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n     }\n+    if (submission_result.m_state.IsValid()) assert(submission_result.m_package_feerate != std::nullopt);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "aaa60951caafc1af3876bcd253aeb411c3a36423",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit, preferable?\r\n```\r\nif (submission_result.m_state.IsValid()) assert(submission_result.m_package_feerate.has_value());\r\n```",
      "created_at": "2022-03-28T21:31:55Z",
      "updated_at": "2022-03-29T19:10:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r836867916",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836867916"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1408,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836869087",
      "pull_request_review_id": 923777051,
      "id": 836869087,
      "node_id": "PRRC_kwDOABII584x4Zvf",
      "diff_hunk": "@@ -98,7 +98,9 @@ BOOST_FIXTURE_TEST_CASE(package_validation_tests, TestChain100Setup)\n     BOOST_CHECK(it_child != result_parent_child.m_tx_results.end());\n     BOOST_CHECK_MESSAGE(it_child->second.m_state.IsValid(),\n                         \"Package validation unexpectedly failed: \" << it_child->second.m_state.GetRejectReason());\n-\n+    BOOST_CHECK(result_parent_child.m_package_feerate != std::nullopt);",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "22bf054eee6bfc7148bb40150d648b0dcf0db44b",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "22bf054eee6bfc7148bb40150d648b0dcf0db44b nit, and similar elsewhere\r\n```suggestion\r\n    BOOST_CHECK(result_parent_child.m_package_feerate.has_value());\r\n```",
      "created_at": "2022-03-28T21:33:43Z",
      "updated_at": "2022-03-29T19:10:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r836869087",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836869087"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 101,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836874350",
      "pull_request_review_id": 923777051,
      "id": 836874350,
      "node_id": "PRRC_kwDOABII584x4bBu",
      "diff_hunk": "@@ -568,6 +587,205 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and child package",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 140,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "22bf054eee6bfc7148bb40150d648b0dcf0db44b",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    // zero-fee parent and fee=1 child package\r\n```",
      "created_at": "2022-03-28T21:42:11Z",
      "updated_at": "2022-03-29T19:10:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r836874350",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836874350"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 612,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837728551",
      "pull_request_review_id": 923777051,
      "id": 837728551,
      "node_id": "PRRC_kwDOABII584x7rkn",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.",
      "path": "doc/policy/packages.md",
      "position": 8,
      "original_position": 8,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n[`prioritisetransaction`](https://developer.bitcoin.org/reference/rpc/prioritisetransaction.html)) divided by the total virtual size of all transactions in the package.\r\n```",
      "created_at": "2022-03-29T17:26:03Z",
      "updated_at": "2022-03-29T19:10:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r837728551",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837728551"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 79,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837764524",
      "pull_request_review_id": 923777051,
      "id": 837764524,
      "node_id": "PRRC_kwDOABII584x70Ws",
      "diff_hunk": "@@ -399,6 +411,9 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_child1->GetHash())));\n \n+        // Child2 would have been validated individually.\n+        BOOST_CHECK(submit_witness1.m_package_feerate == std::nullopt);\n+\n         const auto submit_witness2 = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n                                                        {ptx_parent, ptx_child2}, /*test_accept=*/ false);",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 71,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should we check the feerate for this package? I think this is the only one missing in this file.\r\n```\r\nBOOST_CHECK(submit_witness2.m_package_feerate == std::nullopt);\r\n```",
      "created_at": "2022-03-29T18:06:17Z",
      "updated_at": "2022-03-29T19:10:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r837764524",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837764524"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 418,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837796811",
      "pull_request_review_id": 923777051,
      "id": 837796811,
      "node_id": "PRRC_kwDOABII584x78PL",
      "diff_hunk": "@@ -1231,20 +1254,35 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n         m_viewmempool.PackageAddTransaction(ws.m_ptx);\n     }\n \n+    // Transactions must meet two minimum feerates: the mempool minimum fee and min relay fee.\n+    // For transactions consisting of exactly one child and its parents, it suffices to use the\n+    // package feerate (total modified fees / total virtual size) to check this requirement.\n+    const auto m_total_vsize = std::accumulate(workspaces.cbegin(), workspaces.cend(), int64_t{0},\n+        [](int64_t sum, auto& ws) { return sum + ws.m_vsize; });",
      "path": "src/validation.cpp",
      "position": 89,
      "original_position": 89,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit, maybe just (I'm more old-school) ... but it does lose the `const`, and I don't know if our style guide allows one-line loops (but it should!)\r\n```suggestion\r\n    int64_t m_total_vsize{0};\r\n    for (const auto& ws : workspaces) m_total_vsize += ws.m_vsize;\r\n```",
      "created_at": "2022-03-29T18:43:20Z",
      "updated_at": "2022-03-29T19:10:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r837796811",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837796811"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": 1234,
      "original_start_line": 1260,
      "start_side": "RIGHT",
      "line": 1235,
      "original_line": 1235,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840810355",
      "pull_request_review_id": 929264730,
      "id": 840810355,
      "node_id": "PRRC_kwDOABII584yHb9z",
      "diff_hunk": "@@ -1231,20 +1254,35 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n         m_viewmempool.PackageAddTransaction(ws.m_ptx);\n     }\n \n+    // Transactions must meet two minimum feerates: the mempool minimum fee and min relay fee.\n+    // For transactions consisting of exactly one child and its parents, it suffices to use the\n+    // package feerate (total modified fees / total virtual size) to check this requirement.\n+    const auto m_total_vsize = std::accumulate(workspaces.cbegin(), workspaces.cend(), int64_t{0},\n+        [](int64_t sum, auto& ws) { return sum + ws.m_vsize; });",
      "path": "src/validation.cpp",
      "position": 89,
      "original_position": 89,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": 837796811,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah I disagree. I prefer being able to assign this to a const. I don't see anything wrong with using `std::accumulate`.",
      "created_at": "2022-04-01T18:04:50Z",
      "updated_at": "2022-04-01T18:04:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r840810355",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840810355"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": 1234,
      "original_start_line": 1260,
      "start_side": "RIGHT",
      "line": 1235,
      "original_line": 1235,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840832492",
      "pull_request_review_id": 929295535,
      "id": 840832492,
      "node_id": "PRRC_kwDOABII584yHhXs",
      "diff_hunk": "@@ -399,6 +411,9 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_child1->GetHash())));\n \n+        // Child2 would have been validated individually.\n+        BOOST_CHECK(submit_witness1.m_package_feerate == std::nullopt);\n+\n         const auto submit_witness2 = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n                                                        {ptx_parent, ptx_child2}, /*test_accept=*/ false);",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 71,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": 837764524,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Added",
      "created_at": "2022-04-01T18:37:07Z",
      "updated_at": "2022-04-01T18:37:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r840832492",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840832492"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 418,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840832748",
      "pull_request_review_id": 929295923,
      "id": 840832748,
      "node_id": "PRRC_kwDOABII584yHhbs",
      "diff_hunk": "@@ -1380,18 +1394,31 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n             results.emplace(wtxid, MempoolAcceptResult::MempoolTxDifferentWitness(iter.value()->GetTx().GetWitnessHash()));\n         } else {\n             // Transaction does not already exist in the mempool.\n-            txns_new.push_back(tx);\n+            // Try submitting the transaction on its own.\n+            const auto single_res = AcceptSingleTransaction(tx, single_args);\n+            if (single_res.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                // The transaction succeeded on its own and is now in the mempool. Don't include it\n+                // in package validation, because its fees should only be \"used\" once.\n+                assert(m_pool.exists(GenTxid::Wtxid(wtxid)));\n+                results.emplace(wtxid, single_res);\n+            } else {\n+                txns_new.push_back(tx);\n+            }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (txns_new.empty()) return PackageMempoolAcceptResult(package_state, std::move(results));\n+    if (txns_new.empty()) {\n+        // No package feerate when no package validation was done.\n+        return PackageMempoolAcceptResult(package_state, std::move(results));\n+    }\n     // Validate the (deduplicated) transactions as a package.\n     auto submission_result = AcceptMultipleTransactions(txns_new, args);\n     // Include already-in-mempool transaction results in the final result.\n     for (const auto& [wtxid, mempoolaccept_res] : results) {\n         submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n     }\n+    if (submission_result.m_state.IsValid()) assert(submission_result.m_package_feerate != std::nullopt);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "aaa60951caafc1af3876bcd253aeb411c3a36423",
      "in_reply_to_id": 836867916,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changed all of them to `has_value()`",
      "created_at": "2022-04-01T18:37:31Z",
      "updated_at": "2022-04-01T18:37:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r840832748",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840832748"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1408,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840832906",
      "pull_request_review_id": 929296148,
      "id": 840832906,
      "node_id": "PRRC_kwDOABII584yHheK",
      "diff_hunk": "@@ -568,6 +587,205 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 121,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": 824704838,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2022-04-01T18:37:46Z",
      "updated_at": "2022-04-01T18:37:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r840832906",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840832906"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 593,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840832990",
      "pull_request_review_id": 929296284,
      "id": 840832990,
      "node_id": "PRRC_kwDOABII584yHhfe",
      "diff_hunk": "@@ -568,6 +587,205 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate != std::nullopt);\n+        CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(cs_main);\n+    unsigned int expected_pool_size = m_node.mempool->size();",
      "path": "src/test/txpackage_tests.cpp",
      "position": null,
      "original_position": 132,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": 824702177,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done, noted",
      "created_at": "2022-04-01T18:37:55Z",
      "updated_at": "2022-04-01T18:37:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r840832990",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840832990"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 604,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840833129",
      "pull_request_review_id": 929296465,
      "id": 840833129,
      "node_id": "PRRC_kwDOABII584yHhhp",
      "diff_hunk": "@@ -72,3 +72,48 @@ test accepts):\n      a competing package or transaction with a mutated witness, even though the two\n      same-txid-different-witness transactions are conflicting and cannot replace each other, the\n      honest package should still be considered for acceptance.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees (base fees + any fee delta from\n+`prioritisetransaction`) divided by the total virtual size of all transactions in the package.\n+If any transactions in the package are already in the mempool, they are not submitted again\n+(\"deduplicated\"), and thus excluded from this calculation.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+Implementation Note: Transactions within a package are always validated individually first, and\n+package validation is used for the transactions that failed. Since package feerate is only\n+calculated using transactions that are not in the mempool, this implementation detail affects the\n+outcome of package validation.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping: transaction B is a\n+\"legitimate\" fee-bump for transaction A only if B is a descendant of A and has a *higher* feerate\n+than A. We want to prevent \"parents pay for children\" behavior; fees of parents should not help\n+their children, since the parents can be mined without the child.  More generally, if transaction A\n+is not needed in order for transaction B to be mined, A's fees cannot help B. In a\n+child-with-parents package, simply excluding any parent transactions that meet feerate requirements\n+individually is sufficient to ensure this.\n+\n+*Rationale*: We must not allow a low-feerate child to prevent its parent from being accepted; fees\n+of children should not negatively impact their parents, since they are not necessary for the parents\n+to be mined. More generally, if transaction B is not needed in order for transaction A to be mined,\n+B's fees cannot harm A. In a child-with-parents package, simply validating parents individually\n+first is sufficient to ensure this.\n+\n+*Rationale*: As a principle, we want to avoid accidentally restricting policy in order to be\n+backwards-compatibile for users and applications that rely on p2p transaction relay. Concretely,\n+it's important that package validation does not prevent the acceptance of a transaction that would",
      "path": "doc/policy/packages.md",
      "position": null,
      "original_position": 46,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "dc0b2d3fa375ec0641bd2075a99be0383d1129ee",
      "in_reply_to_id": 824694411,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Took all the doc comments 👍 ",
      "created_at": "2022-04-01T18:38:08Z",
      "updated_at": "2022-04-01T18:38:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r840833129",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/840833129"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 117,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/841866469",
      "pull_request_review_id": 930562955,
      "id": 841866469,
      "node_id": "PRRC_kwDOABII584yLdzl",
      "diff_hunk": "@@ -1380,18 +1394,31 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptPackage(const Package& package,\n             results.emplace(wtxid, MempoolAcceptResult::MempoolTxDifferentWitness(iter.value()->GetTx().GetWitnessHash()));\n         } else {\n             // Transaction does not already exist in the mempool.\n-            txns_new.push_back(tx);\n+            // Try submitting the transaction on its own.\n+            const auto single_res = AcceptSingleTransaction(tx, single_args);\n+            if (single_res.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                // The transaction succeeded on its own and is now in the mempool. Don't include it\n+                // in package validation, because its fees should only be \"used\" once.\n+                assert(m_pool.exists(GenTxid::Wtxid(wtxid)));\n+                results.emplace(wtxid, single_res);\n+            } else {\n+                txns_new.push_back(tx);\n+            }\n         }\n     }\n \n     // Nothing to do if the entire package has already been submitted.\n-    if (txns_new.empty()) return PackageMempoolAcceptResult(package_state, std::move(results));\n+    if (txns_new.empty()) {\n+        // No package feerate when no package validation was done.\n+        return PackageMempoolAcceptResult(package_state, std::move(results));\n+    }\n     // Validate the (deduplicated) transactions as a package.\n     auto submission_result = AcceptMultipleTransactions(txns_new, args);\n     // Include already-in-mempool transaction results in the final result.\n     for (const auto& [wtxid, mempoolaccept_res] : results) {\n         submission_result.m_tx_results.emplace(wtxid, mempoolaccept_res);\n     }\n+    if (submission_result.m_state.IsValid()) assert(submission_result.m_package_feerate != std::nullopt);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "aaa60951caafc1af3876bcd253aeb411c3a36423",
      "in_reply_to_id": 836867916,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If you touch up, this one still could be changed (the test calls have been changed).",
      "created_at": "2022-04-04T15:22:06Z",
      "updated_at": "2022-04-04T15:22:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r841866469",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/841866469"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1408,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842038926",
      "pull_request_review_id": 930808243,
      "id": 842038926,
      "node_id": "PRRC_kwDOABII584yMH6O",
      "diff_hunk": "@@ -508,6 +508,19 @@ class MemPoolAccept\n             };\n         }\n \n+        /** Parameters for a single transaction within a package. */\n+        static ATMPArgs SingleInPackageAccept(const ATMPArgs& package_args) {",
      "path": "src/validation.cpp",
      "position": 36,
      "original_position": 5,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "d347aca4446a9f4ae2d717c0adadf6aaf3bd6875",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "As fas as I can see, the main difference to the `SingleAccept` parameters is that `m_allow_bip125_replacement` is false here, because it is taken from the `PackageTestAccept` or `PackageChildWithParents` parameters. \r\n\r\nIf a transaction is no longer subject to package validation because it is valid on its own, is it still necessary to disallow RBF? This seems to slightly conflict with the philosophy that \"package validation should not prevent the acceptance of a transaction that would otherwise be policy-valid on its own\".",
      "created_at": "2022-04-04T18:43:45Z",
      "updated_at": "2022-04-04T20:50:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r842038926",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842038926"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 512,
      "original_line": 512,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842048301",
      "pull_request_review_id": 930808243,
      "id": 842048301,
      "node_id": "PRRC_kwDOABII584yMKMt",
      "diff_hunk": "@@ -1205,20 +1215,35 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n         m_viewmempool.PackageAddTransaction(ws.m_ptx);\n     }\n \n+    // Transactions must meet two minimum feerates: the mempool minimum fee and min relay fee.\n+    // For transactions consisting of exactly one child and its parents, it suffices to use the\n+    // package feerate (total modified fees / total virtual size) to check this requirement.\n+    const auto m_total_vsize = std::accumulate(workspaces.cbegin(), workspaces.cend(), int64_t{0},\n+        [](int64_t sum, auto& ws) { return sum + ws.m_vsize; });\n+    const auto m_total_modified_fees = std::accumulate(workspaces.cbegin(), workspaces.cend(), CAmount{0},\n+        [](CAmount sum, auto& ws) { return sum + ws.m_modified_fees; });\n+    const CFeeRate package_feerate(m_total_modified_fees, m_total_vsize);\n+    TxValidationState placeholder_state;\n+    if (args.m_package_feerates &&",
      "path": "src/validation.cpp",
      "position": 94,
      "original_position": 81,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "9f9038dc9545cc7fdbc7059b12e0402ff02746ad",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think we currently can't call `AcceptMultipleTransactions()` and get to this point without having `m_package_feerates` set (at least no test breaks if I add an assert for it) - is there a future use case for that or should there be an assert or Assume?",
      "created_at": "2022-04-04T18:56:11Z",
      "updated_at": "2022-04-04T20:50:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r842048301",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842048301"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1240,
      "original_line": 1240,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843315053",
      "pull_request_review_id": 932588000,
      "id": 843315053,
      "node_id": "PRRC_kwDOABII584yQ_dt",
      "diff_hunk": "@@ -508,6 +508,19 @@ class MemPoolAccept\n             };\n         }\n \n+        /** Parameters for a single transaction within a package. */\n+        static ATMPArgs SingleInPackageAccept(const ATMPArgs& package_args) {",
      "path": "src/validation.cpp",
      "position": 36,
      "original_position": 5,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "d347aca4446a9f4ae2d717c0adadf6aaf3bd6875",
      "in_reply_to_id": 842038926,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah, good point. I don't have a good reason as to why BIP125 should ever be disallowed here. Will change it to true for `SingleInPackageAccept`",
      "created_at": "2022-04-05T22:33:57Z",
      "updated_at": "2022-04-05T22:33:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r843315053",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843315053"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 512,
      "original_line": 512,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843317502",
      "pull_request_review_id": 932591096,
      "id": 843317502,
      "node_id": "PRRC_kwDOABII584yRAD-",
      "diff_hunk": "@@ -1205,20 +1215,35 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n         m_viewmempool.PackageAddTransaction(ws.m_ptx);\n     }\n \n+    // Transactions must meet two minimum feerates: the mempool minimum fee and min relay fee.\n+    // For transactions consisting of exactly one child and its parents, it suffices to use the\n+    // package feerate (total modified fees / total virtual size) to check this requirement.\n+    const auto m_total_vsize = std::accumulate(workspaces.cbegin(), workspaces.cend(), int64_t{0},\n+        [](int64_t sum, auto& ws) { return sum + ws.m_vsize; });\n+    const auto m_total_modified_fees = std::accumulate(workspaces.cbegin(), workspaces.cend(), CAmount{0},\n+        [](CAmount sum, auto& ws) { return sum + ws.m_modified_fees; });\n+    const CFeeRate package_feerate(m_total_modified_fees, m_total_vsize);\n+    TxValidationState placeholder_state;\n+    if (args.m_package_feerates &&",
      "path": "src/validation.cpp",
      "position": 94,
      "original_position": 81,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "9f9038dc9545cc7fdbc7059b12e0402ff02746ad",
      "in_reply_to_id": 842048301,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Right, we always have `m_package_feerates` on when we call `AcceptMultipleTransactions`. I imagined turning it off for `testmempoolaccept` with multiple transactions ~but didn't actually come up with a good reason to do that. I think i will delete this condition from here~\r\n\r\nEDIT: I now remember why I wanted to turn off package feerates for testmempoolaccept; it's because those are not restricted by child-with-parents. Sorry for the confusion. Yes, this should be here; the correct fix was to set `m_package_feerates=false` for `ATMPArgs::PackageTestAccept`.",
      "created_at": "2022-04-05T22:39:18Z",
      "updated_at": "2022-04-05T22:53:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r843317502",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843317502"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1240,
      "original_line": 1240,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843333003",
      "pull_request_review_id": 932620126,
      "id": 843333003,
      "node_id": "PRRC_kwDOABII584yRD2L",
      "diff_hunk": "@@ -1205,20 +1215,35 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n         m_viewmempool.PackageAddTransaction(ws.m_ptx);\n     }\n \n+    // Transactions must meet two minimum feerates: the mempool minimum fee and min relay fee.\n+    // For transactions consisting of exactly one child and its parents, it suffices to use the\n+    // package feerate (total modified fees / total virtual size) to check this requirement.\n+    const auto m_total_vsize = std::accumulate(workspaces.cbegin(), workspaces.cend(), int64_t{0},\n+        [](int64_t sum, auto& ws) { return sum + ws.m_vsize; });\n+    const auto m_total_modified_fees = std::accumulate(workspaces.cbegin(), workspaces.cend(), CAmount{0},\n+        [](CAmount sum, auto& ws) { return sum + ws.m_modified_fees; });\n+    const CFeeRate package_feerate(m_total_modified_fees, m_total_vsize);\n+    TxValidationState placeholder_state;\n+    if (args.m_package_feerates &&",
      "path": "src/validation.cpp",
      "position": 94,
      "original_position": 81,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "9f9038dc9545cc7fdbc7059b12e0402ff02746ad",
      "in_reply_to_id": 842048301,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed - it was a mistake to make `ATMPArgs::PackageTestAccept.m_package_feerates=true` in the original code",
      "created_at": "2022-04-05T22:59:26Z",
      "updated_at": "2022-04-05T22:59:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r843333003",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843333003"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1240,
      "original_line": 1240,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843352843",
      "pull_request_review_id": 932645723,
      "id": 843352843,
      "node_id": "PRRC_kwDOABII584yRIsL",
      "diff_hunk": "@@ -508,6 +508,19 @@ class MemPoolAccept\n             };\n         }\n \n+        /** Parameters for a single transaction within a package. */\n+        static ATMPArgs SingleInPackageAccept(const ATMPArgs& package_args) {",
      "path": "src/validation.cpp",
      "position": 36,
      "original_position": 5,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "d347aca4446a9f4ae2d717c0adadf6aaf3bd6875",
      "in_reply_to_id": 842038926,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If the idea is that everything should be just as if this was a single transaction, why introduce a separate `SingleInPackageAccept` function at all, instead of just creating a `SingleAccept()` ATMPArgs set?",
      "created_at": "2022-04-05T23:50:50Z",
      "updated_at": "2022-04-05T23:50:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r843352843",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843352843"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 512,
      "original_line": 512,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844252288",
      "pull_request_review_id": 933914912,
      "id": 844252288,
      "node_id": "PRRC_kwDOABII584yUkSA",
      "diff_hunk": "@@ -508,6 +508,19 @@ class MemPoolAccept\n             };\n         }\n \n+        /** Parameters for a single transaction within a package. */\n+        static ATMPArgs SingleInPackageAccept(const ATMPArgs& package_args) {",
      "path": "src/validation.cpp",
      "position": 36,
      "original_position": 5,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "d347aca4446a9f4ae2d717c0adadf6aaf3bd6875",
      "in_reply_to_id": 842038926,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I just figured it would be safer to have a constructor converting package-to-single ATMPArgs. There also is a difference (albeit small) - `SingleInPackageAccept` should never have `bypass_limits=true`, so I don't want the caller to have the option to set it.",
      "created_at": "2022-04-06T18:20:30Z",
      "updated_at": "2022-04-06T18:20:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r844252288",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844252288"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 512,
      "original_line": 512,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/885085169",
      "pull_request_review_id": 989689132,
      "id": 885085169,
      "node_id": "PRRC_kwDOABII5840wVPx",
      "diff_hunk": "@@ -568,6 +588,205 @@ BOOST_FIXTURE_TEST_CASE(package_witness_swap_tests, TestChain100Setup)\n         BOOST_CHECK(!m_node.mempool->exists(GenTxid::Wtxid(ptx_parent2_v1->GetWitnessHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_parent3->GetHash())));\n         BOOST_CHECK(m_node.mempool->exists(GenTxid::Txid(ptx_mixed_child->GetHash())));\n+\n+        // package feerate should include parent3 and child. It should not include parent1 or parent2_v1.\n+        BOOST_CHECK(mixed_result.m_package_feerate.has_value());\n+        const CFeeRate expected_feerate(1 * COIN, GetVirtualTransactionSize(*ptx_parent3) + GetVirtualTransactionSize(*ptx_mixed_child));\n+        BOOST_CHECK_MESSAGE(mixed_result.m_package_feerate.value() == expected_feerate,\n+                            strprintf(\"Expected package feerate %s, got %s\", expected_feerate.ToString(),\n+                                      mixed_result.m_package_feerate.value().ToString()));\n+    }\n+}\n+\n+BOOST_FIXTURE_TEST_CASE(package_cpfp_tests, TestChain100Setup)\n+{\n+    mineBlocks(5);\n+    LOCK(::cs_main);\n+    size_t expected_pool_size = m_node.mempool->size();\n+    CKey child_key;\n+    child_key.MakeNewKey(true);\n+    CScript parent_spk = GetScriptForDestination(WitnessV0KeyHash(child_key.GetPubKey()));\n+    CKey grandchild_key;\n+    grandchild_key.MakeNewKey(true);\n+    CScript child_spk = GetScriptForDestination(WitnessV0KeyHash(grandchild_key.GetPubKey()));\n+\n+    // zero-fee parent and high-fee child package\n+    const CAmount coinbase_value{50 * COIN};\n+    const CAmount parent_value{coinbase_value - 0};\n+    const CAmount child_value{parent_value - COIN};\n+\n+    Package package_cpfp;\n+    auto mtx_parent = CreateValidMempoolTransaction(/*input_transaction=*/ m_coinbase_txns[0], /*vout=*/ 0,\n+                                                    /*input_height=*/ 0, /*input_signing_key=*/ coinbaseKey,\n+                                                    /*output_destination=*/ parent_spk,\n+                                                    /*output_amount=*/ parent_value, /*submit=*/ false);\n+    CTransactionRef tx_parent = MakeTransactionRef(mtx_parent);\n+    package_cpfp.push_back(tx_parent);\n+\n+    auto mtx_child = CreateValidMempoolTransaction(/*input_transaction=*/ tx_parent, /*vout=*/ 0,\n+                                                   /*input_height=*/ 101, /*input_signing_key=*/ child_key,\n+                                                   /*output_destination=*/ child_spk,\n+                                                   /*output_amount=*/ child_value, /*submit=*/ false);\n+    CTransactionRef tx_child = MakeTransactionRef(mtx_child);\n+    package_cpfp.push_back(tx_child);\n+\n+    // Package feerate is calculated using modified fees, and prioritisetransaction accepts negative\n+    // fee deltas. This should be taken into account. De-prioritise the parent transaction by -1BTC,\n+    // bringing the package feerate to 0.\n+    m_node.mempool->PrioritiseTransaction(tx_parent->GetHash(), -1 * COIN);\n+    {\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const auto submit_cpfp_deprio = ProcessNewPackage(m_node.chainman->ActiveChainstate(), *m_node.mempool,\n+                                                   package_cpfp, /*test_accept=*/ false);\n+        BOOST_CHECK_MESSAGE(submit_cpfp_deprio.m_state.IsInvalid(),\n+                            \"Package validation unexpectedly succeeded: \" << submit_cpfp_deprio.m_state.GetRejectReason());\n+        BOOST_CHECK(submit_cpfp_deprio.m_tx_results.empty());\n+        BOOST_CHECK_EQUAL(m_node.mempool->size(), expected_pool_size);\n+        const CFeeRate expected_feerate(0, GetVirtualTransactionSize(*tx_parent) + GetVirtualTransactionSize(*tx_child));\n+        BOOST_CHECK(submit_cpfp_deprio.m_package_feerate.has_value());\n+        BOOST_CHECK(submit_cpfp_deprio.m_package_feerate.value() == CFeeRate{0});\n+        BOOST_CHECK_MESSAGE(submit_cpfp_deprio.m_package_feerate.value() == expected_feerate,",
      "path": "src/test/txpackage_tests.cpp",
      "position": 178,
      "original_position": 178,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "51edcffa0e156dba06191a8d5c636ba01fa5b65f",
      "in_reply_to_id": null,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: this last check is redundant with the previous since `expected_feerate` is already instantiated to 0",
      "created_at": "2022-05-30T21:33:43Z",
      "updated_at": "2022-06-09T17:33:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r885085169",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/885085169"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": 645,
      "original_start_line": 645,
      "start_side": "RIGHT",
      "line": 648,
      "original_line": 648,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/893777880",
      "pull_request_review_id": 989689132,
      "id": 893777880,
      "node_id": "PRRC_kwDOABII5841RffY",
      "diff_hunk": "@@ -1205,20 +1215,35 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n         m_viewmempool.PackageAddTransaction(ws.m_ptx);\n     }\n \n+    // Transactions must meet two minimum feerates: the mempool minimum fee and min relay fee.\n+    // For transactions consisting of exactly one child and its parents, it suffices to use the\n+    // package feerate (total modified fees / total virtual size) to check this requirement.\n+    const auto m_total_vsize = std::accumulate(workspaces.cbegin(), workspaces.cend(), int64_t{0},",
      "path": "src/validation.cpp",
      "position": 75,
      "original_position": 75,
      "commit_id": "9bebf35e269b2a918df27708565ecd0c5bd3f116",
      "original_commit_id": "17a8ffd8020375d60428695858558f2be264aa36",
      "in_reply_to_id": null,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "~~This assumes that `AcceptMultipleTransactions` always takes proper packages and that we can safely consider the aggregated feerate of the bunch of transactions. It's not the case.~~\r\n\r\n\r\nEDIT: i was reviewing an older version of this branch which was missing a fix.... (https://github.com/bitcoin/bitcoin/pull/24152#pullrequestreview-989689132)\r\n\r\n~~This patch demonstrates how this makes `testmempoolaccept` accept invalid transactions (by considering the package feerate for unrelated transactions):~~\r\n```patch\r\ndiff --git a/test/functional/mempool_accept.py b/test/functional/mempool_accept.py\r\nindex d3961e753d..f8dd380ee5 100755\r\n--- a/test/functional/mempool_accept.py\r\n+++ b/test/functional/mempool_accept.py\r\n@@ -333,6 +333,15 @@ class MempoolAcceptanceTest(BitcoinTestFramework):\r\n             maxfeerate=0,\r\n         )\r\n \r\n+        self.log.info(\"Don't consider package fees between unrelated transactions\")\r\n+        txs = [\r\n+            self.wallet.create_self_transfer(fee_rate=0, mempool_valid=False)['tx'],\r\n+            self.wallet.create_self_transfer()['tx'],\r\n+        ]\r\n+        res = self.nodes[0].testmempoolaccept([tx.serialize().hex() for tx in txs])\r\n+        # The first tx has a feerate of 0. No child pay for it. It should be rejected.\r\n+        assert not res[0][\"allowed\"]\r\n+\r\n \r\n if __name__ == '__main__':\r\n     MempoolAcceptanceTest().main()\r\n```",
      "created_at": "2022-06-09T17:27:06Z",
      "updated_at": "2022-06-10T09:48:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r893777880",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/893777880"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
        }
      },
      "start_line": 1231,
      "original_start_line": 1218,
      "start_side": "RIGHT",
      "line": 1234,
      "original_line": 1221,
      "side": "RIGHT"
    }
  ]
}