{
  "type": "issue",
  "issue": {
    "id": 820281159,
    "node_id": "MDU6SXNzdWU4MjAyODExNTk=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/21340",
    "number": 21340,
    "state": "closed",
    "state_reason": "completed",
    "title": "\"Unable to parse settings.json\" at startup after disk was full",
    "body": "This was reported to me by someone who had a crash issue after the disk was full, ostensibly unable to write `settings.json` and ending up with a truncated file. The solution was obvious in retrospect: delete it. But not everyone is going to figure this out by themselves.\r\n\r\nShould this error be fatal at all? Could it be ignored and logged? Or is a warning then deleting it better (at least in the GUI, that's harder to do for the daemon).\r\n\r\nAnother thing to look into might be to write the file atomically so that this doesn't occur.",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 241832923,
        "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
        "name": "Utils/log/libs",
        "description": "",
        "color": "5319e7",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 12,
    "closed_at": "2021-08-06T15:44:40Z",
    "created_at": "2021-03-02T18:37:30Z",
    "updated_at": "2023-03-20T15:38:32Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 4397487863,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQzOTc0ODc4NjM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4397487863",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-02T18:37:31Z",
      "label": {
        "name": "Utils/log/libs",
        "color": "5319e7"
      }
    },
    {
      "event": "commented",
      "id": 789349694,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTM0OTY5NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/789349694",
      "actor": {
        "login": "mat888",
        "id": 22969119,
        "node_id": "MDQ6VXNlcjIyOTY5MTE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/22969119?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mat888",
        "html_url": "https://github.com/mat888",
        "followers_url": "https://api.github.com/users/mat888/followers",
        "following_url": "https://api.github.com/users/mat888/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mat888/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mat888/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mat888/subscriptions",
        "organizations_url": "https://api.github.com/users/mat888/orgs",
        "repos_url": "https://api.github.com/users/mat888/repos",
        "events_url": "https://api.github.com/users/mat888/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mat888/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-03T01:17:07Z",
      "updated_at": "2021-03-03T01:17:07Z",
      "author_association": "NONE",
      "body": "So the `settings.json` file is becoming corrupted after the disk is full? That seems like a problem which should be avoided. I'm not sure deleting it, and removing any settings which may be important to the user should be the official solution.",
      "user": {
        "login": "mat888",
        "id": 22969119,
        "node_id": "MDQ6VXNlcjIyOTY5MTE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/22969119?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mat888",
        "html_url": "https://github.com/mat888",
        "followers_url": "https://api.github.com/users/mat888/followers",
        "following_url": "https://api.github.com/users/mat888/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mat888/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mat888/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mat888/subscriptions",
        "organizations_url": "https://api.github.com/users/mat888/orgs",
        "repos_url": "https://api.github.com/users/mat888/repos",
        "events_url": "https://api.github.com/users/mat888/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mat888/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-789349694",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "commented",
      "id": 789664942,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTY2NDk0Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/789664942",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-03T12:01:48Z",
      "updated_at": "2021-03-03T12:02:51Z",
      "author_association": "MEMBER",
      "body": "Yes, it is a problem that should be avoided (hence \"Another thing to look into might be to write the file atomically so that this doesn't occur.\"), but even then corruption can still happen and there needs to be a way to recover. I do agree silently deleting it would not be a good thing. A dialog at startup to continue with \"reset settings\" might do the trick better.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-789664942",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "referenced",
      "id": 4996728458,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ5OTY3Mjg0NTg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4996728458",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "cf472050f232dfac0f923ea99993fb7b607b955c",
      "commit_url": "https://api.github.com/repos/ryanofsky/gui/commits/cf472050f232dfac0f923ea99993fb7b607b955c",
      "created_at": "2021-07-08T19:06:48Z"
    },
    {
      "event": "commented",
      "id": 876692566,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg3NjY5MjU2Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/876692566",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-08T19:35:02Z",
      "updated_at": "2021-07-08T19:35:02Z",
      "author_association": "MEMBER",
      "body": "I think bitcoin-core/gui#379 should resolve this. It clarifies the error and adds an option in the gui to reset the file",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-876692566",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "commented",
      "id": 876779561,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg3Njc3OTU2MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/876779561",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-08T22:13:50Z",
      "updated_at": "2021-07-08T22:13:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "> So the `settings.json` file is becoming corrupted after the disk is full? \r\n\r\nWhen disk is totally full on Linux, any file randomly can be truncated to 0 size (the one you will try to overwrite at that moment). Guess solution could be to rename old file to temporary name before writing the new one and deleting old one only after the new one is saved correctly?",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-876779561",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "commented",
      "id": 876797245,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg3Njc5NzI0NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/876797245",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-08T23:02:18Z",
      "updated_at": "2021-07-14T18:52:00Z",
      "author_association": "MEMBER",
      "body": "> When disk is totally full on Linux, any file randomly can be truncated to 0 size (the one you will try to overwrite at that moment). \r\n\r\nInteresting. Is this documented somewhere? ~It definitely suggests regardless of any write errors that the settings read code should be treating an empty file the same as a non-existent file, and just ignoring it instead of triggering a fatal error.~ (EDIT: I don't think this anymore, see below)\r\n\r\nThis is an easy change to make but I'd also be curious to hear from @laanwj if he knows whether the file was truncated to size 0.\r\n\r\n> Guess solution could be to rename old file to temporary name before writing the new one and deleting old one only after the new one is saved correctly?\r\n\r\nI could be misunderstanding but I think this describes what happens currently: https://github.com/bitcoin/bitcoin/blob/df2b5dadfb2dc21b05e5a60b71987fb5b96201f5/src/util/system.cpp#L572-L579, but maybe there could be additional syncs or checks added?",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-876797245",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "mentioned",
      "id": 4997549077,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDk5NzU0OTA3Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4997549077",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-08T23:02:19Z"
    },
    {
      "event": "subscribed",
      "id": 4997549079,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5OTc1NDkwNzk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4997549079",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-08T23:02:19Z"
    },
    {
      "event": "commented",
      "id": 876800543,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg3NjgwMDU0Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/876800543",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-08T23:09:53Z",
      "updated_at": "2021-07-08T23:09:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Interesting. Is this documented somewhere?\r\n\r\nHaven't looked at the kernel code in detail for this, just my personal experience (had old blog written in PHP long long time ago where everything was saved in text files instead of proper database and file got truncated to zero bytes when partition ran out of space, IIRC code just read everything into memory, modified and then tried to overwrite old file).",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-876800543",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "referenced",
      "id": 5015847395,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUwMTU4NDczOTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5015847395",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ebfd619e3cfef148fd0e93ca00505d635636ac34",
      "commit_url": "https://api.github.com/repos/ryanofsky/gui/commits/ebfd619e3cfef148fd0e93ca00505d635636ac34",
      "created_at": "2021-07-13T19:21:29Z"
    },
    {
      "event": "commented",
      "id": 880147010,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg4MDE0NzAxMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880147010",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-14T19:20:06Z",
      "updated_at": "2021-07-14T19:21:14Z",
      "author_association": "MEMBER",
      "body": "> It definitely suggests regardless of any write errors that the settings read code should be treating an empty file the same as a non-existent file, and just ignoring it instead of triggering a fatal error.\r\n\r\nThinking about this more, I disagree with what I wrote earlier. Even if a settings file is truncated to size 0 and the old settings are completely lost (as opposed to partially corrupted), I still think the safest thing for `bitcoind` to do is refuse to start until the corrupt file is cleared away. It would unsafe to assume no important settings were saved before the corruption happened and just start anyway, because there could have been critical settings affecting security (sandbox settings) or privacy (tor settings, wallet settings) or performance (pruning, coins cache size) that would be important not to ignore before starting. So I don't think it would be good to treat a size 0 settings.json file differently than any other corrupt settings.json file.\r\n\r\nI also don't know of a way of avoiding corruption when writing to a full disk that would work better then the current approach of renaming a new file over the old one. Maybe bitcoin should generally shutdown or avoid writing things if disk space gets too low, though.\r\n\r\nI think since `bitcoind` is non-interactive, the best thing it can do on startup when settings are corrupt is show an error about the corruption, and exit like it is currently doing. Since `bitcoin-qt` is interactive, I think the change in bitcoin-core/gui#379 adding a dialog button to reset settings provides a decent way to recover there, and resolves this issue as well as we can for now\r\n\r\n![new-read-error](https://user-images.githubusercontent.com/7133040/124977636-b669b400-dffe-11eb-8d35-02eda95f48c0.png)\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-880147010",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "referenced",
      "id": 5088691626,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUwODg2OTE2MjY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5088691626",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1ee6d0b01a517893967379677029fb5417978247",
      "commit_url": "https://api.github.com/repos/ryanofsky/gui/commits/1ee6d0b01a517893967379677029fb5417978247",
      "created_at": "2021-07-29T23:08:46Z"
    },
    {
      "event": "closed",
      "id": 5123604305,
      "node_id": "MDExOkNsb3NlZEV2ZW50NTEyMzYwNDMwNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5123604305",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1ee6d0b01a517893967379677029fb5417978247",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/1ee6d0b01a517893967379677029fb5417978247",
      "created_at": "2021-08-06T15:44:40Z"
    },
    {
      "event": "referenced",
      "id": 5123604321,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMjM2MDQzMjE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5123604321",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7ebc4c668968da084d7258b32c5f3b2aceefc232",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/7ebc4c668968da084d7258b32c5f3b2aceefc232",
      "created_at": "2021-08-06T15:44:40Z"
    },
    {
      "event": "referenced",
      "id": 5124711956,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMjQ3MTE5NTY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5124711956",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1f3f166be5600443e8953db34d793011200be6d3",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/1f3f166be5600443e8953db34d793011200be6d3",
      "created_at": "2021-08-06T20:38:02Z"
    },
    {
      "event": "referenced",
      "id": 5158980183,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxNTg5ODAxODM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5158980183",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e39550162421d042fc3e8aa4a5aa86e678e30aec",
      "commit_url": "https://api.github.com/repos/stratospher/bitcoin/commits/e39550162421d042fc3e8aa4a5aa86e678e30aec",
      "created_at": "2021-08-14T18:11:17Z"
    },
    {
      "event": "referenced",
      "id": 5473707534,
      "node_id": "REFE_lADOABII584w5H9HzwAAAAFGQiYO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5473707534",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "0ce2f5b8461e903fdcc19cada321823b48247d1c",
      "commit_url": "https://api.github.com/repos/bitcoinknots/bitcoin/commits/0ce2f5b8461e903fdcc19cada321823b48247d1c",
      "created_at": "2021-10-17T02:39:36Z"
    },
    {
      "event": "referenced",
      "id": 5573551927,
      "node_id": "REFE_lADOABII584w5H9HzwAAAAFMNac3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5573551927",
      "actor": {
        "login": "janus",
        "id": 6726,
        "node_id": "MDQ6VXNlcjY3MjY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6726?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janus",
        "html_url": "https://github.com/janus",
        "followers_url": "https://api.github.com/users/janus/followers",
        "following_url": "https://api.github.com/users/janus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janus/subscriptions",
        "organizations_url": "https://api.github.com/users/janus/orgs",
        "repos_url": "https://api.github.com/users/janus/repos",
        "events_url": "https://api.github.com/users/janus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ad36bf5ddeaa40089d14a10d065c768b01122975",
      "commit_url": "https://api.github.com/repos/BitgesellOfficial/bitgesell/commits/ad36bf5ddeaa40089d14a10d065c768b01122975",
      "created_at": "2021-11-05T10:23:09Z"
    },
    {
      "event": "commented",
      "id": 1189963045,
      "node_id": "IC_kwDOABII585G7WUl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1189963045",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-20T08:08:48Z",
      "updated_at": "2022-07-20T08:08:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I think since `bitcoind` is non-interactive, the best thing it can do on startup when settings are corrupt is show an error about the corruption, and exit like it is currently doing.\r\n\r\nHad this on a Debian based machine recently. This error isn't written in `debug.log` (makes sense, settings haven't been loaded yet, so you don't know location of a file), on Systemd based machines only way to see this error will be to `sudo su - bitcoin` and then manually try to launch `bitcoind` process. Which isn't too user friendly.\r\n```\r\n$ sudo systemctl status bitcoind\r\n* bitcoind.service - Bitcoin daemon\r\n     Loaded: loaded (/etc/systemd/system/bitcoind.service; enabled; vendor preset: enabled)\r\n     Active: activating (auto-restart) (Result: exit-code) since Wed 2022-07-20 10:00:17 CEST; 23s ago\r\n    Process: 1354 ExecStart=/usr/local/bin/bitcoind -daemon -pid=/run/bitcoind/bitcoind.pid -conf=/home/bitcoin/.bitcoin/bitcoin.conf -datadir=/home/bitcoin/.bitcoin -startupnotify=chmod g+>\r\n\r\nJul 20 10:00:17 hostname systemd[1]: bitcoind.service: Control process exited, code=exited, status=1/FAILURE\r\nJul 20 10:00:17 hostname systemd[1]: bitcoind.service: Failed with result 'exit-code'.\r\nJul 20 10:00:17 hostname systemd[1]: Failed to start Bitcoin daemon.\r\n$ sudo journalctl -u bitcoin\r\n-- Logs begin at Wed 2022-07-20 09:57:42 CEST, end at Wed 2022-07-20 10:00:26 CEST. --\r\n-- No entries --\r\n$ sudo su - bitcoin\r\n$ bitcoind -daemon -pid=/run/bitcoind/bitcoind.pid -conf=/home/bitcoin/.bitcoin/bitcoin.conf -datadir=/home/bitcoin/.bitcoin\r\nError: Failed loading settings file:\r\n- Unable to parse settings file /home/bitcoin/.bitcoin/settings.json\r\n\r\n```",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-1189963045",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "commented",
      "id": 1189991658,
      "node_id": "IC_kwDOABII585G7dTq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1189991658",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-20T08:37:05Z",
      "updated_at": "2022-07-20T08:37:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Another thing - in this case `settings.json` was anyways \"empty\" (just `{ }`). Probably we should avoid creating it at all if there are no settings to save there?",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-1189991658",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "commented",
      "id": 1198395786,
      "node_id": "IC_kwDOABII585HbhGK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198395786",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T16:50:31Z",
      "updated_at": "2022-07-28T16:50:31Z",
      "author_association": "MEMBER",
      "body": "> Another thing - in this case `settings.json` was anyways \"empty\" (just `{ }`). Probably we should avoid creating it at all if there are no settings to save there?\r\n\r\nI don't have a firm opinion on this, but the settings file is written on startup unconditionally (unless `-nosettings` is specified) to:\r\n\r\n- Show an error message as early as possible if the file is not writable, instead of later when wallets are loaded or when settings are changing, so changes are not lost if there is a write error and problems can be addressed more easily.\r\n- Help debug configuration issues. Let someone see what settings file is in use from the directory listing and file modification time and avoid confusion about what settings path is in use",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-1198395786",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "commented",
      "id": 1198401668,
      "node_id": "IC_kwDOABII585HbiiE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198401668",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T16:56:57Z",
      "updated_at": "2022-07-28T16:57:17Z",
      "author_association": "MEMBER",
      "body": "> Had this on a Debian based machine recently. This error isn't written in `debug.log` (makes sense, settings haven't been loaded yet, so you don't know location of a file), on Systemd based machines only way to see this error will be to `sudo su - bitcoin` and then manually try to launch `bitcoind` process. Which isn't too user friendly.\r\n\r\nThis seems bad. I would expect the message also to be written to stderr and show up in the journald log file. I noticed the command you used is `journalctl -u bitcoin` and maybe that should be `journalctl -u bitcoind`? But maybe also there is problem with the debian systemd file not capturing stderr. This seems like something that could be addressed and discussed further if you have more information and want to open an issue about the missing error.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-1198401668",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    },
    {
      "event": "commented",
      "id": 1476464194,
      "node_id": "IC_kwDOABII585YAQ5C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476464194",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T15:37:12Z",
      "updated_at": "2023-03-20T15:38:32Z",
      "author_association": "MEMBER",
      "body": "One of my boxes running `v24.0.1` just encountered a low storage situation, and `/var/lib/bitcoind/settings.json` was truncated to 0 size.\r\n\r\nFrom my `journalctl`:\r\n```\r\nMar 20 11:33:05 hostname bitcoind[935629]: Error: Failed loading settings file:\r\nMar 20 11:33:05 hostname bitcoind[935629]: - Unable to parse settings file /var/lib/bitcoind/settings.json\r\nMar 20 11:33:05 hostname systemd[1]: bitcoind.service: Control process exited, code=exited, status=1/FAILURE\r\n```\r\n\r\nI'm not sure what to do in a situation like this, is trying to proceed without the settings applied safe? Is it possible the user might have set pruning settings in `settings.json` and proceeding without the settings applied would worsen the low storage situation?\r\n\r\n> This seems bad. I would expect the message also to be written to stderr and show up in the journald log file.\r\n\r\nUnfortunately the current [`bitcoind.service`](https://github.com/bitcoin/bitcoin/blob/40e1c4d4024b8ad35f2511b2e10bf80c5531dfde/contrib/init/bitcoind.service) in the repo does not print logs to `journald`, which I think is unfortunate. Here's my fix: https://github.com/bitcoin/bitcoin/pull/25975\r\n",
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21340#issuecomment-1476464194",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21340"
    }
  ]
}