{
  "type": "issue",
  "issue": {
    "id": 475803273,
    "node_id": "MDU6SXNzdWU0NzU4MDMyNzM=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16520",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16520/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16520/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16520/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/16520",
    "number": 16520,
    "state": "closed",
    "state_reason": "completed",
    "title": "test: feature_pruning fails with \"invalid header received\" (intermittent)",
    "body": "Current master.\r\n\r\n\r\nexcerpt from log:\r\n\r\n```\r\n node0 2019-07-30T22:06:01.182801Z [httpworker.1] UpdateTip: new best=7ab45b35f902d9c29b48424b452e715bd2cc82fe1c3fe906f35e6487770c64af height=1528 version=0x20000000 log2_work=11.578373 tx=1529 date='2019-07-30T22:07:39Z' progress=1.000000 cache=0.1MiB(858txo)\r\n node0 2019-07-30T22:06:01.182860Z [httpworker.1]   - Connect postprocess: 0.61ms [4.21s (1.56ms/blk)]\r\n node0 2019-07-30T22:06:01.182899Z [httpworker.1] - Connect block: 1.84ms [115.73s (42.96ms/blk)]\r\n node0 2019-07-30T22:06:01.182970Z [httpworker.1] Checking mempool with 0 transactions and 0 inputs\r\n node0 2019-07-30T22:06:01.190272Z [scheduler] [default wallet] AddToWallet 17ecd52d2c177743bb26c9a400aaf6cfd8b902211e955da654b3cc6282c3addd  new\r\n node0 2019-07-30T22:06:01.190843Z [msghand] SendMessages: sending inv peer=28 hash=7ab45b35f902d9c29b48424b452e715bd2cc82fe1c3fe906f35e6487770c64af\r\n node0 2019-07-30T22:06:01.190958Z [msghand] sending inv (37 bytes) peer=28\r\n node1 2019-07-30T22:06:01.191437Z [msghand] received: inv (37 bytes) peer=14\r\n node1 2019-07-30T22:06:01.191565Z [msghand] got inv: block 7ab45b35f902d9c29b48424b452e715bd2cc82fe1c3fe906f35e6487770c64af  new peer=14\r\n node1 2019-07-30T22:06:01.191638Z [msghand] sending getheaders (741 bytes) peer=14\r\n node1 2019-07-30T22:06:01.191796Z [msghand] getheaders (1552) 7ab45b35f902d9c29b48424b452e715bd2cc82fe1c3fe906f35e6487770c64af to peer=14\r\n node0 2019-07-30T22:06:01.192116Z [msghand] received: getheaders (741 bytes) peer=28\r\n node0 2019-07-30T22:06:01.192227Z [msghand] getheaders 1032 to 7ab45b35f902d9c29b48424b452e715bd2cc82fe1c3fe906f35e6487770c64af from peer=28\r\n node0 2019-07-30T22:06:01.193508Z [msghand] sending headers (40260 bytes) peer=28\r\n node1 2019-07-30T22:06:01.195532Z [msghand] received: headers (40260 bytes) peer=14\r\n test  2019-07-30T22:06:01.197000Z TestFramework (INFO): Verify node 2 reorged back to the main chain, some blocks of which it had to redownload\r\n node2 2019-07-30T22:06:01.204025Z [http] Received a POST request for / from 127.0.0.1:57753\r\n node2 2019-07-30T22:06:01.204272Z [httpworker.1] ThreadRPCServer method=getblockcount user=__cookie__\r\n node1 2019-07-30T22:06:01.205540Z [msghand] ERROR: AcceptBlockHeader: block 7ae135ed9c9ee74d2070a1f438cfcf24fcef27e6c60915bfccb17b249f3411b4 is marked invalid\r\n node1 2019-07-30T22:06:01.210958Z [msghand] peer=14: invalid header received\r\n node1 2019-07-30T22:06:01.211261Z [msghand] ProcessMessages(headers, 40260 bytes) FAILED peer=14\r\n node2 2019-07-30T22:06:01.257383Z [http] Received a POST request for / from 127.0.0.1:57753\r\n node2 2019-07-30T22:06:01.257592Z [httpworker.0] ThreadRPCServer method=getblockcount user=__cookie__\r\n...\r\n...\r\n...\r\n node2 2019-07-30T22:21:01.184799Z [httpworker.0] ThreadRPCServer method=getblockcount user=__cookie__\r\n test  2019-07-30T22:21:01.603000Z TestFramework.utils (ERROR): wait_until() failed. Predicate: ''''\r\n                                           wait_until(lambda: self.nodes[2].getblockcount() >= goalbestheight, timeout=900)\r\n                                   '''\r\n test  2019-07-30T22:21:01.607000Z TestFramework (ERROR): Assertion failed\r\n                                   Traceback (most recent call last):\r\n                                     File \"/root/workspace/bitcoin-core/test/functional/test_framework/test_framework.py\", line 193, in main\r\n                                       self.run_test()\r\n                                     File \"/root/workspace/bitcoin-core/test/functional/feature_pruning.py\", line 429, in run_test\r\n                                       self.reorg_back()\r\n                                     File \"/root/workspace/bitcoin-core/test/functional/feature_pruning.py\", line 250, in reorg_back\r\n                                       wait_until(lambda: self.nodes[2].getblockcount() >= goalbestheight, timeout=900)\r\n                                     File \"/root/workspace/bitcoin-core/test/functional/test_framework/util.py\", line 225, in wait_until\r\n                                       raise AssertionError(\"Predicate {} not true after {} seconds\".format(predicate_source, timeout))\r\n                                   AssertionError: Predicate ''''\r\n                                           wait_until(lambda: self.nodes[2].getblockcount() >= goalbestheight, timeout=900)\r\n                                   ''' not true after 900 seconds\r\n",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 0,
    "closed_at": "2019-08-05T11:51:26Z",
    "created_at": "2019-08-01T17:30:36Z",
    "updated_at": "2021-12-16T14:09:05Z"
  },
  "events": [
    {
      "event": "renamed",
      "id": 2527329920,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjUyNzMyOTkyMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2527329920",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-08-01T17:30:53Z",
      "rename": {
        "from": "feature_pruning fails with \"invalid header received\"",
        "to": "test: feature_pruning fails with \"invalid header received\""
      }
    },
    {
      "event": "labeled",
      "id": 2527777036,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDI1Mjc3NzcwMzY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2527777036",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-08-01T20:28:12Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "renamed",
      "id": 2531279958,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50MjUzMTI3OTk1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2531279958",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-08-03T11:55:47Z",
      "rename": {
        "from": "test: feature_pruning fails with \"invalid header received\"",
        "to": "test: feature_pruning fails with \"invalid header received\" (intermittent)"
      }
    },
    {
      "event": "closed",
      "id": 2533249119,
      "node_id": "MDExOkNsb3NlZEV2ZW50MjUzMzI0OTExOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2533249119",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-08-05T11:51:26Z"
    },
    {
      "event": "referenced",
      "id": 2533249752,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI1MzMyNDk3NTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2533249752",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "6b6386e854920be76073ce60d9407c35f2914f5b",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b6386e854920be76073ce60d9407c35f2914f5b",
      "created_at": "2019-08-05T11:51:41Z"
    },
    {
      "event": "referenced",
      "id": 5550949291,
      "node_id": "REFE_lADOABII584cXC6JzwAAAAFK3MOr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5550949291",
      "actor": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "5060fe016995965476081bdfd2699a8704afaf58",
      "commit_url": "https://api.github.com/repos/PastaPastaPasta/dash/commits/5060fe016995965476081bdfd2699a8704afaf58",
      "created_at": "2021-11-01T19:15:44Z"
    },
    {
      "event": "referenced",
      "id": 5563233927,
      "node_id": "REFE_lADOABII584cXC6JzwAAAAFLmDaH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5563233927",
      "actor": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7dca136101c8b872a03c0ae3c6a1704133bbb032",
      "commit_url": "https://api.github.com/repos/PastaPastaPasta/dash/commits/7dca136101c8b872a03c0ae3c6a1704133bbb032",
      "created_at": "2021-11-03T16:24:19Z"
    },
    {
      "event": "referenced",
      "id": 5640695095,
      "node_id": "REFE_lADOABII584cXC6JzwAAAAFQNi03",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5640695095",
      "actor": {
        "login": "pravblockc",
        "id": 51935684,
        "node_id": "MDQ6VXNlcjUxOTM1Njg0",
        "avatar_url": "https://avatars.githubusercontent.com/u/51935684?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pravblockc",
        "html_url": "https://github.com/pravblockc",
        "followers_url": "https://api.github.com/users/pravblockc/followers",
        "following_url": "https://api.github.com/users/pravblockc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pravblockc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pravblockc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pravblockc/subscriptions",
        "organizations_url": "https://api.github.com/users/pravblockc/orgs",
        "repos_url": "https://api.github.com/users/pravblockc/repos",
        "events_url": "https://api.github.com/users/pravblockc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pravblockc/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "34706e6e2e5a11b17791f549a90801cf27f28d2d",
      "commit_url": "https://api.github.com/repos/pravblockc/dash/commits/34706e6e2e5a11b17791f549a90801cf27f28d2d",
      "created_at": "2021-11-18T18:27:56Z"
    },
    {
      "event": "locked",
      "id": 5778604662,
      "node_id": "LOE_lADOABII584cXC6JzwAAAAFYboJ2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5778604662",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-12-16T14:09:05Z",
      "lock_reason": "resolved"
    }
  ]
}