{
  "type": "issue",
  "issue": {
    "id": 100350443,
    "node_id": "MDU6SXNzdWUxMDAzNTA0NDM=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/6547",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/6547/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/6547/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/6547/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/6547",
    "number": 6547,
    "state": "closed",
    "state_reason": "completed",
    "title": "decoderawtransaction, different parsing of the same script",
    "body": "I used to think the addresses array into the scriptPubKey (vout) is populated starting from the script, but examining old-fashion multisig transactions, I discovered something made my assumption wrong:\n\nGiven this three vouts:\n\n{\n    \"value\" : 0.01000000,\n    \"n\" : 0,\n    \"scriptPubKey\" : {\n        \"asm\" : \"1 04cc71eb30d653c0c3163990c47b976f3fb3f37cccdcbedb169a1dfef58bbfbfaff7d8a473e7e2e6d317b87bafe8bde97e3cf8f065dec022b51d11fcdd0d348ac4 0461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342af 2 OP_CHECKMULTISIG\",\n        \"hex\" : \"514104cc71eb30d653c0c3163990c47b976f3fb3f37cccdcbedb169a1dfef58bbfbfaff7d8a473e7e2e6d317b87bafe8bde97e3cf8f065dec022b51d11fcdd0d348ac4410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342af52ae\",\n        \"reqSigs\" : 1,\n        \"type\" : \"multisig\",\n        \"addresses\" : [\n            \"1AJbsFZ64EpEfS5UAjAfcUG8pH8Jn3rn1F\",\n            \"1A8JiWcwvpY7tAopUkSnGuEYHmzGYfZPiq\"\n        ]\n    }\n}\n\n{\n    \"value\" : 0.00000002,\n    \"n\" : 0,\n    \"scriptPubKey\" : {\n        \"asm\" : \"1 0351efb6e91a31221652105d032a2508275f374cea63939ad72f1b1e02f477da78 00f2b7816db49d55d24df7bdffdbc1e203b424e8cd39f5651ab938e5e4a193569e 2 OP_CHECKMULTISIG\",\n        \"hex\" : \"51210351efb6e91a31221652105d032a2508275f374cea63939ad72f1b1e02f477da782100f2b7816db49d55d24df7bdffdbc1e203b424e8cd39f5651ab938e5e4a193569e52ae\",\n        \"reqSigs\" : 1,\n        \"type\" : \"multisig\",\n        \"addresses\" : [\n            \"1NdB761LmTmrJixxp93nz7pEiCx5cKPW44\"\n        ]\n    }\n}\nwhich comes respectively from transactions:\n\n60a20bd93aa49ab4b28d514ec10b06e1829ce6818ec06cd3aabd013ebcdc4bb1 274f8be3b7b9b1a220285f5f71f61e2691dd04df9d69bb02a8b3b85f91fb1857\n\nI have noticed that they share the same script:\n\nOP1 OPDATA OPDATA OP2 OP_CHECKMULTISIG\n\nbut with different results.\n\nIn the first one transaction you can see two addresses in the addresses array, in the second one you can see only an address.\n\nAlso, given this one:\n\n{\n    \"value\" : 0.00000001,\n    \"n\" : 22,\n    \"scriptPubKey\" : {\n        \"asm\" : \"1 6565292c66696c653d7379732e737464657272290a0a69662046616c73653a0a202020207072696e742870726f78792e73656e647261777472616e73616374696f 6e287369676e65645f74785b27686578275d29290a656c73653a0a202020207072696e74287369676e65645f7478290a0000000000000000000000000000000000 2 OP_CHECKMULTISIG\",\n        \"hex\" : \"51416565292c66696c653d7379732e737464657272290a0a69662046616c73653a0a202020207072696e742870726f78792e73656e647261777472616e73616374696f416e287369676e65645f74785b27686578275d29290a656c73653a0a202020207072696e74287369676e65645f7478290a000000000000000000000000000000000052ae\",\n        \"type\" : \"multisig\"\n    }\n}\nwhich comes from transaction 4b72a223007eab8a951d43edc171befeabc7b5dca4213770c88e09ba5b936e17\n\nNo reqsigs nor addresses comes in the parsed transaction.\n\nSo, I think I am a little confused on how addresses array is populated, or this is a bug of the decoderawtransaction method.\n",
    "user": {
      "login": "gdassori",
      "id": 5659270,
      "node_id": "MDQ6VXNlcjU2NTkyNzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5659270?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gdassori",
      "html_url": "https://github.com/gdassori",
      "followers_url": "https://api.github.com/users/gdassori/followers",
      "following_url": "https://api.github.com/users/gdassori/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/gdassori/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/gdassori/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/gdassori/subscriptions",
      "organizations_url": "https://api.github.com/users/gdassori/orgs",
      "repos_url": "https://api.github.com/users/gdassori/repos",
      "events_url": "https://api.github.com/users/gdassori/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/gdassori/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 1,
    "closed_at": "2015-08-11T17:21:46Z",
    "created_at": "2015-08-11T16:18:08Z",
    "updated_at": "2021-09-08T12:48:28Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 129977608,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyOTk3NzYwOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/129977608",
      "actor": {
        "login": "gdassori",
        "id": 5659270,
        "node_id": "MDQ6VXNlcjU2NTkyNzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5659270?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gdassori",
        "html_url": "https://github.com/gdassori",
        "followers_url": "https://api.github.com/users/gdassori/followers",
        "following_url": "https://api.github.com/users/gdassori/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gdassori/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gdassori/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gdassori/subscriptions",
        "organizations_url": "https://api.github.com/users/gdassori/orgs",
        "repos_url": "https://api.github.com/users/gdassori/repos",
        "events_url": "https://api.github.com/users/gdassori/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gdassori/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-08-11T17:21:35Z",
      "updated_at": "2015-08-11T17:21:35Z",
      "author_association": "NONE",
      "body": "Looks like it's related to \nhttps://github.com/bitcoin/bitcoin/blob/master/src/pubkey.h#L48.\n\nAs far as I've understand (also thanks to #bitcoin @ freenode users) the pubkeys I was trying to decode didn't match this check, so, for the records: in the examples mentioned, the addresses array (and the reqSigs int) is populated only when the first byte of the pubkey match the checks for the relative length (compressed or not).\n",
      "user": {
        "login": "gdassori",
        "id": 5659270,
        "node_id": "MDQ6VXNlcjU2NTkyNzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5659270?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gdassori",
        "html_url": "https://github.com/gdassori",
        "followers_url": "https://api.github.com/users/gdassori/followers",
        "following_url": "https://api.github.com/users/gdassori/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gdassori/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gdassori/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gdassori/subscriptions",
        "organizations_url": "https://api.github.com/users/gdassori/orgs",
        "repos_url": "https://api.github.com/users/gdassori/repos",
        "events_url": "https://api.github.com/users/gdassori/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gdassori/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/6547#issuecomment-129977608",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/6547"
    },
    {
      "event": "closed",
      "id": 379416169,
      "node_id": "MDExOkNsb3NlZEV2ZW50Mzc5NDE2MTY5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/379416169",
      "actor": {
        "login": "gdassori",
        "id": 5659270,
        "node_id": "MDQ6VXNlcjU2NTkyNzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5659270?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gdassori",
        "html_url": "https://github.com/gdassori",
        "followers_url": "https://api.github.com/users/gdassori/followers",
        "following_url": "https://api.github.com/users/gdassori/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gdassori/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gdassori/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gdassori/subscriptions",
        "organizations_url": "https://api.github.com/users/gdassori/orgs",
        "repos_url": "https://api.github.com/users/gdassori/repos",
        "events_url": "https://api.github.com/users/gdassori/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gdassori/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-08-11T17:21:46Z"
    },
    {
      "event": "locked",
      "id": 5272090161,
      "node_id": "LOE_lADOABII584F-znrzwAAAAE6PbYx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5272090161",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T12:48:28Z",
      "lock_reason": "resolved"
    }
  ]
}