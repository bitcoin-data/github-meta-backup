{
  "type": "issue",
  "issue": {
    "id": 298225254,
    "node_id": "MDU6SXNzdWUyOTgyMjUyNTQ=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12481",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12481/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12481/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12481/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/12481",
    "number": 12481,
    "state": "closed",
    "state_reason": "completed",
    "title": "bitcoind + testnet on same machine fails when zmq is active",
    "body": "\r\n<!-- Describe the issue -->\r\nTrying to run bitcoind node and a testnet node on the same machine, but starting testnet fails when zmq is active\r\n\r\n```\r\n$ bitcoind  -testnet\r\nbitcoind: zmq/zmqpublishnotifier.cpp:104: virtual void CZMQAbstractPublishNotifier::Shutdown(): Assertion `psocket' failed.\r\nAborted (core dumped)\r\n```\r\nWhen zmqnotifications is configured only on mainnet, the testnet fails to start (even when zmq is disabled or configured with different port on testnet).\r\n\r\n\r\n<!--- What behavior did you expect? -->\r\n\r\n<!--- What was the actual behavior (provide screenshots if the issue is GUI-related)? -->\r\n\r\n<!--- How reliably can you reproduce the issue, what are the steps to do so? -->\r\n\r\n<!-- What version of Bitcoin Core are you using, where did you get it (website, self-compiled, etc)? -->\r\n0.16rc4\r\n\r\n<!-- What type of machine are you observing the error on (OS/CPU and disk type)? -->\r\nubuntu 16.04\r\n<!-- Any extra information that might be useful in the debugging process. -->\r\n<!--- This is normally the contents of a `debug.log` or `config.log` file. Raw text or a link to a pastebin type site are preferred. -->\r\n",
    "user": {
      "login": "Alex-CodeLab",
      "id": 1678423,
      "node_id": "MDQ6VXNlcjE2Nzg0MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1678423?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Alex-CodeLab",
      "html_url": "https://github.com/Alex-CodeLab",
      "followers_url": "https://api.github.com/users/Alex-CodeLab/followers",
      "following_url": "https://api.github.com/users/Alex-CodeLab/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/Alex-CodeLab/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/Alex-CodeLab/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/Alex-CodeLab/subscriptions",
      "organizations_url": "https://api.github.com/users/Alex-CodeLab/orgs",
      "repos_url": "https://api.github.com/users/Alex-CodeLab/repos",
      "events_url": "https://api.github.com/users/Alex-CodeLab/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/Alex-CodeLab/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 2,
    "closed_at": "2018-02-21T08:40:53Z",
    "created_at": "2018-02-19T10:27:06Z",
    "updated_at": "2021-09-08T12:27:42Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 1481147040,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDE0ODExNDcwNDA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1481147040",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-02-19T19:08:39Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "commented",
      "id": 367031402,
      "node_id": "MDEyOklzc3VlQ29tbWVudDM2NzAzMTQwMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/367031402",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-02-20T16:20:10Z",
      "updated_at": "2018-02-20T16:20:10Z",
      "author_association": "MEMBER",
      "body": "Can you post the configuration and debug.log?",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/12481#issuecomment-367031402",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12481"
    },
    {
      "event": "commented",
      "id": 367147858,
      "node_id": "MDEyOklzc3VlQ29tbWVudDM2NzE0Nzg1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/367147858",
      "actor": {
        "login": "Alex-CodeLab",
        "id": 1678423,
        "node_id": "MDQ6VXNlcjE2Nzg0MjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1678423?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Alex-CodeLab",
        "html_url": "https://github.com/Alex-CodeLab",
        "followers_url": "https://api.github.com/users/Alex-CodeLab/followers",
        "following_url": "https://api.github.com/users/Alex-CodeLab/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Alex-CodeLab/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Alex-CodeLab/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Alex-CodeLab/subscriptions",
        "organizations_url": "https://api.github.com/users/Alex-CodeLab/orgs",
        "repos_url": "https://api.github.com/users/Alex-CodeLab/repos",
        "events_url": "https://api.github.com/users/Alex-CodeLab/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Alex-CodeLab/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-02-20T22:46:47Z",
      "updated_at": "2018-02-21T08:40:30Z",
      "author_association": "NONE",
      "body": "testnet3/debug.log \r\n\r\n```\r\n2018-02-21 08:27:33 Bitcoin Core version v0.16.0rc4 (release build)\r\n2018-02-21 08:27:33 InitParameterInteraction: parameter interaction: -whitelistforcerelay=1 -> setting -whitelistrelay=1\r\n2018-02-21 08:27:33 Assuming ancestors of block 0000000002e9e7b00e1f6dc5123a04aad68dd0f0968d8c7aa45f6640795c37b1 have valid signatures.\r\n2018-02-21 08:27:33 Setting nMinimumChainWork=00000000000000000000000000000000000000000000002830dab7f76dbb7d63\r\n2018-02-21 08:27:33 Using the 'standard' SHA256 implementation\r\n2018-02-21 08:27:33 Default data directory /home/user/.bitcoin\r\n2018-02-21 08:27:33 Using data directory /home/user/.bitcoin/testnet3\r\n2018-02-21 08:27:33 Using config file /home/user/.bitcoin/bitcoin.conf\r\n2018-02-21 08:27:33 Using at most 125 automatic connections (1024 file descriptors available)\r\n2018-02-21 08:27:33 Using 16 MiB out of 32/2 requested for signature cache, able to store 524288 elements\r\n2018-02-21 08:27:33 Using 16 MiB out of 32/2 requested for script execution cache, able to store 524288 elements\r\n2018-02-21 08:27:33 Using 2 threads for script verification\r\n2018-02-21 08:27:33 scheduler thread start\r\n2018-02-21 08:27:33 Binding RPC on address 0.0.0.0 port 18332 failed.\r\n2018-02-21 08:27:33 HTTP: creating work queue of depth 16\r\n2018-02-21 08:27:33 Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcuser for rpcauth auth generation.\r\n2018-02-21 08:27:33 HTTP: starting 4 worker threads\r\n2018-02-21 08:27:33 Using wallet directory /home/user/.bitcoin/testnet3\r\n2018-02-21 08:27:33 init message: Verifying wallet(s)...\r\n2018-02-21 08:27:33 Using BerkeleyDB version Berkeley DB 4.8.30: (April  9, 2010)\r\n2018-02-21 08:27:33 Using wallet wallet.dat\r\n2018-02-21 08:27:33 CDBEnv::Open: LogDir=/home/user/.bitcoin/testnet3/database ErrorFile=/home/user/.bitcoin/testnet3/db.log\r\n```\r\n\r\n\r\ntestnet3/bitcoin.conf \r\n```\r\nlisten=1\r\nrpcport=8444\r\ntestnet=1\r\ncheckblocks=50\r\n#zmqpubrawtx=tcp://127.0.0.1:28441\r\n#zmqpubhashtx=tcp://127.0.0.1:28442\r\n#zmqpubhashblock=tcp://127.0.0.1:28443\r\n#zmqpubrawblock=tcp://127.0.0.1:28444\r\n#zmqpubrawtx=tcp://127.0.0.1:28445\r\n\r\n```\r\n\r\n\r\n[update].. ok, I noticed it does not automatically look for a `bitcoin.conf` file in the `testnet3/` folder, so it reads the regular conf.  I guess it works as expected, and I have to add the location of the testnet conf using the `-conf=` option\r\n\r\n\r\n\r\n\r\n",
      "user": {
        "login": "Alex-CodeLab",
        "id": 1678423,
        "node_id": "MDQ6VXNlcjE2Nzg0MjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1678423?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Alex-CodeLab",
        "html_url": "https://github.com/Alex-CodeLab",
        "followers_url": "https://api.github.com/users/Alex-CodeLab/followers",
        "following_url": "https://api.github.com/users/Alex-CodeLab/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Alex-CodeLab/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Alex-CodeLab/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Alex-CodeLab/subscriptions",
        "organizations_url": "https://api.github.com/users/Alex-CodeLab/orgs",
        "repos_url": "https://api.github.com/users/Alex-CodeLab/repos",
        "events_url": "https://api.github.com/users/Alex-CodeLab/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Alex-CodeLab/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/12481#issuecomment-367147858",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12481"
    },
    {
      "event": "closed",
      "id": 1484145503,
      "node_id": "MDExOkNsb3NlZEV2ZW50MTQ4NDE0NTUwMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1484145503",
      "actor": {
        "login": "Alex-CodeLab",
        "id": 1678423,
        "node_id": "MDQ6VXNlcjE2Nzg0MjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1678423?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Alex-CodeLab",
        "html_url": "https://github.com/Alex-CodeLab",
        "followers_url": "https://api.github.com/users/Alex-CodeLab/followers",
        "following_url": "https://api.github.com/users/Alex-CodeLab/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Alex-CodeLab/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Alex-CodeLab/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Alex-CodeLab/subscriptions",
        "organizations_url": "https://api.github.com/users/Alex-CodeLab/orgs",
        "repos_url": "https://api.github.com/users/Alex-CodeLab/repos",
        "events_url": "https://api.github.com/users/Alex-CodeLab/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Alex-CodeLab/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-02-21T08:40:53Z"
    },
    {
      "event": "locked",
      "id": 5271977106,
      "node_id": "LOE_lADOABII584Rxo5mzwAAAAE6O_yS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5271977106",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T12:27:42Z",
      "lock_reason": "resolved"
    }
  ]
}