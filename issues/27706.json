{
  "type": "issue",
  "issue": {
    "id": 1718145240,
    "node_id": "I_kwDOABII585maNDY",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/27706",
    "number": 27706,
    "state": "closed",
    "state_reason": "completed",
    "title": "Compute 'short id' when transaction joins mempool",
    "body": "When a node receives a `cmpctblock` it has to verify to its check mempool in order to know whether it has all the required transactions to construct that block. If it doesn't, it will send `getblocktxn` to fetch the missing tx{s}. \r\n\r\n`PartiallyDownloadedBlock::InitData` shows we have to iterate the whole mempool in order to get the short id and do the verifications, see:\r\n```cpp\r\nfor (size_t i = 0; i < pool->vTxHashes.size(); i++) {\r\n    uint64_t shortid = cmpctblock.GetShortID(pool->vTxHashes[i].first);\r\n    std::unordered_map<uint64_t, uint16_t>::iterator idit = shorttxids.find(shortid);\r\n    if (idit != shorttxids.end()) {\r\n        if (!have_txn[idit->second]) {\r\n            txn_available[idit->second] = pool->vTxHashes[i].second->GetSharedTx();\r\n            have_txn[idit->second]  = true;\r\n            mempool_count++;\r\n        } else {\r\n            // If we find two mempool txn that match the short id, just request it.\r\n            // This should be rare enough that the extra bandwidth doesn't matter,\r\n            // but eating a round-trip due to FillBlock failure would be annoying\r\n            if (txn_available[idit->second]) {\r\n                txn_available[idit->second].reset();\r\n                mempool_count--;\r\n            }\r\n        }\r\n    }\r\n    // Though ideally we'd continue scanning for the two-txn-match-shortid case,\r\n    // the performance win of an early exit here is too good to pass up and worth\r\n    // the extra risk.\r\n    if (mempool_count == shorttxids.size())\r\n        break;\r\n}\r\n```\r\n\r\nThis means that every time we receive a compact block we have to iterate the whole mempool and calculate the \"short id\"s all over again. Couldn't`CTxMemPool` have a hashmap where we could store the transactions' short id right after joining the mempool and remove it once the tx gets confirmed/out of mempool?",
    "user": {
      "login": "brunoerg",
      "id": 19480819,
      "node_id": "MDQ6VXNlcjE5NDgwODE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brunoerg",
      "html_url": "https://github.com/brunoerg",
      "followers_url": "https://api.github.com/users/brunoerg/followers",
      "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
      "organizations_url": "https://api.github.com/users/brunoerg/orgs",
      "repos_url": "https://api.github.com/users/brunoerg/repos",
      "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/brunoerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 477890092,
        "node_id": "MDU6TGFiZWw0Nzc4OTAwOTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Questions%20and%20Help",
        "name": "Questions and Help",
        "color": "006688",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 7,
    "closed_at": "2023-05-22T08:56:02Z",
    "created_at": "2023-05-20T11:38:09Z",
    "updated_at": "2023-05-22T08:56:03Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 1555893035,
      "node_id": "IC_kwDOABII585cvQsr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555893035",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T11:38:48Z",
      "updated_at": "2023-05-20T11:38:48Z",
      "author_association": "MEMBER",
      "body": "cc: @Davidson-Souza",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555893035",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706"
    },
    {
      "event": "mentioned",
      "id": 9294354892,
      "node_id": "MEE_lADOABII585maNDYzwAAAAIp_JnM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9294354892",
      "actor": {
        "login": "Davidson-Souza",
        "id": 40968167,
        "node_id": "MDQ6VXNlcjQwOTY4MTY3",
        "avatar_url": "https://avatars.githubusercontent.com/u/40968167?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Davidson-Souza",
        "html_url": "https://github.com/Davidson-Souza",
        "followers_url": "https://api.github.com/users/Davidson-Souza/followers",
        "following_url": "https://api.github.com/users/Davidson-Souza/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Davidson-Souza/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Davidson-Souza/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Davidson-Souza/subscriptions",
        "organizations_url": "https://api.github.com/users/Davidson-Souza/orgs",
        "repos_url": "https://api.github.com/users/Davidson-Souza/repos",
        "events_url": "https://api.github.com/users/Davidson-Souza/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Davidson-Souza/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T11:38:48Z"
    },
    {
      "event": "subscribed",
      "id": 9294354894,
      "node_id": "SE_lADOABII585maNDYzwAAAAIp_JnO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9294354894",
      "actor": {
        "login": "Davidson-Souza",
        "id": 40968167,
        "node_id": "MDQ6VXNlcjQwOTY4MTY3",
        "avatar_url": "https://avatars.githubusercontent.com/u/40968167?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Davidson-Souza",
        "html_url": "https://github.com/Davidson-Souza",
        "followers_url": "https://api.github.com/users/Davidson-Souza/followers",
        "following_url": "https://api.github.com/users/Davidson-Souza/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Davidson-Souza/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Davidson-Souza/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Davidson-Souza/subscriptions",
        "organizations_url": "https://api.github.com/users/Davidson-Souza/orgs",
        "repos_url": "https://api.github.com/users/Davidson-Souza/repos",
        "events_url": "https://api.github.com/users/Davidson-Souza/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Davidson-Souza/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T11:38:48Z"
    },
    {
      "event": "unsubscribed",
      "id": 9294420624,
      "node_id": "UE_lADOABII585maNDYzwAAAAIp_ZqQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9294420624",
      "actor": {
        "login": "joostjager",
        "id": 4638168,
        "node_id": "MDQ6VXNlcjQ2MzgxNjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4638168?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joostjager",
        "html_url": "https://github.com/joostjager",
        "followers_url": "https://api.github.com/users/joostjager/followers",
        "following_url": "https://api.github.com/users/joostjager/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/joostjager/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/joostjager/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/joostjager/subscriptions",
        "organizations_url": "https://api.github.com/users/joostjager/orgs",
        "repos_url": "https://api.github.com/users/joostjager/repos",
        "events_url": "https://api.github.com/users/joostjager/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/joostjager/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T12:36:12Z"
    },
    {
      "event": "commented",
      "id": 1555904229,
      "node_id": "IC_kwDOABII585cvTbl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555904229",
      "actor": {
        "login": "recursive-rat4",
        "id": 73423761,
        "node_id": "MDQ6VXNlcjczNDIzNzYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/73423761?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/recursive-rat4",
        "html_url": "https://github.com/recursive-rat4",
        "followers_url": "https://api.github.com/users/recursive-rat4/followers",
        "following_url": "https://api.github.com/users/recursive-rat4/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/recursive-rat4/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/recursive-rat4/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/recursive-rat4/subscriptions",
        "organizations_url": "https://api.github.com/users/recursive-rat4/orgs",
        "repos_url": "https://api.github.com/users/recursive-rat4/repos",
        "events_url": "https://api.github.com/users/recursive-rat4/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/recursive-rat4/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T12:45:27Z",
      "updated_at": "2023-05-20T12:45:27Z",
      "author_association": "NONE",
      "body": "Short IDs, as they are specified in BIP 152, cannot be computed in advance because their formula includes a block header (and a random nonce) in addition to a transaction content.",
      "user": {
        "login": "recursive-rat4",
        "id": 73423761,
        "node_id": "MDQ6VXNlcjczNDIzNzYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/73423761?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/recursive-rat4",
        "html_url": "https://github.com/recursive-rat4",
        "followers_url": "https://api.github.com/users/recursive-rat4/followers",
        "following_url": "https://api.github.com/users/recursive-rat4/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/recursive-rat4/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/recursive-rat4/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/recursive-rat4/subscriptions",
        "organizations_url": "https://api.github.com/users/recursive-rat4/orgs",
        "repos_url": "https://api.github.com/users/recursive-rat4/repos",
        "events_url": "https://api.github.com/users/recursive-rat4/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/recursive-rat4/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555904229",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706"
    },
    {
      "event": "commented",
      "id": 1555906319,
      "node_id": "IC_kwDOABII585cvT8P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555906319",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T12:57:55Z",
      "updated_at": "2023-05-20T12:57:55Z",
      "author_association": "MEMBER",
      "body": "Yeah, what @pavel-vasin says.\n\nSalting the hash computation using the block header is needed to prevent intentional collisions, and is the price for using short ids.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555906319",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706"
    },
    {
      "event": "mentioned",
      "id": 9294445028,
      "node_id": "MEE_lADOABII585maNDYzwAAAAIp_fnk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9294445028",
      "actor": {
        "login": "recursive-rat4",
        "id": 73423761,
        "node_id": "MDQ6VXNlcjczNDIzNzYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/73423761?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/recursive-rat4",
        "html_url": "https://github.com/recursive-rat4",
        "followers_url": "https://api.github.com/users/recursive-rat4/followers",
        "following_url": "https://api.github.com/users/recursive-rat4/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/recursive-rat4/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/recursive-rat4/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/recursive-rat4/subscriptions",
        "organizations_url": "https://api.github.com/users/recursive-rat4/orgs",
        "repos_url": "https://api.github.com/users/recursive-rat4/repos",
        "events_url": "https://api.github.com/users/recursive-rat4/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/recursive-rat4/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T12:57:55Z"
    },
    {
      "event": "subscribed",
      "id": 9294445029,
      "node_id": "SE_lADOABII585maNDYzwAAAAIp_fnl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9294445029",
      "actor": {
        "login": "recursive-rat4",
        "id": 73423761,
        "node_id": "MDQ6VXNlcjczNDIzNzYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/73423761?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/recursive-rat4",
        "html_url": "https://github.com/recursive-rat4",
        "followers_url": "https://api.github.com/users/recursive-rat4/followers",
        "following_url": "https://api.github.com/users/recursive-rat4/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/recursive-rat4/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/recursive-rat4/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/recursive-rat4/subscriptions",
        "organizations_url": "https://api.github.com/users/recursive-rat4/orgs",
        "repos_url": "https://api.github.com/users/recursive-rat4/repos",
        "events_url": "https://api.github.com/users/recursive-rat4/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/recursive-rat4/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T12:57:55Z"
    },
    {
      "event": "commented",
      "id": 1555917084,
      "node_id": "IC_kwDOABII585cvWkc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555917084",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T13:56:42Z",
      "updated_at": "2023-05-20T13:56:42Z",
      "author_association": "MEMBER",
      "body": "Makes sense, thanks for the clarification!",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555917084",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706"
    },
    {
      "event": "labeled",
      "id": 9294552290,
      "node_id": "LE_lADOABII585maNDYzwAAAAIp_5zi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9294552290",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T14:26:56Z",
      "label": {
        "name": "Questions and Help",
        "color": "006688"
      }
    },
    {
      "event": "commented",
      "id": 1555930857,
      "node_id": "IC_kwDOABII585cvZ7p",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555930857",
      "actor": {
        "login": "Davidson-Souza",
        "id": 40968167,
        "node_id": "MDQ6VXNlcjQwOTY4MTY3",
        "avatar_url": "https://avatars.githubusercontent.com/u/40968167?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Davidson-Souza",
        "html_url": "https://github.com/Davidson-Souza",
        "followers_url": "https://api.github.com/users/Davidson-Souza/followers",
        "following_url": "https://api.github.com/users/Davidson-Souza/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Davidson-Souza/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Davidson-Souza/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Davidson-Souza/subscriptions",
        "organizations_url": "https://api.github.com/users/Davidson-Souza/orgs",
        "repos_url": "https://api.github.com/users/Davidson-Souza/repos",
        "events_url": "https://api.github.com/users/Davidson-Souza/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Davidson-Souza/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T15:01:41Z",
      "updated_at": "2023-05-20T22:58:18Z",
      "author_association": "NONE",
      "body": "@pavel-vasin Yes, you're right. The compact block relay design, as it currently exists, does not permit pre computations.\r\n\r\n> Salting the hash computation using the block header is needed to prevent intentional collisions, and is the price for using short ids.\r\n\r\nDoes it really need to be the block header? If we kept a random, per connection byte-array used for salting, how could an attacker cause intentional collisions?\r\n\r\n(Thinking outside BIP152 context) If we hold a per connection salt, and a rolling hash map for mempool transactions, we could avoid the mempool iteration entirely. Since we only keep a few high-bandwidth connections, and hash sets are very small, it's not really a memory usage penalty, IMO. If our peer misbehave, we can detect it, once they would create an uncommon number of collisions.\r\n\r\nI guess a first good step would be benchmarking this code path, and see how it impacts the whole block compact propagation logic.",
      "user": {
        "login": "Davidson-Souza",
        "id": 40968167,
        "node_id": "MDQ6VXNlcjQwOTY4MTY3",
        "avatar_url": "https://avatars.githubusercontent.com/u/40968167?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Davidson-Souza",
        "html_url": "https://github.com/Davidson-Souza",
        "followers_url": "https://api.github.com/users/Davidson-Souza/followers",
        "following_url": "https://api.github.com/users/Davidson-Souza/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Davidson-Souza/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Davidson-Souza/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Davidson-Souza/subscriptions",
        "organizations_url": "https://api.github.com/users/Davidson-Souza/orgs",
        "repos_url": "https://api.github.com/users/Davidson-Souza/repos",
        "events_url": "https://api.github.com/users/Davidson-Souza/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Davidson-Souza/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555930857",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706"
    },
    {
      "event": "mentioned",
      "id": 9294593328,
      "node_id": "MEE_lADOABII585maNDYzwAAAAIqAD0w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9294593328",
      "actor": {
        "login": "recursive-rat4",
        "id": 73423761,
        "node_id": "MDQ6VXNlcjczNDIzNzYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/73423761?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/recursive-rat4",
        "html_url": "https://github.com/recursive-rat4",
        "followers_url": "https://api.github.com/users/recursive-rat4/followers",
        "following_url": "https://api.github.com/users/recursive-rat4/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/recursive-rat4/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/recursive-rat4/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/recursive-rat4/subscriptions",
        "organizations_url": "https://api.github.com/users/recursive-rat4/orgs",
        "repos_url": "https://api.github.com/users/recursive-rat4/repos",
        "events_url": "https://api.github.com/users/recursive-rat4/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/recursive-rat4/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T15:01:42Z"
    },
    {
      "event": "subscribed",
      "id": 9294593331,
      "node_id": "SE_lADOABII585maNDYzwAAAAIqAD0z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9294593331",
      "actor": {
        "login": "recursive-rat4",
        "id": 73423761,
        "node_id": "MDQ6VXNlcjczNDIzNzYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/73423761?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/recursive-rat4",
        "html_url": "https://github.com/recursive-rat4",
        "followers_url": "https://api.github.com/users/recursive-rat4/followers",
        "following_url": "https://api.github.com/users/recursive-rat4/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/recursive-rat4/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/recursive-rat4/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/recursive-rat4/subscriptions",
        "organizations_url": "https://api.github.com/users/recursive-rat4/orgs",
        "repos_url": "https://api.github.com/users/recursive-rat4/repos",
        "events_url": "https://api.github.com/users/recursive-rat4/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/recursive-rat4/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-20T15:01:42Z"
    },
    {
      "event": "commented",
      "id": 1556126859,
      "node_id": "IC_kwDOABII585cwJyL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1556126859",
      "actor": {
        "login": "recursive-rat4",
        "id": 73423761,
        "node_id": "MDQ6VXNlcjczNDIzNzYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/73423761?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/recursive-rat4",
        "html_url": "https://github.com/recursive-rat4",
        "followers_url": "https://api.github.com/users/recursive-rat4/followers",
        "following_url": "https://api.github.com/users/recursive-rat4/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/recursive-rat4/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/recursive-rat4/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/recursive-rat4/subscriptions",
        "organizations_url": "https://api.github.com/users/recursive-rat4/orgs",
        "repos_url": "https://api.github.com/users/recursive-rat4/repos",
        "events_url": "https://api.github.com/users/recursive-rat4/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/recursive-rat4/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-21T09:11:38Z",
      "updated_at": "2023-05-21T09:11:38Z",
      "author_association": "NONE",
      "body": ">Does it really need to be the block header? If we kept a random, per connection byte-array used for salting, how could an attacker cause intentional collisions?\r\n\r\nIf PoW or something similarly strong is not involved then the attacker can create collisions for a chosen set of nonces. An algorithm of the attack is straightforward:\r\n1. Connect to a next victim\r\n2. Negotiate a nonce\r\n3. Bruteforce transactions that collide under the nonce\r\n4. Go to step 1",
      "user": {
        "login": "recursive-rat4",
        "id": 73423761,
        "node_id": "MDQ6VXNlcjczNDIzNzYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/73423761?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/recursive-rat4",
        "html_url": "https://github.com/recursive-rat4",
        "followers_url": "https://api.github.com/users/recursive-rat4/followers",
        "following_url": "https://api.github.com/users/recursive-rat4/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/recursive-rat4/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/recursive-rat4/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/recursive-rat4/subscriptions",
        "organizations_url": "https://api.github.com/users/recursive-rat4/orgs",
        "repos_url": "https://api.github.com/users/recursive-rat4/repos",
        "events_url": "https://api.github.com/users/recursive-rat4/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/recursive-rat4/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1556126859",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706"
    },
    {
      "event": "commented",
      "id": 1556818802,
      "node_id": "IC_kwDOABII585cyyty",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1556818802",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-22T08:56:02Z",
      "updated_at": "2023-05-22T08:56:02Z",
      "author_association": "MEMBER",
      "body": "Ok. Closing for now. Discussion can continue, but it's not clear why this is an issue. General questions /discussion can also be asked/happen in IRC etc.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1556818802",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27706"
    },
    {
      "event": "closed",
      "id": 9299966525,
      "node_id": "CE_lADOABII585maNDYzwAAAAIqUjo9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9299966525",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-22T08:56:03Z"
    }
  ]
}