{
  "type": "issue",
  "issue": {
    "id": 211879834,
    "node_id": "MDU6SXNzdWUyMTE4Nzk4MzQ=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9918",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9918/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9918/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9918/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/9918",
    "number": 9918,
    "state": "open",
    "state_reason": null,
    "title": "Default -rpcclienttimeout is too low for calls which cause rescan",
    "body": "### Describe the issue\r\n\r\n### Can you reliably reproduce the issue?\r\nYes.\r\n#### If so, please list the steps to reproduce below:\r\n1. Using default options, with bitcoin-cli, call importprivkey (or I assume importaddress or importpubkey too).\r\n\r\n### Expected behaviour\r\nCall should succeed.\r\n\r\n### Actual behaviour\r\nbitcon-cli will timeout after 15 minutes, per default -rpcclienttimeout, exit with code 1. Bitcoind will complete the command in the background.\r\n\r\n### What version of bitcoin-core are you using?\r\n 58861ad9\r\n\r\n### Machine specs:\r\n- OS: Debian stretch\r\n- CPU: i7-2600K CPU @ 3.40GHz\r\n- RAM: 16018 Mb\r\n- Disk Type (HD/SDD): HD\r\n\r\nAdjusting -rpcclienttimeout, the call takes 27 minutes on my machine. \r\n\r\nI can see 3 options for solving this:\r\n\r\n1. Increase the default -rpcclienttimeout. It appeared to be cpu bound. There are probably a not insignificant amount of  people with slower cpus which take 1 hour or more. I can test on a raspberry pi. I assume the time is roughly linearly proportional to the blockchain size, which will double in 2 years time or so. So a default timeout which is expected to work for most people for a few years could be 3 hours or more. The timeout was last changed via commit 2190ea6c4e7f5 in September 2015, changing it from 30 seconds to 15 minutes.\r\n\r\n2. Increase the default -rpcclienttimeout only when a rescan is requested. I'm not sure if this is the only call which needs a higher timeout. \r\n\r\n3. Add a warning in the help output for calls which trigger a rescan about the default -rpcclienttimeout being too low.\r\n",
    "user": {
      "login": "ian-kelling",
      "id": 54232,
      "node_id": "MDQ6VXNlcjU0MjMy",
      "avatar_url": "https://avatars.githubusercontent.com/u/54232?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ian-kelling",
      "html_url": "https://github.com/ian-kelling",
      "followers_url": "https://api.github.com/users/ian-kelling/followers",
      "following_url": "https://api.github.com/users/ian-kelling/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ian-kelling/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ian-kelling/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ian-kelling/subscriptions",
      "organizations_url": "https://api.github.com/users/ian-kelling/orgs",
      "repos_url": "https://api.github.com/users/ian-kelling/repos",
      "events_url": "https://api.github.com/users/ian-kelling/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ian-kelling/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 2,
    "created_at": "2017-03-04T13:30:35Z",
    "updated_at": "2017-03-04T22:44:53Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 986469263,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDk4NjQ2OTI2Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/986469263",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-03-04T14:09:08Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "commented",
      "id": 284188399,
      "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDE4ODM5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284188399",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-03-04T22:11:05Z",
      "updated_at": "2017-03-04T22:11:05Z",
      "author_association": "MEMBER",
      "body": "All of those could work, though the ideal solution to this would be for commands like this to report back progress in some way, one way to do this would be through a chunked HTTP response. The timeout could then be reset each time progress updates come in.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/9918#issuecomment-284188399",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9918"
    },
    {
      "event": "commented",
      "id": 284190262,
      "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDE5MDI2Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284190262",
      "actor": {
        "login": "ian-kelling",
        "id": 54232,
        "node_id": "MDQ6VXNlcjU0MjMy",
        "avatar_url": "https://avatars.githubusercontent.com/u/54232?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ian-kelling",
        "html_url": "https://github.com/ian-kelling",
        "followers_url": "https://api.github.com/users/ian-kelling/followers",
        "following_url": "https://api.github.com/users/ian-kelling/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ian-kelling/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ian-kelling/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ian-kelling/subscriptions",
        "organizations_url": "https://api.github.com/users/ian-kelling/orgs",
        "repos_url": "https://api.github.com/users/ian-kelling/repos",
        "events_url": "https://api.github.com/users/ian-kelling/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ian-kelling/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-03-04T22:44:53Z",
      "updated_at": "2017-03-04T22:44:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "> All of those could work, though the ideal solution to this would be for commands like this to report back progress in some way, one way to do this would be through a chunked HTTP response. The timeout could then be reset each time progress updates come in.\r\n\r\nGreat idea.",
      "user": {
        "login": "ian-kelling",
        "id": 54232,
        "node_id": "MDQ6VXNlcjU0MjMy",
        "avatar_url": "https://avatars.githubusercontent.com/u/54232?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ian-kelling",
        "html_url": "https://github.com/ian-kelling",
        "followers_url": "https://api.github.com/users/ian-kelling/followers",
        "following_url": "https://api.github.com/users/ian-kelling/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ian-kelling/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ian-kelling/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ian-kelling/subscriptions",
        "organizations_url": "https://api.github.com/users/ian-kelling/orgs",
        "repos_url": "https://api.github.com/users/ian-kelling/repos",
        "events_url": "https://api.github.com/users/ian-kelling/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ian-kelling/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/9918#issuecomment-284190262",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9918"
    }
  ]
}