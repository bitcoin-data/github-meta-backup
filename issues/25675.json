{
  "type": "issue",
  "issue": {
    "id": 1314901929,
    "node_id": "I_kwDOABII585OX8-p",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25675",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25675/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25675/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25675/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/25675",
    "number": 25675,
    "state": "open",
    "state_reason": null,
    "title": "Possible savings in `dumptxoutset` serialization format (~20%)",
    "body": "**Is your feature request related to a problem? Please describe.**\r\n\r\nSize of the serialized UTXO set\r\n\r\n**Describe the solution you'd like**\r\n\r\nThe serialization format of the serialized UTXO set from `dumptxoutset` is a list of `(COutPoint, Coin)`.\r\n\r\nHowever, many out points refer to the same transaction so we can group by `Txid` with:\r\n`list(Txid, list((vout,Coin))`\r\n\r\nSince the cursor is already iterating through sorted `Txid` this doesn't add complexity to the serialization code.\r\n\r\nConsidering the UTXO at height 745995:\r\n```\r\nserialized_size: ~5.3Gb\r\ntotal_elements: 83_082_178\r\nuniques_txids: 49_517_483\r\nbytes_lost: total_elements // due to the additional byte for the length of the inner list\r\nbytes_savings: (total_elements-unique_txids)*32 - bytes_lost ~= 1Gb\r\n```\r\n\r\n**Describe alternatives you've considered**\r\n\r\nAdditional bytes could be saved by leveraging the duplications in scripts (address reuse). However, this is not considered worthy because the format would lose the streaming property and also because we don't want to optimize on something which is not recommended.\r\n\r\nThe byte lost for expressing the length of the inner list could be optimized with a special byte containing both the length of the list and the first vout, since usually both vout and this value are very small they should fit on a single byte most of the time having a fallback for edge cases.\r\n\r\n**Additional context**\r\n\r\nTagging @jamesob author of https://github.com/bitcoin/bitcoin/pull/16899\r\nassumeutxo summary https://github.com/bitcoin/bitcoin/pull/15606\r\n",
    "user": {
      "login": "RCasatta",
      "id": 6470319,
      "node_id": "MDQ6VXNlcjY0NzAzMTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6470319?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RCasatta",
      "html_url": "https://github.com/RCasatta",
      "followers_url": "https://api.github.com/users/RCasatta/followers",
      "following_url": "https://api.github.com/users/RCasatta/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/RCasatta/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/RCasatta/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/RCasatta/subscriptions",
      "organizations_url": "https://api.github.com/users/RCasatta/orgs",
      "repos_url": "https://api.github.com/users/RCasatta/repos",
      "events_url": "https://api.github.com/users/RCasatta/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/RCasatta/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64583,
        "node_id": "MDU6TGFiZWw2NDU4Mw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
        "name": "Feature",
        "color": "7cf575",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 1,
    "created_at": "2022-07-22T11:43:39Z",
    "updated_at": "2022-07-25T00:14:54Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 7045880262,
      "node_id": "LE_lADOABII585OX8-pzwAAAAGj95nG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7045880262",
      "actor": {
        "login": "RCasatta",
        "id": 6470319,
        "node_id": "MDQ6VXNlcjY0NzAzMTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6470319?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RCasatta",
        "html_url": "https://github.com/RCasatta",
        "followers_url": "https://api.github.com/users/RCasatta/followers",
        "following_url": "https://api.github.com/users/RCasatta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RCasatta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RCasatta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RCasatta/subscriptions",
        "organizations_url": "https://api.github.com/users/RCasatta/orgs",
        "repos_url": "https://api.github.com/users/RCasatta/repos",
        "events_url": "https://api.github.com/users/RCasatta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RCasatta/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-22T11:43:39Z",
      "label": {
        "name": "Feature",
        "color": "7cf575"
      }
    },
    {
      "event": "mentioned",
      "id": 7045880293,
      "node_id": "MEE_lADOABII585OX8-pzwAAAAGj95nl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7045880293",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-22T11:43:39Z"
    },
    {
      "event": "subscribed",
      "id": 7045880299,
      "node_id": "SE_lADOABII585OX8-pzwAAAAGj95nr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7045880299",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-22T11:43:39Z"
    },
    {
      "event": "mentioned",
      "id": 7052068198,
      "node_id": "MEE_lADOABII585OX8-pzwAAAAGkVgVm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7052068198",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-25T00:14:54Z"
    },
    {
      "event": "subscribed",
      "id": 7052068205,
      "node_id": "SE_lADOABII585OX8-pzwAAAAGkVgVt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7052068205",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-25T00:14:54Z"
    },
    {
      "event": "subscribed",
      "id": 7272951915,
      "node_id": "SE_lADOABII585OX8-pzwAAAAGxgHBr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7272951915",
      "actor": {
        "login": "davidgumberg",
        "id": 2257631,
        "node_id": "MDQ6VXNlcjIyNTc2MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2257631?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidgumberg",
        "html_url": "https://github.com/davidgumberg",
        "followers_url": "https://api.github.com/users/davidgumberg/followers",
        "following_url": "https://api.github.com/users/davidgumberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/davidgumberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/davidgumberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/davidgumberg/subscriptions",
        "organizations_url": "https://api.github.com/users/davidgumberg/orgs",
        "repos_url": "https://api.github.com/users/davidgumberg/repos",
        "events_url": "https://api.github.com/users/davidgumberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/davidgumberg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-28T06:16:59Z"
    }
  ]
}