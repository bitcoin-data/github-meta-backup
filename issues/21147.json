{
  "type": "issue",
  "issue": {
    "id": 805962903,
    "node_id": "MDU6SXNzdWU4MDU5NjI5MDM=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21147",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21147/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21147/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21147/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/21147",
    "number": 21147,
    "state": "closed",
    "state_reason": "completed",
    "title": "Add onion failed; error code 513",
    "body": "`Add onion failed; error code 513`\r\n\r\n\r\nDetails mentioned in `debug.log`:\r\n\r\n    2021-02-10T20:01:58Z tor: Successfully connected!\r\n    2021-02-10T20:01:58Z tor: Connected to Tor version 0.3.2.10\r\n    2021-02-10T20:01:58Z tor: Supported authentication method: COOKIE\r\n    2021-02-10T20:01:58Z tor: Supported authentication method: HASHEDPASSWORD\r\n    2021-02-10T20:01:58Z tor: Supported authentication method: SAFECOOKIE\r\n    2021-02-10T20:01:58Z tor: Using SAFECOOKIE authentication, reading cookie authentication from /var/run/tor/control.authcookie\r\n    2021-02-10T20:01:58Z tor: SAFECOOKIE authentication challenge successful\r\n    2021-02-10T20:01:58Z tor: AUTHCHALLENGE ServerHash fec05d578a7f60d426bc9fbee942102f458f3921db4585c5020d3295b58c56d1 ServerNonce eb57b69b846cfa0984905079b964b0662d71c134cc0afd816cb297d24d37dc10\r\n    2021-02-10T20:01:58Z tor: Authentication successful\r\n    2021-02-10T20:01:58Z tor: Add onion failed; error code 513\r\n    2021-02-10T20:01:58Z Loaded 19221 addresses from peers.dat  209ms\r\n    2021-02-10T20:01:58Z Loaded 2 addresses from \"anchors.dat\"\r\n    2021-02-10T20:01:58Z 2 block-relay-only anchors will be tried for connections.\r\n    2021-02-10T20:01:58Z init message: Starting network threads...\r\n    2021-02-10T20:01:58Z init message: Done loading\r\n    2021-02-10T20:01:58Z msghand thread start\r\n    2021-02-10T20:01:58Z opencon thread start\r\n    2021-02-10T20:01:58Z addcon thread start\r\n    2021-02-10T20:01:58Z dnsseed thread start\r\n\r\nNot sure why it connects to Tor version 0.3.2.10 because I have a recent version on this machine:\r\n\r\n    prayank@ubuntu:~/.bitcoin$ tor --version\r\n    Tor version 0.4.4.6.\r\n\r\nWhat can be the possible reason for this error?\r\n\r\n`bitcoin.conf` file:\r\n\r\n    testnet=1\r\n    listen=1\r\n    torcontrol=127.0.0.1:9051\r\n    onlynet=onion\r\n    debug=tor\r\n    prune=555\r\n\r\n`/etc/tor/torrc`\r\n\r\n    ControlPort 9051\r\n    CookieAuthentication 1\r\n    CookieAuthFileGroupReadable 1\r\n    HashedControlPassword 16:07XXXXXXXXXXXXXXXXXXXXXXXXXXXX$\r\n\r\n",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 5,
    "closed_at": "2021-02-11T17:25:45Z",
    "created_at": "2021-02-10T23:35:05Z",
    "updated_at": "2022-08-29T19:58:16Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 777659252,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc3NzY1OTI1Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/777659252",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-11T17:25:45Z",
      "updated_at": "2021-02-11T17:25:45Z",
      "author_association": "NONE",
      "body": "The issue is with Tor version being used imo because similar setup on new machine with Tor 0.4.2.7 works fine\r\n\r\n```\r\n2021-02-11T17:21:56Z addcon thread start\r\n2021-02-11T17:21:56Z net thread start\r\n2021-02-11T17:21:56Z tor: ADD_ONION successful\r\n2021-02-11T17:21:56Z tor: Got service ID omy7kj7zwvfg5luayideh73uqb2latkoyyy5h65y4atv3fymnlxlzwqd, advertising service omy7kj7zwvfg5luayideh73uqb2latkoyyy5h65y4atv3fymnlxlzwqd.onion:18333\r\n2021-02-11T17:21:56Z tor: Cached service private key to /home/satoshi/.bitcoin/testnet3/onion_v3_private_key\r\n2021-02-11T17:21:56Z AddLocal(omy7kj7zwvfg5luayideh73uqb2latkoyyy5h65y4atv3fymnlxlzwqd.onion:18333,4)\r\n```\r\n",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21147#issuecomment-777659252",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21147"
    },
    {
      "event": "closed",
      "id": 4321064354,
      "node_id": "MDExOkNsb3NlZEV2ZW50NDMyMTA2NDM1NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4321064354",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-11T17:25:45Z"
    },
    {
      "event": "commented",
      "id": 907697376,
      "node_id": "IC_kwDOABII5842Glzg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/907697376",
      "actor": {
        "login": "lano1106",
        "id": 4829131,
        "node_id": "MDQ6VXNlcjQ4MjkxMzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4829131?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lano1106",
        "html_url": "https://github.com/lano1106",
        "followers_url": "https://api.github.com/users/lano1106/followers",
        "following_url": "https://api.github.com/users/lano1106/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lano1106/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lano1106/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lano1106/subscriptions",
        "organizations_url": "https://api.github.com/users/lano1106/orgs",
        "repos_url": "https://api.github.com/users/lano1106/repos",
        "events_url": "https://api.github.com/users/lano1106/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lano1106/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-28T22:26:14Z",
      "updated_at": "2021-08-28T22:26:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "One reason why torcontrol may return 513 is if the target is unreachable.\r\n\r\nTarget ip is set to 127.0.0.1\r\n\r\nThis assumes that the tor proxy is running on the same machine. That might not be the case in a LAN setup. A better approach would be to use the bind address value if specified. If not, then fallback on 127.0.0.1",
      "user": {
        "login": "lano1106",
        "id": 4829131,
        "node_id": "MDQ6VXNlcjQ4MjkxMzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4829131?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lano1106",
        "html_url": "https://github.com/lano1106",
        "followers_url": "https://api.github.com/users/lano1106/followers",
        "following_url": "https://api.github.com/users/lano1106/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lano1106/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lano1106/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lano1106/subscriptions",
        "organizations_url": "https://api.github.com/users/lano1106/orgs",
        "repos_url": "https://api.github.com/users/lano1106/repos",
        "events_url": "https://api.github.com/users/lano1106/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lano1106/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21147#issuecomment-907697376",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21147"
    },
    {
      "event": "commented",
      "id": 907800549,
      "node_id": "IC_kwDOABII5842G-_l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/907800549",
      "actor": {
        "login": "lano1106",
        "id": 4829131,
        "node_id": "MDQ6VXNlcjQ4MjkxMzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4829131?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lano1106",
        "html_url": "https://github.com/lano1106",
        "followers_url": "https://api.github.com/users/lano1106/followers",
        "following_url": "https://api.github.com/users/lano1106/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lano1106/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lano1106/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lano1106/subscriptions",
        "organizations_url": "https://api.github.com/users/lano1106/orgs",
        "repos_url": "https://api.github.com/users/lano1106/repos",
        "events_url": "https://api.github.com/users/lano1106/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lano1106/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-29T14:25:45Z",
      "updated_at": "2021-08-29T14:27:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "I gave my idea a shot and it didn't fix the problem. I did tweak a little bit the logs to have more info. I printed the torcontrol reply first line instead of the error code. Here is what I got:\r\n\r\n```\r\n2021-08-29T14:19:06Z tor: Add onion cmd: ADD_ONION NEW:RSA1024 Port=9999,192.168.1.179:9999\r\n2021-08-29T14:19:06Z tor: Add onion failed; error Invalid key type\r\n```\r\n",
      "user": {
        "login": "lano1106",
        "id": 4829131,
        "node_id": "MDQ6VXNlcjQ4MjkxMzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4829131?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lano1106",
        "html_url": "https://github.com/lano1106",
        "followers_url": "https://api.github.com/users/lano1106/followers",
        "following_url": "https://api.github.com/users/lano1106/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lano1106/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lano1106/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lano1106/subscriptions",
        "organizations_url": "https://api.github.com/users/lano1106/orgs",
        "repos_url": "https://api.github.com/users/lano1106/repos",
        "events_url": "https://api.github.com/users/lano1106/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lano1106/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21147#issuecomment-907800549",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21147"
    },
    {
      "event": "commented",
      "id": 907802837,
      "node_id": "IC_kwDOABII5842G_jV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/907802837",
      "actor": {
        "login": "lano1106",
        "id": 4829131,
        "node_id": "MDQ6VXNlcjQ4MjkxMzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4829131?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lano1106",
        "html_url": "https://github.com/lano1106",
        "followers_url": "https://api.github.com/users/lano1106/followers",
        "following_url": "https://api.github.com/users/lano1106/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lano1106/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lano1106/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lano1106/subscriptions",
        "organizations_url": "https://api.github.com/users/lano1106/orgs",
        "repos_url": "https://api.github.com/users/lano1106/repos",
        "events_url": "https://api.github.com/users/lano1106/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lano1106/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-29T14:39:40Z",
      "updated_at": "2021-08-29T14:39:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "I found something interesting. With tor 0.4.6.7, the algorithm RSA1024 is not accepted anymore. The only choices are:\r\n\r\nBEST or ED25519-V3",
      "user": {
        "login": "lano1106",
        "id": 4829131,
        "node_id": "MDQ6VXNlcjQ4MjkxMzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4829131?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lano1106",
        "html_url": "https://github.com/lano1106",
        "followers_url": "https://api.github.com/users/lano1106/followers",
        "following_url": "https://api.github.com/users/lano1106/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lano1106/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lano1106/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lano1106/subscriptions",
        "organizations_url": "https://api.github.com/users/lano1106/orgs",
        "repos_url": "https://api.github.com/users/lano1106/repos",
        "events_url": "https://api.github.com/users/lano1106/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lano1106/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21147#issuecomment-907802837",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21147"
    },
    {
      "event": "commented",
      "id": 907804392,
      "node_id": "IC_kwDOABII5842G_7o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/907804392",
      "actor": {
        "login": "lano1106",
        "id": 4829131,
        "node_id": "MDQ6VXNlcjQ4MjkxMzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4829131?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lano1106",
        "html_url": "https://github.com/lano1106",
        "followers_url": "https://api.github.com/users/lano1106/followers",
        "following_url": "https://api.github.com/users/lano1106/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lano1106/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lano1106/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lano1106/subscriptions",
        "organizations_url": "https://api.github.com/users/lano1106/orgs",
        "repos_url": "https://api.github.com/users/lano1106/repos",
        "events_url": "https://api.github.com/users/lano1106/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lano1106/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-29T14:48:41Z",
      "updated_at": "2021-08-29T14:48:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "fixed by:\r\nhttps://github.com/bitcoin/bitcoin/pull/19954/commits/dcf0cb477699d11afd0ff37c8bfb2b1b4f7f1ee5",
      "user": {
        "login": "lano1106",
        "id": 4829131,
        "node_id": "MDQ6VXNlcjQ4MjkxMzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4829131?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lano1106",
        "html_url": "https://github.com/lano1106",
        "followers_url": "https://api.github.com/users/lano1106/followers",
        "following_url": "https://api.github.com/users/lano1106/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lano1106/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lano1106/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lano1106/subscriptions",
        "organizations_url": "https://api.github.com/users/lano1106/orgs",
        "repos_url": "https://api.github.com/users/lano1106/repos",
        "events_url": "https://api.github.com/users/lano1106/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lano1106/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/21147#issuecomment-907804392",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21147"
    },
    {
      "event": "locked",
      "id": 7281772233,
      "node_id": "LOE_lADOABII584wCgSXzwAAAAGyBwbJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7281772233",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-29T19:58:16Z",
      "lock_reason": "resolved"
    }
  ]
}