{
  "type": "issue",
  "issue": {
    "id": 496849986,
    "node_id": "MDU6SXNzdWU0OTY4NDk5ODY=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16937",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16937/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16937/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16937/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/16937",
    "number": 16937,
    "state": "closed",
    "state_reason": "completed",
    "title": "bitcoin-qt crash after early call to loadwallet",
    "body": "A call to `loadwallet` while `bitcoin-qt` is starting will cause a crash:\r\n\r\n```bash\r\nProcess 77611 launched: '/Users/michael/github/bitcoin/src/qt/bitcoin-qt' (x86_64)\r\n2019-09-23 07:40:29.799378+0800 bitcoin-qt[77611:495185] MessageTracer: Falling back to default whitelist\r\nProcess 77611 stopped\r\n* thread #12, name = 'bitcoin-httpworker.0', stop reason = EXC_BAD_ACCESS (code=1, address=0x0)\r\n    frame #0: 0x00000001001faaa0 bitcoin-qt`WalletController::getOrCreateWallet(this=0x000000011a5a1670, wallet=unique_ptr<interfaces::Wallet, std::__1::default_delete<interfaces::Wallet> > @ 0x0000700009586200) at walletcontroller.cpp:96:36\r\n   93  \t\r\n   94  \t    // Return model instance if exists.\r\n   95  \t    if (!m_wallets.empty()) {\r\n-> 96  \t        std::string name = wallet->getWalletName();\r\n   97  \t        for (WalletModel* wallet_model : m_wallets) {\r\n   98  \t            if (wallet_model->wallet().getWalletName() == name) {\r\n   99  \t                return wallet_model;\r\nTarget 0: (bitcoin-qt) stopped.\r\n```\r\n\r\n\r\n```python\r\nimport argparse\r\nimport time\r\nimport os\r\nimport sys\r\n\r\nfrom bitcoinrpc.authproxy import AuthServiceProxy, JSONRPCException\r\n\r\n# lldb src/qt/bitcoin-qt -- -debug -regtest\r\n# python3 crash.py <datadir>\r\n\r\nparser = argparse.ArgumentParser()\r\nparser.add_argument('datadir')\r\nargs = parser.parse_args()\r\n\r\ncookie: str = args.datadir + '/regtest/.cookie'\r\nwallet_name: str = 'hello'\r\n\r\n# Wait for cookie file to be created\r\nwhile not os.path.exists(cookie):\r\n    time.sleep(0.5)\r\n# Read .cookie file to get user and pass\r\nwith open(cookie) as f:\r\n    userpass: str = f.readline().lstrip().rstrip()\r\nrpc = AuthServiceProxy('http://{}@127.0.0.1:18443'.format(userpass))\r\n\r\n# Wait for bitcoin-qt to be ready\r\nready: bool = False\r\nwhile not ready:\r\n    print('waiting...')\r\n    try:\r\n        rpc.getblockchaininfo()\r\n        ready = True\r\n    except Exception:\r\n        time.sleep(0.5)\r\n        pass\r\nrpc.loadwallet(wallet_name)\r\n```",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 135946,
        "node_id": "MDU6TGFiZWwxMzU5NDY=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/GUI",
        "name": "GUI",
        "color": "02d7e1",
        "default": false
      },
      {
        "id": 349312277,
        "node_id": "MDU6TGFiZWwzNDkzMTIyNzc=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/good%20first%20issue",
        "name": "good first issue",
        "color": "c2e0c6",
        "default": true
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 1,
    "closed_at": "2020-01-08T14:58:45Z",
    "created_at": "2019-09-22T23:59:54Z",
    "updated_at": "2022-02-15T11:01:49Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 2652972874,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDI2NTI5NzI4NzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2652972874",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-09-22T23:59:54Z",
      "label": {
        "name": "GUI",
        "color": "02d7e1"
      }
    },
    {
      "event": "labeled",
      "id": 2652972875,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDI2NTI5NzI4NzU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2652972875",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-09-22T23:59:54Z",
      "label": {
        "name": "good first issue",
        "color": "c2e0c6"
      }
    },
    {
      "event": "referenced",
      "id": 2658359781,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI2NTgzNTk3ODE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2658359781",
      "actor": {
        "login": "icota",
        "id": 762502,
        "node_id": "MDQ6VXNlcjc2MjUwMg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/762502?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/icota",
        "html_url": "https://github.com/icota",
        "followers_url": "https://api.github.com/users/icota/followers",
        "following_url": "https://api.github.com/users/icota/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/icota/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/icota/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/icota/subscriptions",
        "organizations_url": "https://api.github.com/users/icota/orgs",
        "repos_url": "https://api.github.com/users/icota/repos",
        "events_url": "https://api.github.com/users/icota/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/icota/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "db31bcb475580652e495e9d531862272052a3911",
      "commit_url": "https://api.github.com/repos/icota/bitcoin/commits/db31bcb475580652e495e9d531862272052a3911",
      "created_at": "2019-09-24T14:46:30Z"
    },
    {
      "event": "commented",
      "id": 534899860,
      "node_id": "MDEyOklzc3VlQ29tbWVudDUzNDg5OTg2MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534899860",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-09-25T07:53:06Z",
      "updated_at": "2019-09-25T07:53:06Z",
      "author_association": "MEMBER",
      "body": "Are you able to crash in every try?",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/16937#issuecomment-534899860",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16937"
    },
    {
      "event": "closed",
      "id": 2931506155,
      "node_id": "MDExOkNsb3NlZEV2ZW50MjkzMTUwNjE1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2931506155",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "6196e930018181301b5972842ae384ea4288ff34",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6196e930018181301b5972842ae384ea4288ff34",
      "created_at": "2020-01-08T14:58:46Z"
    },
    {
      "event": "referenced",
      "id": 2932884438,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI5MzI4ODQ0Mzg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2932884438",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a46d74a339ebfb03ac093d1b4d971c9e9ab71c7e",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/a46d74a339ebfb03ac093d1b4d971c9e9ab71c7e",
      "created_at": "2020-01-08T22:03:05Z"
    },
    {
      "event": "referenced",
      "id": 3980858346,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM5ODA4NTgzNDY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3980858346",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "fc6d53ddd2a7b70a1ae7cfa18607ba9fa805f1a7",
      "commit_url": "https://api.github.com/repos/syscoin-core/syscoin/commits/fc6d53ddd2a7b70a1ae7cfa18607ba9fa805f1a7",
      "created_at": "2020-11-10T20:39:44Z"
    },
    {
      "event": "locked",
      "id": 6073997553,
      "node_id": "LOE_lADOABII584dnVRCzwAAAAFqCdjx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6073997553",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-15T11:01:49Z",
      "lock_reason": "resolved"
    }
  ]
}