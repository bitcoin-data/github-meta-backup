{
  "type": "issue",
  "issue": {
    "id": 267271825,
    "node_id": "MDU6SXNzdWUyNjcyNzE4MjU=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11537",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11537/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11537/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11537/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/11537",
    "number": 11537,
    "state": "closed",
    "state_reason": "completed",
    "title": "Add an option for evenly connecting to nodes on different types of networks",
    "body": "### FEATURE REQUEST\r\n\r\nCurrently, when a bitcoin node is set up with a connection to both TOR and normal IPv4/6 internet, the 8 outbound-only connection slots, almost always get filled with nodes connecting over IP.\r\nAdding a config option, which would try to ballance these connections based on what kind of network they go through, would be benefficial in many ways:\r\n\r\n1. It would add edges between bitcoin network on TOR and normal internet, reducing delays, and the risks associated with an attacker isolating a part of TOR-bitcoin-network from the rest of the world\r\n(Or an ISP/government man-in-the-middling all the normal IP connections)\r\n\r\n2. It would help hide/annonymise normal user's transactions from his/her ISP, by mixing them with TOR-outbound ones\r\n\r\n3. It would reduce the stress on normal general purpose TOR exit nodes, as users would more likely/reliably connect to TOR-IPv4/6 bitcoin nodes instead of exiting into normal internet first, and then connecting to default IPv4/6-only bitcoin nodes\r\n\r\nI understand it is possible to create such bridges already, by forcing connections to TOR-only nodes, or by just running a node with lots of inbound slots, but I think the proposed option, would greatly increase the number of such relays, and remove the need for user to maintain a TOR-node whitelist, by handing this work off to normal bitcoind connection finding algorithm.\r\n\r\nThis could be implemented as a minimum number of connections for each network, or just a simple evening boolean switch. (Which could be enabled by default for bitcoind installs with TOR connectivity)\r\n\r\nIn the future, if bitcoin was to support a new network type (for example cjdns/I2P/GNUnet), this option would help establish a presence on the new network faster\r\n\r\nbitcoind: 0.15",
    "user": {
      "login": "msxmine",
      "id": 4729023,
      "node_id": "MDQ6VXNlcjQ3MjkwMjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4729023?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/msxmine",
      "html_url": "https://github.com/msxmine",
      "followers_url": "https://api.github.com/users/msxmine/followers",
      "following_url": "https://api.github.com/users/msxmine/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/msxmine/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/msxmine/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/msxmine/subscriptions",
      "organizations_url": "https://api.github.com/users/msxmine/orgs",
      "repos_url": "https://api.github.com/users/msxmine/repos",
      "events_url": "https://api.github.com/users/msxmine/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/msxmine/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 4,
    "closed_at": "2021-03-30T14:21:13Z",
    "created_at": "2017-10-20T18:57:48Z",
    "updated_at": "2022-08-18T18:36:22Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 1304468663,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDEzMDQ0Njg2NjM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1304468663",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-10-22T10:01:25Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 341927070,
      "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTkyNzA3MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/341927070",
      "actor": {
        "login": "unsystemizer",
        "id": 13134193,
        "node_id": "MDQ6VXNlcjEzMTM0MTkz",
        "avatar_url": "https://avatars.githubusercontent.com/u/13134193?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/unsystemizer",
        "html_url": "https://github.com/unsystemizer",
        "followers_url": "https://api.github.com/users/unsystemizer/followers",
        "following_url": "https://api.github.com/users/unsystemizer/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/unsystemizer/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/unsystemizer/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/unsystemizer/subscriptions",
        "organizations_url": "https://api.github.com/users/unsystemizer/orgs",
        "repos_url": "https://api.github.com/users/unsystemizer/repos",
        "events_url": "https://api.github.com/users/unsystemizer/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/unsystemizer/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-11-04T20:20:48Z",
      "updated_at": "2017-11-04T20:20:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "> the 8 outbound-only connection slots, almost always get filled with nodes connecting over IP.\r\n\r\nI know this doesn't address the request, but if you \"addnode\" a Tor node does that help secure at least 1 outbound connection and make at least one Tor connection recover after restart?",
      "user": {
        "login": "unsystemizer",
        "id": 13134193,
        "node_id": "MDQ6VXNlcjEzMTM0MTkz",
        "avatar_url": "https://avatars.githubusercontent.com/u/13134193?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/unsystemizer",
        "html_url": "https://github.com/unsystemizer",
        "followers_url": "https://api.github.com/users/unsystemizer/followers",
        "following_url": "https://api.github.com/users/unsystemizer/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/unsystemizer/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/unsystemizer/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/unsystemizer/subscriptions",
        "organizations_url": "https://api.github.com/users/unsystemizer/orgs",
        "repos_url": "https://api.github.com/users/unsystemizer/repos",
        "events_url": "https://api.github.com/users/unsystemizer/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/unsystemizer/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/11537#issuecomment-341927070",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11537"
    },
    {
      "event": "commented",
      "id": 341934336,
      "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTkzNDMzNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/341934336",
      "actor": {
        "login": "TheBlueMatt",
        "id": 649246,
        "node_id": "MDQ6VXNlcjY0OTI0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheBlueMatt",
        "html_url": "https://github.com/TheBlueMatt",
        "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
        "following_url": "https://api.github.com/users/TheBlueMatt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheBlueMatt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheBlueMatt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
        "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
        "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
        "events_url": "https://api.github.com/users/TheBlueMatt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-11-04T22:30:07Z",
      "updated_at": "2017-11-04T22:30:07Z",
      "author_association": "MEMBER",
      "body": "Dont think this should be an option, we should just do this (eg 2 from each type of net, one from each protected from rotation) without any options.",
      "user": {
        "login": "TheBlueMatt",
        "id": 649246,
        "node_id": "MDQ6VXNlcjY0OTI0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheBlueMatt",
        "html_url": "https://github.com/TheBlueMatt",
        "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
        "following_url": "https://api.github.com/users/TheBlueMatt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheBlueMatt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheBlueMatt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
        "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
        "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
        "events_url": "https://api.github.com/users/TheBlueMatt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/11537#issuecomment-341934336",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11537"
    },
    {
      "event": "commented",
      "id": 344576013,
      "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDU3NjAxMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/344576013",
      "actor": {
        "login": "msxmine",
        "id": 4729023,
        "node_id": "MDQ6VXNlcjQ3MjkwMjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4729023?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/msxmine",
        "html_url": "https://github.com/msxmine",
        "followers_url": "https://api.github.com/users/msxmine/followers",
        "following_url": "https://api.github.com/users/msxmine/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/msxmine/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/msxmine/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/msxmine/subscriptions",
        "organizations_url": "https://api.github.com/users/msxmine/orgs",
        "repos_url": "https://api.github.com/users/msxmine/repos",
        "events_url": "https://api.github.com/users/msxmine/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/msxmine/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-11-15T12:19:40Z",
      "updated_at": "2017-11-15T12:23:01Z",
      "author_association": "NONE",
      "body": "Yes, addnode is an option, however as I mentioned earlier , it requires the user to effectively maintain a whitelist of trusted, running TOR-facing nodes. I think having a minimum for each network as the default is a good idea. Right now, besides using addnode, the only method for reliably connecting over TOR is the onlynet=onion option, however this removes most of benefits I mentioned in the first comment, as our node no longer is a bridge - it uses only TOR connections, and that is a completely different use-case.\r\nBesides, there are comparatively few people running nodes, they want accessible over both IP and TOR, so the default behaviour, not using them to their full potential - as bridges between networks, is I think a waste. The people running these nodes, may not even know, that they are not connecting to TOR at all, because by chance, they got to only the IP part of bitcoin network. I wanted to set up such node, and just looked at getnetworkinfo, only later I realised that I had no TOR connections, when i ran getpeerinfo. (Obviously, this is not as big of an issue for listening nodes with 100s of connections)",
      "user": {
        "login": "msxmine",
        "id": 4729023,
        "node_id": "MDQ6VXNlcjQ3MjkwMjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4729023?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/msxmine",
        "html_url": "https://github.com/msxmine",
        "followers_url": "https://api.github.com/users/msxmine/followers",
        "following_url": "https://api.github.com/users/msxmine/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/msxmine/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/msxmine/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/msxmine/subscriptions",
        "organizations_url": "https://api.github.com/users/msxmine/orgs",
        "repos_url": "https://api.github.com/users/msxmine/repos",
        "events_url": "https://api.github.com/users/msxmine/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/msxmine/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/11537#issuecomment-344576013",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11537"
    },
    {
      "event": "closed",
      "id": 4528064431,
      "node_id": "MDExOkNsb3NlZEV2ZW50NDUyODA2NDQzMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4528064431",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "dede9eb9247363aacc3816c7352494a3609fa28b",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dede9eb9247363aacc3816c7352494a3609fa28b",
      "created_at": "2021-03-30T14:21:14Z"
    },
    {
      "event": "commented",
      "id": 866991646,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2Njk5MTY0Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/866991646",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-23T16:36:20Z",
      "updated_at": "2021-06-23T16:36:20Z",
      "author_association": "MEMBER",
      "body": "PRs that addressed this network diversity issue with respect to inbound peer eviction protection: #19670, #20197, #21261, #22284.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/11537#issuecomment-866991646",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11537"
    },
    {
      "event": "locked",
      "id": 7216610545,
      "node_id": "LOE_lADOABII584P7j6RzwAAAAGuJLzx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7216610545",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-18T18:36:22Z",
      "lock_reason": "resolved"
    }
  ]
}