{
  "type": "issue",
  "issue": {
    "id": 225641042,
    "node_id": "MDU6SXNzdWUyMjU2NDEwNDI=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10312",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10312/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10312/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10312/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/10312",
    "number": 10312,
    "state": "closed",
    "state_reason": "completed",
    "title": "RPM build fail: Wrongs in specfile Source fields, testscript p2p-fullblocktest.py fail",
    "body": "### Describe\r\n1. The specfile declare `Version: 0.12.0` and inject it to the source URLs to get some files which haven't added yet in tag `v0.12.0`\r\n2. The specfile still declare `Version: 0.12.0` when changes breaking the build process for v0.12.0 are committed. (#9956)\r\n3. testscript p2p-fullblocktest.py fail (with specfile in d34995a, just before #9956 mess up the directory structure)\r\n### Reproduce\r\n1. \r\n```markdown\r\nspectool -g -f ~/rpmbuild/SPECS/bitcoin.spec\r\nGetting https://bitcoin.org/bin/bitcoin-core-0.12.0/bitcoin-0.12.0.tar.gz to ./bitcoin-0.12.0.tar.gz\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100 5272k  100 5272k    0     0   193k      0  0:00:27  0:00:27 --:--:--  205k\r\nGetting http://download.oracle.com/berkeley-db/db-4.8.30.NC.tar.gz to ./db-4.8.30.NC.tar.gz\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100 21.7M  100 21.7M    0     0  3728k      0  0:00:05  0:00:05 --:--:-- 3970k\r\nGetting https://raw.githubusercontent.com/bitcoin/bitcoin/v0.12.0/contrib/debian/examples/bitcoin.conf to ./bitcoin.conf\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  4617  100  4617    0     0   6599      0 --:--:-- --:--:-- --:--:--  6595\r\nGetting https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg to ./Bitcoin.svg\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  1498  100  1498    0     0   1606      0 --:--:-- --:--:-- --:--:--  1607\r\nGetting https://raw.githubusercontent.com/bitcoin/bitcoin/v0.12.0/doc/man/bitcoind.1 to ./bitcoind.1\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\n**curl: (22) The requested URL returned error: 404 Not Found**\r\nGetting https://raw.githubusercontent.com/bitcoin/bitcoin/v0.12.0/doc/man/bitcoin-cli.1 to ./bitcoin-cli.1\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\n**curl: (22) The requested URL returned error: 404 Not Found**\r\nGetting https://raw.githubusercontent.com/bitcoin/bitcoin/v0.12.0/doc/man/bitcoin-qt.1 to ./bitcoin-qt.1\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\n**curl: (22) The requested URL returned error: 404 Not Found**\r\nGetting https://raw.githubusercontent.com/bitcoin/bitcoin/v0.12.0/contrib/rpm/bitcoin.te to ./bitcoin.te\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\n**curl: (22) The requested URL returned error: 404 Not Found**\r\nGetting https://raw.githubusercontent.com/bitcoin/bitcoin/v0.12.0/contrib/rpm/bitcoin.fc to ./bitcoin.fc\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\n**curl: (22) The requested URL returned error: 404 Not Found**\r\nGetting https://raw.githubusercontent.com/bitcoin/bitcoin/v0.12.0/contrib/rpm/bitcoin.if to ./bitcoin.if\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\n**curl: (22) The requested URL returned error: 404 Not Found**\r\n```\r\n2. Execute rpmbuild with specfiles from *master HEAD* or *0.12 HEAD* result in `test/bitcoin-util-test.py: No such file or directory` . In `v0.12.0` , the specfile haven't been added.\r\n3. With specfile from d34995a, the build run smooth and fail in this test:\r\n```\r\nRunning testscript p2p-fullblocktest.py ...\r\nTraceback (most recent call last):\r\n  File \"qa/pull-tester/rpc-tests.py\", line 260, in <module>\r\n    runtests()\r\n  File \"qa/pull-tester/rpc-tests.py\", line 160, in runtests\r\n    rpcTestDir + testScripts[i] + flags, shell=True)\r\n  File \"/usr/lib64/python2.7/subprocess.py\", line 542, in check_call\r\n    raise CalledProcessError(retcode, cmd)\r\nsubprocess.CalledProcessError: Command '/home/khoa/rpmbuild/BUILD/bitcoin-0.12.0/qa/rpc-tests/p2p-fullblocktest.py --srcdir /home/khoa/rpmbuild/BUILD/bitcoin-0.12.0/src  ' returned non-zero exit status -11\r\nerror: Bad exit status from /var/tmp/rpm-tmp.HqT4St (%check)\r\n\r\n\r\nRPM build errors:\r\n    Bad exit status from /var/tmp/rpm-tmp.HqT4St (%check)\r\n```\r\n/var/tmp/rpm-tmp.HqT4St\r\n```\r\n#!/bin/sh\r\n\r\n  RPM_SOURCE_DIR=\"/home/khoa/rpmbuild/SOURCES\"\r\n  RPM_BUILD_DIR=\"/home/khoa/rpmbuild/BUILD\"\r\n  RPM_OPT_FLAGS=\"-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic\"\r\n  RPM_LD_FLAGS=\"-Wl,-z,relro \"\r\n  RPM_ARCH=\"x86_64\"\r\n  RPM_OS=\"linux\"\r\n  export RPM_SOURCE_DIR RPM_BUILD_DIR RPM_OPT_FLAGS RPM_LD_FLAGS RPM_ARCH RPM_OS\r\n  RPM_DOC_DIR=\"/usr/share/doc\"\r\n  export RPM_DOC_DIR\r\n  RPM_PACKAGE_NAME=\"bitcoin\"\r\n  RPM_PACKAGE_VERSION=\"0.12.0\"\r\n  RPM_PACKAGE_RELEASE=\"2.el7.local\"\r\n  export RPM_PACKAGE_NAME RPM_PACKAGE_VERSION RPM_PACKAGE_RELEASE\r\n  LANG=C\r\n  export LANG\r\n  unset CDPATH DISPLAY ||:\r\n  RPM_BUILD_ROOT=\"/home/khoa/rpmbuild/BUILDROOT/bitcoin-0.12.0-2.el7.local.x86_64\"\r\n  export RPM_BUILD_ROOT\r\n  \r\n  PKG_CONFIG_PATH=\"${PKG_CONFIG_PATH}:/usr/lib64/pkgconfig:/usr/share/pkgconfig\"\r\n  export PKG_CONFIG_PATH\r\n  \r\n  set -x\r\n  umask 022\r\n  cd \"/home/khoa/rpmbuild/BUILD\"\r\ncd 'bitcoin-0.12.0'\r\nmake check\r\npushd src\r\nsrcdir=. test/bitcoin-util-test.py\r\npopd\r\nqa/pull-tester/rpc-tests.py -extended\r\n\r\n\r\n```\r\n### Expected behaviour\r\n1. The files is available for fetching with spectool (hardcode a commit with appropriate files).\r\n2. Commits with backward-incompatible changes with a version should not declare that version anymore, or clearly point out a commit in which packager can find appropriate specfile.\r\n3. The test pass. \r\n",
    "user": {
      "login": "voanhcuoc",
      "id": 13129825,
      "node_id": "MDQ6VXNlcjEzMTI5ODI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/13129825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/voanhcuoc",
      "html_url": "https://github.com/voanhcuoc",
      "followers_url": "https://api.github.com/users/voanhcuoc/followers",
      "following_url": "https://api.github.com/users/voanhcuoc/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/voanhcuoc/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/voanhcuoc/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/voanhcuoc/subscriptions",
      "organizations_url": "https://api.github.com/users/voanhcuoc/orgs",
      "repos_url": "https://api.github.com/users/voanhcuoc/repos",
      "events_url": "https://api.github.com/users/voanhcuoc/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/voanhcuoc/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 234878,
        "node_id": "MDU6TGFiZWwyMzQ4Nzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Linux/Unix",
        "name": "Linux/Unix",
        "color": "770000",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 1,
    "closed_at": "2020-04-26T00:44:26Z",
    "created_at": "2017-05-02T09:33:04Z",
    "updated_at": "2022-02-15T11:02:45Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 1065486592,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDEwNjU0ODY1OTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1065486592",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-05-02T12:50:52Z",
      "label": {
        "name": "Linux/Unix",
        "color": "770000"
      }
    },
    {
      "event": "commented",
      "id": 619460743,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYxOTQ2MDc0Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/619460743",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-26T00:44:26Z",
      "updated_at": "2020-04-26T00:44:26Z",
      "author_association": "MEMBER",
      "body": "The RPM spec file was removed in commit https://github.com/bitcoin-core/packaging/commit/fa7c698cb24bab350b40ee2d825c443dabdd9633, because is was unmaintained and outdated.",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/10312#issuecomment-619460743",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10312"
    },
    {
      "event": "closed",
      "id": 3272414882,
      "node_id": "MDExOkNsb3NlZEV2ZW50MzI3MjQxNDg4Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3272414882",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-26T00:44:26Z"
    },
    {
      "event": "locked",
      "id": 6074004062,
      "node_id": "LOE_lADOABII584NcwJSzwAAAAFqCfJe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6074004062",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-15T11:02:45Z",
      "lock_reason": "resolved"
    }
  ]
}