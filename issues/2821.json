{
  "type": "issue",
  "issue": {
    "id": 16593382,
    "node_id": "MDU6SXNzdWUxNjU5MzM4Mg==",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2821",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2821/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2821/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2821/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/2821",
    "number": 2821,
    "state": "closed",
    "state_reason": "completed",
    "title": "Assertion mempool transaction missing input",
    "body": "This seems similar to Issue #2570 even though that is closed.  Interestingly, it still happens in the bitcoin-qt 0.8.3 client, v0.8.3.0-g40809ae-beta version.\n\nThis was a clean compile from source, running on Gentoo Linux (64-bit).  I compiled this independently of the Gentoo system, so no unusual compiler options or anything like that should have been used.\n\nI believe it also happens during a block reorganization.  Here is the debug log:\n\n```\nsending: addr (31 bytes)\nsending: inv (37 bytes)\nreceived: inv (37 bytes)\n  got inventory: tx 0a740a5544620f9b89bb14abf077f8624835bbb5ee65e45f319f9c3e5f8ee6c8  have\nreceived: addr (31 bytes)\nsending: inv (37 bytes)\nreceived: inv (37 bytes)\n  got inventory: tx 0a740a5544620f9b89bb14abf077f8624835bbb5ee65e45f319f9c3e5f8ee6c8  have\nreceived: inv (37 bytes)\n  got inventory: tx 0a740a5544620f9b89bb14abf077f8624835bbb5ee65e45f319f9c3e5f8ee6c8  have\nsending: inv (73 bytes)\nreceived: inv (37 bytes)\n  got inventory: block 000000000000001aa6707204b2d1887089a860eceaf8a893a7c2d08dfe6ac525  have\nsending: getblocks (965 bytes)\nreceived: inv (73 bytes)\n  got inventory: tx 53b325cd548867df032b8879a18abd9c1b97638b3a3c380c38cd8546626d36c5  have\n  got inventory: tx 0a740a5544620f9b89bb14abf077f8624835bbb5ee65e45f319f9c3e5f8ee6c8  have\nreceived: inv (37 bytes)\n  got inventory: tx 53b325cd548867df032b8879a18abd9c1b97638b3a3c380c38cd8546626d36c5  have\nsending: addr (31 bytes)\nsending: inv (73 bytes)\nreceived: inv (37 bytes)\n  got inventory: block 000000000000000dd0d039cf7c7e006d79a915b0ee76180bb300dc74ed3308a2  new\naskfor block 000000000000000dd0d039cf7c7e006d79a915b0ee76180bb300dc74ed3308a2   1373479424000000 (18:03:44)\nreceived: inv (37 bytes)\n  got inventory: block 000000000000001aa6707204b2d1887089a860eceaf8a893a7c2d08dfe6ac525  have\nsending: getblocks (965 bytes)\nreceived: getblocks (965 bytes)\ngetblocks 194158 to 0000000000000000000000000000000000000000000000000000000000000000 limit 500\n  getblocks stopping at limit 194657 00000000000000a13f6a1b564b6ef5bc06067da0374e181f4acf7f3c4d9caf37\nsending: inv (18003 bytes)\nreceived: inv (73 bytes)\n  got inventory: block 000000000000001aa6707204b2d1887089a860eceaf8a893a7c2d08dfe6ac525  have\nsending: getblocks (965 bytes)\n  got inventory: tx 0a740a5544620f9b89bb14abf077f8624835bbb5ee65e45f319f9c3e5f8ee6c8  have\nreceived: inv (37 bytes)\n  got inventory: block 000000000000001aa6707204b2d1887089a860eceaf8a893a7c2d08dfe6ac525  have\nsending: getblocks (965 bytes)\nreceived: block (101786 bytes)\nreceived block 000000000000000dd0d039cf7c7e006d79a915b0ee76180bb300dc74ed3308a2\nREORGANIZE: Disconnect 1 blocks; 000000000000009fd60babdec39b4e49feb4ec17497c0b341e05beb7e692304a..\nREORGANIZE: Connect 2 blocks; ..000000000000001aa6707204b2d1887089a860eceaf8a893a7c2d08dfe6ac525\nCommitting 2146 changed transactions to coin database...\nERROR: Non-canonical signature: R value negative\nERROR: CScriptCheck() : ac0bed4e30581eecf567e9a96ca7b97e5721532b097250c2eb2a5df2c625ad15 VerifySignature failed\nERROR: CTxMemPool::accept() : ConnectInputs failed ac0bed4e30581eecf567e9a96ca7b97e5721532b097250c2eb2a5df2c625ad15\nERROR: CTxMemPool::accept() : nonstandard transaction type\nERROR: Non-canonical signature: R value negative\nERROR: CScriptCheck() : 8a25c7ea809620294d5562026133e3a94f1a3ca429579f9280485e50853b5546 VerifySignature failed\nERROR: CTxMemPool::accept() : ConnectInputs failed 8a25c7ea809620294d5562026133e3a94f1a3ca429579f9280485e50853b5546\nERROR: Non-canonical signature: R value negative\nERROR: CScriptCheck() : 5d8bbdfa6f215f7b33bfcb9608e5e6dd739cc563daf0fc0c591edfd73a8d17ae VerifySignature failed\nERROR: CTxMemPool::accept() : ConnectInputs failed 5d8bbdfa6f215f7b33bfcb9608e5e6dd739cc563daf0fc0c591edfd73a8d17ae\nERROR: CTxMemPool::accept() : nonstandard transaction type\nERROR: CTxMemPool::accept() : nonstandard transaction type\nERROR: CTxMemPool::accept() : nonstandard transaction type\nERROR: CTxMemPool::accept() : inputs already spent\nERROR: CTxMemPool::accept() : inputs already spent\nERROR: CTxMemPool::accept() : inputs already spent\nERROR: CTxMemPool::accept() : inputs already spent\nERROR: CTxMemPool::accept() : nonstandard transaction type\nERROR: CTxMemPool::accept() : inputs already spent\nERROR: CTxMemPool::accept() : inputs already spent\nERROR: CTxMemPool::accept() : inputs already spent\nERROR: CTxMemPool::accept() : inputs already spent\nERROR: Non-canonical signature: S value negative\nERROR: CScriptCheck() : 3b33366cf854d9046678fffadde8dac3435431a33c217ee1a25826502a3ef569 VerifySignature failed\nERROR: CTxMemPool::accept() : ConnectInputs failed 3b33366cf854d9046678fffadde8dac3435431a33c217ee1a25826502a3ef569\nCTxMemPool::accept() : accepted cc4668b4f417e12492b384d22e081843da52875ecb072f2c39efc982a9fa9a4e (poolsz 1304)\nSetBestChain: new best=000000000000001aa6707204b2d1887089a860eceaf8a893a7c2d08dfe6ac525  height=245886  log2_work=70.667529  tx=20513801  date=2013-07-10 17:47:29 progress=0.999999\nProcessBlock: ACCEPTED\nsending: inv (37 bytes)\nsending: inv (37 bytes)\nsending: inv (37 bytes)\nreceived: inv (37 bytes)\n  got inventory: tx 0a740a5544620f9b89bb14abf077f8624835bbb5ee65e45f319f9c3e5f8ee6c8  have\nreceived: inv (37 bytes)\n  got inventory: block 000000000000000dd0d039cf7c7e006d79a915b0ee76180bb300dc74ed3308a2  have\nsending: getblocks (965 bytes)\nforce request: block 000000000000000dd0d039cf7c7e006d79a915b0ee76180bb300dc74ed3308a2\nsending: inv (37 bytes)\nsending: inv (73 bytes)\nsending: inv (37 bytes)\nsending: inv (37 bytes)\nreceived: inv (37 bytes)\n  got inventory: tx 0a740a5544620f9b89bb14abf077f8624835bbb5ee65e45f319f9c3e5f8ee6c8  have\nsending getdata: tx 86a417868917ef04aa7762df4e9d8e8e2d289000e269ebd60787a92f1ab50b25\nsending: getdata (37 bytes)\nsending: inv (37 bytes)\nsending: block (248889 bytes)\nsending: block (98904 bytes)\nsending: block (113210 bytes)\nsending: block (77749 bytes)\nsending: block (63716 bytes)\nsending: inv (37 bytes)\nsending: inv (37 bytes)\nsending: inv (37 bytes)\nsending: inv (37 bytes)\nsending: inv (37 bytes)\nsending: inv (37 bytes)\nsending: inv (37 bytes)\nreceived: inv (37 bytes)\n  got inventory: tx 0a740a5544620f9b89bb14abf077f8624835bbb5ee65e45f319f9c3e5f8ee6c8  have\nsending: inv (37 bytes)\nreceived: inv (37 bytes)\n  got inventory: block 000000000000000dd0d039cf7c7e006d79a915b0ee76180bb300dc74ed3308a2  have\nsending: getblocks (965 bytes)\nforce request: block 000000000000000dd0d039cf7c7e006d79a915b0ee76180bb300dc74ed3308a2\nERROR: mempool transaction missing input\nbitcoin-qt: src/main.cpp:4251: CBlockTemplate* CreateNewBlock(CReserveKey&): Assertion `\"mempool transaction missing input\" == 0' failed.\n```\n\nAfter this, I restarted the client again, and it came right back up and running without incident.\n\nJosh\n",
    "user": {
      "login": "Krellan",
      "id": 4563817,
      "node_id": "MDQ6VXNlcjQ1NjM4MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4563817?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Krellan",
      "html_url": "https://github.com/Krellan",
      "followers_url": "https://api.github.com/users/Krellan/followers",
      "following_url": "https://api.github.com/users/Krellan/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/Krellan/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/Krellan/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/Krellan/subscriptions",
      "organizations_url": "https://api.github.com/users/Krellan/orgs",
      "repos_url": "https://api.github.com/users/Krellan/repos",
      "events_url": "https://api.github.com/users/Krellan/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/Krellan/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64585,
        "node_id": "MDU6TGFiZWw2NDU4NQ==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
        "name": "Bug",
        "color": "FBBAAB",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 1,
    "closed_at": "2016-02-16T17:27:57Z",
    "created_at": "2013-07-10T18:40:01Z",
    "updated_at": "2021-09-08T12:34:43Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 118159835,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDExODE1OTgzNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/118159835",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-05-06T09:25:26Z",
      "label": {
        "name": "Bug",
        "color": "FBBAAB"
      }
    },
    {
      "event": "commented",
      "id": 64153303,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0MTUzMzAz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64153303",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-11-24T05:21:58Z",
      "updated_at": "2014-11-24T05:37:11Z",
      "author_association": "NONE",
      "body": "The mempool can and will contain transactions with missing inputs (orphans) due to various reasons such as reorganization caused by downloading the blockchain while a miner thread is running as you've shown. This is due to the fact that reorganization does nothing with spent coinbase transactions. The assert is useless since the problem is not really a problem but rather a symptom something larger.\n\nRefer to #5267\n",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/2821#issuecomment-64153303",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2821"
    },
    {
      "event": "closed",
      "id": 552356366,
      "node_id": "MDExOkNsb3NlZEV2ZW50NTUyMzU2MzY2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/552356366",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2016-02-16T17:27:57Z"
    },
    {
      "event": "referenced",
      "id": 2255311294,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDIyNTUzMTEyOTQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2255311294",
      "actor": {
        "login": "Bushstar",
        "id": 5293433,
        "node_id": "MDQ6VXNlcjUyOTM0MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5293433?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Bushstar",
        "html_url": "https://github.com/Bushstar",
        "followers_url": "https://api.github.com/users/Bushstar/followers",
        "following_url": "https://api.github.com/users/Bushstar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Bushstar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Bushstar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Bushstar/subscriptions",
        "organizations_url": "https://api.github.com/users/Bushstar/orgs",
        "repos_url": "https://api.github.com/users/Bushstar/repos",
        "events_url": "https://api.github.com/users/Bushstar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Bushstar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a370bbfe3d103294a6b0517ac76a1f5a51e0c685",
      "commit_url": "https://api.github.com/repos/Bushstar/omnicore/commits/a370bbfe3d103294a6b0517ac76a1f5a51e0c685",
      "created_at": "2019-04-05T09:46:11Z"
    },
    {
      "event": "locked",
      "id": 5272014115,
      "node_id": "LOE_lADOABII584A_THmzwAAAAE6PI0j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5272014115",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T12:34:42Z",
      "lock_reason": "resolved"
    }
  ]
}