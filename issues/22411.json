{
  "type": "issue",
  "issue": {
    "id": 938133097,
    "node_id": "MDU6SXNzdWU5MzgxMzMwOTc=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22411",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22411/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22411/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22411/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/22411",
    "number": 22411,
    "state": "closed",
    "state_reason": "completed",
    "title": "Rate limits for `ping` RPC",
    "body": "### Issue\r\nWhat are the rate limits for [`ping`](https://bitcoincore.org/en/doc/0.21.0/rpc/network/ping/) RPC which was added in https://github.com/bitcoin/bitcoin/pull/2937?\r\n\r\nIf no rate limits, do we need them? \r\n\r\n### What behavior did you expect?\r\n\r\nI was expecting some errors in bitcoind or maybe peers ban my node based on the rate limits mentioned in https://bitcointalk.org/index.php?topic=279652.msg3002232#msg3002232\r\n\r\n> I added a ratelimit to RPC-requested ping, so that it will limit to 1/second per peer.  The regular automated keepalive ping is immune to this.\r\n\r\nBut this comment says there is no rate limit:\r\n\r\n> Got rid of the idea of rate-limiting user-requested RPC pings, that simplifies a chunk of code.\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/2937#issuecomment-23245689\r\n\r\n### What was the actual behavior ?\r\n\r\nNo errors. Peers did not ban my node. I was sending 50-100 `ping` per second\r\n\r\n### How reliably can you reproduce the issue, what are the steps to do so?\r\n\r\nIts easy to reproduce. Everyone can use different ways to send `ping`. I used the below steps:\r\n\r\n1. Run `bitcoind` with bitcoin.conf:\r\n\r\n   ```\r\n   testnet=1\r\n   server=1\r\n   \r\n   test.rpcport=18444\r\n   rpcuser=user3\r\n   rpcpassword=password3\r\n   ```\r\n2. Use intruder in Burp Suite to brute force and send `ping` RPC with different id in each request.\r\n\r\n   Request:\r\n\r\n   ```\r\n   POST / HTTP/1.1\r\n   Host: 127.0.01:18444\r\n   Authorization: Basic dXNlcjM6cGFzc3dvcmQz\r\n   Content-Type: text/plain\r\n   Content-Length: 68\r\n\r\n   {\"jsonrpc\": \"1.0\", \"id\": \"$curltest$\", \"method\": \"ping\", \"params\": []}\r\n   ```\r\n\r\n3. Check peers with `-netinfo` and `getpeerinfo`. Keep an eye on bitcoind for errors.\r\n\r\n```\r\n$ bitcoin-cli -netinfo\r\nBitcoin Core v21.99.0-bb4790816d84 testnet - 70016/Satoshi:21.99.0/\r\n\r\n        ipv4    ipv6   onion   total   block\r\nin         0       0       1       1\r\nout        6       0       4      10       2\r\ntotal      6       0       5      11\r\n\r\nLocal addresses\r\neadtub66sw6z4rtzf753aplvy7psthggirtgowr3rsnebbpsws2vyxyd.onion     port  18333    score      4\r\n\r\n```\r\n\r\n`getpeerinfo` : https://pastebin.com/vKi5sfK2\r\n\r\nRequests sent at 06 Jul 2021 17:28:01 GMT (72111 - 72028 = 83)\r\n\r\n<details><summary>First</summary>\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/124644027-692afc80-deaf-11eb-8fae-a6d6cc56daae.png)\r\n\r\n</details>\r\n\r\n<details><summary>Last</summary>\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/124644109-82cc4400-deaf-11eb-9951-2c7dbe9ec241.png)\r\n\r\n</details>\r\n\r\n### Bitcoin Core version\r\n\r\nBitcoin Core v21.99.0-bb4790816d84 (Had compiled yesterday for testing PR 17355)\r\n\r\n### What type of machine are you observing the error on (OS/CPU and disk type)? \r\n\r\nLinux (Pop!_OS) as VM\r\n\r\nRelated question: https://bitcoin.stackexchange.com/questions/107431/what-is-ping-rpc-used-for\r\n\r\n\r\n",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      },
      {
        "id": 477890092,
        "node_id": "MDU6TGFiZWw0Nzc4OTAwOTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Questions%20and%20Help",
        "name": "Questions and Help",
        "color": "006688",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 2,
    "closed_at": "2021-07-07T07:53:50Z",
    "created_at": "2021-07-06T18:00:21Z",
    "updated_at": "2022-08-18T18:36:36Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 875376630,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg3NTM3NjYzMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875376630",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-07T07:53:50Z",
      "updated_at": "2021-07-07T07:53:50Z",
      "author_association": "MEMBER",
      "body": "> What are the rate limits for ping RPC which was added in #2937?\r\n\r\nNone, apart from your local rpc work queue limits.\r\n\r\n> If no rate limits, do we need them?\r\n\r\nI'd say no, unless there is a reason to limit?",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/22411#issuecomment-875376630",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22411"
    },
    {
      "event": "closed",
      "id": 4987430995,
      "node_id": "MDExOkNsb3NlZEV2ZW50NDk4NzQzMDk5NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4987430995",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-07T07:53:50Z"
    },
    {
      "event": "labeled",
      "id": 4987447047,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ5ODc0NDcwNDc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4987447047",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-07T07:57:00Z",
      "label": {
        "name": "Questions and Help",
        "color": "006688"
      }
    },
    {
      "event": "labeled",
      "id": 4987447048,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ5ODc0NDcwNDg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4987447048",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-07T07:57:00Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "commented",
      "id": 875411298,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg3NTQxMTI5OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875411298",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-07T08:40:56Z",
      "updated_at": "2021-07-07T08:40:56Z",
      "author_association": "MEMBER",
      "body": "To clarify my answer a bit: \r\n* The RPC interface is a private trusted interface, so the caller is assumed to behave honestly. If that assumption fails, rate limiting a single RPC isn't going to provide any meaningful benefit.\r\n* The P2P \"interface\" is public and untrusted. Thus, any rate limit can simply be patched out by the bad actor. Any rate limiting would need to be applied at the receiver side. However, as no other message types (even unknown message types, such as `pyng`) are rate limited, rate limiting a single P2P message type isn't going to provide any meaningful benefit either.",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/22411#issuecomment-875411298",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22411"
    },
    {
      "event": "locked",
      "id": 7216611929,
      "node_id": "LOE_lADOABII58436sZpzwAAAAGuJMJZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7216611929",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-18T18:36:36Z",
      "lock_reason": "resolved"
    }
  ]
}