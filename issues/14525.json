{
  "type": "issue",
  "issue": {
    "id": 372169031,
    "node_id": "MDU6SXNzdWUzNzIxNjkwMzE=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14525",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14525/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14525/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14525/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/14525",
    "number": 14525,
    "state": "closed",
    "state_reason": "completed",
    "title": "[consensus] nodes may not reorg after rule violation",
    "body": "After the full publication of CVE-2018-17144, several occasions of hits on derived blockchains came to attention. Following that, we did a test setup:\r\n\r\nHardware: \r\n1 pc. bare metal (DELL R730)\r\n3 pc. Antminer S9 (via Slush's Stratum protocol)\r\n\r\nProcedure:\r\n- take git 0296b9c85e942686df7ef40333e07e9b1802b892 (0.16.2) \r\n- mod testnet params to run a confined chain in regressive time scale (all in chainparams.cpp, no other change)\r\n- run a bunch of nodes, one of them mining (1 ASIC)\r\n- in order to have more fun, consolidate some tcoins so we have a transaction other than coinbase\r\n- create a raw transaction Italian flavour, copy-pasta inputs and it's being mined as described in the publication.\r\n- let the node mine further for a while, in the test case 500+ blocks, nvm the exact number\r\n- assume we have virtually discovered the attack and stop the mining node\r\n- apply the patch to the mining node (all others left untouched) \r\n- start mining node by -reindex\r\n- the updated node recognises the invalid block and finally bans the others\r\n- patch a second one because we need a peer \r\n- attach the remaining 2 ASICS together with the first one and go on from the first invalid block (speed things up while simulating real life)\r\n\r\nExpected result:\r\n\r\n- the non-updated nodes should follow the (work wise) longest chain\r\n\r\nTest result:\r\n\r\n- the \"crowd\" nodes are stuck at their latest block information\r\n\r\nThe confirmation and reproduction of this behaviour is the current point of our research, would like to read reactions before we extend the setup for running both chains in parallel.\r\n\r\nUpdate:\r\n\r\n- Noticed while matching nbits, the new and now valid block's hash resulted in an overall lower number than the culprit containing multi-inputs\r\n\r\n- non-updated nodes can be brought back to life by reindexing \r\n\r\n\r\n",
    "user": {
      "login": "HashUnlimited",
      "id": 26601261,
      "node_id": "MDQ6VXNlcjI2NjAxMjYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/26601261?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/HashUnlimited",
      "html_url": "https://github.com/HashUnlimited",
      "followers_url": "https://api.github.com/users/HashUnlimited/followers",
      "following_url": "https://api.github.com/users/HashUnlimited/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/HashUnlimited/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/HashUnlimited/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/HashUnlimited/subscriptions",
      "organizations_url": "https://api.github.com/users/HashUnlimited/orgs",
      "repos_url": "https://api.github.com/users/HashUnlimited/repos",
      "events_url": "https://api.github.com/users/HashUnlimited/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/HashUnlimited/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64584,
        "node_id": "MDU6TGFiZWw2NDU4NA==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Brainstorming",
        "name": "Brainstorming",
        "color": "ebd775",
        "default": false
      },
      {
        "id": 192202000,
        "node_id": "MDU6TGFiZWwxOTIyMDIwMDA=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Consensus",
        "name": "Consensus",
        "color": "009800",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 1,
    "closed_at": "2018-10-20T13:50:00Z",
    "created_at": "2018-10-20T03:51:38Z",
    "updated_at": "2021-09-08T12:51:22Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 431582147,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTU4MjE0Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431582147",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-20T13:28:12Z",
      "updated_at": "2018-10-20T13:28:12Z",
      "author_association": "MEMBER",
      "body": "See #14341.",
      "user": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/14525#issuecomment-431582147",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14525"
    },
    {
      "event": "closed",
      "id": 1916218882,
      "node_id": "MDExOkNsb3NlZEV2ZW50MTkxNjIxODg4Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1916218882",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-20T13:50:00Z"
    },
    {
      "event": "labeled",
      "id": 1916218948,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDE5MTYyMTg5NDg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1916218948",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-20T13:50:07Z",
      "label": {
        "name": "Consensus",
        "color": "009800"
      }
    },
    {
      "event": "labeled",
      "id": 1916218991,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDE5MTYyMTg5OTE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1916218991",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-20T13:50:12Z",
      "label": {
        "name": "Brainstorming",
        "color": "ebd775"
      }
    },
    {
      "event": "locked",
      "id": 5272106480,
      "node_id": "LOE_lADOABII584WLtlHzwAAAAE6PfXw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5272106480",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T12:51:22Z",
      "lock_reason": "resolved"
    }
  ]
}