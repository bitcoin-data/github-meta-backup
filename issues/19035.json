{
  "type": "issue",
  "issue": {
    "id": 622205284,
    "node_id": "MDU6SXNzdWU2MjIyMDUyODQ=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19035",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19035/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19035/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19035/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/19035",
    "number": 19035,
    "state": "open",
    "state_reason": null,
    "title": "Address cluster information on coin control window",
    "body": "I found it is very difficult to maintain privacy on my transactions because it is difficult to keep the address separated. I'm trying to prevent my addresses to cluster together, based on the following definition:\r\n\r\n> Usually an adversary will try to link together multiple addresses which they believe belong to the same wallet. Such address collections are called \"clusters\", \"closures\" or \"wallet clusters\", and the activity of creating them is called \"wallet clustering\". ([source](https://en.bitcoin.it/wiki/Privacy#Blockchain_attacks_on_privacy))\r\n\r\nWhile the coin control feature helps with that, it does not show all the transaction tree, listing just the coin sources.\r\n\r\nI would like the coin control window display all the clustered addresses belonging to any given tree so I can chose better which coins to use.\r\n\r\n### An example tree ###\r\n\r\nGiven the following transaction tree (where up-case letters are owned addresses)\r\n\r\n```\r\na -> B\r\n  -> C -> e\r\n     |--> D\r\n```\r\n\r\nThere are two UTXOs that can be spend: `B` and `D`, both are change addresses, within the coin-control I can see that the coins were received from `a`, but there is no mention of `e`, and that could be actually quite important, if for example `e` does know my name. That would allow for example, prioritizing those UTXO to send more money to `e`.\r\n\r\nCould it be possible to add that information in the tree?",
    "user": {
      "login": "eloyesp",
      "id": 173797,
      "node_id": "MDQ6VXNlcjE3Mzc5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173797?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eloyesp",
      "html_url": "https://github.com/eloyesp",
      "followers_url": "https://api.github.com/users/eloyesp/followers",
      "following_url": "https://api.github.com/users/eloyesp/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/eloyesp/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/eloyesp/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/eloyesp/subscriptions",
      "organizations_url": "https://api.github.com/users/eloyesp/orgs",
      "repos_url": "https://api.github.com/users/eloyesp/repos",
      "events_url": "https://api.github.com/users/eloyesp/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/eloyesp/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64583,
        "node_id": "MDU6TGFiZWw2NDU4Mw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
        "name": "Feature",
        "color": "7cf575",
        "default": false
      },
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 2,
    "created_at": "2020-05-21T02:40:55Z",
    "updated_at": "2020-05-28T09:55:36Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 3359020630,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMzNTkwMjA2MzA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3359020630",
      "actor": {
        "login": "eloyesp",
        "id": 173797,
        "node_id": "MDQ6VXNlcjE3Mzc5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/173797?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/eloyesp",
        "html_url": "https://github.com/eloyesp",
        "followers_url": "https://api.github.com/users/eloyesp/followers",
        "following_url": "https://api.github.com/users/eloyesp/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/eloyesp/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/eloyesp/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/eloyesp/subscriptions",
        "organizations_url": "https://api.github.com/users/eloyesp/orgs",
        "repos_url": "https://api.github.com/users/eloyesp/repos",
        "events_url": "https://api.github.com/users/eloyesp/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/eloyesp/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-21T02:40:55Z",
      "label": {
        "name": "Feature",
        "color": "7cf575"
      }
    },
    {
      "event": "labeled",
      "id": 3359027814,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMzNTkwMjc4MTQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3359027814",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-21T02:44:56Z",
      "label": {
        "name": "GUI",
        "color": "02d7e1"
      }
    },
    {
      "event": "unlabeled",
      "id": 3360429235,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50MzM2MDQyOTIzNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3360429235",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-21T12:11:15Z",
      "label": {
        "name": "GUI",
        "color": "02d7e1"
      }
    },
    {
      "event": "commented",
      "id": 632052160,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzMjA1MjE2MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/632052160",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-21T12:11:33Z",
      "updated_at": "2020-05-21T12:11:33Z",
      "author_association": "MEMBER",
      "body": "I think if this is implemented, it should also be available to RPC wallets",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/19035#issuecomment-632052160",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19035"
    },
    {
      "event": "labeled",
      "id": 3360430439,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMzNjA0MzA0Mzk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3360430439",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-21T12:11:38Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "commented",
      "id": 635241696,
      "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTI0MTY5Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635241696",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-05-28T09:55:15Z",
      "updated_at": "2020-05-28T09:55:36Z",
      "author_association": "MEMBER",
      "body": "It would indeed be useful to track where linked funds have been sent to. Perhaps we can add a column \"Linked destinations\". This would contain a list of labels (fallback to addresses) of anything we sent to.\r\n\r\n<img width=\"999\" alt=\"Schermafbeelding 2020-05-28 om 11 14 31\" src=\"https://user-images.githubusercontent.com/10217/83122858-839f7d80-a0d4-11ea-9811-e9ff97726200.png\">\r\n\r\n> I think if this is implemented, it should also be available to RPC wallets\r\n\r\nWe have `listaddressgroupings` but could use `listunspentgroupings`. That might be a good place to start. Starting with the newest unspent output in a wallet, recursively iterate over its inputs and change outputs to collect all related wallet transactions. Insert all of them in the first group. Pick a wallet output that's not in the first group, rinse and repeat. Once you have the groups, collect all its non-wallet destinations (labels) and origins (labels).\r\n\r\n```\r\n[\r\n {\r\n    \"destinations\": [{\"label\": \"KYC place\", \"address\": \"3...\"}],\r\n    \"origins\": [{\"label\": \"Customer 1, \"address\": \"bc1...\"}, {\"label\": \"Customer 2, \"address\": \"bc1...\"}],\r\n   \"unspents\": [ same format as listunspent ] \r\n  },\r\n  {\r\n    // second group...\r\n  },\r\n  // other groups\r\n]\r\n```\r\n\r\nIdeally the UI coin selection tree would also have these groups.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/19035#issuecomment-635241696",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19035"
    }
  ]
}