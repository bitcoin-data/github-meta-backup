{
  "type": "issue",
  "issue": {
    "id": 183887630,
    "node_id": "MDU6SXNzdWUxODM4ODc2MzA=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8971",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8971/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8971/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8971/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/8971",
    "number": 8971,
    "state": "closed",
    "state_reason": "completed",
    "title": "block download stall at 998938",
    "body": "Last new best was block 00000000009f9e3d0031fb6ba1d5ce398c74430d5f772a50046638016511e70e (998938).\n\nRunning on testnet, Bitcoin version v0.13.0.0-b248185-dirty\n\nthe first entry in debug.log for a block of height 998937 is:-\n\n> 2016-10-19 06:02:18.179519 recv header 0000000000224e8e56f92315d1ca0584d6e8c09d443c480947e71c737ffc1580 (998937)\n\nThis is the first time this block hash is seen. It does not trigger a getdata block request. Instead another header is received, with a lower height, which does trigger a getdata and the block arriving:-\n\n> 2016-10-19 06:02:19.762340 recv header 00000000001e98549fe7313de57caf4713e72c3a55b813261d0611ab09812028 (998695)\n> 2016-10-19 06:02:19.762378 send getdata block \n> 00000000001e98549fe7313de57caf4713e72c3a55b813261d0611ab09812028 (998695)\n> 2016-10-19 06:02:20.023983 recv block 00000000001e98549fe7313de57caf4713e72c3a55b813261d0611ab09812028 (998695)\n> 2016-10-19 06:02:20.024308 UpdateTip: new best=00000000001e98549fe7313de57caf4713e72c3a55b813261d0611ab09812028 (998695) ver=0x20000000 date=2016-10-19 08:02:02 tx=1 100.000215%\n\nThen we see a header for a block with a higher height, but this doesn't trigger a getdata:-\n\n> 2016-10-19 06:02:23.738059 recv header 00000000001cd44adf20b47ea48fbc8524c0516a87517814edcd51fb07f947fe (998938)\n\nand following this, subsequent blocks increasing in height. So there seems to be more than one block of height 998938 so far.\n\nThe first time the block that is currently the new best is seen is at:-\n\n> 2016-10-19 06:15:58.246604 recv header 00000000009f9e3d0031fb6ba1d5ce398c74430d5f772a50046638016511e70e (998938)\n> 2016-10-19 06:15:58.246651 send getdata block 00000000009f9e3d0031fb6ba1d5ce398c74430d5f772a50046638016511e70e (998938)\n> 2016-10-19 06:15:58.507754 recv block 00000000009f9e3d0031fb6ba1d5ce398c74430d5f772a50046638016511e70e (998938)\n> 2016-10-19 06:15:58.508065 UpdateTip: new best=00000000009f9e3d0031fb6ba1d5ce398c74430d5f772a50046638016511e70e (998938) ver=0x20000000 date=2016-10-19 08:15:33 tx=1 100.000214%\n\nand this is the last time my node sends a getdata block request.\n\nThe next time we see any mention of a block height of 998938 is at:-\n\n> 2016-10-19 06:17:43.387921 recv header 00000000003f6d0285755d48676148792103833d8e5a97cd8e7a7953f16fb21e (998938)\n\nwhich again is a different block hash (a 3rd one for this height) indicating at least 3 branches from an earlier block. The header above is seen in a block of headers from 000000000094b95002d22956ca9fd21a4cc08dc29c94458d5d818160491c6046 (998568) to 000000000074d98c42a13cb1203a40a27bb7f4db6c07013c935b9beba0980c5d (999104), all of which are already in the BlockIndex. The next header received is a new one (i.e. not in the BlockIndex), 000000000038dfcf8b810293acf32a6737bb3a025324b38693fdff3497fa0553 (999105).\n\nNext a sequence of headers (already in the BlockIndex are received), 000000000094b95002d22956ca9fd21a4cc08dc29c94458d5d818160491c6046 (998568) to 000000000038dfcf8b810293acf32a6737bb3a025324b38693fdff3497fa0553 (999105), all from the same peer so far, but then a new header is received: 0000000000c0cedcecb5b226bf6775dd62d3c5ebbfb779c024e7d410d894cada (999106), followed by several more new headers until 0000000000ee976e05798ea2def35b444f5d02255ec858a019bedbda81d9d533 (999112).\n\nStill debugging this to try to unravel what is going on....\n",
    "user": {
      "login": "rebroad",
      "id": 1530283,
      "node_id": "MDQ6VXNlcjE1MzAyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rebroad",
      "html_url": "https://github.com/rebroad",
      "followers_url": "https://api.github.com/users/rebroad/followers",
      "following_url": "https://api.github.com/users/rebroad/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/rebroad/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/rebroad/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
      "organizations_url": "https://api.github.com/users/rebroad/orgs",
      "repos_url": "https://api.github.com/users/rebroad/repos",
      "events_url": "https://api.github.com/users/rebroad/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/rebroad/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 1,
    "closed_at": "2016-10-20T03:48:35Z",
    "created_at": "2016-10-19T07:38:38Z",
    "updated_at": "2021-09-08T12:43:18Z"
  },
  "events": [
    {
      "event": "renamed",
      "id": 828638249,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50ODI4NjM4MjQ5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/828638249",
      "actor": {
        "login": "rebroad",
        "id": 1530283,
        "node_id": "MDQ6VXNlcjE1MzAyODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rebroad",
        "html_url": "https://github.com/rebroad",
        "followers_url": "https://api.github.com/users/rebroad/followers",
        "following_url": "https://api.github.com/users/rebroad/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rebroad/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rebroad/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
        "organizations_url": "https://api.github.com/users/rebroad/orgs",
        "repos_url": "https://api.github.com/users/rebroad/repos",
        "events_url": "https://api.github.com/users/rebroad/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rebroad/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2016-10-19T07:41:26Z",
      "rename": {
        "from": "block download stall",
        "to": "block download stall at 998938"
      }
    },
    {
      "event": "commented",
      "id": 255002082,
      "node_id": "MDEyOklzc3VlQ29tbWVudDI1NTAwMjA4Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255002082",
      "actor": {
        "login": "rebroad",
        "id": 1530283,
        "node_id": "MDQ6VXNlcjE1MzAyODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rebroad",
        "html_url": "https://github.com/rebroad",
        "followers_url": "https://api.github.com/users/rebroad/followers",
        "following_url": "https://api.github.com/users/rebroad/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rebroad/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rebroad/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
        "organizations_url": "https://api.github.com/users/rebroad/orgs",
        "repos_url": "https://api.github.com/users/rebroad/repos",
        "events_url": "https://api.github.com/users/rebroad/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rebroad/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2016-10-20T03:46:35Z",
      "updated_at": "2016-10-20T03:46:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "Seems this might not be a problem, but perhaps highlights that some additional debug would help to see why no getdata blocks were sent.\n\nWith hindsight we can now see that block 00000000008de23f76f653be1dff8dd6ebc4bf5d6e5b915cc837734af498afb4 (998939) is the next block to follow, and this is not seen on the network until:-\n\n> 2016-10-19 09:08:26.633713 recv header 00000000008de23f76f653be1dff8dd6ebc4bf5d6e5b915cc837734af498afb4 (998939)\n\nwhich is then requested and becomes the new best:-\n\n> 2016-10-19 09:08:32.180607 UpdateTip: new best=00000000008de23f76f653be1dff8dd6ebc4bf5d6e5b915cc837734af498afb4 (998939) ver=0x20000000 date=2016-10-19 09:08:37 tx=487 100.000000%\n\nWhat was confusing is that other headers received after the new best 998938 with block height 998939 (but not the \"official\" 998939) are still shown in the debug but not distinguished as a different branch, e.g.:-\n\n> 2016-10-19 06:02:24.018650 recv header 00000000001f7b5d22d081021658e78fb2cde7ff86ccae65d62f66ab916d38cb (998939) \n> 2016-10-19 06:17:43.387935 recv header 00000000005c7500961a079c049c0bfb254585a7dd360364bf46ab3f0ef4e7a5 (998939)\n\nwhich upon first glance make it appear that block fetching is broken. Will work on a PR that will add a debug message to distinguish between main chain and alt chains.  Changing subject of this issue to signify that this is simply a debug ambiguity.\n",
      "user": {
        "login": "rebroad",
        "id": 1530283,
        "node_id": "MDQ6VXNlcjE1MzAyODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rebroad",
        "html_url": "https://github.com/rebroad",
        "followers_url": "https://api.github.com/users/rebroad/followers",
        "following_url": "https://api.github.com/users/rebroad/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rebroad/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rebroad/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
        "organizations_url": "https://api.github.com/users/rebroad/orgs",
        "repos_url": "https://api.github.com/users/rebroad/repos",
        "events_url": "https://api.github.com/users/rebroad/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rebroad/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/8971#issuecomment-255002082",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8971"
    },
    {
      "event": "closed",
      "id": 830020406,
      "node_id": "MDExOkNsb3NlZEV2ZW50ODMwMDIwNDA2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/830020406",
      "actor": {
        "login": "rebroad",
        "id": 1530283,
        "node_id": "MDQ6VXNlcjE1MzAyODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rebroad",
        "html_url": "https://github.com/rebroad",
        "followers_url": "https://api.github.com/users/rebroad/followers",
        "following_url": "https://api.github.com/users/rebroad/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rebroad/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rebroad/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
        "organizations_url": "https://api.github.com/users/rebroad/orgs",
        "repos_url": "https://api.github.com/users/rebroad/repos",
        "events_url": "https://api.github.com/users/rebroad/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rebroad/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2016-10-20T03:48:35Z"
    },
    {
      "event": "locked",
      "id": 5272061089,
      "node_id": "LOE_lADOABII584K9ecOzwAAAAE6PUSh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5272061089",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T12:43:18Z",
      "lock_reason": "resolved"
    }
  ]
}