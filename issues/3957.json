{
  "type": "issue",
  "issue": {
    "id": 30108431,
    "node_id": "MDU6SXNzdWUzMDEwODQzMQ==",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3957",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3957/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3957/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3957/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/3957",
    "number": 3957,
    "state": "closed",
    "state_reason": "completed",
    "title": "Missing blk00000.dat doesn't cause failure when retrieving blocks.",
    "body": "Using bitcoind v0.9.0rc2-17-gd33f69a-beta (64-bit).  When using bitcoinj as a client to  to retrieve blocks from bitcoind with the wire protocol recent blocks were able to be retrieved as normal but when starting at the genesis block invalid blocks were being returned.\n\nThe following steps were taken:\n1/ complete ver/verack handshake\n2/ send getblocks message using genesis block hash as the locator\n3/ receive inv message with 500 block hashes.  The first 5 were manually validated as correct by checking blockchain.info\n4/ send getblocks message using the same inventory items from the previous inv message.\n5/ 500 block messages returned by bitcoind.  However every block 81 bytes long.  First byte was 0x02 (which is the wrong version for the genesis block) followed by 80 0x00 bytes.\n\nAfter much investigating it turns out blk00000.dat was missing.  Apparently rather than failing when unable to locate the block in the blockchain bitcoind was returning zeroed arrays of bytes.  Whilst a peer could probably recover from connecting to a bitcoind in this state as it will simply ignore the obviously invalid blocks it's not quite the behaviour you'd expect.  The client behaved completely normally as a client.  Guessing it would have continued to do so unless the wallet contained outputs from the missing blkxxxxx.dat.\n\nUnable to pinpoint when the file was deleted but likely it was several weeks ago and the client has been running happilly without it.\n\nPresumably the indexes where still present as the bitcoind was able to produce a valid inv response to getblocks.\n",
    "user": {
      "login": "shadders",
      "id": 947848,
      "node_id": "MDQ6VXNlcjk0Nzg0OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/947848?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shadders",
      "html_url": "https://github.com/shadders",
      "followers_url": "https://api.github.com/users/shadders/followers",
      "following_url": "https://api.github.com/users/shadders/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/shadders/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/shadders/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/shadders/subscriptions",
      "organizations_url": "https://api.github.com/users/shadders/orgs",
      "repos_url": "https://api.github.com/users/shadders/repos",
      "events_url": "https://api.github.com/users/shadders/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/shadders/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64585,
        "node_id": "MDU6TGFiZWw2NDU4NQ==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
        "name": "Bug",
        "color": "FBBAAB",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 2,
    "closed_at": "2014-06-01T15:48:45Z",
    "created_at": "2014-03-25T09:39:34Z",
    "updated_at": "2021-09-08T12:33:03Z"
  },
  "events": [
    {
      "event": "renamed",
      "id": 105139580,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50MTA1MTM5NTgw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/105139580",
      "actor": {
        "login": "shadders",
        "id": 947848,
        "node_id": "MDQ6VXNlcjk0Nzg0OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/947848?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/shadders",
        "html_url": "https://github.com/shadders",
        "followers_url": "https://api.github.com/users/shadders/followers",
        "following_url": "https://api.github.com/users/shadders/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/shadders/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/shadders/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/shadders/subscriptions",
        "organizations_url": "https://api.github.com/users/shadders/orgs",
        "repos_url": "https://api.github.com/users/shadders/repos",
        "events_url": "https://api.github.com/users/shadders/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/shadders/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-03-25T09:40:22Z",
      "rename": {
        "from": "Missing blk00000.dat doesn't cause failure.",
        "to": "Missing blk00000.dat doesn't cause failure when retrieving blocks."
      }
    },
    {
      "event": "labeled",
      "id": 105157152,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDEwNTE1NzE1Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/105157152",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-03-25T10:39:56Z",
      "label": {
        "name": "Bug",
        "color": "FBBAAB"
      }
    },
    {
      "event": "commented",
      "id": 42762608,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzYyNjA4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42762608",
      "actor": {
        "login": "ashleyholman",
        "id": 549484,
        "node_id": "MDQ6VXNlcjU0OTQ4NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/549484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ashleyholman",
        "html_url": "https://github.com/ashleyholman",
        "followers_url": "https://api.github.com/users/ashleyholman/followers",
        "following_url": "https://api.github.com/users/ashleyholman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ashleyholman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ashleyholman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ashleyholman/subscriptions",
        "organizations_url": "https://api.github.com/users/ashleyholman/orgs",
        "repos_url": "https://api.github.com/users/ashleyholman/repos",
        "events_url": "https://api.github.com/users/ashleyholman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ashleyholman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-05-11T05:28:06Z",
      "updated_at": "2014-05-11T05:28:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "I have reproduced this issue in the latest master branch and can confirm the behaviour as described in the above report.\n\nStep 1: renamed blk00000.dat to blk.00000.dat.moved\nStep 2: Requested block 1 (getdata 000000006a625f06636b8bb6ac7b960a8d03705d1ace08b1a19da3fdcc99ddbd)\nStep 3: Received a \"block\" response with a corrupt block: 020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\nMessages logged in debug.log:\n2014-05-11 05:20:35 Unable to open file /media/btcnode/blocks/blk00000.dat\n2014-05-11 05:20:35 ERROR: ReadBlockFromDisk : OpenBlockFile failed\n\nBoth OpenBlockFile() and its calling function ReadBlockFromDisk() are correctly detecting the error, but the block-serving code in ProcessGetData() is not checking the return value for errors.\n\nA simple solution is to check for the error and not respond to the getdata request if the block was not available on disk.\n\nPull request incoming.\n",
      "user": {
        "login": "ashleyholman",
        "id": 549484,
        "node_id": "MDQ6VXNlcjU0OTQ4NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/549484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ashleyholman",
        "html_url": "https://github.com/ashleyholman",
        "followers_url": "https://api.github.com/users/ashleyholman/followers",
        "following_url": "https://api.github.com/users/ashleyholman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ashleyholman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ashleyholman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ashleyholman/subscriptions",
        "organizations_url": "https://api.github.com/users/ashleyholman/orgs",
        "repos_url": "https://api.github.com/users/ashleyholman/repos",
        "events_url": "https://api.github.com/users/ashleyholman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ashleyholman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/3957#issuecomment-42762608",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3957"
    },
    {
      "event": "referenced",
      "id": 119867809,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDExOTg2NzgwOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/119867809",
      "actor": {
        "login": "ashleyholman",
        "id": 549484,
        "node_id": "MDQ6VXNlcjU0OTQ4NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/549484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ashleyholman",
        "html_url": "https://github.com/ashleyholman",
        "followers_url": "https://api.github.com/users/ashleyholman/followers",
        "following_url": "https://api.github.com/users/ashleyholman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ashleyholman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ashleyholman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ashleyholman/subscriptions",
        "organizations_url": "https://api.github.com/users/ashleyholman/orgs",
        "repos_url": "https://api.github.com/users/ashleyholman/repos",
        "events_url": "https://api.github.com/users/ashleyholman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ashleyholman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "aee8028dbbadb942d0dbf6b809e0b1a46c4995a6",
      "commit_url": "https://api.github.com/repos/ashleyholman/bitcoin/commits/aee8028dbbadb942d0dbf6b809e0b1a46c4995a6",
      "created_at": "2014-05-11T05:34:49Z"
    },
    {
      "event": "commented",
      "id": 44716582,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NzE2NTgy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44716582",
      "actor": {
        "login": "cozz",
        "id": 2814559,
        "node_id": "MDQ6VXNlcjI4MTQ1NTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2814559?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cozz",
        "html_url": "https://github.com/cozz",
        "followers_url": "https://api.github.com/users/cozz/followers",
        "following_url": "https://api.github.com/users/cozz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/cozz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/cozz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/cozz/subscriptions",
        "organizations_url": "https://api.github.com/users/cozz/orgs",
        "repos_url": "https://api.github.com/users/cozz/repos",
        "events_url": "https://api.github.com/users/cozz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/cozz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-05-31T03:18:47Z",
      "updated_at": "2014-05-31T03:18:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "This issue can be closed as it has been fixed.\n",
      "user": {
        "login": "cozz",
        "id": 2814559,
        "node_id": "MDQ6VXNlcjI4MTQ1NTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2814559?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cozz",
        "html_url": "https://github.com/cozz",
        "followers_url": "https://api.github.com/users/cozz/followers",
        "following_url": "https://api.github.com/users/cozz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/cozz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/cozz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/cozz/subscriptions",
        "organizations_url": "https://api.github.com/users/cozz/orgs",
        "repos_url": "https://api.github.com/users/cozz/repos",
        "events_url": "https://api.github.com/users/cozz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/cozz/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/3957#issuecomment-44716582",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3957"
    },
    {
      "event": "closed",
      "id": 126823714,
      "node_id": "MDExOkNsb3NlZEV2ZW50MTI2ODIzNzE0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/126823714",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-06-01T15:48:45Z"
    },
    {
      "event": "locked",
      "id": 5272005045,
      "node_id": "LOE_lADOABII584By2sPzwAAAAE6PGm1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5272005045",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T12:33:03Z",
      "lock_reason": "resolved"
    }
  ]
}