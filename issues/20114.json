{
  "type": "issue",
  "issue": {
    "id": 718307080,
    "node_id": "MDU6SXNzdWU3MTgzMDcwODA=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20114",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20114/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20114/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20114/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/20114",
    "number": 20114,
    "state": "closed",
    "state_reason": "completed",
    "title": "Can't access bitcoind over Tor (error code 1 - \"EOF reached\")",
    "body": "\r\n## Abstract\r\n\r\nI can't access bitcoind over Tor.\r\n\r\nbitcoin.conf: (passwords and onion address are dummy and only for testing purposes)\r\n\r\n```\r\nregtest=1\r\nserver=1\r\nrpcuser=bitcoin\r\nrpcpassword=password\r\ntorpassword=************\r\n```\r\n\r\nThe service is up and running: `bitcoind -listen -debug=tor -printtoconsole -debug=1`\r\n```\r\n2020-10-09T16:57:26Z tor: Connected to Tor version 0.4.4.5\r\n2020-10-09T16:57:26Z tor: Supported authentication method: COOKIE\r\n2020-10-09T16:57:26Z tor: Supported authentication method: HASHEDPASSWORD\r\n2020-10-09T16:57:26Z tor: Supported authentication method: SAFECOOKIE\r\n2020-10-09T16:57:26Z tor: Using HASHEDPASSWORD authentication\r\n2020-10-09T16:57:26Z Loaded 0 addresses from peers.dat  0ms\r\n2020-10-09T16:57:26Z init message: Starting network threads...\r\n2020-10-09T16:57:26Z net thread start\r\n2020-10-09T16:57:26Z tor: Authentication successful\r\n2020-10-09T16:57:26Z init message: Done loading\r\n2020-10-09T16:57:26Z addcon thread start\r\n2020-10-09T16:57:26Z dnsseed thread start\r\n2020-10-09T16:57:26Z 0 addresses found from DNS seeds\r\n2020-10-09T16:57:26Z dnsseed thread exit\r\n2020-10-09T16:57:26Z opencon thread start\r\n2020-10-09T16:57:26Z msghand thread start\r\n2020-10-09T16:57:26Z tor: ADD_ONION successful\r\n2020-10-09T16:57:26Z tor: Got service ID oigbht6zrvck7jxw, advertising service oigbht6zrvck7jxw.onion:18444\r\n2020-10-09T16:57:26Z tor: Cached service private key to /home/gorazd/.bitcoin/regtest/onion_private_key\r\n2020-10-09T16:57:26Z AddLocal(oigbht6zrvck7jxw.onion:18444,4)\r\n```\r\nI can access `bitcoin-cli` over Tor:\r\n```\r\ngorazd@gorazd-MS-7C37:~$ torify bitcoin-cli -rpcconnect=oigbht6zrvck7jxw.onion -rpcport=18444 -rpcpassword=password --version\r\nBitcoin Core RPC client version v0.20.0, Bitcoin Core version v0.20.0\r\ngorazd@gorazd-MS-7C37:~$\r\n```\r\nBut I can't access bitcoind:\r\n```\r\ngorazd@gorazd-MS-7C37:~$ torify bitcoin-cli -rpcconnect=oigbht6zrvck7jxw.onion -rpcport=18444 -rpcuser=bitcoin -rpcpassword=password getblockcount\r\nerror: Could not connect to the server oigbht6zrvck7jxw.onion:18444 (error code 1 - \"EOF reached\")\r\n\r\nMake sure the bitcoind server is running and that you are connecting to the correct RPC port.\r\n```\r\nbitcoind accepts and rejects the connection:\r\n```\r\n2020-10-09T17:00:04Z Added connection peer=0\r\n2020-10-09T17:00:04Z connection from 127.0.0.1:53940 accepted\r\n2020-10-09T17:00:05Z disconnecting peer=0\r\n2020-10-09T17:00:05Z Cleared nodestate for peer=0\r\n```\r\n\r\nWithout Tor it's ok:\r\n```\r\ngorazd@gorazd-MS-7C37:~$ bitcoin-cli -rpcuser=bitcoin -rpcpassword=password getblockcount\r\n0\r\n```\r\n\r\nWhat am I missing?\r\n\r\nSpec:\r\n* Tor version 0.4.4.5.\r\n* Bitcoin Core RPC client version v0.20.0, Bitcoin Core version v0.20.0\r\n* Ubuntu 18.04\r\n",
    "user": {
      "login": "gorazdko",
      "id": 25270775,
      "node_id": "MDQ6VXNlcjI1MjcwNzc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/25270775?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gorazdko",
      "html_url": "https://github.com/gorazdko",
      "followers_url": "https://api.github.com/users/gorazdko/followers",
      "following_url": "https://api.github.com/users/gorazdko/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/gorazdko/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/gorazdko/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/gorazdko/subscriptions",
      "organizations_url": "https://api.github.com/users/gorazdko/orgs",
      "repos_url": "https://api.github.com/users/gorazdko/repos",
      "events_url": "https://api.github.com/users/gorazdko/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/gorazdko/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 3,
    "closed_at": "2020-10-09T21:30:28Z",
    "created_at": "2020-10-09T17:21:22Z",
    "updated_at": "2022-02-15T10:47:59Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 706384090,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjM4NDA5MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/706384090",
      "actor": {
        "login": "Saibato",
        "id": 34917548,
        "node_id": "MDQ6VXNlcjM0OTE3NTQ4",
        "avatar_url": "https://avatars.githubusercontent.com/u/34917548?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Saibato",
        "html_url": "https://github.com/Saibato",
        "followers_url": "https://api.github.com/users/Saibato/followers",
        "following_url": "https://api.github.com/users/Saibato/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Saibato/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Saibato/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Saibato/subscriptions",
        "organizations_url": "https://api.github.com/users/Saibato/orgs",
        "repos_url": "https://api.github.com/users/Saibato/repos",
        "events_url": "https://api.github.com/users/Saibato/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Saibato/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-09T20:18:17Z",
      "updated_at": "2020-10-09T20:23:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "You might try an entry in /etc/tor/torrc like\r\n```\r\nHiddenServiceDir /var/lib/tor/hidden_service/\r\nHiddenServicePort 18443:127.0.0.1:18443\r\n```\r\nrestart Tor and\r\nget the onion addrress from /var/lib/tor/hidden_service/hostbame\r\nand then do a\r\ntorify bitcoin-cli -rpcconnect=theonionaddresugrabbed.onion -rpcport=18443 -rpcuser=bitcoin -rpcpassword=password getblockcount\r\n\r\nthat should work.\r\nBut keep in mind that will open your RPC reachable over Tor, i hope u want this really?\r\n\r\nThe deeper reason is that that torcontroler in bitcoind creates only a listen inbound tor onion for 18444 gossip and not for the rpc on 18443 so local that works without Tor but remote without edit torrc not",
      "user": {
        "login": "Saibato",
        "id": 34917548,
        "node_id": "MDQ6VXNlcjM0OTE3NTQ4",
        "avatar_url": "https://avatars.githubusercontent.com/u/34917548?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Saibato",
        "html_url": "https://github.com/Saibato",
        "followers_url": "https://api.github.com/users/Saibato/followers",
        "following_url": "https://api.github.com/users/Saibato/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Saibato/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Saibato/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Saibato/subscriptions",
        "organizations_url": "https://api.github.com/users/Saibato/orgs",
        "repos_url": "https://api.github.com/users/Saibato/repos",
        "events_url": "https://api.github.com/users/Saibato/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Saibato/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/20114#issuecomment-706384090",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20114"
    },
    {
      "event": "commented",
      "id": 706410888,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjQxMDg4OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/706410888",
      "actor": {
        "login": "gorazdko",
        "id": 25270775,
        "node_id": "MDQ6VXNlcjI1MjcwNzc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25270775?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gorazdko",
        "html_url": "https://github.com/gorazdko",
        "followers_url": "https://api.github.com/users/gorazdko/followers",
        "following_url": "https://api.github.com/users/gorazdko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gorazdko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gorazdko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gorazdko/subscriptions",
        "organizations_url": "https://api.github.com/users/gorazdko/orgs",
        "repos_url": "https://api.github.com/users/gorazdko/repos",
        "events_url": "https://api.github.com/users/gorazdko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gorazdko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-09T21:30:28Z",
      "updated_at": "2020-10-09T21:30:28Z",
      "author_association": "NONE",
      "body": "Thanks it worked!  (HiddenServicePort 18443 127.0.0.1:18443)\r\n",
      "user": {
        "login": "gorazdko",
        "id": 25270775,
        "node_id": "MDQ6VXNlcjI1MjcwNzc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25270775?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gorazdko",
        "html_url": "https://github.com/gorazdko",
        "followers_url": "https://api.github.com/users/gorazdko/followers",
        "following_url": "https://api.github.com/users/gorazdko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gorazdko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gorazdko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gorazdko/subscriptions",
        "organizations_url": "https://api.github.com/users/gorazdko/orgs",
        "repos_url": "https://api.github.com/users/gorazdko/repos",
        "events_url": "https://api.github.com/users/gorazdko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gorazdko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/20114#issuecomment-706410888",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20114"
    },
    {
      "event": "closed",
      "id": 3861863512,
      "node_id": "MDExOkNsb3NlZEV2ZW50Mzg2MTg2MzUxMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3861863512",
      "actor": {
        "login": "gorazdko",
        "id": 25270775,
        "node_id": "MDQ6VXNlcjI1MjcwNzc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25270775?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gorazdko",
        "html_url": "https://github.com/gorazdko",
        "followers_url": "https://api.github.com/users/gorazdko/followers",
        "following_url": "https://api.github.com/users/gorazdko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gorazdko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gorazdko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gorazdko/subscriptions",
        "organizations_url": "https://api.github.com/users/gorazdko/orgs",
        "repos_url": "https://api.github.com/users/gorazdko/repos",
        "events_url": "https://api.github.com/users/gorazdko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gorazdko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-09T21:30:29Z"
    },
    {
      "event": "commented",
      "id": 706416277,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjQxNjI3Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/706416277",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-09T21:53:30Z",
      "updated_at": "2020-10-09T21:54:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "@gorazdko Be aware that the setup described is highly insecure. The RPC port is *not* meant to be reachable for attackers no matter how strong password you've set. Pre-auth RPC issues (and post-auth RPC issues such as #17742) are not even considered vulnerabilities in Bitcoin Core (they get no CVE) since we assume that merely exposing the RPC port is unsafe. More specifically we're operating under the trust boundary assumption that an attacker cannot connect to the RPC port.",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/20114#issuecomment-706416277",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20114"
    },
    {
      "event": "mentioned",
      "id": 3861940568,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50Mzg2MTk0MDU2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3861940568",
      "actor": {
        "login": "gorazdko",
        "id": 25270775,
        "node_id": "MDQ6VXNlcjI1MjcwNzc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25270775?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gorazdko",
        "html_url": "https://github.com/gorazdko",
        "followers_url": "https://api.github.com/users/gorazdko/followers",
        "following_url": "https://api.github.com/users/gorazdko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gorazdko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gorazdko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gorazdko/subscriptions",
        "organizations_url": "https://api.github.com/users/gorazdko/orgs",
        "repos_url": "https://api.github.com/users/gorazdko/repos",
        "events_url": "https://api.github.com/users/gorazdko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gorazdko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-09T22:15:01Z"
    },
    {
      "event": "subscribed",
      "id": 3861940589,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM4NjE5NDA1ODk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3861940589",
      "actor": {
        "login": "gorazdko",
        "id": 25270775,
        "node_id": "MDQ6VXNlcjI1MjcwNzc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/25270775?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gorazdko",
        "html_url": "https://github.com/gorazdko",
        "followers_url": "https://api.github.com/users/gorazdko/followers",
        "following_url": "https://api.github.com/users/gorazdko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gorazdko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gorazdko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gorazdko/subscriptions",
        "organizations_url": "https://api.github.com/users/gorazdko/orgs",
        "repos_url": "https://api.github.com/users/gorazdko/repos",
        "events_url": "https://api.github.com/users/gorazdko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gorazdko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-09T22:15:01Z"
    },
    {
      "event": "locked",
      "id": 6073904719,
      "node_id": "LOE_lADOABII584q0H8IzwAAAAFqCG5P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6073904719",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-15T10:47:59Z",
      "lock_reason": "resolved"
    }
  ]
}